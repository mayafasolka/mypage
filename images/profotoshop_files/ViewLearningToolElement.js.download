function ViewLearningToolElement(a,k,g){function l(){CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.checkCopyStatus.replace("{elementId}",a.elementId)}).done(function(b){b.status!=a.enums.copyStatus.inProgress&&(clearInterval(h),$("#"+a.controls.progressPanel).hide(),e().toggleCloseLink(!1),b.status==a.enums.copyStatus.completed?a.isCopy||e().showMessage(a.enums.feedbackType.information,a.terms.creatingNewVersionSucceededFeedback):b.status==a.enums.copyStatus.failed?a.isCopy?e().showMessage(a.enums.feedbackType.warning,
a.terms.creatingCopyFailedFeedback):e().showMessage(a.enums.feedbackType.warning,a.terms.creatingNewVersionFailedFeedback):b.status!=a.enums.copyStatus.none||a.isCopy?e().showMessage(a.enums.feedbackType.information,a.terms.copyingStatusChangedFeedback):e().showMessage(a.enums.feedbackType.information,a.terms.creatingNewVersionSucceededFeedback))}).error(function(){clearInterval(h)})}function m(b){var c=$("."+a.cssClasses.pageFunctionDependsFromElementActivation);c&&c.length&&(c.toggleHyperlink(b),
c.toggleClass(a.cssClasses.inactive,!b))}function f(){var b=$("#"+a.controls.extensionIframe);return b&&b[0]&&b[0].contentWindow?b[0].contentWindow:null}var d=this,h;(new CCL.AutoIframeResizer({extensionIframeId:a.controls.extensionIframe,extensionContentId:a.controls.extensionContent,iosScrollFixClass:a.cssClasses.iosScrollFix,resizeIframeWidth:a.resizeExtensionIframeWidth})).init();var p=new ItslearningWeb.Onboarding.ViewLearningToolElement.PostMessageDispatcher;if(f()){var q=$("#"+a.controls.extensionIframe);
p.init(a.onboardingServiceUrl,q,a)}CommonFunctions.attachPostMessageEventListener($(window),a.refreshTreeMenuMessageName,function(){var b;(b=window.parent)&&window!=b&&CommonFunctions.makePostMessageCall(b,{messageName:a.refreshTreeMenuMessageName,elementId:a.elementId,folderId:a.folderId})});CommonFunctions.attachPostMessageEventListener($(window),a.refreshElementFrameMessageName,function(){window.location.reload(!0)});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.openPersonProfileCard,
function(a){document.showProfileCard(a.extendedData)});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.backToPreviousPage,function(){document.location.replace(a.backPageUrl)});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.cloudFilePermissionError,function(){window.location.replace(a.cloudFilePermissionErrorUrl)});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.askExtensionParentFrameWhetherTopFrameExists,
function(){var a=!1;try{a=window.self!==window.itslTop}catch(n){}var c=f();c&&a&&(a=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.replyToExtensionFrameWhenTopFrameExists),CCL.CommonFunctions.makePostMessageCall(c,a))});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.askWhetherItslearningIsEmbedded,function(){var b=f();if(b&&a.isItslearningEmbedded){var c=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.replyIfItslearningIsEmbedded);
CCL.CommonFunctions.makePostMessageCall(b,c)}else(c=window.parent)&&window!==c&&CommonFunctions.makePostMessageCall(c,new CCL.CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.askWhetherItslearningIsEmbedded))});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.replyIfItslearningIsEmbedded,function(){var a=f();if(a){var c=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.replyIfItslearningIsEmbedded);CCL.CommonFunctions.makePostMessageCall(a,
c)}});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.replaceTopFrame,function(a){if(a&&a.url){var b;(b=window.parent)&&window!==b?CommonFunctions.makePostMessageCallWithData(b,new CCL.CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.replaceTopFrame),{url:a.url}):window.location.replace(a.url)}});CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.scrollToTop,function(){$(window).scrollTop(0)});
g&&g();if(a.canEdit){a.copyStatus==a.enums.copyStatus.inProgress&&(h=setInterval(l,1E3));g=new ItslearningWeb.Controls.ElementTitleEditor($("#"+a.controls.titleLabel),a.elementTitleEditorClientSettings,a.elementId,a.folderId);if(k)$(g).on("change",k);$(g).on("change",function(a){var b=f();if(b){var n=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionTitleUpdated);CCL.CommonFunctions.makePostMessageCallWithData(b,n,{newTitle:a})}})}(function(){CCL.CommonFunctions.attachPostMessageEventListener($(window),
CommonWindowMessages.MessageNames.elementAddedToYourCollection,function(){var b=window.location.href.split("#")[0];window.location.href=b.setQueryStringParameter(a.addedParam,(!0).toString())})})();CCL.IframeContentHeightReporter.attachExtensionContentOpenedListenerForIframe(a.controls.extensionIframe,a.resizeExtensionIframeWidth);m(a.isActive);d.closeManageRubricDialog=function(){var b=$("#"+a.rubricDialogClientInstanceName).find("iframe").get(0).contentWindow;CCL.CommonFunctions.makePostMessageCall(b,
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.submitIframe))};d.showCopyConfirmation=function(b){$.alerts.okButton=b;$.alerts.cancelButton=a.terms.cancel;jConfirm(a.terms.startCopyingConfirmation,a.terms.pleaseConfirm,function(b){b&&CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.startCopying.replace("{elementId}",a.elementId)}).done(function(b){b.success&&(a.isCopy=!1,d.showProgressMessage(a.terms.creatingNewVersionProgressFeedback),h=setInterval(l,1E3))})})};
d.showProgressMessage=function(b){$("#"+a.controls.progressPanel).show();$("#"+a.controls.progressLabel).text(b);e().hide(!1)};d.flushCopyStatus=function(){CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.flushCopyStatus.replace("{elementId}",a.elementId)})};d.printContentFrame=function(b){var c=f();c&&CommonFunctions.makePostMessageCall(c,{messageName:CommonWindowMessages.MessageNames.extensionPrintContentFrame,headerText:b,headerHtml:'<h1 css="'+a.cssClasses.title+'" style="margin-bottom:16px;">'+
b+"</h1>"});return!1};d.notifyAboutChanges=function(){$.alerts.okButton=a.terms.ok;$.alerts.cancelButton=a.terms.cancel;jConfirm(a.terms.notifyAboutChangesConfirmation,a.terms.pleaseConfirm,function(b){b&&CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.notifyAboutChanges,data:{elementId:a.elementId}}).fail(CCL.CommonFunctions.alertAjaxError)});return!1};d.sendElementReminders=function(){$.alerts.okButton=a.terms.sendRemindersYes;$.alerts.cancelButton=a.terms.cancel;jConfirm(a.terms.sendRemindersDetails,
a.terms.sendReminders,function(b){b&&CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.sendReminders,data:{elementId:a.elementId}}).fail(CCL.CommonFunctions.alertAjaxError)});return!1};var e=function(){return window[a.copyStatusFeedbackInstanceName]};d.copyToClipboardOk=function(b){var c=null,d=null;"CopyLink"==b?(c=$("#"+a.controls.linkText),d=$("#"+a.controls.copyLinkToClipboardOkIcon)):(c=$("#"+a.controls.embedCodeText),d=$("#"+a.controls.copyEmbedCodeToClipboardOkIcon));b=d.css("width");d.parent().css("width",
b);(function(a){var b=document.createElement("input");b.style.position="fixed";b.style.opacity=0;b.value=a;document.body.appendChild(b);b.select();document.execCommand("copy");document.body.removeChild(b)})(c.val());d.prev().hide();d.fadeIn(500);setTimeout(function(){d.hide().prev().fadeIn(400)},1E3)};d.changePageFunctionsState=function(a){m(a)}};
