var __extends=this&&this.__extends||function(c,g){function k(){this.constructor=c}for(var e in g)g.hasOwnProperty(e)&&(c[e]=g[e]);c.prototype=null===g?Object.create(g):(k.prototype=g.prototype,new k)},ItslearningWeb;
(function(c){(function(c){var g=function(){return function(e){this.context=e;this.selectedItemsCount=function(){var b=$("td [id^='"+c.courseManagerInstance.context.Controls.SelectedItemsClientId+"']:not([id='"+c.courseManagerInstance.context.Controls.SelectAllItemsCheckboxClientId+"'])");if(!b||0===b.length)return 0;if(c.courseManagerInstance.context.Controls.PerformAllCheckbox.is(":checked"))return c.courseManagerInstance.context.Settings.CoursesVirtualCount;var a=0,d=0;for(b=b.get();d<b.length;d++)b[d].checked&&
a++;return a};this.hideArchiveFilter=function(b){var a=$("."+c.courseManagerInstance.context.Settings.ArchiveDateCssClass).parent();$("#"+c.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").first().attr("id")===b.target.id?a.hide():a.show()};this.clickOnAction=function(b){if($(b.currentTarget).parent().hasClass(c.courseManagerInstance.context.Settings.ToolbarItemDisabledCssClass))return!1;var a=c.courseManagerInstance.selectedItemsCount();return 0!==a&&confirm(CCL.CommonFunctions.formatString(b.data.text,
a))};this.context=e;c.courseManagerInstance=this;$("#"+c.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").first().is(":checked")&&$("."+c.courseManagerInstance.context.Settings.ArchiveDateCssClass).parent().hide();$("#"+c.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").click(this.hideArchiveFilter);c.courseManagerInstance.context.Controls.DeleteAction.on("click",null,{text:c.courseManagerInstance.context.LanguageTerms.DeleteConfirmText},
this.clickOnAction);c.courseManagerInstance.context.Controls.ArchiveAction.on("click",null,{text:c.courseManagerInstance.context.LanguageTerms.ArchiveConfirmText},this.clickOnAction);c.courseManagerInstance.context.Controls.UnarchiveAction.on("click",null,{text:c.courseManagerInstance.context.LanguageTerms.UnarchiveConfirmText},this.clickOnAction);if(c.courseManagerInstance.context.Controls.EnrolAction.length)c.courseManagerInstance.context.Controls.EnrolAction.on("click",null,{text:c.courseManagerInstance.context.LanguageTerms.EnrolConfirmText},
this.clickOnAction);if(c.courseManagerInstance.context.Controls.WithdrawAction.length)c.courseManagerInstance.context.Controls.WithdrawAction.on("click",null,{text:c.courseManagerInstance.context.LanguageTerms.WithdrawConfirmText},this.clickOnAction)}}();c.CourseManager=g})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(e){var b=this;this.settings=this.settings=e;$(function(){function a(){l.is(":checked")?(e.removeAttribute("readonly"),e.removeEventListener("click",f)):(e.setAttribute("readonly","true"),e.addEventListener("click",f))}function d(){l.is(":checked")?(c.removeProp("readonly"),c.off("click",h)):(c.prop("readonly","readonly"),c.on("click",h))}function f(){return!1}function h(){return!1}var l=$("#"+b.settings.PlannerCheckboxClientId),e=document.getElementById(b.settings.PlannerCheckboxClientId),
c=$("#"+b.settings.TopicsInPlannerCheckboxClientId);a();d();l.on("change",function(){a();d()})})}}();c.EditDefaultCourseSettings=g})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){var a=this;this.context=b;c.editPolicyInstance=this;b.Settings.IsBroadcastMassMessageEnabled&&b.Settings.CanChangeOrganization&&b.Settings.CanSitePermissionBeSelectedForMassMessaging&&$("#"+b.Controls.OrganizationsDropdownClientId).change(function(d){a.onOrganizationChanged(d)})}e.prototype.checkEsafetyChanged=function(){if(c.editPolicyInstance.context.Settings.IsInstantMessageSystemEnabled&&c.editPolicyInstance.context.Settings.IsEditMode){var b=
[];CCL.CommonFunctions.checkAndAddRole(c.editPolicyInstance.context.Settings.EsafetyStaffChecked,c.editPolicyInstance.context.Controls.StaffCheckboxClientId,c.editPolicyInstance.context.LanguageTerms.Staff,b);CCL.CommonFunctions.checkAndAddRole(c.editPolicyInstance.context.Settings.EsafetyStudentChecked,c.editPolicyInstance.context.Controls.StudentCheckboxClientId,c.editPolicyInstance.context.LanguageTerms.Student,b);CCL.CommonFunctions.checkAndAddRole(c.editPolicyInstance.context.Settings.EsafetyGuestChecked,
c.editPolicyInstance.context.Controls.GuestCheckboxClientId,c.editPolicyInstance.context.LanguageTerms.Guest,b);var a="";$("#"+c.editPolicyInstance.context.Controls.InitiateCommunicationCheckBoxClientId).is(":checked")&&(a="\n"+c.editPolicyInstance.context.LanguageTerms.AdditionEsafetyText);switch(b.length){case 1:alert(CCL.CommonFunctions.formatString(c.editPolicyInstance.context.LanguageTerms.UncheckedOneEsafetyRoleText,b[0])+a);break;case 2:alert(CCL.CommonFunctions.formatString(c.editPolicyInstance.context.LanguageTerms.UncheckedTwoEsafetyRolesText,
b[0],b[1])+a);break;case 3:alert(CCL.CommonFunctions.formatString(c.editPolicyInstance.context.LanguageTerms.UncheckedThreeEsafetyRolesText)+a)}}};e.prototype.toogleEsafetyDropDown=function(b,a){document.getElementById(b).style.visibility=document.getElementById(a).checked?"visible":"hidden"};e.prototype.onOrganizationChanged=function(b){(b=b.target)&&this.toggleSiteOptionInBroadcastMassMessagingDropdown(b.options[b.selectedIndex].value===this.context.Settings.SiteOrganizationId.toString())};e.prototype.toggleSiteOptionInBroadcastMassMessagingDropdown=
function(b){var a=$("#"+this.context.Controls.BroadcastMassMessageDropdownClientId+" option[value='"+this.context.Settings.BroadcastMassMessageSchoolPermission+"']");b?(b=$("<option value='"+this.context.Settings.BroadcastMassMessageSitePermission+"'>"+this.context.LanguageTerms.Site+"</option>"),a.before(b)):(b=$("#"+this.context.Controls.BroadcastMassMessageDropdownClientId+" option:selected").val(),$("#"+this.context.Controls.BroadcastMassMessageDropdownClientId+" option[value='"+this.context.Settings.BroadcastMassMessageSitePermission+
"']").remove(),b===this.context.Settings.BroadcastMassMessageSitePermission.toString()&&a.attr("selected","selected"))};return e}();c.EditPolicy=g})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){return function(b){var a=this;this.controls={checkbox:null,newActionButton:null,radioButtons:null,textArea:null,confirmButton:null};this.sections={recentActions:null,newAction:null,reason:null,confirmation:null};this.initialize=function(d){a.initializeSections(d);a.initializeControls(d);setTimeout(a.revealElements,0)};this.initializeSections=function(d){a.sections.recentActions=$("#"+d.RecentActionsSectionId);a.sections.newAction=$("#"+d.NewActionSectionId);
a.sections.reason=$("#"+d.ReasonSectionId);a.sections.confirmation=$("#"+d.ConfirmationSectionId)};this.initializeControls=function(d){a.controls.checkbox=$("#"+d.CheckboxId);a.controls.newActionButton=$("#"+d.NewActionButtonId);a.controls.radioButtons=$("#"+d.NewActionSectionId+" input");a.controls.textArea=$("#"+d.TextAreaId);a.controls.confirmButton=$("#"+d.ConfirmButtonId);a.controls.checkbox.change(a.onCheckboxClick);a.controls.newActionButton.on("click",a.onNewActionButtonClick);a.controls.radioButtons.on("change",
a.onRadioButtonClick);CCL.TextAreaExtensions.setMaxLength(a.controls.textArea,d.ReasonMaxLength);a.controls.textArea.on("input change",a.onTextAreaUpdate)};this.onCheckboxClick=function(d){d.target.checked||(a.hasNewActionButtonBeenPressed=!1);a.revealElements()};this.onNewActionButtonClick=function(){a.hasNewActionButtonBeenPressed=!0;a.revealElements()};this.onRadioButtonClick=function(){a.revealElements()};this.onTextAreaUpdate=function(){a.revealElements()};this.revealElements=function(){var d=
!1,f=!0,b=!1,l=!1,e=!1,c=!1;a.isUserConfirmed()&&(d=!0,a.hasNewActionButtonBeenPressed&&(f=!1,b=!0,a.isActionSelected()&&(e=l=!0,a.isReasonProvided()&&(c=!0))));a.showOrHideElement(a.sections.recentActions,d);a.showOrHideElement(a.controls.newActionButton,f);a.showOrHideElement(a.sections.newAction,b,function(){a.controls.radioButtons.each(function(){$(this).prop("checked",!1)})});a.showOrHideElement(a.sections.reason,l,function(){a.controls.textArea.val("")});a.showOrHideElement(a.sections.confirmation,
e);a.controls.confirmButton.prop("disabled",!c)};this.showOrHideElement=function(a,f,b){void 0===b&&(b=function(){});f?a.show():(a.hide(),b())};this.isUserConfirmed=function(){return a.controls.checkbox.is(":checked")};this.isActionSelected=function(){return a.controls.radioButtons.is(":checked")};this.isReasonProvided=function(){return""!=a.controls.textArea.val().trim()};$(function(){return a.initialize(b)})}}();c.Default=e})(c.Gdpr||(c.Gdpr={}))})(c.Administration||(c.Administration={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(g){(function(g){var e=function(){function b(a){var d=this;this.context=a;this.onDialogAddButtonClick=function(a){var f=[];a.forEach(function(a,d){a!==c.CheckboxStateMachine.State.Saved&&a!==c.CheckboxStateMachine.State.AttachedByUser||f.push(d)});d.selectedHierarchyIds.val(f.join());d.isHierarchySelectionChanged=!0};this.onDialogClosed=function(){d.isHierarchySelectionChanged&&d.context.Scripts.SelectHierarchyScript()};this.setupHierarchyLinkClickHandler()}Object.defineProperty(b.prototype,
"selectedHierarchyIds",{get:function(){return $("#"+this.context.Controls.SelectedHierarchyIds)},enumerable:!0,configurable:!0});b.prototype.setupHierarchyLinkClickHandler=function(){var a=this,d=c.Controls.HierarchyDialog.hierarchyDialogManagerInstance,f=this.selectedHierarchyIds.val()?this.selectedHierarchyIds.val().split(","):[];if(d)$("#"+this.context.Controls.AddHierarchyLinkId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){a.isHierarchySelectionChanged=!1;var b=new Map;
f.forEach(function(a){b.set(parseInt(a),c.CheckboxStateMachine.State.Saved)});d.openDialog({itemStates:b,disabledItemIds:[],header:a.context.Resources.HierarchyDialogHeader,afterOkClickCallback:a.onDialogAddButtonClick,afterCloseDialogCallback:a.onDialogClosed,allowFolderSelection:!0},{})})};return b}();g.AddEditModuleApps=e})(g.ManageApps||(g.ManageApps={}))})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(){function a(a,f,b,l){this.utility=a;this.editorCallbacks=f;this.cssClasses=b;this.terms=l}a.prototype.buildCommonMarkup=function(a,f,b,l,e,c,g,k,q,u,w,t){void 0===k&&(k=null);void 0===q&&(q=!1);void 0===u&&(u=!1);void 0===w&&(w=!0);b&&this.buildSectionTitle(a,l,e);k&&k();this.buildContentMarkup(a,f.editable&&g,!u&&q,c,u,w,t)};a.prototype.buildSectionTitle=function(a,f,b){$("<div>").addClass(f).text(b).appendTo(a)};a.prototype.getEditorBinding=
function(a,f){var d=this;return{element:f,event:a,watermarkText:this.getTextContainerWatermark(a),cachedText:this.getCachedText(a),cachedPlainText:this.getCachedPlainText(a),isPlainText:this.isPlainText(a),sendTextAjax:function(b){return d.sendTextAjax(a,f,b)}}};a.prototype.checkEventHasAttachedResources=function(a,f){return a.bookedResources&&0<a.bookedResources.length||a.PlanIds&&0<a.PlanIds.length||0<this.utility.getAddedElementsCount(f)};a.prototype.buildContentMarkup=function(a,f,b,l,e,k,p){var d=
this,h=$("<div>");p&&h.addClass(this.utility.settings.cssClasses.ModernInputTextEditor).addClass(this.utility.settings.cssClasses.ModernInputTextIsValid).appendTo(a);var m=$("<div>").addClass(this.cssClasses.inlineEditContainer).appendTo(p?h:a),n=$("<div>");e?n.text(l.cachedText):(n.html(l.cachedText),b&&CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(n));n.addClass(this.utility.settings.cssClasses.UserInput).appendTo(m);f&&(l.isPlainText?(m.addClass(this.utility.settings.cssClasses.TextContainerEditable),
n.css("cursor","pointer"),n.css("outline","none"),n.prop("tabindex",0),l.cachedText.trim()||n.addClass(this.utility.settings.cssClasses.TextContainerWatermark).text(l.watermarkText),n.one("click keyup",function(){if(void 0===m.find("textarea")[0]&&0===m.find("div[data-created-marker=true]").length&&(n.attr("data-created-marker","true"),(new g.InlineEdit.InlineEditContent(m,d.utility,d.editorCallbacks,l,e,k,p?p.inputValidationFunction:null)).makeTextContentInlineEditable(),p)){var a=new c.InputValidator(d.utility,
h,p);a.createValidationMessageContainer();d.editorCallbacks.onEditFinished=function(){a.resetValidation()}}})):n.prop("title",this.terms.isNotEditableTooltip));e||CCL.CommonFunctions.executeScripts(l.cachedText)};return a}();e.MarkupBuilderBase=b})(g.EventTextContent||(g.EventTextContent={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a){this.utility=a}a.prototype.buildMarkup=function(a,f){(f.editable||f.PreviousEvent.ExtraDescription&&f.PreviousEvent.ExtraDescription.length)&&$("<div>").addClass(this.utility.settings.cssClasses.DescriptionApiLabel).text(this.utility.settings.terms.ApiDescriptionLabel).appendTo(a);$("<div>").addClass(this.utility.settings.cssClasses.UserInput).addClass(this.utility.settings.cssClasses.DescriptionApi).html(f.apiDescription).appendTo($(a))};
return a}();e.ApiDescriptionMarkupBuilder=b})(c.EventTextContent||(c.EventTextContent={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){this.utility=a;this.defaultTitleHeight=20;this.defaultDescriptionHeight=86;this.cssClasses=this.utility.settings.cssClasses;this.controls=this.utility.controls}b.prototype.getFilterItemIds=function(a,d){var f=[],b=0;for(a=this.getFilterItemsList(a);b<a.length;b++){var l=a[b];!d===!this.filterItemChecked(l)&&f.push(+l.dataset.itemid)}return f};b.prototype.getFilterItemIdsWithColors=function(a,d){var f=[],b=[],l=0;for(a=this.getFilterItemsList(a);l<
a.length;l++){var e=a[l];!d===!this.filterItemChecked(e)&&(f.push(+e.dataset.itemid),b.push(+e.dataset.itemcolor))}return{persons:f.join(),colors:b.join()}};b.prototype.toggleDescriptionInlineEditorModes=function(a,d){d&&!a.isPlainTextInDescription?(this.controls.AddEventReadOnlyDescriptionContainer.innerHTML=a.description,this.controls.AddEventReadOnlyDescriptionContainer.style.display="block",this.controls.AddEventEditableDescriptionContainer.style.display="none",CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick($(this.controls.AddEventReadOnlyDescriptionContainer))):
(this.controls.AddEventReadOnlyDescriptionContainer&&(this.controls.AddEventReadOnlyDescriptionContainer.innerHTML="",this.controls.AddEventReadOnlyDescriptionContainer.style.display="none"),this.controls.AddEventEditableDescriptionContainer.style.display="block",this.controls.addEventDescriptionBox[0].value=d&&a.descriptionPlainText||"");this.utility.settings.customerSettings.enableFrenchCalendarLayout&&(d&&!a.isPlainTextInExtraDescription?(this.controls.AddEventReadOnlyExtraDescriptionContainer.innerHTML=
a.extraDescription,this.controls.AddEventReadOnlyExtraDescriptionContainer.style.display="block",this.controls.AddEventEditableExtraDescriptionContainer.style.display="none",CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick($(this.controls.AddEventEditableExtraDescriptionContainer))):(this.controls.AddEventReadOnlyExtraDescriptionContainer&&(this.controls.AddEventReadOnlyExtraDescriptionContainer.innerHTML="",this.controls.AddEventReadOnlyExtraDescriptionContainer.style.display="none"),
this.controls.AddEventEditableExtraDescriptionContainer.style.display="block",this.controls.addEventExtraDescriptionBox[0].value=d&&a.extraDescriptionPlainText||""))};b.prototype.resetInputFieldsToDefault=function(a){this.controls.addEventChooseCategoryErrorMessageLabel[0].style.display="none";this.controls.addEventResponseErrorMessageLabel[0].style.display="none";this.controls.AddEventTitleTextBox[0].value=a;this.controls.addEventDescriptionBox[0].value="";this.controls.addEventExtraDescriptionBox[0]&&
(this.controls.addEventExtraDescriptionBox[0].value="");this.controls.AddEventTitleTextBox[0].style.height=this.defaultTitleHeight+"px";this.controls.addEventDescriptionBox[0].style.height=this.defaultDescriptionHeight+"px";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].style.height=this.defaultDescriptionHeight+"px")};b.prototype.adjustHeights=function(){this.controls.AddEventTitleTextBox[0].style.height=this.controls.AddEventTitleTextBox[0].scrollHeight+
"px";this.controls.addEventDescriptionBox[0].style.height=this.controls.addEventDescriptionBox[0].scrollHeight+"px";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].style.height=this.controls.addEventExtraDescriptionBox[0].scrollHeight+"px")};b.prototype.setUserInputsIfNeeded=function(a){if(a){if(!a.IsEventTitleReadOnly){var d=this.controls.eventDetailsMainContainer.querySelector("."+this.cssClasses.Title+" > ."+this.cssClasses.UserInput);d&&(a.EventTitle=
!d.classList.contains(this.cssClasses.TextContainerWatermark)&&d.innerText||"")}a.isPlainTextInDescription&&(d=this.controls.eventDetailsMainContainer.querySelector("."+this.cssClasses.Description+" > ."+this.cssClasses.UserInput))&&(a.description=!d.classList.contains(this.cssClasses.TextContainerWatermark)&&d.innerHTML||"");this.utility.settings.customerSettings.enableFrenchCalendarLayout&&a.showExtraDescription&&a.isPlainTextInExtraDescription&&(d=this.controls.eventDetailsMainContainer.querySelector("."+
this.cssClasses.DescriptionExtra+" > ."+this.cssClasses.UserInput))&&(a.extraDescription=!d.classList.contains(this.cssClasses.TextContainerWatermark)&&d.innerHTML||"")}};b.prototype.getFilterItemsList=function(a){return a&&Object.assign([],a.getElementsByClassName(this.cssClasses.FilterItem))||[]};b.prototype.filterItemChecked=function(a){return a.querySelector("input").checked};return b}();c.Schedule=e})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb=
{}));(function(c){c=c.Calendar||(c.Calendar={});c=c.Schedule||(c.Schedule={});c=c.SelfRegistrationAttendance||(c.SelfRegistrationAttendance={});c=c.SelfRegisteredPersonAttendanceStatus||(c.SelfRegisteredPersonAttendanceStatus={});c[c.None=0]="None";c[c.NotSet=1]="NotSet";c[c.Success=2]="Success";c[c.RegistrationClosed=3]="RegistrationClosed";c[c.AttendanceChangedByTeacher=4]="AttendanceChangedByTeacher"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a){this.utility=a;this.terms=this.utility.settings.terms;this.cssClasses=this.utility.settings.cssClasses}a.prototype.buildMarkup=function(a,f,b){if(f.showSelfRegistrationOfAttendanceSection&&!f.editable&&f.selfRegisteredAttendanceStatus!==e.SelfRegisteredPersonAttendanceStatus.None){var d=document.createElement("div");d.classList.add(this.utility.settings.cssClasses.SelfRegistrationLabel);d.innerText=this.utility.settings.terms.SelfRegistration;
var h=document.createElement("div");h.appendChild(d);f.selfRegisteredAttendanceStatus===e.SelfRegisteredPersonAttendanceStatus.NotSet?this.buildSelfRegistrationButton(h,b):this.buildSelfRegisteredAttendanceStatus(h,f.selfRegisteredAttendanceStatus);a[0].appendChild(h)}};a.prototype.buildSelfRegistrationButton=function(a,f){var d=document.createElement("button");d.type="button";d.setAttribute("aria-label",this.terms.RegisterPresence);d.addEventListener("click",f);d.classList.add(this.cssClasses.Button);
d.classList.add(this.cssClasses.SelfRegistrationButton);f=document.createTextNode(this.terms.RegisterPresence);d.appendChild(f);f=document.createElement("div");f.classList.add(this.utility.settings.cssClasses.MarginBottom20);f.classList.add(this.utility.settings.cssClasses.MarginTop10);f.appendChild(d);$(f).appendTo($(a))};a.prototype.buildSelfRegisteredAttendanceStatus=function(a,f){var d="",b="";switch(f){case e.SelfRegisteredPersonAttendanceStatus.Success:d=this.terms.PresenceRegistered;b=this.cssClasses.SelfRegistrationStatusSuccess;
break;case e.SelfRegisteredPersonAttendanceStatus.RegistrationClosed:d=this.terms.SelfRegistrationClosed;b=this.cssClasses.SelfRegistrationStatusClosed;break;case e.SelfRegisteredPersonAttendanceStatus.AttendanceChangedByTeacher:d=this.terms.PresenceChangedToAbsence,b=this.cssClasses.SelfRegistrationStatusChanged}""!==d&&(f=document.createElement("div"),f.classList.add(this.cssClasses.SelfRegistrationStatusLabel),f.classList.add(b),d=document.createTextNode(d),f.appendChild(d),$(f).appendTo($(a)))};
return a}();e.SelfRegistrationSectionMarkupBuilder=b})(c.SelfRegistrationAttendance||(c.SelfRegistrationAttendance={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d){var f=this;this.controls=a;this.settings=d;c.multipleCourseSearchSelectorDialogClientInstance=this;this.modalDialog=window[this.dialogId];this.controls.CourseSearchButton&&(this.controls.CourseSearchButton.onclick=function(){f.inputSelectize.isOpen?f.inputSelectize.close():f.inputSelectize.open()});this.controls.AddButton.onclick=function(a){f.preventDefaultOnSave&&a.preventDefault();f.updateSelectedCourses();f.settings.OnSaveCallback&&
f.settings.OnSaveCallback(a)};this.modalDialog.setCustomScripts({afterCloseDialog:function(){f.modalDialog.clearLastActiveElement();f.inputSelectize.blur()},afterOpenDialog:function(){f.inputSelectize.close();f.inputSelectize.focus();setTimeout(function(){f.refreshSelectedCourses()},10)}});this.initSelectize();this.inputSelectize.hideInput=function(){this.setTextboxValue("");this.$control_input.css({opacity:0});this.isInputHidden=!0};var b=this.inputSelectize.$dropdown,e=this.inputSelectize.$control;
this.inputSelectize.positionDropdown=function(){b.position({my:"left top",at:"left bottom",of:e,collision:"none"});b.css("width",e.outerWidth())}}Object.defineProperty(b.prototype,"dialogId",{get:function(){return this.controls.Container.id},enumerable:!0,configurable:!0});b.prototype.setCoursesToSelectFrom=function(a){this.settings.CoursesAvailableToSelect=a;this.inputSelectize.clearOptions();this.updateSearchInput()};b.prototype.setMaxItems=function(a){this.inputSelectize.settings.maxItems=a};b.prototype.openDialog=
function(a,d,f){void 0===f&&(f=!0);this.settings.OnSaveCallback=d;this.preventDefaultOnSave=f;this.modalDialog.openDialog(!1);this.selectedCourses=a};Object.defineProperty(b.prototype,"selectedCourses",{get:function(){return this.selectedCoursesArray},set:function(a){this.selectedCoursesArray=a},enumerable:!0,configurable:!0});b.prototype.updateSelectedCourses=function(){var a=this;this.selectedCourses=this.inputSelectize.items?this.inputSelectize.items.map(function(d){return a.settings.CoursesAvailableToSelect.filter(function(a){return a.CourseId===
parseInt(d,10)})[0]}):[]};b.prototype.getAvailableCoursesCount=function(){return this.settings.CoursesAvailableToSelect.length};b.prototype.clear=function(){this.inputSelectize.clear(!0)};b.prototype.toggleError=function(a){var d=this.controls.Container.querySelector("."+this.settings.CssClasses.SelectizeInput);a?d.classList.add(this.settings.CssClasses.ModernInputInvalid):d.classList.remove(this.settings.CssClasses.ModernInputInvalid)};b.prototype.initSelectize=function(){var a=this,d=$(this.controls.CourseSearchInput);
d.selectize({valueField:"Value",plugins:{"selectize-plugin-a11y":{},remove_button:{title:this.settings.Terms.Remove},no_results:{message:this.settings.Terms.NoMatches}},searchField:["Label"],highlight:!1,openOnFocus:!0,closeAfterSelect:!0,preload:"focus",addPrecedence:!0,persist:!1,loadThrottle:null,maxOptions:0<this.settings.MaxNumberOfCoursesToShow?this.settings.MaxNumberOfCoursesToShow:void 0,placeholder:this.settings.Terms.FindCourses,diacritics:!1,render:{item:function(d,b){return'<div class="itsl-selectize-item"><span class="'+
a.settings.CssClasses.CourseIconClass+" "+d.ColorCssClass+'"></span><span class="itsl-selectize-item-label">'+b(d.Label)+"</span></div>"},option:function(d,b){return'<div class="itsl-selectize-option"><span class="'+a.settings.CssClasses.CourseIconClass+" "+d.ColorCssClass+'"></span><span class="itsl-selectize-option-label">'+b(d.Label)+"</span></div>"}},load:function(){a.settings.CoursesAvailableToSelect.forEach(function(d){a.inputSelectize.addOption({Label:d.Title,Value:d.CourseId,ColorCssClass:d.ColorCssClass})});
a.inputSelectize.refreshOptions()},onItemAdd:function(){a.updateSearchInput();a.inputSelectize.$control[0].scrollTop=a.inputSelectize.$control[0].scrollHeight;a.settings.OnItemAddCallback&&a.settings.OnItemAddCallback()},onItemRemove:function(){a.updateSearchInput();a.settings.OnItemRemoveCallback&&a.settings.OnItemRemoveCallback()},onFocus:function(){a.updateSearchInput()}});this.inputSelectize=d[0].selectize;this.inputSelectize.$control.click(function(){return a.inputSelectize.open()});this.inputSelectize.$control_input.keypress(function(a){a.which===
CCL.CommonConstants.keyCodes.enter&&a.preventDefault()}).keyup(function(d){d.which===CCL.CommonConstants.keyCodes.escape&&a.inputSelectize.isFocused&&d.stopPropagation()})};b.prototype.refreshSelectedCourses=function(){var a=this.selectedCourses?this.selectedCourses.map(function(a){return a.CourseId.toString()}):[];this.inputSelectize.setValue(a,!0)};b.prototype.updateSearchInput=function(){this.inputSelectize.loadedSearches={};this.inputSelectize.lastQuery=null;this.inputSelectize.refreshOptions()};
return b}();c.MultipleCourseSearchSelector=e})(c.MultipleCourseSearchSelector||(c.MultipleCourseSearchSelector={}))})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){this.settings=a;window[b.instanceName]=this}b.prototype.countDown=function(a,d){var f=this,b=document.querySelector("[id$='"+this.settings.TimerPrefix+a+"']"),e=document.querySelector("[id$='"+this.settings.EditLinkPrefix+a+"']");e&&b&&(0<d?(b.innerHTML=this.settings.EditMessagePart1+" "+d+" "+this.settings.EditMessagePart2,--d,setTimeout(function(){f.countDown(a,d)},6E4)):(b.style.display="none",e.style.display="none"))};b.getInstance=
function(){return window[b.instanceName]};b.instanceName="ThreadViewTableClientInstance";return b}();c.ThreadViewTable=e})(c.Discussion||(c.Discussion={}))})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d){var f=this;this.controls=a;this.settings=d;this.modalDialog=window[this.getDialogId()];this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){var a=window[f.settings.TreeViewSelectorContainerId];a.init({allowFolderSelection:!0,itemStates:f.currentParams.itemStates,disabledItemIds:f.currentParams.disabledItemIds});var d=0<a.countCheckedItems();f.controls.OkButton.prop("disabled",
!d);f.controls.Container.on(a.settings.StateChangedEventName,function(a,d){f.controls.OkButton.prop("disabled",0===d)});a.onFolderContentLoaded();d=f.controls.Container.find(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.ItemId)).first();a.expandFolder(d)},afterCloseDialog:function(){void 0!==f.currentParams.afterCloseDialogCallback&&f.currentParams.afterCloseDialogCallback()}})}b.prototype.openDialog=function(a,d){this.currentParams=a;$.extend(d,{treeViewContainerId:this.settings.TreeViewSelectorContainerId});
this.ajaxParams=d;this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,d,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1)};b.prototype.closeDialog=function(){CssModal.closeDialog()};b.prototype.getDialogId=function(){return this.controls.Container.prop("id")};b.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.on("click",function(d){a.currentParams.afterOkClickCallback(a.currentParams.itemStates);a.closeDialog();d.preventDefault()})};
return b}();c.HierarchyDialogManager=e})(c.HierarchyDialog||(c.HierarchyDialog={}))})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.options=new Map;this.optionsGroup=b;this.options=new Map;a.forEach(function(a){return d.options.set(a[0],a[1])});this.optionsGroup.on("keydown","label",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.enter||a.keyCode===CCL.CommonConstants.keyCodes.space)return $(a.target).click(),a.preventDefault(),!1})}e.prototype.isSelected=function(b){return this.isOptionSelected(this.options.get(b))};e.prototype.addOnChangeHandler=
function(b){this.optionsGroup.on("change","input:radio",b)};e.prototype.isOptionSelected=function(b){return b.is(":checked")};return e}();c.OptionRadioButtonManagerBase=g})(c.OptionRadioButton||(c.OptionRadioButton={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(g){var e=function(){function b(a,d){var f=this;this.controls=a;this.settings=d;this.optionRadioManager=new c.OptionRadioButton.OptionRadioButtonManagerBase(this.controls.RadioButtonGroup,[[g.PrivacyChangedDialogActionType.MakeReadOnly,this.controls.RadioButtonReadOnly],[g.PrivacyChangedDialogActionType.LeaveOpen,this.controls.RadioButtonLeaveOpen]]);this.optionRadioManager.addOnChangeHandler(function(){f.switchState()});g.privacyChangedDialogManagerInstance.toggleOkButton(0===
this.getSelectedProfilesIds().length);this.controls.ProfileCheckboxesByCss.off("change").on("change",function(a){g.privacyChangedDialogManagerInstance.toggleOkButton(0===f.getSelectedProfilesIds().length)})}b.prototype.getCurrentProfileId=function(){return this.settings.CurrentProfileId};b.prototype.selectedActionType=function(){return this.optionRadioManager.isSelected(g.PrivacyChangedDialogActionType.MakeReadOnly)?g.PrivacyChangedDialogActionType.MakeReadOnly:g.PrivacyChangedDialogActionType.LeaveOpen};
b.prototype.getSelectedProfilesIds=function(){for(var a=this,d=[],f=function(f){if(f.is(":checked")){var h=b.settings.PersonProfiles.find(function(d){return d.PersonProfileId.toString()===f.attr("id").replace(a.settings.ProfileCheckboxPrefix,"")});d.push(h.PersonProfileId)}},b=this,e=0,c=this.controls.ProfileCheckboxes;e<c.length;e++)f(c[e]);return d};b.prototype.getSelectedProfileNames=function(){for(var a=this,d=[],f=function(f){if(f.is(":checked")){var h=b.settings.PersonProfiles.find(function(d){return d.PersonProfileId.toString()===
f.attr("id").replace(a.settings.ProfileCheckboxPrefix,"")});d.push(h.PersonProfileName)}},b=this,e=0,c=this.controls.ProfileCheckboxes;e<c.length;e++)f(c[e]);return d};b.prototype.areGroupConversationsIncludedChecked=function(){return this.controls.IncludeGroupConversationsCheckbox.is(":checked")};b.prototype.switchState=function(){this.optionRadioManager.isSelected(g.PrivacyChangedDialogActionType.MakeReadOnly)?(this.controls.ReadOnlySection.show(),g.privacyChangedDialogManagerInstance.toggleOkButton(0===
this.getSelectedProfilesIds().length)):(this.controls.ReadOnlySection.hide(),g.privacyChangedDialogManagerInstance.toggleOkButton(!1))};return b}();g.PrivacyChangedDialogContentManager=e})(g.PersonProfile||(g.PersonProfile={}))})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(g){var e=function(){function b(a,d){this.controls=a;this.settings=d;this.modalDialog=window[this.getDialogId()]}b.prototype.toggleOkButton=function(a){this.controls.OkButton.prop("disabled",a)};b.prototype.openDialog=function(a,d){this.params=a;this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,d,!1);this.modalDialog.setTitle(this.settings.HeaderText);this.setupOkButtonClickHandler();this.modalDialog.openDialog(!1)};b.prototype.closeDialog=function(){CssModal.closeDialog()};
b.prototype.getDialogId=function(){return this.controls.Container.prop("id")};b.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.off("click").on("click",function(d){c.WebComponents.personProfileSiteInstance.showConfirmEsafetyChanges(g.privacyChangedDialogContentManagerInstance.getSelectedProfileNames(),g.privacyChangedDialogContentManagerInstance.areGroupConversationsIncludedChecked(),g.privacyChangedDialogContentManagerInstance.selectedActionType())?(a.startJob(),
a.closeDialog(),d.preventDefault(),(new Function(a.params.submitFormMethod))()):d.preventDefault()})};b.prototype.startJob=function(){var a={selectedAction:g.privacyChangedDialogContentManagerInstance.selectedActionType(),selectedProfileIds:g.privacyChangedDialogContentManagerInstance.getSelectedProfilesIds(),currentProfileId:g.privacyChangedDialogContentManagerInstance.getCurrentProfileId(),areGroupConversationsIncluded:g.privacyChangedDialogContentManagerInstance.areGroupConversationsIncludedChecked()};
CCL.CommonFunctions.safeAjaxPost({url:this.settings.StartPrivacyChangedJob,data:a,dataType:"html"})};return b}();g.PrivacyChangedDialogManager=e})(g.PersonProfile||(g.PersonProfile={}))})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(e){this.context=e;this.selectedItemsCount=function(){return c.projectManagerInstance.context.Controls.PerformOnAllCheckbox.is(":checked")?c.projectManagerInstance.context.Settings.ProjectsVirtualCount:c.projectManagerInstance.context.Controls.TableItem.find("tr.selected").length};this.hideArchiveFilter=function(a){var d=$("."+c.projectManagerInstance.context.Settings.ArchiveDateCssClass).parent();$("#"+c.projectManagerInstance.context.Controls.StatusClientId+
" input[type = 'radio']").first().attr("id")===a.target.id?d.hide():d.show()};this.clickOnAction=function(a){if($(a.currentTarget).is("[disabled=disabled]"))return!1;var d=c.projectManagerInstance.selectedItemsCount();return 0!==d&&confirm(CCL.CommonFunctions.formatString(a.data.text,d))};this.context=e;c.projectManagerInstance=this;$("."+c.projectManagerInstance.context.Settings.ArchiveDateCssClass).children().addClass(c.projectManagerInstance.context.Settings.InlineCssClass);$("#"+c.projectManagerInstance.context.Controls.StatusClientId+
" input[type = 'radio']").first().is(":checked")&&$("."+c.projectManagerInstance.context.Settings.ArchiveDateCssClass).parent().hide();$("#"+c.projectManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").click(this.hideArchiveFilter);c.projectManagerInstance.context.Controls.DeleteAction.on("click",null,{text:c.projectManagerInstance.context.LanguageTerms.DeleteConfirmText},this.clickOnAction);e=0;for(var b=c.projectManagerInstance.context.Controls.HeaderClientIds;e<b.length;e++){var a=
document.getElementById(b[e]);a&&1===a.childNodes.length&&(a.className="")}}}();c.ProjectManager=g})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){this.context=b;c.finalAssessmentInstance=this}e.prototype.toggleView=function(b,a){$(b).closest(this.context.Controls.ItemRootCssSelector).find("li[data-id='"+a+"']").toggle()};e.prototype.alertAjaxError=function(b){CCL.CommonFunctions.alertAjaxError(b,null,null)};e.prototype.updateViewScore=function(b,a){var d=b.val();d===this.context.Settings.NotAssessmentStringPattern&&(d=this.context.Settings.NotAssessmentReplaceValue);b.closest(this.context.Controls.ItemRootCssSelector).find("li[data-id='"+
a+"'] "+this.context.Controls.ScoreCssSelector).text(d)};e.prototype.assessPerson=function(b,a,d,f,h){b={personId:b,assessmentId:d,assessmentItemId:a.getValue(),courseId:f,gradeBookItemId:h};CCL.CommonFunctions.safeAjaxPost({url:this.context.WebMethods.AssessWithScaleUrl,data:b}).fail(this.alertAjaxError).done(this.updateViewScore(a,h))};return e}();c.FinalAssessment=g})(c.AssessmentRecord||(c.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){c.termAssessmentOverviewInstance=this;this.context=a}b.prototype.init=function(){var a=this;$("#"+this.context.Controls.CompleteCourseButtonId).click(function(){return a.completeSelectedCourses()});$("#"+this.context.Controls.RevertCourseButtonId).click(function(){return a.revertSelectedCourses()})};b.prototype.getSelectedCourses=function(){for(var a=[],d=0,f=$("#"+this.context.Controls.GridId).find("tbody > tr.selected").toArray();d<
f.length;d++){var b=$("span["+this.context.Settings.DataSerializedInfoAttribute+"]",f[d]).first();b=$.parseJSON(b.attr(this.context.Settings.DataSerializedInfoAttribute));a.push(b)}return a};b.prototype.getRevertConfirmationMessage=function(a){var d="";switch(a.length){case 0:break;case 1:d=this.context.Settings.RevertConfirmOneCourseMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title);break;case 2:d=this.context.Settings.RevertConfirmTwoCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,
a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title);break;case 3:d=this.context.Settings.RevertConfirmThreeCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title).replace(this.context.Settings.CourseCPattern,a[2].Title);break;default:d=this.context.Settings.RevertConfirmFourOrMoreCoursesMessagesPattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,
a[1].Title).replace(this.context.Settings.NumberOfCoursesPattern,(a.length-2).toString())}return d};b.prototype.checkSelectionExists=function(a){return 0==a.length?(jAlert(this.context.Settings.PleaseMakeSelectionMessage),!1):!0};b.prototype.completeSelectedCourses=function(){var a=this,d=this.getSelectedCourses();this.checkSelectionExists(d)&&jConfirm(this.context.Settings.CompleteConfirmMessage,this.context.Settings.ConfirmDialogTitle,function(d){d&&a.context.Scripts.PostbackComplete()})};b.prototype.revertSelectedCourses=
function(){var a=this,d=this.getSelectedCourses();this.checkSelectionExists(d)&&(d=this.getRevertConfirmationMessage(d),jConfirm(d,this.context.Settings.ConfirmDialogTitle,function(d){d&&a.context.Scripts.PostbackRevert()}))};return b}();c.TermAssessmentOverview=e})(c.Headteacher||(c.Headteacher={}))})(c.Assessment||(c.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){this.settings=b;this.crumbs=window.parent.document.getElementById("crumbs");this.textItemBuilder=new c.BreadcrumbTextItemBuilder(b.CssClasses);this.linkItemBuilder=new c.BreadcrumbLinkItemBuilder(b.CssClasses,b.KpiSettings)}e.prototype.buildBreadcrumbs=function(b){var a=this;window.parent!==window&&this.crumbs&&(Array.prototype.slice.call(this.crumbs.querySelectorAll("li:not(:first-child)")).forEach(function(a){a.parentNode.removeChild(a)}),
b.forEach(function(d,f){a.crumbs.appendChild((f===b.length-1?a.textItemBuilder:a.linkItemBuilder).buildItem(d))}))};return e}();c.BreadcrumbBuilder=g})(c.Breadcrumbs||(c.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){this.cssClasses=b}e.prototype.buildListItem=function(b){var a=document.createElement("li");a.appendChild(this.getSeparator());a.appendChild(b);return a};e.prototype.getSeparator=function(){var b=document.createElement("span");b.innerText="/";b.className=this.cssClasses.Separator;return b};return e}();c.BreadcrumbItemBuilderBase=g})(c.Breadcrumbs||(c.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(e){function b(a,d){e.call(this,a);this.kpiSettings=d}__extends(b,e);b.prototype.buildItem=function(a){var d=this,f=document.createElement("a");f.innerText=a.Text;f.setAttribute("title",a.Title&&a.Title.length?a.Title:a.Text);f.setAttribute("href",a.Href);f.setAttribute("target",a.Target);f.onclick=function(){return d.measureKpi()};a=document.createElement("span");a.appendChild(f);return this.buildListItem(a)};b.prototype.measureKpi=function(){fetch(this.kpiSettings.Url,
{credentials:"same-origin",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({measureSection:this.kpiSettings.Section,measurement:this.kpiSettings.Measurement,measureContext:this.kpiSettings.Context})})};return b}(c.BreadcrumbItemBuilderBase);c.BreadcrumbLinkItemBuilder=g})(c.Breadcrumbs||(c.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(e){function b(a){e.call(this,a)}__extends(b,e);b.prototype.buildItem=function(a){var d=document.createElement("span");d.className=this.cssClasses.SelectedCrumb;d.innerText=a.Text;return this.buildListItem(d)};return b}(c.BreadcrumbItemBuilderBase);c.BreadcrumbTextItemBuilder=g})(c.Breadcrumbs||(c.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.AddResourceMenu||(c.AddResourceMenu={});c=c.ElementExternalSourceType||(c.ElementExternalSourceType={});c[c.Library=0]="Library";c[c.Course=1]="Course";c[c.CreateNew=2]="CreateNew";c[c.Computer=3]="Computer"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.Administration||(c.Administration={});c=c.PersonProfile||(c.PersonProfile={});c=c.PrivacyChangedDialogActionType||(c.PrivacyChangedDialogActionType={});c[c.MakeReadOnly=0]="MakeReadOnly";c[c.LeaveOpen=1]="LeaveOpen"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){e[e.Other=0]="Other";e[e.Resource=1]="Resource";e[e.Child=2]="Child"})(c.CalendarTypes||(c.CalendarTypes={}));(function(e){e[e.Month=0]="Month";e[e.Week=1]="Week";e[e.Day=2]="Day";e[e.List=3]="List"})(c.CalendarView||(c.CalendarView={}));(function(e){e[e.ReportError=0]="ReportError";e[e.PerformUpdate=1]="PerformUpdate";e[e.AskConfirmation=2]="AskConfirmation"})(c.EventCheckDecision||(c.EventCheckDecision={}));(function(e){e[e.Month=0]="Month"})(c.EventCopyPeriodType||
(c.EventCopyPeriodType={}));(function(e){e[e.Unspecified=0]="Unspecified";e[e.RecurringEventInSingleMode=1]="RecurringEventInSingleMode";e[e.RecurringEventInUpcomingMode=2]="RecurringEventInUpcomingMode"})(c.EventScopeMode||(c.EventScopeMode={}));(function(e){e[e.CheckOnly=0]="CheckOnly";e[e.CheckOrUpdate=1]="CheckOrUpdate";e[e.UpdateOnly=2]="UpdateOnly"})(c.EventScopeOperation||(c.EventScopeOperation={}));(function(e){e[e.Course=1]="Course";e[e.Person=2]="Person";e[e.Project=3]="Project";e[e.All=
4]="All"})(c.EventType||(c.EventType={}));(function(e){e[e.None=0]="None";e[e.Default=1]="Default";e[e.CourseApproval=2]="CourseApproval";e[e.BookingsAvailability=4]="BookingsAvailability"})(c.EventValidationScope||(c.EventValidationScope={}))})(c.CalendarControllerModels||(c.CalendarControllerModels={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){e[e.Available=1]="Available";e[e.PartlyBooked=2]="PartlyBooked";e[e.Booked=3]="Booked"})(c.BookableResourceStatuses||(c.BookableResourceStatuses={}));(function(e){e[e.Monday=1]="Monday";e[e.Tuesday=2]="Tuesday";e[e.Wednesday=4]="Wednesday";e[e.Thursday=8]="Thursday";e[e.Friday=16]="Friday";e[e.Saturday=32]="Saturday";e[e.Sunday=64]="Sunday"})(c.WeekDays||(c.WeekDays={}))})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));(function(c){c=c.CheckboxStateMachine||(c.CheckboxStateMachine={});c=c.State||(c.State={});c[c.Empty=0]="Empty";c[c.Saved=1]="Saved";c[c.AttachedByUser=2]="AttachedByUser";c[c.DetachedByUser=3]="DetachedByUser"})(ItslearningWeb||(ItslearningWeb={}));(function(c){c=c.Controls||(c.Controls={});c=c.DatePeriod||(c.DatePeriod={});c[c.Day=0]="Day";c[c.Week=1]="Week"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.CopyMoveElementDialog||(c.CopyMoveElementDialog={});c=c.CopyMoveElementDialogMode||(c.CopyMoveElementDialogMode={});c[c.Copy=0]="Copy";c[c.Move=1]="Move"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.ElementLinkDialog||(c.ElementLinkDialog={});c=c.ContentElementType||(c.ContentElementType={});c[c.All=0]="All";c[c.Resources=1]="Resources";c[c.Activities=2]="Activities";c[c.LearningObjectives=3]="LearningObjectives";c[c.Homework=4]="Homework";c[c.Files=5]="Files"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.ElementParticipantPicker||(c.ElementParticipantPicker={});c=c.ItemType||(c.ItemType={});c[c.Participant=0]="Participant";c[c.Group=1]="Group"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){e[e.NextStep=0]="NextStep";e[e.NoNewSteps=-1]="NoNewSteps";e[e.Finish=-2]="Finish"})(c.TriggerResult||(c.TriggerResult={}));(function(e){e[e.Score=1]="Score";e[e.StatusViewed=2]="StatusViewed";e[e.StatusSubmitted=3]="StatusSubmitted";e[e.StatusCompleted=4]="StatusCompleted"})(c.TriggerCondition||(c.TriggerCondition={}));(function(e){e[e.LinearTransitionWithSingleElement=0]="LinearTransitionWithSingleElement";e[e.LinearTransitionWithMultipleElements=
1]="LinearTransitionWithMultipleElements";e[e.BranchingWithSingleElement=2]="BranchingWithSingleElement"})(c.StepType||(c.StepType={}));(function(e){e[e.StudentView=0]="StudentView";e[e.TeacherView=1]="TeacherView";e[e.TeacherEdit=2]="TeacherEdit"})(c.LearningPathStepViewMode||(c.LearningPathStepViewMode={}))})(c.Builder||(c.Builder={}))})(c.LearningPath||(c.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){e[e.First="First"]="First";e[e.Last="Last"]="Last";e[e.Best="Best"]="Best"})(c.WhichAttemptCounts||(c.WhichAttemptCounts={}));(function(e){e[e.Never="Never"]="Never";e[e.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";e[e.AfterDeadline="AfterDeadline"]="AfterDeadline";e[e.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";e[e.WhenTeacherDecides="WhenTeacherDecides"]="WhenTeacherDecides"})(c.WhenToShowResult||(c.WhenToShowResult={}));
(function(e){e[e.Never="Never"]="Never";e[e.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";e[e.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";e[e.WithResults="WithResults"]="WithResults";e[e.AfterDeadline="AfterDeadline"]="AfterDeadline"})(c.WhenToShowQuestionListAndAnswer||(c.WhenToShowQuestionListAndAnswer={}))})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.LearningToolElement||(c.LearningToolElement={});c=c.Settings||(c.Settings={});c=c.SettingType||(c.SettingType={});c[c.ActivationControl=1]="ActivationControl";c[c.Results=2]="Results";c[c.SubmissionStatusForStudent=3]="SubmissionStatusForStudent";c[c.CollaborationSelector=4]="CollaborationSelector";c[c.Deadline=5]="Deadline";c[c.Homework=6]="Homework";c[c.LearningObjectiveList=7]="LearningObjectiveList";c[c.AssessmentScale=8]="AssessmentScale";c[c.Attempts=9]="Attempts";c[c.ResultsAndFeedback=
10]="ResultsAndFeedback";c[c.SubmissionStatusForTeacher=11]="SubmissionStatusForTeacher";c[c.GroupSubmission=12]="GroupSubmission";c[c.AnonymousSubmission=13]="AnonymousSubmission";c[c.PlagiarismControl=14]="PlagiarismControl";c[c.Mandatory=15]="Mandatory";c[c.PeerAssessment=16]="PeerAssessment";c[c.TestMode=17]="TestMode";c[c.WorkloadSetting=18]="WorkloadSetting";c[c.Description=19]="Description";c[c.AssignTo=20]="AssignTo"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){c[c.ShowCurrent=0]="ShowCurrent";c[c.ShowScheduled=1]="ShowScheduled";c[c.ShowExpired=2]="ShowExpired"})(c.BulletinsDisplayMode||(c.BulletinsDisplayMode={}));(function(c){c[c.Success=0]="Success";c[c.LightBulletinNotFound=1]="LightBulletinNotFound"})(c.GenericResponseCode||(c.GenericResponseCode={}));(function(c){c[c.Edit=0]="Edit";c[c.SetCommentsAvailability=1]="SetCommentsAvailability";c[c.ScheduleBulletin=2]="ScheduleBulletin";c[c.Delete=3]="Delete";c[c.ToggleSubscription=
4]="ToggleSubscription";c[c.ImmersiveReader=5]="ImmersiveReader"})(c.LightBulletinDropDownMenuActionType||(c.LightBulletinDropDownMenuActionType={}));(function(c){c[c.UnsubscribedManually=0]="UnsubscribedManually";c[c.Subscribed=1]="Subscribed";c[c.WasNotSubscribed=2]="WasNotSubscribed"})(c.PersonSubscriptionStatus||(c.PersonSubscriptionStatus={}))})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.Planner||(c.Planner={});c=c.ClientColumnType||(c.ClientColumnType={});c[c.RichText=0]="RichText";c[c.TopicTitle=1]="TopicTitle";c[c.TopicDescription=2]="TopicDescription";c[c.PlanDescription=3]="PlanDescription";c[c.PlanTitle=4]="PlanTitle";c[c.ClassHours=5]="ClassHours"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.Planner||(c.Planner={});c=c.Dialogs||(c.Dialogs={});c=c.CopyDialogOverwriteAssessmentCriteriaState||(c.CopyDialogOverwriteAssessmentCriteriaState={});c[c.Show=0]="Show";c[c.Hide=1]="Hide";c[c.Disable=2]="Disable"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=c.CalendarControllerModels.EventValidationScope,b=function(){function a(a){var d=this;this.utility=a;this.currentChangesScope=e.None;this.changesDebouncer=new CCL.CallbackDebouncer(function(){return d.callChangesHandler()});this.setupStartEndDateTimeHandlers();this.setupRecurringHandlers()}a.prototype.setChangesHandler=function(a){this.changesHandler=a};a.prototype.callChangesHandler=function(){var a=this.currentChangesScope;this.currentChangesScope=e.None;
this.changesHandler(a)};a.prototype.setupStartEndDateTimeHandlers=function(){var a=this;this.utility.controls.startDateInput.add(this.utility.controls.startTimeInput).change(function(){a.onChanged(e.Default|a.getCourseApprovalScopeIfNeeded()|a.getBookingsAvailabilityScopeIfNeeded())});this.utility.controls.endDateInput.add(this.utility.controls.endTimeInput).change(function(){a.onChanged(e.Default|a.getBookingsAvailabilityScopeIfNeeded())})};a.prototype.setupRecurringHandlers=function(){var a=this;
this.utility.controls.recurringCheckbox.add(this.utility.controls.recurrenceEndDateInput).change(function(){a.onChanged(e.Default|a.getBookingsAvailabilityScopeIfNeeded())});this.utility.controls.repeatWeekCountSelect.add(this.utility.controls.repeatWeekDaysList).change(function(){return a.onChanged(a.getBookingsAvailabilityScopeIfNeeded())})};a.prototype.onChanged=function(a){this.changesHandler&&(this.currentChangesScope|=a,this.currentChangesScope!==e.None&&this.changesDebouncer.invokeCallback(void 0,
g.Utility.timeoutForValidationAfterDateShiftedMilliseconds))};a.prototype.getCourseApprovalScopeIfNeeded=function(){return this.utility.settings.AvailableFeatures.IsCalendarApprovalEnabled?e.CourseApproval:0};a.prototype.getBookingsAvailabilityScopeIfNeeded=function(){return this.utility.hasAnyBookingsSelected()?e.BookingsAvailability:0};return a}();g.ChangesAdapter=b})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e;(function(a){a[a.Empty=0]="Empty";a[a.Single=1]="Single";a[a.Multiple=2]="Multiple"})(e||(e={}));var b=function(){function a(a){this.container=a.controls.FeedbackContainer;this.cssClasses=a.settings.CssClasses}a.prototype.addErrorMessage=function(a){switch(this.detectFeedbackType()){case e.Empty:this.createSingleError(a);break;case e.Single:var d=this.findSingleError(),b=d.text();b!==a&&d.replaceWith(this.createMultiErrorList([b,a]));break;case e.Multiple:0===
this.filterMultiErrors(a,this.findMultiErrors()).length&&this.findFeedbackError().find("ol").append($("<li>").text(a));break;default:throw Error("Unknown feedback type");}};a.prototype.removeErrorMessages=function(){this.findFeedbackError().remove()};a.prototype.createSingleError=function(a){this.createFeedbackError().append($("<div>").addClass(this.cssClasses.FeedbackText).text(a))};a.prototype.createMultiErrorList=function(a){for(var d=$("<ol>").addClass(this.cssClasses.NoBullet+" "+this.cssClasses.Margin0+
" "+this.cssClasses.Padding0),b=0;b<a.length;b++)d.append($("<li>").text(a[b]));return d};a.prototype.createFeedbackError=function(){return $("<div>").addClass(this.cssClasses.Feedback+" "+this.cssClasses.FeedbackError+" "+this.cssClasses.ClearFloat).append($("<i>").addClass(this.cssClasses.ImageContainer+" "+this.cssClasses.ExclamationCircle)).prependTo(this.container)};a.prototype.detectFeedbackType=function(){var a=this.findFeedbackError(),f=e.Empty;0<a.length&&(0<a.find("."+this.cssClasses.FeedbackText).length?
f=e.Single:0<a.find("ol").length&&(f=e.Multiple));return f};a.prototype.findFeedbackError=function(){return this.container.find("."+this.cssClasses.Feedback+"."+this.cssClasses.FeedbackError)};a.prototype.findSingleError=function(){return this.findFeedbackError().find("."+this.cssClasses.FeedbackText)};a.prototype.findMultiErrors=function(){return this.findFeedbackError().find("ol > li")};a.prototype.filterMultiErrors=function(a,f){return f.filter(function(d,f){return $(f).text()===a})};return a}();
c.FeedbackBuilder=b})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(){function b(a,d){this.utility=a;this.ajaxClient=d;this.setEventHandlersForBookings();this.updateBookingsAvailability();this.toggleBookingSection()}b.prototype.onDeleteBookingClick=function(a,d){d.IsNotAvailable?this.deleteBookingWithConfirmation(a,d):this.deleteBooking(a,d.BookableResourceId)};b.prototype.checkBookingsAvailability=function(a,d){var f=this;if(this.utility.controls.BookingsHolder.has("."+this.utility.settings.CssClasses.Statuses.Unknown).length)a();
else{var b=this.utility.getEventDateValidationInputModel(c.CalendarControllerModels.EventValidationScope.BookingsAvailability);0===b.SelectedBookingIds.length?a():this.ajaxClient.validateDateRelatedContent(b).done(this.createBookingsAvailabilityValidatedBeforeSubmitConfirmationHandler(b,a,d)).fail(function(){f.setBookingsAvailabilityUnknown();d()})}};b.prototype.setEventHandlersForBookings=function(){var a=this,d=function(){var d;a.utility.controls.allDateAndTimePickers.each(function(a,f){$(f).val()||
(d=!0)});return d};this.utility.controls.allDateAndTimePickers.blur(function(){d()&&a.setBookingsAvailabilityUnknown()});this.utility.controls.OpenBookDialogButton.click(function(){window[a.utility.settings.ClientInstanceNames.ResourceBookerDialog].openDialog()});$(this.utility.controls.AddBookingsButton).click(function(){a.bookingDialogAfterOkClick()});$(this.utility.controls.CancelBookingDialogButton).click(function(){CssModal.closeDialog()})};b.prototype.handleBookingsAvailabilityValidated=function(a){var d=
this;this.utility.controls.BookingsHolder.find("span."+this.utility.settings.CssClasses.TooltipLink).remove();if(a&&a.BookingAvailabilityMessageTooltipTemplates.length){var f=function(a){var f=b.utility.controls.BookingsHolder.find(CCL.CommonFunctions.getDataSelector(b.utility.settings.DataAttributes.BookingForEvent)).filter(function(f,b){return(f=$(b).data(d.utility.settings.DataAttributes.BookingForEvent))&&f.BookableResourceId===a.BookableResourceId});f.find("span."+b.utility.settings.CssClasses.StatusColor).removeClass().addClass(b.utility.settings.CssClasses.StatusColor).addClass(b.getStatusCssClass(a.Status)).prop("title",
b.getStatusToolTip(a.Status,f.hasClass(b.utility.settings.CssClasses.BookingItemReserved)));if(a.MessageTooltipTemplate&&b.utility.settings.InitToolTipFunctionName&&b.utility.settings.ToolTipAddDatasourceItemMethod){var h=$("<span/>").text(b.utility.settings.Terms.IsNotAvailableForAllDays),e=a.BookableResourceId.toString();f.append(h);window[b.utility.settings.ToolTipAddDatasourceItemMethod](e,"",CCL.CommonFunctions.formatString(a.MessageTooltipTemplate,f.find("span."+b.utility.settings.CssClasses.StatusText).html()));
window[b.utility.settings.InitToolTipFunctionName](h,e)}},b=this,e=0;for(a=a.BookingAvailabilityMessageTooltipTemplates;e<a.length;e++)f(a[e])}else this.setBookingsAvailabilityUnknown()};b.prototype.createBookingsAvailabilityValidatedBeforeSubmitConfirmationHandler=function(a,d,f){var b=this;return function(h){if(h&&h.EventBookingAvailabilityResponse)if(h=h.EventBookingAvailabilityResponse,h.Result)d();else{var e=h.Text;a&&a.IsRecurring&&(e+="<br />"+h.ResourceDetails);b.utility.openConfirmSubmitDialog(e,
function(a){return a?d():f()})}}};b.prototype.bookingDialogAfterOkClick=function(){var a=JSON.parse(this.utility.controls.EventBookingsBookedIdsHidden.val());this.utility.controls.EventBookingsReservedIdsHidden.val(JSON.stringify(window[this.utility.settings.ClientInstanceNames.ResourceBookerGrid].getSelectedIds().map(Number).filter(function(d){return-1===a.indexOf(d)})));this.toggleBookingSection();CssModal.closeDialog();this.refreshReservedBookingList()};b.prototype.updateBookingsAvailability=function(){var a=
this,d=this.utility.getEventDateValidationInputModel(c.CalendarControllerModels.EventValidationScope.BookingsAvailability);0<d.SelectedBookingIds.length&&this.ajaxClient.validateDateRelatedContent(d).done(function(d){d&&d.EventBookingAvailabilityResponse&&a.handleBookingsAvailabilityValidated(d.EventBookingAvailabilityResponse)})};b.prototype.getStatusCssClass=function(a){switch(a){case g.BookableResourceStatuses.Available:return this.utility.settings.CssClasses.Statuses.Available;case g.BookableResourceStatuses.PartlyBooked:return this.utility.settings.CssClasses.Statuses.PartlyBooked;
case g.BookableResourceStatuses.Booked:return this.utility.settings.CssClasses.Statuses.Booked;default:return this.utility.settings.CssClasses.Statuses.Unknown}};b.prototype.getStatusToolTip=function(a,d){var f=this.utility.settings.Terms.Tooltips;switch(a){case g.BookableResourceStatuses.Available:return d?f.ReservedButNotBooked:f.ResourceIsBookedByYou;case g.BookableResourceStatuses.PartlyBooked:return this.utility.settings.IsRecurring?f.ResourceIsNotAvailableForAllDays:f.ResourceIsAlreadyBookedForAPartOfEventTime;
case g.BookableResourceStatuses.Booked:return f.ResourceIsAlreadyBookedByOtherPerson;default:return""}};b.prototype.refreshReservedBookingList=function(){var a=this;this.ajaxClient.getBookingMarkups({reservedBookingIds:JSON.parse(this.utility.controls.EventBookingsReservedIdsHidden.val()),clientInstanceName:this.utility.settings.ClientInstanceNames.Page}).done(function(d){a.utility.controls.BookingsHolder.find("> span."+a.utility.settings.CssClasses.BookingItemReserved).remove();a.utility.controls.BookingsHolder.append(d.markups);
a.updateBookingsAvailability()})};b.prototype.toggleBookingSection=function(){this.utility.controls.BookingsPanel.toggle(0<JSON.parse(this.utility.controls.EventBookingsBookedIdsHidden.val()).length||0<JSON.parse(this.utility.controls.EventBookingsReservedIdsHidden.val()).length)};b.prototype.deleteBookingWithConfirmation=function(a,d){var f=this;CCL.CommonFunctions.jAjaxConfirm(CCL.CommonFunctions.formatString(this.utility.settings.Terms.DeleteBookingConfirmationTextTemplate,CCL.CommonFunctions.htmlEncode(d.NameForConfirmation)),
CCL.CommonFunctions.formatString(this.utility.settings.Terms.RemoveTooltipTemplate,d.NameForConfirmation),this.utility.settings.Terms.Ok,this.utility.settings.Terms.CancelButton,function(b){b&&f.deleteBooking(a,d.BookableResourceId)})};b.prototype.deleteBooking=function(a,d){this.removeBookingIdFromHiddenField(this.utility.controls.EventBookingsBookedIdsHidden,d);this.removeBookingIdFromHiddenField(this.utility.controls.EventBookingsReservedIdsHidden,d);a.parent().remove();this.toggleBookingSection()};
b.prototype.removeBookingIdFromHiddenField=function(a,d){if(a.val()){var f=JSON.parse(a.val());-1!==f.indexOf(d)&&(f.splice(f.indexOf(d),1),a.val(JSON.stringify(f)))}};b.prototype.setBookingsAvailabilityUnknown=function(){this.utility.controls.BookingsHolder.find("span."+this.utility.settings.CssClasses.StatusColor).addClass(this.utility.settings.CssClasses.Statuses.Unknown).prop("title","")};return b}();g.BookingWorker=e})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d){var f=this;this.fullCalendarWrapper=a;this.timeFormats=d;this.getIsoDateTime=function(a){return f.formatDate(a,f.timeFormats.LocalIsoFormat)};this.getFormattedDate=function(a,d){return f.formatDate(a,d)}}b.prototype.getEventFormattedDates=function(a,d){var f=a.getDate()!==d.getDate()||a.getMonth()!==d.getMonth()?this.timeFormats.twoDaysFormat:this.timeFormats.timeRangeFormat;return this.formatDates(a,d,f)};b.prototype.getEventFormattedDateAndTime=
function(a,d,f){void 0===f&&(f=!0);f=a.getDate()!==d.getDate()||a.getMonth()!==d.getMonth()?this.timeFormats.twoDaysFormat:f?this.timeFormats.DateAndTimeRangeFormat:this.timeFormats.DateAndTimeRangeFormatWithoutSeparator;return this.formatDates(a,d,f)};b.prototype.getShortDateTime=function(a){return this.formatDate(a,this.timeFormats.ShortDateAndTimeFormat)};b.prototype.getShortDate=function(a){return this.formatDate(a,this.timeFormats.shortDatePattern)};b.prototype.formatDate=function(a,d){return this.fullCalendarWrapper.formatDate(a,
d)};b.prototype.formatDates=function(a,d,f){return this.fullCalendarWrapper.formatDates(a,d,f)};return b}();c.DateFormatter=e})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a,d,f){var h=this;this.utilityBase=b;this.ajaxClientBase=a;this.datePickerClientInstanceName=d;this.timeSlotPickerClientInstanceName=f;$(function(){return h.getNextEventDatePicker().onDateSelectedFunction=function(a){return h.getNextEventTimeSlotPicker().updateFilteredTimeForDate(a.dateText,a.dateFilterId)}})}Object.defineProperty(e.prototype,"hasNextEvent",{get:function(){return 0<this.getNextEventId()},enumerable:!0,configurable:!0});e.prototype.getNextEventId=
function(){return parseInt(this.getNextEventTimeSlotPicker().getSelectedTimeSlotId(),10)||0};e.prototype.getNextEventDatePicker=function(){return window[this.datePickerClientInstanceName]};e.prototype.getNextEventTimeSlotPicker=function(){return window[this.timeSlotPickerClientInstanceName]};return e}();c.NextEventDateWorkerBase=g})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(b){function a(a,f){var d=this;b.call(this,a,f,a.settings.ClientInstanceNames.NextEventPicker,a.settings.ClientInstanceNames.NextEventTimeSlotPicker);this.utility=a;this.ajaxClient=f;$(function(){d.getNextEventDatePicker().getAvailableDatesFunction=function(a){return d.getAvailableDates(a)};d.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=function(a){return d.getAvailableTimeSlotsForDate(a)}})}__extends(a,b);a.prototype.setDefaultDate=
function(a){this.getNextEventDatePicker().setDefaultDate(a)};a.prototype.getAvailableDates=function(a){this.ajaxClient.getDatesOfEventsToBePickedAsNextEventForEditEventPage({courseId:this.utility.settings.LocationId,eventId:this.utility.settings.SingleActivityId,startDate:a.startDate,endDate:a.endDate,eventStopDateAsUserInputString:this.utility.controls.endDateInput.val(),eventStopTimeAsUserInputString:this.utility.controls.endTimeInput.val()}).done(function(d){return a.allowedDates=d})};a.prototype.getAvailableTimeSlotsForDate=
function(a){this.ajaxClient.getTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage({courseId:this.utility.settings.LocationId,eventId:this.utility.settings.SingleActivityId,date:a.date,eventStopDateAsUserInputString:this.utility.controls.endDateInput.val(),eventStopTimeAsUserInputString:this.utility.controls.endTimeInput.val()}).done(function(d){return a.availableTimeSlots=d})};return a}(c.NextEventDateWorkerBase);g.NextEventDateWorker=e})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a,f,b,c,g,k){this.utility=a;this.addEventElementLinkManager=new e.AddEventElementLinkManager(a,f,b,c,{onUploadFromComputer:k.onUploadFromComputer});this.editEventElementLinkManager=new e.EditEventElementLinkManager(a,f,b,g,k);this.initEventHandlers()}a.prototype.initEventHandlers=function(){$(document).on("click","."+this.utility.settings.cssClasses.AddResourceMenuLink,function(a){e.ElementLinkManagerDialogBase.currentManager.onAddResourceMenuItemLinkClick(a)})};return a}();
e.ElementLinkManagerFactory=b})(c.ElementLink||(c.ElementLink={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(a){function d(d,b,e){a.call(this,d,b,{inlineEditContainer:d.settings.cssClasses.Title},{isNotEditableTooltip:""});this.ajaxClient=e}__extends(d,a);d.prototype.buildMarkup=function(d,b,e,c){b.editable&&e&&b.IsEventTitleReadOnly?this.buildReadOnlyTitleMarkup(d,b):a.prototype.buildCommonMarkup.call(this,d,b,b.editable&&(e||0<b.EventTitle.length),this.utility.settings.cssClasses.TitleLabel,this.utility.settings.terms.Title,this.getEditorBinding(b,
d),e,null,!1,!0,!1,c)};d.prototype.getTextContainerWatermark=function(a){return this.utility.settings.terms.Title};d.prototype.getCachedText=function(a){return a.EventTitle};d.prototype.getCachedPlainText=function(a){return a.EventTitle};d.prototype.isPlainText=function(a){return!0};d.prototype.sendTextAjax=function(a,d,b){return this.ajaxClient.editEventTitle({EventId:a.activityId,Text:b,HasResources:this.checkEventHasAttachedResources(a,d)})};d.prototype.buildReadOnlyTitleMarkup=function(a,d){if(d.editable&&
""!==d.EventTitle){var f=document.createElement("div");f.classList.add(this.utility.settings.cssClasses.TitleLabel);f.innerText=this.utility.settings.terms.Title;a[0].appendChild(f)}f=document.createElement("div");f.classList.add(this.utility.settings.cssClasses.UserInput);f.classList.add(this.utility.settings.cssClasses.DescriptionApi);f.innerText=d.EventTitle;a[0].appendChild(f)};return d}(e.MarkupBuilderBase);e.TitleMarkupBuilder=b})(c.EventTextContent||(c.EventTextContent={}))})(c.Schedule||(c.Schedule=
{}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d,f){var b=this;this.getFullCalendar=a;this.getCalendar=d;this.eventSourceNames=f;this.handleChildrenCalendarsChange=function(){b.refetchSourceByName(b.eventSourceNames.childrenCalendars)};this.handleOtherCalendarsChange=function(){b.refetchSourceByName(b.eventSourceNames.otherCalendars)};this.handleResourcesCalendarsChange=function(){b.refetchSourceByName(b.eventSourceNames.resourceCalendars)}}b.prototype.addEventForSource=function(a,
d){this.getFullCalendar().fullCalendar("renderEventForSource",a,d)};b.prototype.addEventForSourceByName=function(a,d){d in this.getCalendar().eventSources&&(d=this.getCalendar().eventSources[d],this.addEventForSource(a,d));this.refetchSourceByName(this.eventSourceNames.otherCalendars);this.refetchSourceByName(this.eventSourceNames.childrenCalendars)};b.prototype.changeView=function(a){this.getFullCalendar().fullCalendar("changeView",a)};b.prototype.getDate=function(){return this.getFullCalendar().fullCalendar("getDate")};
b.prototype.getFirstDay=function(){return this.getFullCalendar().fullCalendar("option","firstDay")};b.prototype.getView=function(){return this.getFullCalendar().fullCalendar("getView")};b.prototype.getViewName=function(){return this.getView().name};b.prototype.refetchAll=function(){this.getFullCalendar().fullCalendar("refetchEvents")};b.prototype.refetchEvents=function(a,d){this.handleOtherCalendarsChange();this.handleChildrenCalendarsChange();a=this.getFullCalendar().fullCalendar("clientEvents",
a);0<a.length&&this.getCalendar().refetchEvents(a,d)};b.prototype.refetchSourceByName=function(a){a in this.getCalendar().eventSources&&(a=this.getCalendar().eventSources[a],this.getFullCalendar().fullCalendar("refetchSource",a))};b.prototype.refetchTaskSourceByName=function(a){a in this.getCalendar().taskSources&&(a=this.getCalendar().taskSources[a],this.getFullCalendar().fullCalendar("refetchTaskSource",a))};b.prototype.removeEvent=function(a){this.getFullCalendar().fullCalendar("removeEvents",
a)};b.prototype.removeEvents=function(a){this.getFullCalendar().fullCalendar("removeEvents",a)};b.prototype.render=function(){this.getFullCalendar().fullCalendar("render")};b.prototype.select=function(a,d,f){this.getFullCalendar().fullCalendar("select",a,d,f)};b.prototype.unselect=function(){this.getFullCalendar().fullCalendar("unselect")};b.prototype.formatDate=function(a,d){return this.getFullCalendar().fullCalendar("formatDate",a,d)};b.prototype.formatDates=function(a,d,f){return this.getFullCalendar().fullCalendar("formatDates",
a,d,f)};return b}();c.FullCalendarWrapper=e})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){this.utility=a}b.prototype.buildBookingsIcon=function(a){var d=document.createElement("span");d.classList.add(this.utility.settings.cssClasses.FcEventInlineIcon);d.innerHTML=this.utility.settings.InlineIcons.Bookings;a.appendChild(d)};b.prototype.buildAttendanceIcon=function(a){var d=document.createElement("span");d.innerHTML=this.utility.settings.InlineIcons.RegisterAttendance;a.appendChild(d)};b.prototype.buildAttendanceEventButton=
function(a,d,f,b,e,c){void 0===e&&(e="");void 0===c&&(c=!1);var h=document.createElement("button");h.type="button";h.disabled=d;h.classList.add(this.utility.settings.cssClasses.EventInlineButton);h.title=f;h.setAttribute("aria-label",f);h.innerHTML=this.utility.settings.InlineIcons.RegisterAttendance;e&&0<e.length&&(f=document.createElement("span"),f.classList.add(this.utility.settings.cssClasses.EventAttendanceButtonText),f.appendChild(document.createTextNode(e)),h.insertBefore(f,h.firstChild));
!d&&b&&h.addEventListener("click",b);c?(d=document.createElement("span"),d.classList.add(this.utility.settings.cssClasses.FcEventInlineButton),d.appendChild(h),a.appendChild(d)):a.appendChild(h)};b.prototype.buildColorIcon=function(a){void 0===a&&(a="");var d=document.createElement("span");a&&d.classList.add(a);d.classList.add(this.utility.settings.cssClasses.EventItemColor);return d};b.prototype.replaceColorIcon=function(a,d){a.className=this.utility.settings.cssClasses.EventItemColor+" "+d};b.prototype.buildDeleteEventButton=
function(a){var d=document.createElement("button");d.type="button";d.classList.add(a?this.utility.settings.cssClasses.MarginRight10:this.utility.settings.cssClasses.MarginRight15);d.title=this.utility.settings.terms.deleteEventTooltip;d.setAttribute("aria-label",this.utility.settings.terms.deleteEventTooltip);d.innerHTML=this.utility.settings.InlineIcons.Trashcan;a&&d.setAttribute("data-eventdetails-delete","");return d};b.prototype.buildCopyIcon=function(a){a.innerHTML=this.utility.settings.InlineIcons.Copy;
a.title=this.utility.settings.terms.CopyEvent;a.setAttribute("aria-label",this.utility.settings.terms.CopyEvent);return a};b.prototype.buildEditEventIcon=function(a,d,f,b){var h=document.createElement("a");h.innerHTML=this.utility.settings.InlineIcons.Edit;h.classList.add(d);h.setAttribute("href",f);h.title=this.utility.settings.terms.editEventTooltip;h.setAttribute("aria-label",this.utility.settings.terms.editEventTooltip);a.appendChild(h);b&&h.addEventListener("click",b)};b.prototype.buildGroupIcon=
function(a,d,f){var b=document.createElement("span");b.classList.add(this.utility.settings.cssClasses.FcEventInlineIcon);b.innerHTML=this.utility.settings.InlineIcons.Users;b.setAttribute("alt",this.utility.settings.terms.group);b.title=d?this.utility.settings.terms.group:this.utility.settings.terms.group+": ("+f+")";a.appendChild(b);d&&(d=document.createElement("span"),d.classList.add(this.utility.settings.cssClasses.ColorGrey),d.classList.add(this.utility.settings.cssClasses.EventItemIconText),
d.textContent=f,a.appendChild(d))};b.prototype.buildHomeworkIcon=function(a){var d=document.createElement("span");d.classList.add(this.utility.settings.cssClasses.FcEventInlineIcon);d.title=this.utility.settings.terms.homeworkIconToolTip;d.innerHTML=this.utility.settings.InlineIcons.Homework;a.appendChild(d)};b.prototype.buildLockIcon=function(a,d,f){var b=document.createElement("span");b.classList.add(this.utility.settings.cssClasses.LockIcon);b.innerHTML=this.utility.settings.InlineIcons.Lock;d?
(d=document.createElement("span"),d.textContent=f,f=document.createElement("div"),f.classList.add(this.utility.settings.cssClasses.LockInformationContainer),f.appendChild(b),f.appendChild(d),a.insertBefore(f,a.firstChild)):a.insertBefore(b,a.firstChild)};b.prototype.buildPlanIcon=function(a){var d=document.createElement("span");d.classList.add(this.utility.settings.cssClasses.MarginRight5);d.innerHTML=this.utility.settings.InlineIcons.Plans;a.appendChild(d)};b.prototype.buildPlannerButtonIcon=function(a,
d,f){var b=document.createElement("button");b.type="button";b.title=d;b.classList.add(this.utility.settings.cssClasses.EventInlineButton);b.addEventListener("click",f);b.innerHTML=this.utility.settings.InlineIcons.Plans;d=document.createElement("span");d.classList.add(this.utility.settings.cssClasses.FcEventInlineButton);d.appendChild(b);a.appendChild(d)};b.prototype.buildRecurringIcon=function(a){var d=this.createImageNode(this.utility.settings.urls.recurringImageUrl,this.utility.settings.constants.IconSize,
this.utility.settings.terms.recurringTooltip);d.classList.add(this.utility.settings.cssClasses.VerticalAlignMiddle);d.classList.add(this.utility.settings.cssClasses.MarginLeft5);a.appendChild(d)};b.prototype.createImageNode=function(a,d,b){var f=document.createElement("img");f.src=a;f.width=d;f.height=d;f.alt="";f.title=b;return f};return b}();c.IconBuilder=e})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a,b,h,c,g,k,p,r,q){this.utility=a;this.dateFormatter=b;this.toggleEventSettings=h;this.extraDescriptionMarkupBuilder=c;this.nextEventMarkupBuilder=new e.NextEventMarkupBuilder(this.utility,this.dateFormatter);this.addEventDialogNextEventDateWorker=new e.AddEventDialogNextEventDateWorker(this.utility,g,k,r);this.editEventDialogNextEventDateWorker=new e.EditEventDialogNextEventDateWorker(this.utility,g,q)}a.prototype.initNextEventForAddDialog=
function(){var a=this;this.setOnChangeDatePickerEvent(this.utility.controls.NextEvent.AddEventDatePickerContainer,this.addEventDialogNextEventDateWorker);this.utility.controls.NextEvent.AddEventDatePickerButton.one("click",function(){$(a.addEventDialogNextEventDateWorker.getNextEventDatePicker()).on(a.utility.settings.constants.NextEventDateSetEventName,function(){a.utility.controls.addEventCalendarsDropdown.is(":disabled")||a.toggleEventSettings(!0)});$(a.addEventDialogNextEventDateWorker.getNextEventDatePicker()).on(a.utility.settings.constants.NextEventDateClearedEventName,
function(){a.utility.controls.addEventCalendarsDropdown.is(":disabled")&&a.toggleEventSettings(!1)})})};a.prototype.buildContainerForEditEvent=function(a,b,h){var d=this,f=a.editable&&!h,e=a.showExtraDescription&&(0<a.NextEventId||f);(a.showExtraDescription&&(a.extraDescription||f)||e)&&this.extraDescriptionMarkupBuilder.buildMarkup(b,a,!h,function(){e&&(d.nextEventMarkupBuilder.buildMarkup(b,f,a),f&&d.initializeNextEventHandlers(a))})};a.prototype.isEditDialogEditMode=function(){return this.editEventDialogNextEventDateWorker.isInEditMode()};
a.prototype.initializeNextEventHandlers=function(a){this.editEventDialogNextEventDateWorker.nextEventQueryArgs={nextEvent:{eventId:a.NextEventId,eventStart:a.NextEventStart},courseId:a.courseId,eventId:a.activityId,eventStopDateTimeAsIsoString:JSON.stringify(this.dateFormatter.getIsoDateTime(a.end))};var d=this.utility.controls.NextEvent.EditEventDatePickerContainer.find("."+this.utility.settings.cssClasses.DatePickerInput),b=this.editEventDialogNextEventDateWorker.getNextEventDatePicker();this.utility.controls.NextEvent.EditEventDatePickerContainer.find(".ui-datepicker-trigger").remove();
d.removeClass("hasDatepicker");b.initialize();this.editEventDialogNextEventDateWorker.getNextEventTimeSlotPicker().initialize();0<a.NextEventId&&this.editEventDialogNextEventDateWorker.setDateTimePickerValues();this.setOnChangeDatePickerEvent(this.utility.controls.NextEvent.EditEventDatePickerContainer,this.editEventDialogNextEventDateWorker)};a.prototype.setOnChangeDatePickerEvent=function(a,b){var d=this;a.on("change","input, select",function(){return d.updateDateTimeLabel(b)})};a.prototype.updateDateTimeLabel=
function(a){var d=a.getNextEventTimeSlotPicker().getSelectedTimeSlot();a.getDatePickerButton().find("."+this.utility.settings.cssClasses.NextEventButtonText).text(d?this.dateFormatter.getEventFormattedDateAndTime(CCL.SerializableDateTimeConverter.toDateWithSeconds(d.EventStartLocal),CCL.SerializableDateTimeConverter.toDateWithSeconds(d.EventStopLocal)):this.utility.settings.terms.PickDate)};return a}();e.NextEventManager=b})(c.NextEvent||(c.NextEvent={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||
(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a,d){var f=this;this.utility=b;this.container=a;this.inputValidatorParameters=d;this.modernInput=new CCL.ModernInput({EditorTextarea:this.utility.cssClassesBase.ModernInputTextEditor,TextIsValid:this.utility.cssClassesBase.ModernInputTextIsValid},{TextValidationErrorMessage:this.utility.dataAttributeNames.InputValidationMessage});var h=a.find("textarea, input").first();if(h.length){var c=new CCL.CallbackDebouncer(function(){return h.val(e.cleanUpLineBreaks(h.val()))});
h.on("input",function(){return f.validateOnInput(h)}).on("paste",function(){return c.invokeCallback(void 0,50)})}}e.cleanUpInputValue=function(b){return b?e.cleanUpLineBreaks(b).replace(/\s{2,}/g," ").trim():""};e.prototype.createValidationMessageContainer=function(){$("<span>").addClass(this.inputValidatorParameters.errorMessageClass).attr("data-"+this.utility.dataAttributeNames.InputValidationMessage,"").appendTo(this.container)};e.prototype.resetValidation=function(){this.validate(!0)};e.cleanUpLineBreaks=
function(b){return b.replace(/\r?\n/g,"")};e.prototype.validateOnInput=function(b){b=this.inputValidatorParameters.inputValidationFunction(e.cleanUpInputValue(b.val()));this.validate(b)};e.prototype.validate=function(b){this.modernInput.toggleTextError(this.container.parent(),this.inputValidatorParameters.errorMessageText,!b);if(this.inputValidatorParameters.onValidateFunction)this.inputValidatorParameters.onValidateFunction(b)};return e}();c.InputValidator=g})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));var UploadStatus;(function(c){c[c.Awaiting=0]="Awaiting";c[c.InProgress=1]="InProgress";c[c.Succeeded=2]="Succeeded";c[c.SucceededWithErrors=3]="SucceededWithErrors";c[c.Failed=4]="Failed"})(UploadStatus||(UploadStatus={}));
(function(c){(function(c){var g=function(){function e(b){var a=this;this.settings=b;this.handleSubmitButtonBehaviour=function(d){a.lockSubmitButton(d===UploadStatus.InProgress)};this.isUploaderDirty=function(){var d=window[a.settings.ClientIds.UploaderControl];return!!d&&0<d.uploadedItems.uploadMetadataArray.length+d.uploadedItems.fileInCloudMetadataArray.length};window[b.ClientInstanceName]=this;this.$form=$("#"+this.settings.ClientIds.PageForm);this.$submitButton=$("#"+this.settings.ClientIds.SubmitButton);
this.$cancelButton=$("#"+this.settings.ClientIds.CancelButton);this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.$form,this.settings.Terms.BeforeUnloadWarningMessage,{cancelButtonId:this.settings.ClientIds.CancelButton,callback:this.isUploaderDirty});this.lockSubmitButton(!1)}e.prototype.lockSubmitButton=function(b){this.$submitButton.toggleHyperlink(!b)};return e}();c.EditPortfolioItemControl=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){this.input=b;this.serialize=a}Object.defineProperty(e.prototype,"dateValue",{get:function(){return this.date},set:function(b){this.date=b;this.input.val(this.serialize(b))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"stringValue",{get:function(){return this.input.val()},enumerable:!0,configurable:!0});return e}();c.DateInputWrapper=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(a){function d(d,b,e){a.call(this,d,b,{inlineEditContainer:d.settings.cssClasses.Description},{isNotEditableTooltip:d.settings.terms.eventDescriptionNotEditableTooltip});this.ajaxClient=e}__extends(d,a);d.prototype.buildMarkup=function(d,b,e,c){void 0===c&&(c=null);a.prototype.buildCommonMarkup.call(this,d,b,b.editable||!!c||b.PreviousEvent.ExtraDescription&&0<b.PreviousEvent.ExtraDescription.length&&0<b.description.length,this.utility.settings.cssClasses.DescriptionLabel,
this.utility.settings.terms.DescriptionLabel,this.getEditorBinding(b,d),e,c,!0)};d.prototype.getTextContainerWatermark=function(a){return 0===a.courseId?this.utility.settings.terms.otherEventDescriptionWatermark:this.utility.settings.customerSettings.enableFrenchCalendarLayout?this.utility.settings.terms.courseEventPastDescriptionWatermark:this.utility.settings.terms.courseEventDescriptionWatermark};d.prototype.getCachedText=function(a){return a.description};d.prototype.getCachedPlainText=function(a){return a.descriptionPlainText};
d.prototype.isPlainText=function(a){return a.isPlainTextInDescription};d.prototype.sendTextAjax=function(a,d,b){return this.ajaxClient.editEventDescription({EventId:a.activityId,Text:b,HasResources:this.checkEventHasAttachedResources(a,d)})};return d}(e.MarkupBuilderBase);e.DescriptionMarkupBuilder=b})(c.EventTextContent||(c.EventTextContent={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(a){function d(d,b,e){a.call(this,d,b,{inlineEditContainer:d.settings.cssClasses.DescriptionExtra},{isNotEditableTooltip:d.settings.terms.eventExtraDescriptionNotEditableTooltip});this.ajaxClient=e}__extends(d,a);d.prototype.buildMarkup=function(d,b,e,c){a.prototype.buildCommonMarkup.call(this,d,b,b.editable||0<b.NextEventId||0<b.extraDescription.length,this.utility.settings.cssClasses.DescriptionExtraHeader,this.utility.settings.terms.extraDescriptionLabel,
this.getEditorBinding(b,d),e,c,!0)};d.prototype.buildPreviousExtraDescriptionMarkup=function(a,d,b,e){var f=document.createElement("div");f.classList.add(this.utility.settings.cssClasses.PreviousEventContainer);f.classList.add(this.utility.settings.cssClasses.UserInput);if(d){this.buildSectionTitle(a,this.utility.settings.cssClasses.PreviousEventExtraDescriptionLabel,this.utility.settings.terms.PreviousEventExtraDescriptionLabel);var h=document.createElement("div");h.classList.add(this.utility.settings.cssClasses.PreviousEventExtraDescription);
h.innerHTML=d;f.appendChild(h)}d=document.createElement("div");d.classList.add(this.utility.settings.cssClasses.PreviousEventDateLabel);e?(e=document.createElement("p"),e.innerText=b,b=document.createElement("p"),b.innerText=this.utility.settings.terms.CannotPreviewOrEditPreviousEvent,d.appendChild(e),d.appendChild(b)):d.innerText=b;f.appendChild(d);a[0].appendChild(f)};d.prototype.buildOpenPreviousEventButton=function(a,d,b){var f=document.createElement("button");f.type="button";f.classList.add(this.utility.settings.cssClasses.Button);
f.classList.add(this.utility.settings.cssClasses.PreviousEventEditButton);f.innerText=d;f.addEventListener("click",b);a.appendChild(f)};d.prototype.getTextContainerWatermark=function(a){return this.utility.settings.terms.courseEventFutureDescriptionWatermark};d.prototype.getCachedText=function(a){return a.extraDescription};d.prototype.getCachedPlainText=function(a){return a.extraDescriptionPlainText};d.prototype.isPlainText=function(a){return a.isPlainTextInExtraDescription};d.prototype.sendTextAjax=
function(a,d,b){return this.ajaxClient.editEventExtraDescription({EventId:a.activityId,Text:b,HasResources:this.checkEventHasAttachedResources(a,d)})};return d}(e.MarkupBuilderBase);e.ExtraDescriptionMarkupBuilder=b})(c.EventTextContent||(c.EventTextContent={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.Calendar||(c.Calendar={});c=c.Schedule||(c.Schedule={});c=c.EventDetailsType||(c.EventDetailsType={});c[c.ListView=1]="ListView";c[c.ContextDialog=2]="ContextDialog"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){this.utility=a;this.combinedClasses={expandableSection:this.utility.settings.cssClasses.ExpandableContainer+" "+this.utility.settings.cssClasses.ExpandableSection,expandableHeaderArrowCollapsed:this.utility.settings.cssClasses.Icon+" "+this.utility.settings.cssClasses.IconArrowForward+" "+this.utility.settings.cssClasses.IconColorDefault,expandableHeaderArrowExpanded:this.utility.settings.cssClasses.Icon+" "+this.utility.settings.cssClasses.IconArrowDown+
" "+this.utility.settings.cssClasses.IconColorDefault}}b.prototype.buildExpandableContainer=function(a,d,b,h,e){var f=this;h=(void 0===h?{}:h).isExpanded;h=void 0===h?!1:h;d=$("<section>").addClass(this.combinedClasses.expandableSection).append($("<div tabindex='0'>").addClass(this.utility.settings.cssClasses.ExpandableContainerHeader).append($("<i>").addClass(h?this.combinedClasses.expandableHeaderArrowExpanded:this.combinedClasses.expandableHeaderArrowCollapsed)).append($("<span>").append(d))).append($("<div>").addClass(this.utility.settings.cssClasses.ExpandableContainerContent).append(b));
a.append(d);return new ExpandableContainer(d,{isExpanded:h,onToggleCallback:function(a,d){d.find(f.utility.selectors.expandableContainerHeaderIcon).toggleClass(f.utility.settings.cssClasses.IconArrowForward,!a).toggleClass(f.utility.settings.cssClasses.IconArrowDown,a);e&&e()}})};return b}();c.ExpanderBuilder=e})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b,a,d,f,h,e,c){this.dataAttributeNames=b;this.cssClassesBase=a;this.terms=d;this.clientInstanceNamesBase=f;this.postMessageNames=h;this.controlsBase=e;this.constants=c;this.dataAttributes=this.initDataAttributesCommon();this.selectors=this.initSelectorsCommon()}e.prototype.initSelectorsCommon=function(){return{addElementButton:"."+this.cssClassesBase.AddElementButton,elementExternalSourceComputer:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementExternalSource,
c.AddResourceMenu.ElementExternalSourceType.Computer),elementListContainer:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainer),elementListContainerHomework:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainerHomework),elementListCount:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListCount),elementListItem:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListItem)}};e.prototype.initDataAttributesCommon=
function(){return{elementListContainer:"data-"+this.dataAttributeNames.ElementListContainer,elementListContainerHomework:"data-"+this.dataAttributeNames.ElementListContainerHomework,elementListCount:"data-"+this.dataAttributeNames.ElementListCount,elementListItem:"data-"+this.dataAttributeNames.ElementListItem}};e.prototype.getElementForEventData=function(b){return b.data(this.dataAttributeNames.ElementListItem)};e.prototype.getElementExternalSourceType=function(b){return b.data(this.dataAttributeNames.ElementExternalSource)};
e.prototype.getContentElementType=function(b){return b.data(this.dataAttributeNames.ContentElementType)};e.prototype.getAddResourceMenuParameters=function(b){return b.data(g.CalendarClientConstants.dataAttributeNames.addResourceMenuParameters)};e.prototype.getElementId=function(b){return this.getElementForEventData(b).ElementId};e.prototype.getElementByElementId=function(b){return $("["+this.dataAttributes.elementListItem+'*=\'"ElementId":'+b+",']")};e.prototype.getAddedElementsCount=function(b){return b.find(this.selectors.elementListItem).length};
e.prototype.toggleElementActivation=function(b){this.getElementByElementId(b).find("."+this.cssClassesBase.ElementListTitle).toggleClass(this.cssClassesBase.ElementItemInactive)};e.prototype.toggleCalendarDropdown=function(b){var a=b.enabled?"":this.terms.CannotChangeCalendarBecauseOfNextEventTooltip;b.calendarDropdown.prop("disabled",!b.enabled);b.calendarDropdown.prop("title",a)};return e}();g.CalendarUtilityBase=k})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=c.CalendarControllerModels.EventValidationScope,b=function(a){function d(d,b){a.call(this,d.DataAttributes,d.CssClasses,d.Terms,d.ClientInstanceNames,d.PostMessageNames,b,d.CalendarClientConstants);this.settings=d;this.controls=b}__extends(d,a);d.prototype.getEventDateValidationInputModel=function(a){var d=this,b=this.getEventSettingsRecurring(),f=this.parseJsonIntList(this.controls.EventBookingsBookedIdsHidden.val()),c=this.parseJsonIntList(this.controls.EventBookingsReservedIdsHidden.val()),
g=this.settings.SingleActivityId,k=0;this.getWeekDayCheckboxes().each(function(a,b){a=$(b);a.is(":checked")&&(b=CCL.CommonFunctions.getDataSelector(d.settings.DataAttributes.WeekDayEnumValue),a=a.closest(b),k+=parseInt(a.data(d.settings.DataAttributes.WeekDayEnumValue),10))});var q=(a&e.BookingsAvailability)===e.BookingsAvailability;return{ValidationScope:a,StartDate:this.controls.startDateInput.val(),StartTime:this.controls.startTimeInput.val(),StopDate:this.controls.endDateInput.val(),StopTime:this.controls.endTimeInput.val(),
CourseId:this.settings.LocationId,RecurrenceEndDate:b.RecurrenceEndDate,IsRecurring:b.IsRecurring,IsSingle:!b.IsRecurring,WasIsSingle:this.settings.WasIsSingle,RepeatWeekCount:this.controls.repeatWeekCountSelect.val()||"0",WeekDaysEnumValue:k,SelectedBookingIds:""+$.merge(f,c),HidePartlyBookedBookingsForRecurringEvent:q&&0!==g,EventId:g}};d.prototype.getEventSettingsRecurring=function(){return{StartDate:this.controls.startDateInput.val(),RecurrenceEndDate:0<this.controls.recurrenceEndDateInput.length?
this.controls.recurrenceEndDateInput.val():"",IsRecurring:this.controls.recurringCheckbox.is(":checked")}};d.prototype.getWeekDayCheckboxes=function(){this.weekDayCheckboxes||(this.weekDayCheckboxes=this.controls.repeatWeekDaysList.find("input:checkbox"));return this.weekDayCheckboxes};d.prototype.isBookingsHandlingNeeded=function(){return this.settings.EnableBookings||this.hasAnyBookingsSelected()};d.prototype.hasAnyBookingsSelected=function(){return 0<this.parseJsonIntList(this.controls.EventBookingsBookedIdsHidden.val()).length||
0<this.parseJsonIntList(this.controls.EventBookingsReservedIdsHidden.val()).length};d.prototype.openConfirmSubmitDialog=function(a,d){CCL.CommonFunctions.jAjaxConfirm(a,this.settings.Terms.ConfirmationDialogTitle,this.settings.Terms.Ok,this.settings.Terms.CancelButton,d)};d.prototype.parseJsonIntList=function(a){return JSON.parse(a||"[]")};d.timeoutForDatesIntervalShiftingMilliseconds=200;d.timeoutForValidationAfterDateShiftedMilliseconds=d.timeoutForDatesIntervalShiftingMilliseconds+100;return d}(c.CalendarUtilityBase);
g.Utility=b})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){var a=this;this.utilityBase=b;this.toggleSectionByItemCount=function(d){var b=d.getElementsByClassName(a.utilityBase.cssClassesBase.ElementList).item(0);d.style.display=b&&b.hasChildNodes()?"":"none"}}e.prototype.getFakeElement=function(){return $("#"+this.utilityBase.constants.FakeElementItemId)};e.prototype.getCurrentFakeElementTitle=function(){return this.getFakeElement().find("."+this.utilityBase.cssClassesBase.ElementListTitle).text()};
e.prototype.hasFakeElement=function(){return this.getFakeElement().is(":visible")};e.prototype.removeElement=function(b,a){var d=this;void 0===a&&(a=void 0);var f=b.closest(this.elementListSelector);b.slideUp(c.CalendarClientConstants.animationSpeedMilliseconds,function(){b.remove();d.afterRemoveElement(f,a)})};e.prototype.buildFakeElementMarkup=function(b){var a=document.createElement("li");a.id=this.utilityBase.constants.FakeElementItemId;a.setAttribute(this.utilityBase.dataAttributes.elementListItem,
"");var d=this.utilityBase.controlsBase.LoadingWheel;d.style.display="";var f=document.createElement("div");f.classList.add(this.utilityBase.cssClassesBase.ElementListItemContainer);var h=document.createElement("span");h.classList.add(this.utilityBase.cssClassesBase.ElementListTitle);h.classList.add(this.utilityBase.cssClassesBase.FontItalic);h.textContent=CCL.CommonFunctions.htmlEncode(b);f.appendChild(d);f.appendChild(h);a.appendChild(f);return a};e.prototype.buildElementListSectionMarkup=function(){return'<ul class="'+
this.utilityBase.cssClassesBase.ElementList+" "+this.utilityBase.cssClassesBase.GenericList+'" />'};e.prototype.afterRemoveElement=function(b,a){0===this.utilityBase.getAddedElementsCount(b)&&b.slideUp();a&&a()};return e}();c.ElementListMarkupBuilderBase=g})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(b){function a(a){b.call(this,a);this.utility=a;this.elementListSelector=this.utility.selectors.elementListContainer}__extends(a,b);a.prototype.buildElementListMarkup=function(a){0<a.ResourceCount&&this.utility.controls.ElementListSection.get(0).insertAdjacentHTML("beforeEnd",a.Resources);this.utility.settings.IsAddingHomeworkElementsEnabled&&0<a.HomeworkCount&&this.utility.controls.HomeworkElementListSection.get(0).insertAdjacentHTML("beforeEnd",
a.Homework)};a.prototype.addFakeItemIntoElementSection=function(a){a=this.buildFakeElementMarkup(a);var d=this.utility.controls.ElementListSection.get(0),b=d.getElementsByClassName(this.utility.cssClassesBase.ElementList);b.length||(d.insertAdjacentHTML("beforeEnd",this.buildElementListSectionMarkup()),b=d.getElementsByClassName(this.utility.cssClassesBase.ElementList));b[0].insertAdjacentHTML("beforeEnd",a.outerHTML);"none"===d.style.display&&(d.style.display="")};a.prototype.removeFakeItemFromElementSection=
function(){this.getFakeElement().remove();this.toggleSectionByItemCount(this.utility.controls.ElementListSection.get(0))};a.prototype.toggleAddResourceButtonAndSections=function(a){this.toggleAddButton(a);this.toggleSectionByItemCount(this.utility.controls.ElementListSection.get(0));this.utility.settings.IsAddingHomeworkElementsEnabled&&this.toggleSectionByItemCount(this.utility.controls.HomeworkElementListSection.get(0))};a.prototype.afterRemoveElement=function(a,f){var d=this;b.prototype.afterRemoveElement.call(this,
a,function(){d.toggleAddButton();f&&f()})};a.prototype.toggleAddButton=function(a){void 0===a&&(a=void 0);a=a||this.utility.getAddedElementsCount($(document));$(this.utility.selectors.addElementButton).toggle(a<this.utility.constants.MaxCountOfAddedElements)};return a}(c.ElementListMarkupBuilderBase);g.ElementListMarkupBuilder=e})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a,d,f){void 0===f&&(f=3);this.targetContainer=b;this.dotContainerCssClass=a;this.dotsCssClass=d;this.dotsCount=f;a=$("<div>").addClass(this.dotContainerCssClass);for(d=0;d<f;d++)a.append($("<div>").addClass(this.dotsCssClass));b.append(a)}c.prototype.removeDotContainer=function(){this.targetContainer.find("."+this.dotContainerCssClass).remove()};return c}();c.CalendarBouncingDots=g})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb=
{}));(function(c){c=c.Calendar||(c.Calendar={});c=c.CalendarClientConstants||(c.CalendarClientConstants={});c.animationSpeedMilliseconds=500;c.dataAttributeNames={addResourceMenuParameters:"add-resource-menu-parameters"};c.alternativeChoiceDialogOffsetY=-7;c.uploadingFileTimeoutMilliseconds=400})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(a){function d(d,b,c){a.call(this,d);this.utility=d;this.expanderBuilder=b;this.callbackOnSectionToggle=c;this.enableElementLinkManagement=!0;this.elementListSelector=this.utility.selectors.expandableContainer}__extends(d,a);d.prototype.renderAddButtonWithElementSections=function(a,d,b){this.enableElementLinkManagement=d.enableElementLinkManagement&&b!==g.EventDetailsType.ListView;b=a.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);
0===b.length&&(b=this.generateElementListAppendTarget(),a.append(b));this.enableElementLinkManagement&&!a.find("#calendar-add-menu").length&&b.before($('<div id="calendar-add-menu" data-course-id="'+d.courseId+'">').addClass(this.utility.settings.cssClasses.MarginTop10).addClass(this.utility.settings.cssClasses.AddElementButton));this.renderElementList(b,d.elementListMarkups)};d.prototype.generateElementListAppendTarget=function(){return $("<div>").addClass(this.utility.settings.cssClasses.SelectedElementListAppendTarget)};
d.prototype.generateAttachedElementsHidden=function(){return $("<input>").attr(this.utility.selectors.addEventDialogAttachedElementsHidden,"").prop("type","hidden").prop("value","[]")};d.prototype.addFakeItemIntoElementSection=function(a,d){a=this.buildFakeElementMarkup(a);d=this.utility.getElementListAppendTarget(d);var b=d.find(this.utility.selectors.elementListContainer),f=b.find("."+this.utility.cssClassesBase.ElementList);f.length?(f.append(a),a=this.utility.getExpandableContainer(b),a.is(":visible")||
a.show(),this.updateHeaderCounter(a)):(b=document.createElement("ul"),b.classList.add(this.utility.settings.cssClasses.ElementList),b.classList.add(this.utility.settings.cssClasses.GenericList),b.innerHTML=a.outerHTML,this.buildResourceListMarkup(d,{Homework:"",HomeworkCount:0,Resources:b.outerHTML,ResourceCount:1,BookableResourceCount:0,BookableResources:""}))};d.prototype.removeFakeItemFromElementSection=function(){var a=this,d=this.getFakeElement(),b=d.closest("."+this.utility.cssClassesBase.ElementList);
d.remove();if(b.length){var e=this.utility.getExpandableContainer(b);setTimeout(function(){a.updateHeaderCounter(e);a.toggleSectionByItemCount(e.get(0))},c.CalendarClientConstants.uploadingFileTimeoutMilliseconds)}};d.prototype.renderElementList=function(a,d){d&&(this.utility.settings.customerSettings.enableHomework&&this.buildHomeworkListMarkup(a,d),this.buildResourceListMarkup(a,d),this.toggleAddElementButton(a.closest("."+this.utility.settings.cssClasses.ContextDialogContent)))};d.prototype.rebuildElementListMarkup=
function(a,d){a=a.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);a.find(this.utility.selectors.expandableContainer).remove();this.renderElementList(a,d);this.updateHeaderCounter(this.utility.getExpandableContainer(a.find(this.utility.selectors.elementListContainer)))};d.prototype.buildHeader=function(a,d){return $("<span>").text(a).append(" (").append($("<span>").attr(this.utility.dataAttributes.elementListCount,"").text(d)).append(")")};d.prototype.afterRemoveElement=
function(d,b){var f=this;a.prototype.afterRemoveElement.call(this,d,function(){f.toggleAddElementButton(d.closest("."+f.utility.settings.cssClasses.ContextDialogContent));f.updateHeaderCounter(d);b&&b()})};d.prototype.buildHomeworkListMarkup=function(a,d){this.buildElementListMarkup(a,this.utility.settings.terms.HomeworkResourcesSectionTitle,this.utility.dataAttributes.elementListContainerHomework,d.Homework,d.HomeworkCount)};d.prototype.buildResourceListMarkup=function(a,d){this.buildElementListMarkup(a,
this.utility.settings.terms.ResourcesSectionTitle,this.utility.dataAttributes.elementListContainer,d.Resources,d.ResourceCount)};d.prototype.buildElementListMarkup=function(a,d,b,c,e){null!=c&&0<c.length&&(b=$("<div>").attr(b,"").append(c),this.enableElementLinkManagement||b.find("."+this.utility.settings.cssClasses.ElementListItemRemove).remove(),this.expanderBuilder.buildExpandableContainer(a,this.buildHeader(d,e),b,{isExpanded:!0},this.callbackOnSectionToggle))};d.prototype.updateHeaderCounter=
function(a){a.find(this.utility.selectors.elementListCount).text(this.utility.getAddedElementsCount(a))};d.prototype.toggleAddElementButton=function(a){var d=this.utility.getManuallyAddedElementsCount(a);a.find(this.utility.selectors.addElementButton).toggle(d<this.utility.constants.MaxCountOfAddedElements)};return d}(c.ElementListMarkupBuilderBase);e.ElementListMarkupBuilder=b})(g.ElementLink||(g.ElementLink={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(c){(function(c){(function(c){(function(c){var b=function(){function a(a,b,h,c,e,g,k){var d=this;this.container=a;this.utility=b;this.callbacks=h;this.binding=c;this.isAlwaysPlainText=e;this.isMultiline=g;this.inputValidationFunction=k;this.onEditFunction=function(a,b){a.actualText=a.actualText.replace(/[^\S\n]{2,}/g," ").trim();if(d.inputValidationFunction&&!d.inputValidationFunction(a.actualText))a.stopOnEdit=!0,a.isUpdateSuccess=!1,b(a);else{var f=d.isMultiline?CCL.CommonFunctions.replaceLineBreaksWithPTags(CCL.CommonFunctions.htmlEncode(a.actualText)):a.actualText;
d.callbacks.onTextSaved();d.binding.sendTextAjax(f).fail(function(){return a.isUpdateSuccess=!1}).always(function(){return b(a)})}};this.onChangeModeFunction=function(a){[d.cssClasses.ScheduleDialogSubheader,d.cssClasses.ShowMoreOptionsLink,d.cssClasses.ExpandableContainerHeader,d.cssClasses.ExpandableContainerContent].forEach(function(b){b=$("."+b);if(CCL.CommonFunctions.isIe()||CCL.CommonFunctions.isEdge())b=b.parent();b.css("pointer-events",a.isEditMode||d.callbacks.checkIfAnythingElseIsInEditMode()?
"none":"")});if(a.isEditMode)d.initEditMode();else{d.container.removeClass(d.cssClasses.TextContainerFocused);if(d.callbacks.onEditFinished)d.callbacks.onEditFinished();a.actualText?d.initViewModeWithChangedText():a.isNewTextSaved||d.textContainer.hasClass(d.cssClasses.TextContainerWatermark)?d.initViewModeWithWatermark():d.initViewModeWithInitialText()}};this.cssClasses=this.utility.settings.cssClasses;this.editorOptions={autoResize:!0,autoResizeAdditionalHeight:0,multiline:!0,editFieldCssClass:this.cssClasses.Width100Percent+
" "+this.cssClasses.ResizeNone+" "+this.cssClasses.UserInput,watermark:this.binding.watermarkText,watermarkCssClass:this.cssClasses.TextContainerWatermark,preventLineBreaksInMultilineMode:!g}}a.prototype.makeTextContentInlineEditable=function(){this.textContainer=this.container.find("."+this.cssClasses.UserInput);this.editorInstance=new ClientInlineEditor(this.textContainer,void 0,this.createHidden(),this.editorOptions,this.onEditFunction,this.onChangeModeFunction,void 0);this.textContainer.click()};
a.prototype.createHidden=function(){return $("<input type='hidden'>").val(this.binding.cachedPlainText).appendTo(this.container)};a.prototype.initEditMode=function(){this.editorInstance.hideWatermark();this.container.addClass(this.cssClasses.TextContainerFocused)};a.prototype.initViewModeWithChangedText=function(){this.textContainer.removeClass(this.cssClasses.TextContainerWatermark);var a=this.isMultiline?CCL.CommonFunctions.replaceBrTagsWithPTags(this.textContainer.html()):this.isAlwaysPlainText?
this.textContainer.text():this.textContainer.html();this.setText(a);this.binding.cachedText=a};a.prototype.initViewModeWithWatermark=function(){this.textContainer.hasClass(this.cssClasses.TextContainerWatermark)||this.textContainer.addClass(this.cssClasses.TextContainerWatermark);this.textContainer.text(this.binding.watermarkText)};a.prototype.initViewModeWithInitialText=function(){this.setText(this.binding.cachedText)};a.prototype.setText=function(a){this.isAlwaysPlainText?this.textContainer.text(a):
this.textContainer.html(a)};return a}();c.InlineEditContent=b})(c.InlineEdit||(c.InlineEdit={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(a){function d(d,b,c,e){var f=this;a.call(this,d,b,c,e);this.utility=d;this.ajaxClient=b;this.setFocusOutEvent=function(){var a=f.getDatePickerContainer();a.on("focusout",function(){return setTimeout(function(){if((!f.getNextEventDatePicker().isPickerVisible()||f.getNextEventDatePicker().isPickerClosing())&&0===$(document.activeElement).closest(a).length)f.onFocusOut()})})}}__extends(d,a);d.prototype.setDatePickerButtonClick=function(){var a=
this;this.getDatePickerButton().one("click",this.setFocusOutEvent).click(function(){a.getNextEventDatePicker().setDefaultDate(a.getDefaultDate());a.toggleDatePicker(!0);a.getNextEventDatePicker().focus()})};d.prototype.getAvailableDates=function(a,d,b,c){this.ajaxClient.getDatesOfEventsToBePickedAsNextEventForSchedulePage({courseId:d,eventId:b,startDate:a.startDate,endDate:a.endDate,eventStopDateTimeAsIsoString:c}).done(function(d){return a.allowedDates=d})};d.prototype.getAvailableTimeSlotsForDate=
function(a,d,b,c){this.ajaxClient.getTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage({courseId:d,eventId:b,date:a.date,eventStopDateTimeAsIsoString:c}).done(function(d){return a.availableTimeSlots=d})};d.prototype.resetDatePicker=function(){this.toggleDatePicker(!1);var a=this.getNextEventDatePicker();a.clearDateAndTime(!1);a.setDefaultDate(null)};d.prototype.isInEditMode=function(){return this.isEditMode};d.prototype.toggleDatePicker=function(a){this.getDatePickerContainer()[0].style.display=
a?"inline-flex":"none";this.getDatePickerButton()[0].style.display=a?"none":"inline-flex";this.isEditMode=a};d.prototype.onFocusOut=function(){this.toggleDatePicker(!1)};return d}(c.NextEventDateWorkerBase);e.AddEditEventDialogNextEventDateWorker=b})(g.NextEvent||(g.NextEvent={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(c){var b=function(a){function d(d,b,c,e){var f=this;a.call(this,d,b,d.settings.ClientInstanceNames.AddEventNextEventPicker,d.settings.ClientInstanceNames.AddEventNextEventTimeSlotPicker);this.utility=d;this.locationParser=c;this.addEventEndDateHiddenFieldWrapper=e;this.setDatePickerButtonClick();$(function(){f.getNextEventDatePicker().getAvailableDatesFunction=function(a){return f.getAvailableDates(a,f.getCourseId(),0,f.getEventStopDateTimeAsIsoString())};
f.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=function(a){return f.getAvailableTimeSlotsForDate(a,f.getCourseId(),0,f.getEventStopDateTimeAsIsoString())}})}__extends(d,a);d.prototype.resetDatePicker=function(){a.prototype.resetDatePicker.call(this);this.getDatePickerButton().find("span").text(this.utility.settings.terms.PickDate)};d.prototype.getDatePickerButton=function(){return this.utility.controls.NextEvent.AddEventDatePickerButton};d.prototype.getDatePickerContainer=function(){return this.utility.controls.NextEvent.AddEventDatePickerContainer};
d.prototype.getDefaultDate=function(){return new Date(this.utility.controls.addEventEndDateHiddenField.val())};d.prototype.getCourseId=function(){return this.locationParser.parseCourseId(this.utility.controls.addEventCalendarsDropdown.val())};d.prototype.getEventStopDateTimeAsIsoString=function(){return JSON.stringify(this.addEventEndDateHiddenFieldWrapper.stringValue)};return d}(c.AddEditEventDialogNextEventDateWorker);c.AddEventDialogNextEventDateWorker=b})(c.NextEvent||(c.NextEvent={}))})(c.Schedule||
(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(c){var b=function(a){function d(d,b,c){var f=this;a.call(this,d,b,d.settings.ClientInstanceNames.EditEventNextEventPicker,d.settings.ClientInstanceNames.EditEventNextEventTimeSlotPicker);this.onNextEventSaved=c;$(function(){f.getNextEventDatePicker().getAvailableDatesFunction=function(a){return f.getAvailableDates(a,f.queryArgs.courseId,f.queryArgs.eventId,f.queryArgs.eventStopDateTimeAsIsoString)};f.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=
function(a){return f.getAvailableTimeSlotsForDate(a,f.queryArgs.courseId,f.queryArgs.eventId,f.queryArgs.eventStopDateTimeAsIsoString)}})}__extends(d,a);Object.defineProperty(d.prototype,"nextEventQueryArgs",{set:function(a){this.resetDatePicker();this.setDatePickerButtonClick();this.queryArgs=a;0<a.nextEvent.eventId&&this.setDateTimePickerValues()},enumerable:!0,configurable:!0});d.prototype.setDateTimePickerValues=function(){var a=this.getNextEventDatePicker();a.setDate(CCL.SerializableDateTimeConverter.toDateWithSeconds(this.queryArgs.nextEvent.eventStart));
var d=this.getNextEventTimeSlotPicker();d.updateFilteredTimeForDate(a.getDateAsString(),a.selectedFilterId);d.setSelectedTimeSlot(this.queryArgs.nextEvent.eventId);d.toggle(!0)};d.prototype.getDatePickerButton=function(){return this.utility.controls.NextEvent.EditEventDatePickerButton};d.prototype.getDatePickerContainer=function(){return this.utility.controls.NextEvent.EditEventDatePickerContainer};d.prototype.getDefaultDate=function(){return new Date(JSON.parse(this.queryArgs.eventStopDateTimeAsIsoString))};
d.prototype.onFocusOut=function(){a.prototype.onFocusOut.call(this);this.getNextEventId()!==this.queryArgs.nextEvent.eventId&&this.saveNextEvent()};d.prototype.saveNextEvent=function(){var a=this,d=this.getNextEventId();this.ajaxClient.editNextEventId({EventId:this.queryArgs.eventId,NextEventId:d}).done(function(){a.queryArgs.nextEvent.eventId=d;if(a.onNextEventSaved)a.onNextEventSaved(d)})};return d}(c.AddEditEventDialogNextEventDateWorker);c.EditEventDialogNextEventDateWorker=b})(c.NextEvent||(c.NextEvent=
{}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(c){var b=function(){function a(a,b){this.utility=a;this.dateFormatter=b}a.prototype.buildMarkup=function(a,b,h){h=0<h.NextEventId?this.dateFormatter.getEventFormattedDateAndTime(CCL.SerializableDateTimeConverter.toDateWithSeconds(h.NextEventStart),CCL.SerializableDateTimeConverter.toDateWithSeconds(h.NextEventStop)):void 0;b?(this.utility.controls.NextEvent.EditEventDatePickerButton.find("span").text(h||this.utility.settings.terms.PickDate),this.utility.controls.NextEvent.EditEventDatePickerButton.appendTo(a),
this.utility.controls.NextEvent.EditEventDatePickerContainer.appendTo(a)):h&&$("<div>").addClass(this.utility.settings.cssClasses.NextEventDateLabel).text(h).appendTo(a)};return a}();c.NextEventMarkupBuilder=b})(c.NextEvent||(c.NextEvent={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){var g=function(){return function(c,e){var b=this;void 0===e&&(e=function(){});this.commonSettings=c;this.onBeforeRedirect=e;this.handleAjaxError=function(a){var d=function(){b.onBeforeRedirect();(window.itslTop||window.top).location.href=b.commonSettings.LogoutPageUrl},f=function(){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(CCL.CommonFunctions.htmlDecode(b.commonSettings.AnErrorOccurredTerm))};a.status===CCL.CommonConstants.httpStatusCodes.badRequest||a.status===
CCL.CommonConstants.httpStatusCodes.unauthorized||a.status===CCL.CommonConstants.httpStatusCodes.methodNotAllowed?$.ajax({type:"GET",url:b.commonSettings.CheckSessionUrl}).done(function(a){return(a?d:f)()}).fail(d):f()}}}();c.CommonAjaxClient=g})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){this.clientInstanceName=b;this.settings=a;window[b]=this;this.modalDialogClientInstanceName=a.ModalDialogClientInstanceName;this.modalDialog=window[a.ModalDialogClientInstanceName]}e.prototype.openDialog=function(b,a,d,f){void 0===d&&(d=!1);void 0===f&&(f=!0);a=this.createIFrameUrl(b,a,d,f);this.modalDialog.setIframeUrl(a,!1);this.modalDialog.setTitle(b===c.CopyMoveElementDialogMode.Copy?this.settings.Terms.CopyTo:this.settings.Terms.MoveTo);
this.modalDialog.openDialog(!1)};e.prototype.closeDialog=function(){CssModal.closeDialog()};e.prototype.getContentMaxHeight=function(){return this.modalDialog.getInnerContentMaxHeight()};e.prototype.resizeDialog=function(){this.modalDialog.adjustWindowSize()};e.prototype.copyMoveOperationInProgress=function(b){var a=this;this.modalDialog.toggleDialogCloseButton(!b);this.modalDialog.getIframe().load(function(){a.modalDialog.toggleDialogCloseButton(!0)})};e.prototype.copyMoveOperationCompleted=function(b){window.dispatchEvent(new CustomEvent(this.settings.CopyMoveOperationCompletedEventName,
{detail:b}))};e.prototype.createIFrameUrl=function(b,a,d,f){b=this.settings.IframePageUrl+"?"+this.settings.RequestItems.Mode+"="+b+"&"+this.settings.RequestItems.ElementIds+"="+(Array.isArray(a)?encodeURIComponent(a.join(",")):a);d&&(b=b+"&"+this.settings.RequestItems.HideLocationDropdown+"="+d);f||(b=b+"&"+this.settings.RequestItems.ShowFeedback+"="+f);return b};return e}();c.CopyMoveElementDialog=g})(c.CopyMoveElementDialog||(c.CopyMoveElementDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.clientInstanceName=b;this.settings=a;window[b]=this;$(function(){d.$copyMoveButton=$("#"+d.settings.ClientIds.CopyMoveButton);d.$copyWithTreeLinksButton=$("#"+d.settings.ClientIds.CopyWithTreeLinksButton);d.$cancelButton=$("#"+d.settings.ClientIds.CancelButton);d.$courseAndProjectsDropDownList=$("#"+d.settings.ClientIds.CourseAndProjectDropDownList);d.$includeAnswersCheckBox=$("#"+d.settings.ClientIds.IncludeAnswersCheckBox);
d.$includeAnswersCheckBoxHidden=$("#"+d.settings.ClientIds.IncludeAnswersCheckBoxHiddenField);d.$overwriteAssessmentCriteriaCheckBox=$("#"+d.settings.ClientIds.OverwriteAssessmentCriteriaCheckBox);d.$overwriteAssessmentCriteriaCheckBoxHidden=$("#"+d.settings.ClientIds.OverwriteAssessmentCriteriaCheckBoxHiddenField);d.$treeMenu=$("#"+d.settings.ClientIds.TreeMenu);d.$viewPort=$("#"+d.settings.ClientIds.ViewPort);d.$lastSelected=$("."+d.settings.CssClasses.NodeClicked);d.treeLinksFeedback=window[d.settings.TreeLinksWarning.TreeLinksFeedbackName];
d.treeLinksWarning=d.settings.TreeLinksWarning;d.genericFeedback=window[d.settings.FeedbackMessage.FeedbackClientInstanceName];d.feedbackMessage=d.settings.FeedbackMessage;d.terms=d.settings.Terms;d.mode=d.settings.Mode;d.contentContainer=document.getElementById(d.settings.ClientIds.ContentContainer);d.windowParent=window.parent;d.$viewPort[0]&&(d.contentHeightWithoutTreeMenu=d.contentContainer.scrollHeight-d.$viewPort[0].clientHeight);d.copyMovePostbackClientFunction=new Function(d.settings.ClientFunctions.CopyMovePostback);
d.copyWithTreeLinksPostbackClientFunction=new Function(d.settings.ClientFunctions.CopyWithTreeLinksPostback);d.currentlyInProgress=!1;d.$copyMoveButton.prop("disabled",!0).removeAttr("onclick").click(function(){d.inProgress();d.copyMovePostbackClientFunction()});d.$copyWithTreeLinksButton.prop("disabled",!0).removeAttr("onclick").click(function(){d.inProgress();d.copyWithTreeLinksPostbackClientFunction()});d.feedbackMessage.ShowMessage?(d.currentlyInProgress=!0,d.genericFeedback.showMessage(CCL.FeedbackType.Warning,
d.feedbackMessage.Message),d.$copyMoveButton.prop("disabled",!0),d.$copyWithTreeLinksButton.prop("disabled",!0),d.$copyMoveButton.hide(),d.$copyWithTreeLinksButton.hide()):d.treeLinksWarning.ShowTreeLinksWarning&&(d.updateTreeLinksFeedbackAndButtons(d.treeLinksWarning.TreeLinksWarningMessage),d.$includeAnswersCheckBox.length&&d.$includeAnswersCheckBox.removeAttr("onclick").click(function(){d.updateTreeLinksWarningClientFunction()}));d.settings.ReloadFolder&&("function"===typeof window.itslTop.reloadFolder&&
window.itslTop.reloadFolder(),d.notifyAboutProgress(!1));d.attachTreeMenuListeners()})}e.prototype.updateTreeLinksFeedbackAndButtons=function(b){b&&b.HasTreeLinks?(this.treeLinksFeedback.showMessage(CCL.FeedbackType.Warning,b.TreeLinksWarningMessage),this.$copyWithTreeLinksButton.show(),this.$copyMoveButton.prop("value",this.mode===c.CopyMoveElementDialogMode.Copy?this.terms.CopySelectedResourceOnly:this.terms.Move)):(this.treeLinksFeedback.hide(),this.$copyWithTreeLinksButton.hide(),this.$copyMoveButton.prop("value",
this.mode===c.CopyMoveElementDialogMode.Copy?this.terms.Copy:this.terms.Move))};e.prototype.updateTreeLinksWarningClientFunction=function(){var b=this;$.ajax({url:this.treeLinksWarning.GetTreeLinksWarningMessageUrl.replace(/includeAnswers=((true)|(false))/ig,"includeAnswers="+this.$includeAnswersCheckBox.is(":checked")),dataType:"json"}).done(function(a){b.updateTreeLinksFeedbackAndButtons(a)})};e.prototype.closeDialog=function(){this.windowParent.closeCopyOrMoveElementsDialog?this.windowParent.closeCopyOrMoveElementsDialog():
window.parent[this.settings.DialogClientInstanceName]&&window.parent[this.settings.DialogClientInstanceName].closeDialog()};e.prototype.attachTreeMenuListeners=function(){var b=this;this.$treeMenu.on("loaded.jstree",function(){$("."+b.settings.CssClasses.Tree).show();b.notifyAboutResizeRequired()});var a=this;this.$treeMenu.on("select_node.jstree",function(d,f){d=$("#"+b.settings.ClientIds.SelectedTreeNode);f=$(f.rslt.obj);if(f.hasClass(a.settings.CssClasses.TreeMenuTogglableNode))return d.val(""),
b.$copyMoveButton.prop("disabled",!0),b.$copyWithTreeLinksButton.prop("disabled",!0),!1;!1===b.currentlyInProgress&&(b.$copyMoveButton.prop("disabled",!1),b.$copyWithTreeLinksButton.prop("disabled",!1));d.val($(f).prop("id"));a.isScrolledIntoView(f)||$("html, body, div").scrollTop(f.offset().top+a.$viewPort.scrollTop()-$(f).height());f.focus();b.$lastSelected&&b.$lastSelected.removeClass(a.settings.CssClasses.NodeSelected);b.$lastSelected=f;b.$lastSelected&&a.$lastSelected.addClass(a.settings.CssClasses.NodeSelected);
return!0});this.$treeMenu.on("open_node.jstree",function(d,f){b.notifyAboutResizeRequired();d=$(f.rslt.obj);if(d.hasClass(a.settings.CssClasses.TreeMenuTogglableNode))a.$treeMenu.jstree("deselect_node",d),a.$treeMenu.jstree("open_node",d),a.$lastSelected&&a.$lastSelected.addClass(a.settings.CssClasses.NodeClicked);else return!0});this.$treeMenu.on("close_node.jstree",function(d,f){b.notifyAboutResizeRequired();d=$(f.rslt.obj);if(d.hasClass(a.settings.CssClasses.TreeMenuTogglableNode)||a.settings.CssClasses.Folder)a.$treeMenu.jstree("deselect_node",
d),a.$treeMenu.jstree("close_node",d),a.$lastSelected&&b.$lastSelected.addClass(a.settings.CssClasses.NodeClicked);else return!0})};e.prototype.isScrolledIntoView=function(b){var a=this.$viewPort.scrollTop(),d=a+this.$viewPort.height(),f=b.offset().top+a;b=f+b.height();return b>=a&&f<=d&&b<=d&&f>=a};e.prototype.inProgress=function(){this.currentlyInProgress=!0;this.$copyMoveButton.prop("disabled",!0).prop("value","").addClass(this.settings.CssClasses.InProgress);this.$copyWithTreeLinksButton.prop("disabled",
!0).prop("value","").addClass(this.settings.CssClasses.InProgress);this.$cancelButton.prop("disabled",!0);this.$courseAndProjectsDropDownList.prop("disabled",!0);this.$includeAnswersCheckBox.length&&(this.$includeAnswersCheckBoxHidden.val(this.$includeAnswersCheckBox.is(":checked").toString()),this.$includeAnswersCheckBox.prop("disabled",!0));this.$overwriteAssessmentCriteriaCheckBox.length&&(this.$overwriteAssessmentCriteriaCheckBoxHidden.val(this.$overwriteAssessmentCriteriaCheckBox.is(":checked").toString()),
this.$overwriteAssessmentCriteriaCheckBox.prop("disabled",!0));this.notifyAboutProgress(!0)};e.prototype.notifyAboutProgress=function(b){this.windowParent.copyMoveOperationInProgress?this.windowParent.copyMoveOperationInProgress(b):window.parent[this.settings.DialogClientInstanceName]&&window.parent[this.settings.DialogClientInstanceName].copyMoveOperationInProgress&&window.parent[this.settings.DialogClientInstanceName].copyMoveOperationInProgress(b)};e.prototype.notifyAboutResizeRequired=function(){if(this.windowParent.getContentMaxHeight){var b=
this.windowParent.getContentMaxHeight();this.$viewPort.css("max-height",b-this.contentHeightWithoutTreeMenu)}else window.parent[this.settings.DialogClientInstanceName]&&window.parent[this.settings.DialogClientInstanceName].getContentMaxHeight&&(b=window.parent[this.settings.DialogClientInstanceName].getContentMaxHeight(),this.$viewPort.css("max-height",b-this.contentHeightWithoutTreeMenu));this.windowParent.resizeDialog?this.windowParent.resizeDialog():window.parent[this.settings.DialogClientInstanceName]&&
window.parent[this.settings.DialogClientInstanceName].resizeDialog&&window.parent[this.settings.DialogClientInstanceName].resizeDialog()};return e}();c.CopyMoveElementDialogPage=g})(c.CopyMoveElementDialog||(c.CopyMoveElementDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){var a=this;this.settings=b;$("table button[id*='_Delete_']").click(function(d){return a.onDeleteGroup(d)});b=$("#"+b.DeleteButtonClientId);this.deletePostBackReference=b.attr("href").replace("javascript:","");b.click(function(d){return a.onDeleteSelectedGroups(d)})}c.prototype.isAnyGroupSelected=function(){var b=$("[id^='"+this.settings.TableClientId+"_Select']:checked");return 0<b.length?1===b.length&&-1<b[0].id.toLowerCase().indexOf("selectall")?
!1:!0:!1};c.prototype.onDeleteGroup=function(b){var a=this,d=$(b.currentTarget);b=[];b.push(this.getGroupId(d));this.checkBeforeDelete(b,function(){return a.deleteGroup(d)})};c.prototype.onDeleteSelectedGroups=function(b){var a=this;if(!this.isAnyGroupSelected())return alert(this.settings.Terms.SelectGroups),!1;this.checkBeforeDelete(GroupsTableGetSelectedValues(),function(){(new Function(a.deletePostBackReference))()});return!1};c.prototype.checkBeforeDelete=function(b,a){var d=this,f=1===b.length?
this.settings.Terms.DeleteGroupQuestion:this.settings.Terms.DeleteGroupsQuestion;this.checkRelatedCalendarEvents(b).done(function(b){if(b){b=new CCL.ConfirmButtonMetaData(d.settings.Terms.Delete,CCL.CommonCssClasses.Buttons.Red,"Delete");var h=new CCL.ConfirmButtonMetaData(d.settings.Terms.Cancel,"","Cancel");CCL.CommonFunctions.jAjaxMultiButtonConfirm("",d.settings.Terms.GroupHasConnectedEventsWarning,[b,h],function(d){"Delete"===d.customId&&a()})}else confirm(f)&&a()})};c.prototype.deleteGroup=
function(b){__doPostBack(b.data("event-target"),"")};c.prototype.getGroupId=function(b){b=b.attr("id");return Number(b.substr(b.lastIndexOf("_")+1))};c.prototype.checkRelatedCalendarEvents=function(b){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.ApiRoutes.CheckRelatedCalendarEvents,data:b})};return c}();c.Groups=g})(c.Courses||(c.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d){var b=this;window[a]=this;this.settings=d;$(function(){b.$pickerResults=$("#"+b.settings.Controls.PickerResultsHidden)})}b.prototype.getPickerResult=function(){return this.$pickerResults.val()};return b}();c.AssignTo=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function a(a){var d=this;this.settings=a;$("#"+this.settings.Controls.EmailDeactivate).on("click",function(){confirm(d.settings.Terms.AreYouSureDeactivateEmail)&&d.updateServiceStatus(b.email,!1,function(){$("."+d.settings.CssClasses.Services+" [data-service='"+b.email+"']").attr("data-is-active","false");d.showInformationFeedback(d.settings.Terms.EmailSuccessfullyDeactivated);d.updateCheckboxesStates(b.email)})});$("#"+this.settings.Controls.EmailActivate).on("click",
function(){confirm(d.settings.Terms.AreYouSureActivateEmail)&&d.updateServiceStatus(b.email,!0,function(){$("."+d.settings.CssClasses.Services+" [data-service='"+b.email+"']").attr("data-is-active","true");d.showInformationFeedback(d.settings.Terms.EmailSuccessfullyActivated);d.updateCheckboxesStates(b.email)})});$("#"+this.settings.Controls.SubscriptionsSave).on("click",function(){var a=[];$("."+d.settings.CssClasses.SubscriptionsCheckbox).each(function(d,b){a.push({Service:$(b).attr("data-service"),
Subscription:$(b).attr("data-subscription"),IsChecked:$(b).find("input").prop("checked")})});var b={};b[d.settings.AntiForgeryHeaderName]=d.settings.AntiForgeryHeaderValue;CCL.CommonFunctions.safeAjaxPost({url:d.settings.SubscriptionsUrl,data:{model:a},headers:b}).done(function(){d.showInformationFeedback(d.settings.Terms.InformationSaved)}).fail(function(){return d.showInformationFeedback(d.settings.Terms.ErrorFeedback)})})}a.prototype.updateServiceStatus=function(a,b,h){var d=this,f={};f[this.settings.AntiForgeryHeaderName]=
this.settings.AntiForgeryHeaderValue;CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceStatusUrl,data:{service:a,isActive:b},headers:f}).done(h).fail(function(){return d.showInformationFeedback(d.settings.Terms.ErrorFeedback)})};a.prototype.updateCheckboxesStates=function(a){var d=$("."+this.settings.CssClasses.Services+" [data-service='"+a+"']").attr("data-is-active");a=$("."+this.settings.CssClasses.SubscriptionsCheckbox+"[data-service='"+a+"'] input");"false"===d&&a.attr("disabled","disabled");
"true"===d&&a.removeAttr("disabled")};a.prototype.showInformationFeedback=function(a){CCL.InformationFeedback.showFeedback($("#"+this.settings.Controls.MainContainer),a)};return a}();c.Alerts=e;var b=function(){function a(){}a.email="email";return a}()})(c.Settings||(c.Settings={}))})(c.Person||(c.Person={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this.lastTreeLinkIdToNavigate=void 0;this.settings=b;$(function(){d.$informationFeedbackContainer=$("#"+a);CCL.CustomTreeLinkNavigationManager.registerCustomHandler(function(a){d.handleTreeLinkNavigationEvent(a)});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.askIfCustomTreeLinkNavigationRequired,function(){d.hideInformationFeedback(!1)})})}c.prototype.handleTreeLinkNavigationEvent=
function(b){var a=this;this.lastTreeLinkIdToNavigate=b.linkId;if(!b.linkId||0>=b.sourceId)this.showInformationFeedback(b.context===CCL.TreeLinkContext.library?this.settings.Terms.TreeLinkIsInLibrary:this.settings.Terms.ErrorOccurred);else{var d=this.settings.TreeLinksGetInfoForCustomNavigation.replace("{id}",b.linkId).replace("{sourceElementId}",b.sourceId.toString());$.get(d).done(function(d){if(a.lastTreeLinkIdToNavigate===b.linkId)if(d.HasError)a.showInformationFeedback(d.ErrorDescription);else{var f=
a.settings.KpiSettings;CCL.CommonFunctions.measureKpi(f.url,f.section,f.clickOnTreeLinkMeasurement,f.context).always(function(){"_blank"===b.target?window.open(d.TargetElementContentUrl,"_blank"):window.itslTop.location.assign(d.TargetElementUrl)})}}).fail(function(){a.lastTreeLinkIdToNavigate===b.linkId&&a.showInformationFeedback(a.settings.Terms.ErrorOccurred)})}};c.prototype.showInformationFeedback=function(b){CCL.InformationFeedback.showFeedback(this.$informationFeedbackContainer,b)};c.prototype.hideInformationFeedback=
function(b){void 0===b&&(b=!0);CCL.InformationFeedback.hideFeedback(this.$informationFeedbackContainer,b)};return c}();c.GenericTreeLinkNavigationHandler=g})(c.TreeLink||(c.TreeLink={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d){var b=this;this.onWorkloadEnableChanged=function(a){$("#"+b.settings.Controls.WorkloadEnableCheckbox).is(":checked")?b.$workloadEstimationSection.show():(b.$workloadEstimationHoursTextBox.val("0"),b.$workloadEstimationMinutesDropDown.val("00"),b.$workloadEstimationSection.hide())};window[a]=this;this.settings=d;$(function(){b.$workloadEstimationSection=$("#"+b.settings.Controls.WorkloadEstimationSection);b.$workloadEstimationHoursTextBox=
$("#"+b.settings.Controls.WorkloadEstimationHoursTextBox);b.$workloadEstimationHoursInputError=$("#"+b.settings.Controls.WorkloadEstimationHoursInputError);b.$workloadEstimationMinutesDropDown=$("#"+b.settings.Controls.WorkloadEstimationMinutesDropdown);b.$workloadEnableCheckbox=$("#"+b.settings.Controls.WorkloadEnableCheckbox);b.$workloadEnableCheckbox.on("click",function(a){return b.onWorkloadEnableChanged(a)});$("#"+b.settings.Controls.WorkloadEnableCheckbox).is(":checked")||b.$workloadEstimationSection.hide();
b.$workloadEstimationSection.on("change keyup",function(){$(document).trigger(b.settings.Events.WorkloadChangedClient)})})}b.prototype.onChange=function(a){this.onChangeHandler=a};b.prototype.isValid=function(){var a=$.isNumeric(this.$workloadEstimationHoursTextBox.val()),d=60*this.$workloadEstimationHoursTextBox.val()+1*this.$workloadEstimationMinutesDropDown.val();if(!a||0>d||599940<d)return this.$workloadEstimationHoursInputError.show(),this.$workloadEstimationHoursTextBox.addClass("itsl-workload-estimationhourseditbox-error"),
!1;this.$workloadEstimationHoursInputError.hide();this.$workloadEstimationHoursTextBox.removeClass("itsl-workload-estimationhourseditbox-error");return!0};b.prototype.getWorkloadEnabled=function(){return $("#"+this.settings.Controls.WorkloadEnableCheckbox).is(":checked")?!0:(this.$workloadEstimationHoursTextBox.val("0"),this.$workloadEstimationMinutesDropDown.val("00"),!1)};b.prototype.getWorkloadEstimation=function(){var a=60*this.$workloadEstimationHoursTextBox.val()+1*this.$workloadEstimationMinutesDropDown.val();
return 0>a||599940<a?-1:a};return b}();c.WorkloadSetting=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a,b){this.controls=a;this.settings=b;this.eventPreview=new c.Agenda.AgendaEventPreview(b.ClientInstanceNames.EventDialog,a.EventDialog,b.WebMethods.GetEventDetails,b.WebMethods.DeleteEvent,b.WidgetSettings,b.Terms,{name:b.AntiForgeryTokenName,value:b.AntiForgeryTokenValue},b.EventNames.LoadPlanCards,b.CssClasses.PlansContainer);this.utility=new c.Agenda.AgendaUtility(b.DataAttributes,null);this.setupEventItemClick();this.setupOpenStartUpEvent()}
a.prototype.setupOpenStartUpEvent=function(){var a=this;if(null!=this.settings.StartupEvent&&($(window).load(function(){a.eventPreview.open(a.settings.StartupEvent.Id,a.settings.StartupEvent.Title,a.settings.StartupEvent.Category,a.settings.StartupEvent.Url,a.settings.StartupEvent.ColorSchema,a.settings.StartupEvent.UrlTarget,a.settings.StartupEvent.EditUrl,a.settings.StartupEvent.EditRecurringUrl)}),window.parent&&window.parent.document&&window.parent.history)){var b=CCL.CommonFunctions.setQueryStringParameter(window.parent.location.href,
this.settings.StartupEvent.EventParameterName,"");window.parent.history.replaceState({},window.parent.document.title,b)}};a.prototype.setupEventItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventTimeRangeLink),function(d){d=$(d.currentTarget);d.getIfHyperLinkEnabled()&&a.eventPreview.open(a.utility.getEventId(d),a.utility.getEventTitle(d),a.utility.getEventCategory(d),a.utility.getEventUrl(d),a.utility.getEventColorSchema(d),
a.utility.getEventUrlTarget(d),a.utility.getEditEventUrl(d),a.utility.getEditRecurringEventUrl(d))});this.controls.Container.on("click","."+this.settings.CssClasses.KeepAttendanceButton,function(d){$(d.currentTarget).prop("disabled")||(d=$(d.currentTarget).closest(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.EventId)).data(a.settings.DataAttributes.EventId),a.openKeepAttendanceDialog(d));return!1})};a.prototype.clearEventDialogContent=function(){this.eventPreview.resetDialog()};a.prototype.openKeepAttendanceDialog=
function(a){var d=this;a=new CustomEvent(this.settings.EventNames.OpenKeepAttendanceDialog,{detail:{eventId:a}});document.dispatchEvent(a);var b=function(a){document.removeEventListener(d.settings.EventNames.CloseKeepAttendanceDialog,b);if(a.detail&&a.detail.eventId&&(a.detail.saved||a.detail.attendanceChanged)){if(a.detail.saved){var f=d.settings.Terms.FeedbackMessage.replace("{0}",a.detail.eventDate+" "+a.detail.eventTime).replace("{1}",CCL.CommonFunctions.htmlEncode(a.detail.courseName));CCL.InformationFeedback.showFeedback(d.controls.Container,
f)}var h=(f=0<a.detail.presentCount||0<a.detail.absentCount)?CCL.CommonFunctions.formatString(d.settings.Terms.AttendanceHasBeenKeptWithStatistics,a.detail.presentCount,a.detail.absentCount)+" "+d.settings.Terms.EditAttendance:d.settings.Terms.RegisterAttendance;d.getKeepAttendanceButton(a.detail.eventId).prop("title",h).prop("aria-label",h);d.getAttendanceStatisticsLabel(a.detail.eventId).toggle(f).text(f?a.detail.presentCount+"/"+a.detail.absentCount:"")}};document.addEventListener(this.settings.EventNames.CloseKeepAttendanceDialog,
b)};a.prototype.getKeepAttendanceButton=function(a){return this.getEventContainer(a).find("."+this.settings.CssClasses.KeepAttendanceButton)};a.prototype.getAttendanceStatisticsLabel=function(a){return this.getEventContainer(a).find("."+this.settings.CssClasses.AttendanceStatisticsLabel)};a.prototype.getEventContainer=function(a){return this.controls.Container.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventId,a))};return a}();e.EventsContentBlock=b})(c.Events||(c.Events=
{}))})(c.Widgets||(c.Widgets={}))})(c.Dashboard||(c.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(c){var b=function(){function a(a,b,h,c,e,g,k,r,q){var d=this;this.controlsModel=b;this.url=h;this.deleteUrl=c;this.widgetSettings=e;this.terms=g;this.antiForgeryToken=k;this.loadPlanCardsEventName=r;this.plansContainerCssClass=q;this.courseIconKey="Course";this.eventDialog=window[a];this.initializeButtons();document.addEventListener(CCL.FullScreenDialog.onCloseCancelableEvent,function(){d.currentEventId&&d.loadEvent(d.createGetEventAjaxRequest(d.currentEventId))})}
a.prototype.resetDialog=function(){this.resetNav();this.resetHeaderIcons();this.controlsModel.Content.empty();this.controlsModel.Footer.AttendanceSection.show();this.controlsModel.Footer.AttendanceSection.empty();this.controlsModel.AjaxLoading.hide();this.controlsModel.Footer.ButtonsContainer.hide();this.controlsModel.Header.DeleteEventButton.hide();this.controlsModel.Header.EditEventLink.hide();this.controlsModel.Footer.ShowMore.show();this.currentEventId=void 0};a.prototype.showConfirmation=function(a,
b){this.resetHeaderIcons();var d=$("<span>").addClass(this.controlsModel.ContentHeaderTitleCssClass).text(a);d=$("<div>").addClass(this.controlsModel.ContentHeaderCssClass).append(d);b=$("<div>").text(b);this.controlsModel.Content.empty().append(d,b);this.controlsModel.Header.DeleteEventButton.hide();this.controlsModel.Header.EditEventLink.hide();this.controlsModel.Header.HeaderTitle.text(a);this.controlsModel.Header.HeaderColorSchema.hide();this.controlsModel.Footer.AttendanceSection.hide();this.controlsModel.Footer.ShowMore.hide();
this.controlsModel.Footer.ButtonsContainer.show();this.controlsModel.AjaxLoading.hide();this.eventDialog.adjustWindowSize()};a.prototype.resetHeaderIcons=function(){var a=this,b=this.controlsModel.Header.HeaderColorSchema.data("schema");b&&this.controlsModel.Header.HeaderColorSchema.removeClass(b);Object.keys(this.controlsModel.Header.Icons).forEach(function(d){a.controlsModel.Header.Icons[d].Instance.hide();d!==a.courseIconKey&&a.controlsModel.Header.Icons[d].Instance.parent().hide()})};a.prototype.resetNav=
function(){this.setNav("#")};a.prototype.setNav=function(a,b){void 0===b&&(b="_top");this.controlsModel.Footer.ShowMore.prop("href",a);this.controlsModel.Footer.ShowMore.prop("target",b)};a.prototype.setEditLink=function(a,b){this.controlsModel.Header.EditEventLink.prop("href",a)};a.prototype.SetTitle=function(a,b,h){b in this.controlsModel.Header.Icons&&(h=h.replace("itsl-dot",""),this.controlsModel.Header.HeaderColorSchema.addClass(h).data("schema",h),this.controlsModel.Header.Icons[b].Instance.show(),
b!==this.courseIconKey&&this.controlsModel.Header.Icons[b].Instance.parent().show());this.controlsModel.Header.HeaderTitle.text(a)};a.prototype.open=function(a,b,h,c,e,g,k,r){this.resetDialog();this.SetTitle(b,h,e);this.setNav(c,g);this.eventDialog.openDialog(!1);this.loadEvent(this.createGetEventAjaxRequest(a));this.setEditLink(k,r);this.currentEventId=a};a.prototype.loadEvent=function(a){var d=this;this.currentLoadingSession&&this.currentLoadingSession.abort&&this.currentLoadingSession.abort();
this.controlsModel.Content.empty();this.controlsModel.Content.click(function(a){$(a.target).is("a")&&CssModal.closeDialog()});this.controlsModel.AjaxLoading.show();this.currentLoadingSession=a();this.currentLoadingSession.done(function(a){d.controlsModel.Content.html(a.Content);d.controlsModel.Footer.AttendanceSection.html(a.AttendanceOverview);d.eventDialog.adjustWindowSize();d.controlsModel.Header.DeleteEventButton.toggle(a.IsDeletable);d.controlsModel.Header.EditEventLink.toggle(a.IsEditable);
d.initializeOpenSelfRegistrationDialogEventHandler();CCL.CommonFunctions.applyIframely();d.loadPlanCards()}).always(function(){d.controlsModel.AjaxLoading.hide();d.currentLoadingSession=void 0})};a.prototype.loadPlanCards=function(){var a=this.controlsModel.Content.get(0).getElementsByClassName(this.plansContainerCssClass);if(1===a.length){var b=a[0].getElementsByTagName("input");1===b.length&&a[0].getElementsByTagName("div")[0].dispatchEvent(new CustomEvent(this.loadPlanCardsEventName,{bubbles:!0,
detail:JSON.parse(b[0].value)}))}};a.prototype.createGetEventAjaxRequest=function(a){var d=this;return function(){return CCL.CommonFunctions.safeAjaxPost({url:d.url.replace("{eventId}",a),data:{widgetSettings:d.widgetSettings}})}};a.prototype.initializeButtons=function(){var a=this;this.controlsModel.Header.EditEventLink.click(function(a){CssModal.closeDialog()});this.controlsModel.Header.DeleteEventButton.click(function(d){d=a.controlsModel.Content.find("."+a.controlsModel.EventTitleCssClass).text();
a.showConfirmation(CCL.CommonFunctions.formatString(a.terms.DeleteEventConfirmationHeader,d),a.terms.DeleteEventConfirmationText)});this.controlsModel.Footer.DeleteEventButton.click(function(){$.ajax({type:"DELETE",url:a.deleteUrl.replace("{eventId}",a.currentEventId.toString())+"?deleteRecurringSeries=false",contentType:"application/json",headers:(d={},d[a.antiForgeryToken.name]=a.antiForgeryToken.value,d)}).done(function(){CssModal.closeDialog();window.location.reload()});var d});this.controlsModel.Footer.CancelButton.click(function(){CssModal.closeDialog()})};
a.prototype.initializeOpenSelfRegistrationDialogEventHandler=function(){var a=this;$("."+this.controlsModel.ContentSelfRegisterPresenceButtonCssClass).click(function(d){d.stopPropagation();CssModal.closeDialog();a.openSelfRegistrationAttendanceDialog(a.currentEventId)})};a.prototype.openSelfRegistrationAttendanceDialog=function(a){var d=this;CCL.CommonFunctions.makePostMessageCall(window.top,{messageName:CCL.CommonWindowMessages.MessageNames.maskNavigationBar});a=new CustomEvent(this.controlsModel.OpenSelfRegistrationDialogEventName,
{detail:{eventId:a}});document.dispatchEvent(a);var b=function(a){document.removeEventListener(d.controlsModel.CloseSelfRegistrationDialogEventName,b);CCL.CommonFunctions.makePostMessageCall(window.top,{messageName:CCL.CommonWindowMessages.MessageNames.unmaskNavigationBar})};document.addEventListener(this.controlsModel.CloseSelfRegistrationDialogEventName,b)};return a}();c.AgendaEventPreview=b})(c.Agenda||(c.Agenda={}))})(c.Widgets||(c.Widgets={}))})(c.Dashboard||(c.Dashboard={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){this.clientInstanceName=b;this.settings=a;window[b]=this;this.modalDialogClientInstanceName=a.ModalDialogClientInstanceName;this.modalDialog=window[a.ModalDialogClientInstanceName];this.modalDialog.setCustomScripts({afterOpenDialog:this.fixSidePanelExpansion.bind(this)})}c.prototype.openDialog=function(b){this.deferred=jQuery.Deferred();document.querySelector("#"+this.settings.DialogContentId).innerHTML=b;b=document.querySelector("#"+this.settings.ModalDialogClientInstanceName).querySelectorAll("button");
for(var a=0;a<b.length;a++)b[a].addEventListener("click",this.closeDialog.bind(this));this.modalDialog.openDialog(!1);return this.deferred.promise()};c.prototype.closeDialog=function(b){CssModal.closeDialog();"ok"===b.target.value?this.deferred.resolve(!0):this.deferred.resolve(!1)};c.prototype.fixSidePanelExpansion=function(){setTimeout(function(){return CCL.CommonFunctions.makePostMessageCall(window,{messageName:CCL.CommonWindowMessages.MessageNames.collapseExtensionIframe})},500)};return c}();
c.LearningObjectiveRemovalDialog=g})(c.LearningObjectiveRemovalDialog||(c.LearningObjectiveRemovalDialog={}))})(ItslearningWeb||(ItslearningWeb={}));(function(c){(function(c){var g=function(){function e(){}e.handle=function(b,a,d){switch(b.Code){case c.GenericResponseCode.Success:a(b.ResponseData);break;default:b.ErrorMessage&&alert(b.ErrorMessage),d&&d(b)}};return e}();c.GenericResponseHandler=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.LightBulletin||(c.LightBulletin={});c=c.PendingProcessStatus||(c.PendingProcessStatus={});c[c.InProgress=0]="InProgress";c[c.Failed=1]="Failed";c[c.Aborted=2]="Aborted"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(){this.processes=new Map;this.lastProcessId=0}e.prototype.createProcess=function(b){var a=this.lastProcessId+1;b={processId:a,pendingStatus:c.PendingProcessStatus.InProgress,ajaxRequest:b};this.lastProcessId=a;this.processes.set(a,b);return b};e.prototype.getProcessById=function(b){return this.processes.get(b)};e.prototype.setProcessFailed=function(b){b.pendingStatus=c.PendingProcessStatus.Failed;this.clearProcessAjaxRequest(b)};e.prototype.clearProcessAjaxRequest=
function(b){b.ajaxRequest=void 0};e.prototype.cancelProcess=function(b){b=this.processes.get(b);b.pendingStatus===c.PendingProcessStatus.InProgress&&(b.pendingStatus=c.PendingProcessStatus.Aborted,b.ajaxRequest&&(b.ajaxRequest.abort(),this.clearProcessAjaxRequest(b)))};e.prototype.removeProcessById=function(b){this.processes.delete(b)};return e}();c.PendingEmbedProcessManager=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){this.settings=b;c.supervisorOverviewInstance=this}e.prototype.findSupervisor=function(b,a){return CCL.CommonFunctions.safeAjax({type:"GET",url:c.supervisorOverviewInstance.settings.FindSupervisorsServiceUrl+"?search="+b.term+"&supervisorType="+c.supervisorOverviewInstance.settings.SupervisorType+"&organisationId="+c.supervisorOverviewInstance.settings.OrganizationId,dataType:"json",success:function(d){a($.map(d,function(a){return{label:a.Name,
value:a.Name,id:a.PersonId,organization:a.Organization}}))}})};e.prototype.personSearchRenderItem=function(b,a){return $("<li>").append($("<button>").attr("type","button").text(a.label).addClass(c.supervisorOverviewInstance.settings.CssClasses.ButtonPerson).append($("<div>").addClass(c.supervisorOverviewInstance.settings.CssClasses.ButtonPersonHierarchy).text(a.organization))).appendTo(b)};e.prototype.selectedSupervisorChanged=function(b,a){location.href=c.supervisorOverviewInstance.settings.FilterUrl+
"&"+$.param({SearchText:a.item.value,SearchValue:a.item.id})};return e}();c.SupervisorOverview=g})(c.Supervisor||(c.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b){this.context=b;g.personProfileSiteInstance=this;this.enableTwoFactorCheckboxOnlyForAdmins()}e.prototype.checkEsafetyChanged=function(){if(g.personProfileSiteInstance.context.Settings.IsInstantMessageSystemEnabled&&g.personProfileSiteInstance.context.Settings.IsEditMode){this.rolesUnchecked=[];CCL.CommonFunctions.checkAndAddRole(g.personProfileSiteInstance.context.Settings.EsafetyStaffChecked,g.personProfileSiteInstance.context.Controls.StaffCheckboxClientId,
g.personProfileSiteInstance.context.LanguageTerms.Staff,this.rolesUnchecked);CCL.CommonFunctions.checkAndAddRole(g.personProfileSiteInstance.context.Settings.EsafetyStudentChecked,g.personProfileSiteInstance.context.Controls.StudentCheckboxClientId,g.personProfileSiteInstance.context.LanguageTerms.Student,this.rolesUnchecked);CCL.CommonFunctions.checkAndAddRole(g.personProfileSiteInstance.context.Settings.EsafetyGuestChecked,g.personProfileSiteInstance.context.Controls.GuestCheckboxClientId,g.personProfileSiteInstance.context.LanguageTerms.Guest,
this.rolesUnchecked);var b=c.Administration.PersonProfile.privacyChangedDialogManagerInstance;return b&&0<this.rolesUnchecked.length?(b.openDialog({submitFormMethod:this.context.Settings.SumbitFormMethodString},{personProfileId:g.personProfileSiteInstance.context.Settings.ProfileId,rolesUnchecked:this.rolesUnchecked}),!1):!0}};e.prototype.showConfirmEsafetyChanges=function(b,a,d){var f=g.personProfileSiteInstance.context.Settings.ProfileName,h="";$("#"+g.personProfileSiteInstance.context.Controls.InitiateCommunicationCheckBoxClientId).is(":checked")&&
(h="\n"+g.personProfileSiteInstance.context.LanguageTerms.AdditionEsafetyText);var e="";switch(this.rolesUnchecked.length){case 1:e=CCL.CommonFunctions.formatString(g.personProfileSiteInstance.context.LanguageTerms.UncheckedOneEsafetyRoleText,f,this.rolesUnchecked[0]);break;case 2:e=CCL.CommonFunctions.formatString(g.personProfileSiteInstance.context.LanguageTerms.UncheckedTwoEsafetyRolesText,f,this.rolesUnchecked[0],this.rolesUnchecked[1]);break;case 3:e=CCL.CommonFunctions.formatString(g.personProfileSiteInstance.context.LanguageTerms.UncheckedThreeEsafetyRolesText,
f)}var m="";d===c.Administration.PersonProfile.PrivacyChangedDialogActionType.MakeReadOnly&&(m=a?CCL.CommonFunctions.formatString(g.personProfileSiteInstance.context.LanguageTerms.MarkCurrentConversationsIncludingGroupAsReadOnlyText,f,b.join(", ")):CCL.CommonFunctions.formatString(g.personProfileSiteInstance.context.LanguageTerms.MarkCurrentConversationsAsReadOnlyText,f,b.join(", ")),m=m+"\n"+g.personProfileSiteInstance.context.LanguageTerms.ClosingCouldTakeSomeTime);return confirm(e+" "+m+" "+h)};
e.prototype.onHierarchyRoleChange=function(){this.enableTwoFactorCheckboxOnlyForAdmins()};e.prototype.enableTwoFactorCheckboxOnlyForAdmins=function(){var b=document.getElementById(this.context.Controls.TwoFactorCheckboxClientId),a=document.getElementById(this.context.Controls.HierarchyRoleDropDownClientId);b&&a&&(this.context.Settings.IsProfileOfSystemAdmin||a.value!==this.context.Settings.HierarchyRoleAdministratorValue?(this.context.Settings.IsProfileOfSystemAdmin||(b.checked=!1),b.disabled=!0):
b.disabled=!1)};return e}();g.PersonProfileSite=k})(c.WebComponents||(c.WebComponents={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this.onAssessmentChanged=function(a){var b=d.$assessmentItemDropDown.find("option:selected").val(),f=b===d.settings.Constants.UseScoreItemValue;d.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(d.settings.EventNames.ToggleCriteriaWeightVisibility,{show:b!==d.settings.Constants.DoNotUseAssessmentItemValue});0===d.$assessmentItemDropDown.length&&(f=d.settings.Permissions.IsScoreUsed);d.$maxScoreFloatingSection.toggle(f);
d.onMaxScoreStateChanged();d.settings.Permissions.UseGradeBook&&d.toggleTermAndCategoryPanel();if(void 0!==d.onChangeHandler&&void 0!==a)d.onChangeHandler(a)};window[b]=this;this.settings=a;$(function(){d.$addToGradeBookCheck=$("#"+d.settings.Controls.AddToGradeBookCheckbox);d.$assessmentItemDropDown=$("#"+d.settings.Controls.AssessmentItemDropDown);d.$maxScoreFloatingSection=$("#"+d.settings.Controls.MaxScoreFloatingSection);d.$assessmentSection=$("#"+d.settings.Controls.AssessmentSection);d.$maxScoreTextBox=
$("#"+d.settings.Controls.MaxScoreTextBox);d.$addToGradeBookCheckWithLabel=d.$addToGradeBookCheck.add(d.$addToGradeBookCheck.next());d.$categoryDropDown=$("#"+d.settings.Controls.CategoryDropDown);d.$termDropDown=$("#"+d.settings.Controls.TermDropDown);d.onAssessmentChanged(void 0);d.$assessmentItemDropDown.change(d.onAssessmentChanged);d.$maxScoreTextBox&&(d.$maxScoreTextBox.on("blur input",function(){return d.onMaxScoreStateChanged()}),d.$maxScoreTextBox.keydown(function(a){-1!==$.inArray(a.which,
[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter,CCL.CommonConstants.keyCodes.decimalPoint,CCL.CommonConstants.keyCodes.comma,CCL.CommonConstants.keyCodes.period])||a.which===CCL.CommonConstants.keyCodes.keyA&&(a.ctrlKey||a.metaKey)||a.which>=CCL.CommonConstants.keyCodes.end&&a.which<=CCL.CommonConstants.keyCodes.arrowDown||(a.shiftKey||a.which<CCL.CommonConstants.keyCodes.key0||
a.which>CCL.CommonConstants.keyCodes.key9)&&(a.which<CCL.CommonConstants.keyCodes.numpad0||a.which>CCL.CommonConstants.keyCodes.numpad9)&&a.preventDefault()}));d.settings.Permissions.UseGradeBook&&d.toggleTermAndCategoryPanel()})}c.prototype.canUseAutoMaxScore=function(){return this.settings.Permissions.CanUseAutoMaxScore};c.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue};c.prototype.isValid=
function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};c.prototype.validateScore=function(b){if(""===b)return!1;b=parseFloat(b.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(b)||b<this.settings.MaxScoreMinValue||b>this.settings.MaxScoreMaxValue?!1:!0};c.prototype.onChange=function(b){this.onChangeHandler=b};c.prototype.onMaxScoreStateChanged=
function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&$(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient)};c.prototype.getState=function(){var b={};b.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val());b.IsScore=b.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,10);b.MaxScore=parseInt(this.$maxScoreTextBox.val());b.AddToGradeBook=this.$addToGradeBookCheck.is(":checked");this.$categoryDropDown&&(b.CategoryId=
parseInt(this.$categoryDropDown.val()));this.$termDropDown&&(b.TermId=parseInt(this.$termDropDown.val()));return b};c.prototype.toggleTermAndCategoryPanel=function(){var b=this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue;b&&this.$addToGradeBookCheck.is(":visible")||(this.$addToGradeBookCheckWithLabel.toggle(b),this.$addToGradeBookCheck.prop("checked",b),eval(this.settings.ToggleTermAndCategoryPanelClientFunctionName+"("+b+")"))};return c}();
c.AssessmentScaleControl=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a,d,f){var h=this;this.$elementTitleLabel=b;this.settings=a;this.elementId=d;this.parentFolderId=f;window[c.clientInstanceName]=this;new ClientInlineEditor(this.$elementTitleLabel,void 0,void 0,{clickToEditToolTip:this.settings.Terms.ClickToEditToolTip,clickToSaveToolTip:this.settings.Terms.ClickToSaveToolTip,submitOnEnter:!0,editFieldCssClass:this.settings.CssClasses.EditFieldCssClass,editFieldAutoWidth:!1,editFieldDisplayInline:!0,highlightOnSave:!0,
highlightOnFocus:!0,renderRightLinkWithIcon:!0,maxLength:this.settings.MaxLength,rightLinkViewModeCssClass:this.settings.CssClasses.RightLinkViewModeCssClass,rightLinkEditModeCssClass:this.settings.CssClasses.RightLinkEditModeCssClass},a.UpdateTitleWebMethod?function(a,d){return h.onEditFunction(a,d)}:null,function(a){return h.onChangeModeFunction(a)},void 0)}c.getInstance=function(){return window[c.clientInstanceName]};c.getText=function(){return c.getInstance().$elementTitleLabel.text()};c.prototype.onEditFunction=
function(b,a){var d=this;b.actualText&&$.trim(b.actualText)?CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.UpdateTitleWebMethod.replace("{elementId}",this.elementId.toString()),data:{title:b.actualText}}).done(function(f){b.actualText=f;a(b);$(d).trigger("change",f)}).fail(function(){b.isUpdateSuccess=!1;b.stopOnEdit=!0}):(b.isUpdateSuccess=!1,b.stopOnEdit=!0,a(b),CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.EmptyTitleErrorMessage,this.settings.Terms.ErrorOccured,this.settings.Terms.Ok,
!1))};c.prototype.onChangeModeFunction=function(b){!b.isEditMode&&b.isNewTextSaved&&window!=top&&(b=top,b.reloadFolder&&b.reloadFolder("item"+this.parentFolderId,"item"+this.elementId,!0))};c.clientInstanceName="ElementTitleEditorClientInstance";return c}();c.ElementTitleEditor=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d,b){this.utility=a;this.inputSelector=d;this.errorSelector=b;this.input=this.utility.controls.Dialog.find(d);this.error=this.utility.controls.Dialog.find(b);this.instance=this.utility.getClientInstance(this.input.prop("id"))}Object.defineProperty(b.prototype,"date",{get:function(){return this.instance.getDate()},set:function(a){this.instance.setDate(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateAsQueryStringParameter",
{get:function(){return this.instance.getDateAsQueryStringParameter()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isDateValid",{get:function(){return this.instance.isDateValid()},enumerable:!0,configurable:!0});b.prototype.showError=function(a){void 0===a&&(a=void 0);this.input.addClass(this.utility.settings.CssClasses.DatePickerErrorState);a&&this.error.show().text(a)};b.prototype.hideError=function(){this.input.removeClass(this.utility.settings.CssClasses.DatePickerErrorState);
this.error.hide()};return b}();c.DatePickerWrapper=e})(c.PrintSettingsDialog||(c.PrintSettingsDialog={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d){this.controls=a;this.settings=d;this.dataSelectors={courseTitleContainer:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.CourseTitleContainer),courseDropdown:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.CourseDropdown),dateFrom:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateFrom),dateTo:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateTo),dateFromError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateFromError),
dateToError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateToError),dateRangeError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateRangeError),okButton:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.OkButton)}}Object.defineProperty(b.prototype,"dialog",{get:function(){return this.getClientInstance(this.controls.Dialog.prop("id"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"datePickerFrom",{get:function(){return new c.DatePickerWrapper(this,
this.dataSelectors.dateFrom,this.dataSelectors.dateFromError)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"datePickerTo",{get:function(){return new c.DatePickerWrapper(this,this.dataSelectors.dateTo,this.dataSelectors.dateToError)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateRangeError",{get:function(){return this.controls.Dialog.find(this.dataSelectors.dateRangeError)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"okButton",{get:function(){return this.controls.Dialog.find(this.dataSelectors.okButton)},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"courseTitleContainer",{get:function(){return this.controls.Dialog.find(this.dataSelectors.courseTitleContainer)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"courseDropdown",{get:function(){return this.controls.Dialog.find(this.dataSelectors.courseDropdown)},enumerable:!0,configurable:!0});b.prototype.getClientInstance=function(a){return window[a]};return b}();c.CalendarPrintUtility=e})(c.PrintSettingsDialog||
(c.PrintSettingsDialog={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(g){var e=c.Controls.MultipleCourseSearchSelector.MultipleCourseSearchSelector,b=function(){function a(a,b){var d=this;this.controls=a;this.maxUrlLengthChars=2E3;this.okButtonClickHandler=function(a){if(d.isInputValid())d.updatePrintUrl(),CssModal.closeDialog();else return a.preventDefault(),!1};this.updatePrintUrl=function(){d.utility.settings.IsPossibleToChooseCourse&&(d.currentCourseId=Number(d.utility.courseDropdown.val()));d.utility.settings.EnableMultipleCourseSelection&&
d.multipleCourseSelector.updateSelectedCourses();var a=d.utility.settings.EnableMultipleCourseSelection?d.multipleCourseSelector.selectedCourses.map(function(a){return a.CourseId}):[d.currentCourseId],b=d.makeCalendarPrintUrl({CourseIds:a.join(","),EventId:0,StartDate:d.utility.datePickerFrom.dateAsQueryStringParameter,EndDate:d.utility.datePickerTo.dateAsQueryStringParameter,IsPrintFromAdminPage:!d.utility.settings.IsPossibleToChooseCourse});d.isUrlValid(b,a.length)?d.utility.okButton.prop("href",
b):d.utility.settings.EnableMultipleCourseSelection&&d.multipleCourseSelector.setMaxItems(a.length-1)};this.utility=new g.CalendarPrintUtility(a,b);g.manager=this;b.EnableMultipleCourseSelection?(b.MultipleCourseSelectorSettings.OnItemAddCallback=this.updatePrintUrl,b.MultipleCourseSelectorSettings.OnItemRemoveCallback=this.updatePrintUrl,this.multipleCourseSelector=new e(a.MultipleCourseSelectorControls,b.MultipleCourseSelectorSettings)):this.utility.okButton.click(this.okButtonClickHandler)}a.prototype.openPrintSettingsDialog=
function(a,b,h){this.hideErrors();this.currentCourseId=a;this.utility.datePickerFrom.date=CCL.SerializableDateTimeConverter.toDate(this.utility.settings.DefaultDateFrom);this.utility.datePickerTo.date=CCL.SerializableDateTimeConverter.toDate(this.utility.settings.DefaultDateTo);this.utility.courseTitleContainer.html(b);h&&this.utility.settings.EnableMultipleCourseSelection?(this.multipleCourseSelector.setCoursesToSelectFrom(h),this.multipleCourseSelector.openDialog([h.filter(function(d){return d.CourseId===
a})[0]],this.okButtonClickHandler,!1)):this.utility.dialog.openDialog(!1)};a.prototype.makeCalendarPrintUrl=function(a){return this.utility.settings.Urls.GetCalendarPrintoutMarkup+"?"+$.param(a)};a.prototype.isInputValid=function(){this.hideErrors();var a=!0;this.utility.datePickerFrom.isDateValid||(this.utility.datePickerFrom.showError(this.utility.settings.Terms.InvalidDateFrom),a=!1);this.utility.datePickerTo.isDateValid||(this.utility.datePickerTo.showError(this.utility.settings.Terms.InvalidDateTo),
a=!1);a&&this.utility.datePickerFrom.date>this.utility.datePickerTo.date&&(this.utility.datePickerFrom.showError(),this.utility.datePickerTo.showError(),this.utility.dateRangeError.show().text(this.utility.settings.Terms.InvalidDateRange),a=!1);this.utility.settings.EnableMultipleCourseSelection&&!this.multipleCourseSelector.selectedCourses.length&&(this.multipleCourseSelector.toggleError(!0),this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display="",this.controls.MultipleCourseSelectorControls.ErrorLabel.textContent=
this.utility.settings.Terms.SelectAtLeastOneCourse,a=!1);return a};a.prototype.isUrlValid=function(a,b){if(!this.utility.settings.EnableMultipleCourseSelection)return!0;if(a.length>this.maxUrlLengthChars)return this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display="",this.controls.MultipleCourseSelectorControls.ErrorLabel.textContent=CCL.CommonFunctions.formatString(this.utility.settings.Terms.YouCanSelectOnlyXCourses,b-1),!1;this.multipleCourseSelector.toggleError(!1);this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display=
"none";return!0};a.prototype.hideErrors=function(){this.utility.datePickerFrom.hideError();this.utility.datePickerTo.hideError();this.utility.dateRangeError.hide();this.utility.settings.EnableMultipleCourseSelection&&(this.multipleCourseSelector.toggleError(!1),this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display="none")};return a}();g.DialogManager=b})(g.PrintSettingsDialog||(g.PrintSettingsDialog={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(c){function b(a,d){c.call(this,d);this.urls=a}__extends(b,c);b.prototype.getElementListMarkupByIds=function(a){return $.ajax({type:"POST",url:this.urls.GetElementListByIds,data:JSON.stringify(a),dataType:"html",contentType:"application/json; charset=utf-8"})};return b}(c.CommonAjaxClient);g.ElementPickerAjaxClient=k})(c.CustomActivityElementPicker||(c.CustomActivityElementPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(c){var b=this;this.cssClasses=c;$("."+this.cssClasses.SelectedElementList).on("mouseenter","li",function(a){a=$(a.currentTarget).find("."+b.cssClasses.ElementTitle).get(0);var d=$(a).closest("a"),f=a.offsetWidth;CCL.CommonFunctions.isChrome()&&!CCL.CommonFunctions.isEdge()||f++;d.prop("title",f<a.scrollWidth?a.textContent.trim():"")})}}();c.CustomActivityOverview=g})(c.CustomActivityOverview||(c.CustomActivityOverview={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(c){var b=function(){function a(a,b){this.webMethods=a;this.widgetSettings=b}a.prototype.createGetAgendaDayListContainerAjaxRequest=function(a,b,h){var d=this;return function(){return CCL.CommonFunctions.safeAjaxPost({url:d.webMethods.GetAgendaDayListContainer,data:{fromDateTime:a,toDateTime:b,datePeriod:h,widgetSettings:d.widgetSettings}})}};a.prototype.createHideTaskAjaxRequest=function(a,b,h,c){var d=this;return function(){return CCL.CommonFunctions.safeAjax({type:"DELETE",url:d.webMethods.HideTask.replace("{taskId}",
a),data:{fromDateTime:b,toDateTime:h,datePeriod:c,widgetSettings:d.widgetSettings}})}};return a}();c.AgendaAjaxClient=b})(c.Agenda||(c.Agenda={}))})(c.Widgets||(c.Widgets={}))})(c.Dashboard||(c.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(g){(function(e){var b=function(){function a(a,b){this.attributesModel=a;this.controls=b}a.prototype.getEventDescription=function(a){return a.data(this.attributesModel.EventDescription)};a.prototype.getEventColorSchema=function(a){return a.data(this.attributesModel.EventColorSchema)};a.prototype.getEventUrl=function(a){return a.data(this.attributesModel.EventUrl)};a.prototype.getEditEventUrl=function(a){return a.data(this.attributesModel.EditEventUrl)};a.prototype.getEditRecurringEventUrl=
function(a){return a.data(this.attributesModel.EditRecurringEventUrl)};a.prototype.getEventUrlTarget=function(a){return a.data(this.attributesModel.EventUrlTarget)};a.prototype.getEventId=function(a){return a.data(this.attributesModel.EventId)};a.prototype.getEventTitle=function(a){return a.data(this.attributesModel.EventTitle)};a.prototype.getEventCategory=function(a){return a.data(this.attributesModel.EventCategory)};a.prototype.getTaskHideId=function(a){return a.data(this.attributesModel.TaskHideId)};
a.prototype.getExpectedDatePeriod=function(a){if(a===this.controls.WeekViewLink.get(0))return c.Controls.DatePeriod.Week;if(a===this.controls.DayViewLink.get(0))return c.Controls.DatePeriod.Day;throw Error("Unexpected control: "+a);};return a}();e.AgendaUtility=b})(g.Agenda||(g.Agenda={}))})(g.Widgets||(g.Widgets={}))})(c.Dashboard||(c.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,d){this.settings=d;window[a]=this;this.$allowEveryoneCheckbox=$("."+d.AllowEveryoneCheckboxCss).find("input:checkbox");this.$disableCommentsCheckbox=$("."+d.DisableCommentsCheckboxCss).find("input:checkbox");this.editBulletinSettingsDialog=window[this.settings.EditBulletinsSettingsDialogClientId]}b.prototype.showEditBulletinSettings=function(){var a=this;this.editBulletinSettingsDialog.show().then(function(d){d===CCL.ConfirmDialogResult.Confirm?
(d={AllowEveryoneSetting:a.$allowEveryoneCheckbox.is(":checked")},a.$disableCommentsCheckbox&&a.$disableCommentsCheckbox.length&&(d.DisableCommentsSetting=a.$disableCommentsCheckbox.is(":checked")),$.ajax({type:"POST",url:a.settings.UpdateCourseBulletinSettingsUrl,contentType:"application/json; charset=utf-8",data:JSON.stringify({courseId:a.settings.CourseId,settings:d})}).fail(function(){jAlert(a.settings.ErrorMessage)}).done(function(){window.location.reload()})):(a.$allowEveryoneCheckbox.prop("checked",
a.settings.AllowAllUsersPostBulletinsCourseSetting),a.$disableCommentsCheckbox&&a.$disableCommentsCheckbox.length&&a.$disableCommentsCheckbox.prop("checked",a.settings.DisableLightBulletinCommentsCourseSetting))});$("#"+this.settings.EditBulletinsSettingsDialogClientId).find(":focusable").first().focus()};return b}();c.Bulletins=e})(c.Widgets||(c.Widgets={}))})(c.Dashboard||(c.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function b(a,d,b,h,c,e){var f=this;this.$itemSelector=a;this.$filterMenu=d;this.idDataAttribute=b;this.selectAllItemId=h;this.optionCheckboxPrefix=c;this.languageTerms=e;this.handleItemSelection=function(a){var d=a.closest("[data-"+f.idDataAttribute+"]").data(f.idDataAttribute),b=a.is(":checked");a=d===f.selectAllItemId;var h=f.$filterMenu.find("[data-"+f.idDataAttribute+"]");if(a)h.each(function(a,d){a=$(d).data(f.idDataAttribute);f.getOptionCheckBox(a).prop("checked",
b)});else{f.getOptionCheckBox(d).prop("checked",b);var c=null,e=!0;h.each(function(a,d){a=$(d).data(f.idDataAttribute);return a!==f.selectAllItemId&&(a=f.getOptionCheckBox(a).is(":checked"),null==c&&(c=a),a!==c)?e=!1:!0});f.toggleAllOptionCheckBox(e,!1,c)}f.setDefaultItemText()};this.hasItems=function(){return 0<f.$filterMenu.find("[data-"+f.idDataAttribute+"]").length};this.getSelectedItems=function(){var a=[];f.$filterMenu.find("[data-"+f.idDataAttribute+"]").each(function(d,b){d=$(b).data(f.idDataAttribute);
f.getOptionCheckBox(d).is(":checked")&&d!==f.selectAllItemId&&a.push(d)});return a};this.areAllItemsSelected=function(){return null!=f.allOptionCheckBox?f.allOptionCheckBox.is(":checked"):!1};this.areNoneItemsSelected=function(){return 0===f.getSelectedItems().length};this.setDefaultItemText=function(){if(f.areAllItemsSelected())var a=f.languageTerms.All+" "+f.languageTerms.Items.toLowerCase();else f.areNoneItemsSelected()?a=f.languageTerms.SelectItem:(a=f.getSelectedItems(),a=1<a.length?f.getSelectedItems().length+
" "+f.languageTerms.Items.toLowerCase():f.$filterMenu.find("[data-"+f.idDataAttribute+'="'+a[0]+'"]').find("label").text());f.$itemSelector.text(CCL.CommonFunctions.htmlEncode(a))};this.getOptionCheckBox=function(a){return $("#"+f.optionCheckboxPrefix+a)};this.toggleAllOptionCheckBox=function(a,d,b){a?d||f.allOptionCheckBox.prop("checked",b):f.allOptionCheckBox.prop("checked",!1)};this.setDefaultItemText()}Object.defineProperty(b.prototype,"allOptionCheckBox",{get:function(){return this.getOptionCheckBox(this.selectAllItemId)},
enumerable:!0,configurable:!0});return b}(),e=function(){function b(a,d,f){var h=this;this.settings=d;this.controls=f;this.selectedItemIds=[];this.onItemClickHandler=function(a){h.itemMultiSelectorManager.handleItemSelection($(a.target));h.selectedItemIds=h.itemMultiSelectorManager.areAllItemsSelected()||h.itemMultiSelectorManager.areNoneItemsSelected()?[]:h.itemMultiSelectorManager.getSelectedItems();h.controls.ItemMultiSelector.trigger(b.itemMultiSelectorOnChangeEventName,h)};this.initPerfectScrollbar=
function(){h.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});var a=new CCL.CallbackDebouncer(function(){h.controls.MenuContainer.perfectScrollbar("update")});$(window).on("resize",function(){a.invokeCallback(null,100)})};window[a]=this;this.itemMultiSelectorManager=new g(this.controls.ItemMultiSelector,this.controls.MenuContainer,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.OptionCheckboxPrefix,this.settings.LanguageTerms);this.initPerfectScrollbar();
this.controls.ItemMultiSelector.parent().on("focusin",function(){h.controls.ItemMultiSelector.addClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.parent().on("focusout",function(){h.controls.ItemMultiSelector.removeClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&h.controls.ItemMultiSelector.trigger("click")});this.controls.MenuContainer.on("change",this.onItemClickHandler)}Object.defineProperty(b.prototype,
"hasItems",{get:function(){return this.itemMultiSelectorManager.hasItems()},enumerable:!0,configurable:!0});b.itemMultiSelectorOnChangeEventName="itemMultiSelector:onchange";return b}();c.ItemMultiSelector=e})(c.ItemMultiSelector||(c.ItemMultiSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(c){var b=this;this.settings=c;this.onItemClickHandler=function(a){b.$checkbox.prop("checked",!b.$checkbox.is(":checked")).change();a.stopPropagation()};this.$checkbox=$("#"+this.settings.OptionCheckboxClientId);c=$("#"+c.ClientId);c.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);c.on("keyup",function(a){if(a.which===CCL.CommonConstants.keyCodes.enter)b.onItemClickHandler(a)})}}();c.Item=g})(c.ItemMultiSelector||
(c.ItemMultiSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){var g=function(){return function(){this.registerSafeImgBinding=function(){ko.bindingHandlers.safeImg={init:function(c,e){var b=ko.utils.unwrapObservable(e());e=ko.utils.unwrapObservable(b.src);b=ko.utils.unwrapObservable(b.fallback);$(c).prop("src",e||b)},update:function(c,e){var b=ko.utils.unwrapObservable(e());e=ko.utils.unwrapObservable(b.src);b=ko.utils.unwrapObservable(b.fallback);$(c).prop("src",e||b)}}};this.registerPerfectScrollBarBinding=function(){ko.bindingHandlers.perfectlyScrollable=
{init:function(c,e,b,a,d){e=ko.unwrap(e())||{minScrollbarLength:10};var f=$(c);f.perfectScrollbar(e);var h=new CCL.CallbackDebouncer(function(){f.perfectScrollbar("update")}),l=function(){h.invokeCallback(null,100)};$(window).on("resize",l);ko.utils.domNodeDisposal.addDisposeCallback(c,function(){f.perfectScrollbar("destroy");$(window).off("resize",l)})}}}}}();c.KnockoutCustomBindingsManager=g})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){this.clientFunctions={};window[b]=this;this.settings=a;this.terms=a.Terms;this.cssClasses=a.CssClasses;this.clientFunctions.DeleteCurrentPostback=new Function(a.ClientFunctions.DeleteCurrentPostback);this.clientFunctions.DeleteSelectedPostback=new Function(a.ClientFunctions.DeleteSelectedPostback);this.clientFunctions.PublishAllPostback=new Function(a.ClientFunctions.PublishAllPostback);this.clientFunctions.UnpublishAllPostback=new Function(a.ClientFunctions.UnpublishAllPostback);
this.clientFunctions.UnpublishCurrentPostback=new Function(a.ClientFunctions.UnpublishCurrentPostback);this.clientFunctions.UnpublishSelectedPostback=new Function(a.ClientFunctions.UnpublishSelectedPostback);this.grid=window[a.Controls.GridClientInstanceName]}c.prototype.publishAll=function(){var b=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.PublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(a){a&&b.clientFunctions.PublishAllPostback()})};c.prototype.unpublishAll=
function(){var b=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.UnpublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(a){a&&b.clientFunctions.UnpublishAllPostback()})};c.prototype.deleteCurrentLearningObjective=function(){this.deleteConfirmation(this.settings.IsCurrentSubjectPublished,this.clientFunctions.DeleteCurrentPostback,this.clientFunctions.UnpublishCurrentPostback)};c.prototype.deleteSelectedLearningObjectives=function(){var b=this.grid.getSelectedValues();
if(0===b.length)CCL.CommonFunctions.jAlertAjaxError(this.terms.PleaseMakeSelection,this.terms.Alert,this.terms.Ok,!1);else{for(var a=!1,d=0;d<b.length;d++)if(0<this.grid.getRow(b[d]).find("."+this.cssClasses.Published).length){a=!0;break}this.deleteConfirmation(a,this.clientFunctions.DeleteSelectedPostback,this.clientFunctions.UnpublishSelectedPostback)}};c.prototype.deleteConfirmation=function(b,a,d){var f=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.FirstDeleteConfirmation,this.terms.PleaseConfirm,
this.terms.Ok,this.terms.Cancel,function(h){h&&(b?f.deleteConfirmationFromPublishedSubject(a,d):a())})};c.prototype.deleteConfirmationFromPublishedSubject=function(b,a){var d=[];d.push(new CCL.ConfirmButtonMetaData(this.terms.Unpublish,"","confirm_unpublish"));d.push(new CCL.ConfirmButtonMetaData(this.terms.Delete,this.cssClasses.DeleteButton,"confirm_delete"));d.push(new CCL.ConfirmButtonMetaData(this.terms.Cancel,"","confirm_cancel"));CCL.CommonFunctions.jAjaxMultiButtonConfirm("<p>"+this.terms.DeleteConfirmationFromPublishedSubjectBody+
"</p><p>"+this.terms.DeleteConfirmationFromPublishedSubjectFooter+"</p>",this.terms.AreYouSure,d,function(d){d&&d.customId&&"confirm_cancel"!==d.customId&&("confirm_delete"===d.customId?b():"confirm_unpublish"===d.customId&&a())})};return c}();c.LearningObjectiveOverview=g})(c.LearningObjectiveRepository||(c.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(){}c.convertElementIdsToElementStateMapping=function(b,a){var d=new Map;b.forEach(function(b){d.set(b,a)});return d};return c}();c.LearningObjectiveRepositoryHelper=g})(c.LearningObjectiveRepository||(c.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){return function(e){var b=this;this.settings=e;this.openDialog=function(){var a=[];JSON.parse(b.$subjectHiddenField.val()).forEach(function(d){a.push(d.Id)});var d={elementStates:g.LearningObjectiveRepositoryHelper.convertElementIdsToElementStateMapping(a,c.CheckboxStateMachine.State.AttachedByUser),disabledElementIds:[],showAll:!0,header:b.settings.HeaderText,elementType:c.ElementLinkDialog.ContentElementType.LearningObjectives,allowFolderSelection:!0,openerPage:c.ElementLinkDialog.ElementsPopupOpener.None,
allowEmptySubmit:!0,afterOkClickCallback:function(a){var d=[];a.forEach(function(a,b){a!==c.CheckboxStateMachine.State.Empty&&d.push(b)});b.updateUiWithNewElements(d)}};b.elementLinkDialogManagerInstance.openDialog(d,{countryCode:b.settings.CountryCode})};this.createTagItInput=function(){CCL.TagItInput.createTagItInput(b.$aliasesContainer,{isReadonly:!1,placeholderText:b.settings.AliasesPlaceholderText,tagitLimit:255})};this.updateSubjectsInUi=function(){var a=JSON.parse(b.$subjectHiddenField.val());
b.$subjectContainer.html("");a.forEach(function(a){var d=$("<div/>").addClass(b.settings.CssClasses.LearningObjectiveContainerCssClass),h=$("<img/>").addClass(b.settings.CssClasses.LearningObjectiveIconCssClass),c=$("<span/>").addClass(b.settings.CssClasses.LearningObjectiveTitleCssClass).text(a.Title),e=$("<span> &times; </span>").addClass(b.settings.CssClasses.LearningObjectiveDeleteCssClass).on("click",function(){b.removeSubject(a.Id)});d.append(h).append(" ").append(c).append(" ").append(e);b.$subjectContainer.append(d).append($("<br/>"))})};
this.removeSubject=function(a){var d=-1,f=JSON.parse(b.$subjectHiddenField.val());f.forEach(function(b,f){b.Id===a&&(d=f)});-1!==d&&(f.splice(d,1),b.$subjectHiddenField.val(JSON.stringify(f)),b.updateSubjectsInUi())};this.updateUiWithNewElements=function(a){$.ajax({type:"GET",url:b.settings.GetLearningObjectiveNamesUrl,data:{learningObjectiveIds:a.join(",")},dataType:"json",xhrFields:{withCredentials:!0}}).done(function(a){b.$subjectHiddenField.val(JSON.stringify(a));b.updateSubjectsInUi()}).fail(function(a,
b,h){CCL.CommonFunctions.alertAjaxError(a,b,h)})};this.elementLinkDialogManagerInstance=c.ElementLinkDialog.elementLinkDialogManagerInstance;this.$subjectContainer=$("#"+e.ClientIds.SubjectLabelContainerClientId);this.$subjectHiddenField=$("#"+e.ClientIds.SubjectLabelHiddenFieldClientId);this.$aliasesContainer=$("#"+e.ClientIds.AliasesContainerClientId);this.createTagItInput();CCL.CommonFunctions.preventSubmitOnEnter($("#"+e.ClientIds.LabelTextboxClientId));$("#"+e.ClientIds.AddSubjectsButtonClientId).on("click",
function(){b.openDialog();return!1})}}();g.LearningObjectiveSubjectLabelsManager=k})(c.LearningObjectiveRepository||(c.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function a(d){var b=this;this.settings=d;this.signalRRetryConnection=0;window[a.clientInstanceName]=this;$(function(){b.jQueryAny=jQuery;b.jQueryAny.connection.hub.url=b.settings.Endpoint;var a=b.jQueryAny.connection.learningPathHub;"undefined"!==typeof a&&null!==a&&void 0!==a&&(a.client.activityCompleted=function(a,d){b.triggerStudentProgressEvent(e.ActivityCompleted,a,d)},a.client.resourceViewed=function(a,d){b.triggerStudentProgressEvent(e.ResourceViewed,
a,d)},a.client.teachersActionNeeded=function(a){b.triggerStudentProgressEvent(e.TeachersActionNeeded,a,0)},a.client.finishIsReached=function(a){b.triggerStudentProgressEvent(e.FinishIsReached,a,0)},a.client.anotherTryNeeded=function(a){b.triggerStudentProgressEvent(e.AnotherTryNeeded,a,0)});b.startSignalRHub();b.jQueryAny.connection.hub.connectionSlow(function(){return console.log("We are currently experiencing difficulties with the connection.")});b.jQueryAny.connection.hub.reconnecting(function(){b.setSignalROnlineStatus(!1);
console.log("SignalR reconnecting.")});b.jQueryAny.connection.hub.disconnected(function(){b.setSignalROnlineStatus(!1);console.log("SignalR disconnected.");b.reconnectToSignalRHub(!0)});b.jQueryAny.connection.hub.reconnected(function(){b.setSignalROnlineStatus(!0);console.log("SignalR reconnected.");b.reconnectToSignalRHub(!1)})})}a.prototype.triggerStudentProgressEvent=function(d,f,c){$(window).trigger(a.studentProgressChangedEvent,new b(d,f,c))};a.prototype.setSignalROnlineStatus=function(a){$(window).trigger("SignalRConnectionStatus",
a)};a.prototype.startSignalRHub=function(){var a=this;this.jQueryAny.connection.hub.start().done(function(){var d="";localStorage.getItem("learningpath-channelid")&&(d=localStorage.getItem("learningpath-channelid"));5>=d.length&&(d="");$.ajax({url:a.settings.CommunicationChannelEndPoint,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({channelId:a.jQueryAny.connection.hub.id,unregister:d})}).done(function(){a.setSignalROnlineStatus(!0);a.reconnectToSignalRHub(!1);console.log("SignalR connection registered. ChannelId: "+
a.jQueryAny.connection.hub.id)});localStorage.setItem("learningpath-channelid",a.jQueryAny.connection.hub.id)}).fail(function(d){a.setSignalROnlineStatus(!1);a.reconnectToSignalRHub(!0);console.log("Error starting SignalR connection: "+d)})};a.prototype.reconnectToSignalRHub=function(a){var d=this;a?this.signalRRetryConnection<=this.settings.RetryConnectionMax&&(this.signalRRetryConnection+=1,window.clearInterval(this.signalRRetryInterval),this.signalRRetryInterval=window.setInterval(function(){return d.startSignalRHub()},
3E3)):(window.clearInterval(this.signalRRetryInterval),this.signalRRetryConnection=0)};a.clientInstanceName="LearningPathSignalRListenerClientInstanceName";a.studentProgressChangedEvent="LearningPathSignalRListener:studentProgressChanged";return a}();c.LearningPathSignalRListener=g;(function(a){a[a.NoProgress=0]="NoProgress";a[a.ResourceViewed=1]="ResourceViewed";a[a.ActivityCompleted=2]="ActivityCompleted";a[a.TeachersActionNeeded=3]="TeachersActionNeeded";a[a.FinishIsReached=4]="FinishIsReached";
a[a.AnotherTryNeeded=5]="AnotherTryNeeded"})(c.StudentProgressType||(c.StudentProgressType={}));var e=c.StudentProgressType,b=function(){return function(a,d,b){this.studentProgressType=a;this.learningPathId=d;this.unlockedElementId=b}}();c.StudentProgressEventData=b})(c.LearningPath||(c.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){var a=this;this.settings=b;window[e.clientInstanceName]=this;$(function(){a.$elementListContainer=$("#"+a.settings.Controls.ElementListContainerId);a.$frame=$("#"+a.settings.Controls.Frame);a.$loadingIndicator=$("#"+a.settings.Controls.LoadingIndicator);a.$feedback=$("#"+a.settings.Controls.Feedback);a.$elementListContainer.on("click","."+a.settings.Css.ElementTitle,function(d){d=$(d.currentTarget).closest("."+a.settings.Css.ElementContainer);
d=parseInt(d.data(a.settings.DataAttributes.ElementId),10);a.setCurrentElement(d);return!1});a.setCurrentElement(a.settings.ElementIdToSelect);IframeResizer.reportSetIframeDefaultHeight()})}e.getInstance=function(){return window[e.clientInstanceName]};e.reloadElementList=function(b){e.getInstance().reloadElementList(b)};e.prototype.setCurrentElement=function(b){if(!b||b!==this.currentElementId){var a=!1;if(0<b){var d=this.$elementListContainer.find("."+this.settings.Css.ElementContainer+"[data-element-id="+
b+"]");0===d.length&&(d=this.$elementListContainer.find("."+this.settings.Css.ElementContainer).first(),a=!0)}else d=this.$elementListContainer.find("."+this.settings.Css.ElementContainer).first(),a=!0;var f=d.find("."+this.settings.Css.ElementTitle).prop("href");$("."+this.settings.Css.ElementContainer).removeClass(this.settings.Css.SelectedElement);d.addClass(this.settings.Css.SelectedElement);this.$elementListContainer.scrollTop(d.offset().top-this.$elementListContainer.offset().top+this.$elementListContainer.scrollTop());
this.setFrameUrl(f);this.currentElementId=a?0:b}};e.prototype.setFrameUrl=function(b){b?(this.$frame.prop("src",b),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};e.prototype.getElementLinkTitle=function(b){return this.$elementListContainer.find(""+CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementId,b)).find("."+this.settings.Css.ElementTitle)};e.prototype.reloadElementList=function(b){var a=this;$.get(this.settings.Urls.StudentViewElementList+
"&selectedElementId="+this.currentElementId).done(function(d){a.$elementListContainer.html(d);CCL.InformationFeedback.showFeedbackWithextraButton(a.$feedback,a.getFeedbackMessage(b.studentProgressType),0<b.unlockedElementId?a.settings.Terms.Continue:a.settings.Terms.Ok,function(){0<b.unlockedElementId&&a.setCurrentElement(b.unlockedElementId);CCL.InformationFeedback.hideFeedback(a.$feedback)})})};e.prototype.getFeedbackMessage=function(b){switch(b){case c.StudentProgressType.ActivityCompleted:return this.settings.Terms.NewStepAvailable;
case c.StudentProgressType.ResourceViewed:return this.settings.Terms.TakeGoodLookAtThisResource;case c.StudentProgressType.FinishIsReached:return this.settings.Terms.ThatWasIt;case c.StudentProgressType.TeachersActionNeeded:return this.settings.Terms.YouCanContinueAfterTeacherReviewed;case c.StudentProgressType.AnotherTryNeeded:return this.settings.Terms.PleaseGiveItAnotherTry;default:return""}};e.clientInstanceName="StudentViewLearningPathInstance";return e}();c.TakeLearningPathDialogContent=g})(c.LearningPath||
(c.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b){var a=this;this.convertId="confirm_convert_to_folder";this.deleteId="confirm_delete";this.cancelId="confirm_cancel";window[e.clientInstanceName]=this;this.settings=b;$(function(){$("."+a.settings.Css.DeleteLink).click(function(){$.ajax({url:a.settings.Urls.GetConfirmationModelForElementsDeleting,data:{elementIds:a.settings.LearningPathId},dataType:"json"}).done(function(d){var b=[],f=0===$("."+a.settings.Css.StepElementTitle).length,c=f?a.settings.Terms.EmptyLearningPathDeleteConfirmation:
a.settings.Terms.LearningPathDeleteConfirmation;b.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Delete,a.settings.Css.RedButton,a.deleteId));f||b.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.MakeNormalFolder,a.settings.Css.ConfirmConvertButton,a.convertId));b.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Cancel,"",a.cancelId));d&&d.HasTreeLinks&&(c=d.TreeLinksDeleteConfirmationMessage+" "+c);a.showDeleteConvertConfirmDialog(c,b)})});$("."+a.settings.Css.ConvertToFolderLink).click(function(){var d=
[];d.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Ok,a.settings.Css.BlueButton,a.convertId));d.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Cancel,"",a.cancelId));a.showDeleteConvertConfirmDialog(a.settings.Terms.AreYouSure,d)});var d=new c.Controls.ElementTitleEditor($("."+a.settings.Css.TitleLabel),a.settings.TitleEditorSettings,a.settings.LearningPathId,a.settings.ParentFolderId);if(a.settings.PopupScripts&&(a.settings.PopupScripts.AddElement&&a.executeScript(a.settings.PopupScripts.AddElement),
a.settings.PopupScripts.UpdateElement))$(d).on("change",function(){return a.executeScript(a.settings.PopupScripts.UpdateElement)})})}e.prototype.showDeleteConvertConfirmDialog=function(b,a){var d=this;CCL.CommonFunctions.jAjaxMultiButtonConfirm("",b,a,function(a){if(a&&a.customId)switch(a.customId){case d.deleteId:d.deleteLearningPath();break;case d.convertId:d.convertLearningPathToFolder()}})};e.prototype.showError=function(b,a){void 0===a&&(a=!1);CCL.CommonFunctions.jAlertAjaxError(b,this.settings.Terms.ErrorOccured,
this.settings.Terms.Ok,a)};e.prototype.convertLearningPathToFolder=function(){var b=this;$.ajax({url:this.settings.Urls.ConvertToFolder.Action,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({LearningPathId:this.settings.LearningPathId})}).done(function(a){a.Success?b.settings.UseSimpleMenu?itslTop.location.href=b.settings.Urls.ConvertToFolder.RedirectAfterSucceed:window.location.href=b.settings.Urls.ConvertToFolder.RedirectAfterSucceed:b.showError(a.ErrorMessage)}).fail(function(){return b.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};
e.prototype.deleteLearningPath=function(){var b=this;$.ajax({url:this.settings.Urls.Delete.Action,type:"DELETE",dataType:"json",contentType:"application/json",data:JSON.stringify({LearningPathId:this.settings.LearningPathId})}).done(function(a){a.Success?window.location.href=b.settings.Urls.Delete.RedirectAfterSucceed:b.showError(a.ErrorMessage)}).fail(function(){return b.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};e.prototype.executeScript=function(b){(new Function(b))()};e.clientInstanceName=
"LearningPathCommonEditActionsInstance";return e}();g.LearningPathCommonEditActions=k})(c.LearningPath||(c.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));var Helpers;
(function(c){var g=function(){function c(){}c.prototype.parseParams=function(c){var b={},a=/([^&=]+)=([^&]*)/g,d;for(c=c.replace(/\+/g,"%20");d=a.exec(c);)b[decodeURIComponent(d[1]).toLowerCase()]=decodeURIComponent(d[2]);return b};c.prototype.parseUrlQueryString=function(){return this.parseParams(window.location.search.substring(1))};c.prototype.parseUrlFragmentString=function(){return this.parseParams(window.location.hash.substring(1))};return c}();c.UrlParamParser=g})(Helpers||(Helpers={}));
(function(c){(function(c){var g=function(){function e(b){var a=this;window[e.clientInstanceName]=this;this.settings=b;$(function(){if(a.settings.IsPlanner2||CCL.CommonFunctions.isSafari()){var d=(new Helpers.UrlParamParser).parseUrlQueryString();if(d.launch_url){a.dialog=CCL.FullScreenDialog.getInstance();var b=decodeURIComponent(d.launch_url);a.dialog.openDialog(b)}$("#"+a.settings.Controls.OpenDialogLink).click(function(b){b=$(b.currentTarget).prop("href");d.launch_url||"None"===d.openerpage?a.dialog.openDialog(b):
(b=encodeURIComponent(b),window.open(window.location.href+"&launch_url="+b+(a.settings.IsPlanner2?"&isPlanner2=true":""),"_blank"));return!1})}else $("#"+a.settings.Controls.OpenDialogLink).click(function(d){d=$(d.currentTarget).prop("href");a.dialog.openDialog(d);return!1});a.dialog=CCL.FullScreenDialog.getInstance();$(a.dialog).on(CCL.FullScreenDialog.onCloseEvent,function(){clearTimeout(a.timer);window.location.href=a.settings.Urls.ViewLearningPath});$(window).on(c.LearningPathSignalRListener.studentProgressChangedEvent,
function(d,b){a.settings.LearningPathId===b.learningPathId&&(a.timer=setTimeout(function(){return a.reloadElementList(b)},a.getTimeout(b)))})})}e.prototype.reloadElementList=function(b){this.dialog.isOpened()?c.TakeLearningPathDialogContent.reloadElementList(b):window.location.href=this.settings.Urls.ViewLearningPath};e.prototype.getTimeout=function(b){return b.studentProgressType===c.StudentProgressType.ResourceViewed?this.settings.Timeouts.ResourceCompletedInMs:b.studentProgressType===c.StudentProgressType.FinishIsReached?
this.settings.Timeouts.FinishIsReachedInMs:this.settings.Timeouts.ActivityCompletedInMs};e.clientInstanceName="TakeLearningPathDialogLauncherInstance";return e}();c.TakeLearningPathDialogLauncher=g})(c.LearningPath||(c.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function a(d,b){var f=this;this.dataUrl=d;this.model=b;this.page=0;this.run=function(d){d&&(f.page=d);f.model.lettersLoading(!0);d={supervisorType:f.model.settings.SupervisorType,termId:f.model.termId(),hierarchyIds:f.model.hierarchyIds(),paging:{pageIndex:f.page,pageSize:a.pageSize},sorting:{sort:f.model.sorting.term,sortDescending:f.model.sorting.descending},search:f.model.lettersSearch()};d=CCL.CommonFunctions.safeAjaxPost({url:f.dataUrl,data:d,dataType:"json"});
d.done(function(a){f.model.addLetters(a);f.page++;f.model.lettersLoading(!1)});return d}}a.pageSize=50;return a}(),e=function(){return function(){this.term="FullName";this.descending=!1}}(),b=function(){function a(a,d){var b=this;this.settings=a;this.controls=d;this.addLetters=function(a){[].push.apply(b.allLetters(),a);b.allLetters.valueHasMutated();b.lettersLoading(!1);b.lettersCount(b.allLetters().length);b.areAllLettersRetreived(!a||0===a.length||a.length<k.pageSize)};this.showCard=function(a){return b.showStudentProfile(a)};
this.showLetters=function(a){return b.showStudentProfile(a,"letters")};this.setSorting=function(a,d){a=$(d.currentTarget).data(b.settings.DataAttributes.SortValue);b.allLetters([]);b.lettersLoading(!0);b.lettersCount(0);a===b.sorting.term?b.sorting.descending=!b.sorting.descending:(b.sorting.term=a,b.sorting.descending=!0);b.fetcher.page=0;b.fetcher.run()};this.showMoreLetters=function(a){$(a.currentTarget).blur();b.fetchNextLettersPage()};this.getParentLettersOverview=function(a){return 0<a.parentLettersTotalNumber?
a.lettersOpenedByParentsTotalNumber+"/"+a.parentLettersTotalNumber:"-"};this.getStudentLettersOverview=function(a){return 0<a.studentLettersTotalNumber?a.lettersOpenedByStudentTotalNumber+"/"+a.studentLettersTotalNumber:"-"};this.fetchData=function(){b.allLetters([]);b.lettersCount(b.allLetters().length);b.lettersLoading(!0);b.fetcher.page=0;null!=b.fetchDataPromise&&b.fetchDataPromise.readyState!==b.fetchDataPromise.DONE&&b.fetchDataPromise.abort();b.fetchDataCallbackDebouncer.invokeCallback({},
200)};this.onSearchChangeHandler=function(a){var d=$(a.currentTarget).val();d=(a.which===CCL.CommonConstants.keyCodes.del||a.which===CCL.CommonConstants.keyCodes.backspace)&&d&&""===$.trim(d);if(a.which===CCL.CommonConstants.keyCodes.enter||d)b.lettersSearch($(a.currentTarget).val()),b.fetchData(),b.$searchFilter.val(b.lettersSearch()),a.stopPropagation();CCL.CommonFunctions.isMobileDevice()&&a.which===CCL.CommonConstants.keyCodes.enter&&$(a.currentTarget).blur();0===$(a.currentTarget).val().length?
b.$searchFilterClear.hide():b.$searchFilterClear.show()};this.onSearchClearHandler=function(){b.lettersSearch("");b.$searchFilter.val(b.lettersSearch());b.$searchFilterClear.hide();b.fetchData()};this.fetchNextLettersPage=function(){b.areAllLettersRetreived()||(null!=b.lettersScrollingPromise&&b.lettersScrollingPromise.readyState!==b.lettersScrollingPromise.DONE&&b.lettersScrollingPromise.abort(),b.lettersScrollingTimeout&&clearTimeout(b.lettersScrollingTimeout),b.lettersScrollingTimeout=setTimeout(function(){b.allLetters.valueHasMutated();
b.lettersScrollingPromise=b.fetcher.run()},50))};this.onFetchLettersHandler=function(a){a=$(a.target).scrollTop();if(a>b.lettersLastScrollTop){var d=$("."+b.settings.CssClasses.StudentsList).children("li");d=d.eq(d.length-k.pageSize/2);CCL.CommonFunctions.isOnScreen(d,.5,.5)&&b.fetchNextLettersPage()}b.lettersLastScrollTop=a};this.showStudentProfile=function(a,d){document.showProfileCard?d?document.showProfileCard(a.personId,d):document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,
"","resizable,scrollbars,height=500,width=750")};this.configTermFilter=function(){b.controls.TermFilter.on(c.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,d){b.measureLettersOverviewPageFilterUsageKpi();b.termId(d.selectedItemId);b.fetchData()};this.configHierarchyFilter=function(){b.controls.HierarchyFilter.on(c.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onHierarchyFilterItemClickHandler)};
this.onHierarchyFilterItemClickHandler=function(a,d){b.measureLettersOverviewPageFilterUsageKpi();b.hierarchyIds(d.selectedItemIds);b.fetchData()};this.measureLettersOverviewPageFilterUsageKpi=function(){CCL.CommonFunctions.measureKpi(b.settings.WebMethods.MeasureKpi,b.settings.SupervisorKpiSection,b.settings.LettersOverviewPageFilterUsageKpiMeasurement,b.settings.RegularKpiContext)};this.fetchDataCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchDataPromise=b.fetcher.run()});this.allLetters=
ko.observableArray([]);this.lettersInitiated=ko.observable(!1);this.lettersLoading=ko.observable(!0);this.letters=ko.pureComputed(function(){return b.allLetters()});this.lettersCount=ko.observable(0);this.areAllLettersRetreived=ko.observable(!1);this.lettersSearch=ko.observable("");this.$searchFilter.keyup(this.onSearchChangeHandler);this.$searchFilterClear.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onSearchClearHandler);this.sorting=new e;this.lettersLastScrollTop=$(window).scrollTop();
$(window).on("scroll touchmove",this.onFetchLettersHandler);this.configTermFilter();this.configHierarchyFilter();this.termId=ko.observable(null);this.hierarchyIds=ko.observableArray([]);this.isSearchOrFilteringApplied=ko.pureComputed(function(){return 0<b.lettersSearch().length||null!=b.termId()||0<b.hierarchyIds().length})}Object.defineProperty(a.prototype,"$searchFilter",{get:function(){return $("."+this.settings.CssClasses.SearchFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$searchFilterClear",{get:function(){return $("."+this.settings.CssClasses.SearchFilterClear)},enumerable:!0,configurable:!0});return a}();g.LettersOverviewViewModel=b;var a=function(){function a(a,d){var f=this;this.settings=a;this.controls=d;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).hasClass("c-supervisor-letters__inner")&&a.stopPropagation()};(new c.KnockoutCustomBindingsManager).registerSafeImgBinding();this.model=new b(a,d);ko.applyBindings(this.model,$("."+this.settings.CssClasses.Container)[0]);
this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){f.$container.off("click",f.preventFromDropDownMenuFromClosing)});this.model.fetcher=new k(this.settings.WebMethods.GetSupervisorLettersOverviews,this.model);this.model.fetcher.run().done(function(){f.model.lettersInitiated(!0)})}Object.defineProperty(a.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});
return a}();g.SupervisorLetters=a})(c.Letter||(c.Letter={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(){function a(a,b){var d=this;this.settings=b;window[a]=this;this.settings=b;this.$mainContainer=$("#"+this.settings.Controls.MainContainer);this.$courseGroupSelectorLink=$("#"+this.settings.Controls.GroupSelectorLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.settingManager=c.Settings.Manager.getInstance();$(function(){$("#"+d.settings.Controls.DropDownMenuContainer).find("."+d.settings.MenuItemCssClass).click(function(a){a=
$(a.currentTarget).data("groupid");CCL.CommonFunctions.safeAjaxPost({url:d.settings.WebMethods.CreateCollaborationBasedOnCourseGroup.replace("{elementId}",d.settings.ElementId.toString()),data:{groupId:a}}).done(function(a){return d.processResponse(a)}).fail(function(){return d.settingManager.alertError()})});d.$submitIndividuallyLink.on("click",function(){CCL.CommonFunctions.safeAjaxPost({url:d.settings.WebMethods.UseIndividualSubmission.replace("{elementId}",d.settings.ElementId.toString())}).done(function(a){return d.processResponse(a)}).fail(function(){return d.settingManager.alertError()})})})}
a.prototype.processResponse=function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();e.CourseGroups=b})(g.Collaboration||(g.Collaboration={}))})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(c){function b(a,d){c.call(this,d);this.actionUrlsBase=a}__extends(b,c);b.prototype.getElementListMarkupForEventIds=function(a,d,b,c,e,g){void 0===e&&(e="");void 0===g&&(g=!1);return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrlsBase.GetElementListMarkupForEventIds,data:{eventId:a,startDateTime:d,courseId:b,elementIds:c,fakeElementTitle:e,showConnectedDate:g},dataType:"json"})};b.prototype.createNewFileElementForEvent=function(a,d,b,c){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrlsBase.CreateNewFileElementForEvent,
data:{CourseId:a,EventId:d,FileName:b.name,FileId:b.id,SignedFileId:b.signature,ShouldFileBeAttachedToEventImmediately:c}})};return b}(c.CommonAjaxClient);g.AjaxClientBase=k})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(b){function a(a,f){b.call(this,a,f);this.actionUrls=a}__extends(a,b);a.prototype.validateDateRelatedContent=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.ValidateDateRelatedContent,data:a})};a.prototype.checkRecurringEventPeriodDuration=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.CheckRecurringEventPeriodDuration,async:!1,data:a})};a.prototype.getDatesOfEventsToBePickedAsNextEventForEditEventPage=
function(a){return $.ajax({type:"GET",url:this.actionUrls.GetDatesOfEventsToBePickedAsNextEventForEditEventPage,async:!1,data:a,dataType:"json"})};a.prototype.getTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage,async:!1,data:a,dataType:"json"})};a.prototype.getBookingMarkups=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.GetBookingMarkups,data:a,dataType:"json"})};
return a}(c.AjaxClientBase);g.AjaxClient=e})(c.EditEvent||(c.EditEvent={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(b){function a(a){b.call(this,a.settings.services,a.settings.CommonAjaxClientSettings);this.utility=a;this.actionUrls=a.settings.services}__extends(a,b);a.prototype.getAddResourceMenu=function(a){return $.ajax({type:"GET",url:this.actionUrls.getAddResourceMenu,data:a})};a.prototype.updateEventElements=function(a){return $.ajax({type:"PUT",url:this.actionUrls.updateEventElements,data:JSON.stringify(a),contentType:"application/json"})};a.prototype.removeElement=
function(a){return $.ajax({type:"DELETE",url:this.actionUrls.removeElement,data:JSON.stringify(a),contentType:"application/json"})};a.prototype.getElementListMarkupForEvent=function(a){return $.ajax({type:"GET",url:this.actionUrls.getElementListMarkupForEvent,data:a,dataType:"json"})};a.prototype.createEventWithLocation=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.createEventWithLocation,data:a,dataType:"json"})};a.prototype.ensureEditableEvent=function(a){return $.ajax({type:"GET",
url:this.actionUrls.ensureEditableEvent,data:a,dataType:"json"})};a.prototype.editEventTitle=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditEventTitle,data:a,dataType:"json"})};a.prototype.editEventDescription=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.editEventDescriptionUrl,data:a,dataType:"json"})};a.prototype.editEventExtraDescription=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditEventExtraDescription,
data:a,dataType:"json"})};a.prototype.editNextEventId=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditNextEventId,data:a,dataType:"json"})};a.prototype.eventScope=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.eventScopeUrl,data:a,dataType:"json"})};a.prototype.deleteEvent=function(a,b){return $.ajax({type:"DELETE",url:a.deleteEventUrl.replace("{eventId}",a.activityId.toString())+"?deleteRecurringSeries="+!b,contentType:"application/json",
headers:(d={},d[this.utility.settings.AntiForgeryTokenName]=this.utility.settings.AntiForgeryTokenValue,d)});var d};a.prototype.getDatesOfEventsToBePickedAsNextEventForSchedulePage=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetDatesOfEventsToBePickedAsNextEventForSchedulePage,async:!1,data:a,dataType:"json"})};a.prototype.getTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage,
async:!1,data:a,dataType:"json"})};a.prototype.checkIfAnyOfMyEventsFiltered=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.checkIfAnyOfMyEventsFiltered,data:a,dataType:"json"})};a.prototype.getCourseApprovalDates=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetCourseApprovalDates,async:!1,data:a,dataType:"json"})};a.prototype.checkRecurringEventGroupsMembership=function(a){return $.ajax({type:"GET",url:this.actionUrls.CheckRecurringEventGroupsMembership,async:!1,
data:a,dataType:"json"})};a.prototype.getEvent=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetEvent,async:!1,data:a,dataType:"json"})};a.prototype.removeCalendar=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.removeCalendar,data:a})};a.prototype.changeCalendarView=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.changeCalendarView,data:a})};a.prototype.getGroupsForDropdown=function(a){return $.ajax({type:"GET",url:this.actionUrls.getGroupsForDropdown,
data:a})};a.prototype.getRecurringEventDetails=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetRecurringEventDetails,data:a,async:!1})};a.prototype.saveFilterPreferences=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.saveCalendarFiltersPreferences,data:a})};a.prototype.addCalendar=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.addCalendar,dataType:"html",data:a})};a.prototype.toggleCalendar=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.toggleCalendar,
data:a})};return a}(c.AjaxClientBase);g.AjaxClient=e})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(b){function a(a,f){b.call(this,a.dataAttributes,a.cssClasses,a.terms,a.ClientInstanceNames,a.PostMessageNames,f,a.constants);this.settings=a;this.controls=f;this.initSelectors();this.initDataAttributes()}__extends(a,b);a.prototype.getExpandableContainer=function(a){return a.closest(this.selectors.expandableContainer)};a.prototype.getManuallyAddedElementsCount=function(a){return a.find("li["+this.dataAttributes.elementListItem+"*='\"AddedManually\":true']").length};
a.prototype.formatSectionNameWithCounter=function(a,b){return a+" ("+b+")"};a.prototype.getElementListAppendTarget=function(a){return a.find("."+this.settings.cssClasses.SelectedElementListAppendTarget)};a.prototype.initSelectors=function(){this.selectors.addEventDialogAttachedElementsHidden="data-"+this.settings.dataAttributes.AddEventDialogAttachedElementsHidden;this.selectors.contextDialogHeaderH2="."+this.settings.cssClasses.ContextDialogHeader+" > h2";this.selectors.expandableContainerHeaderIcon=
"."+this.settings.cssClasses.ExpandableContainerHeader+" > ."+this.settings.cssClasses.Icon;this.selectors.expandableContainer="."+this.settings.cssClasses.ExpandableContainer};a.prototype.initDataAttributes=function(){this.dataAttributes.addEventDialogAttachedElementsHidden=CCL.CommonFunctions.getDataSelector(this.settings.dataAttributes.AddEventDialogAttachedElementsHidden)};return a}(c.CalendarUtilityBase);g.Utility=e})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){var g;(function(b){b[b.NotLoaded=0]="NotLoaded";b[b.Loading=1]="Loading";b[b.Loaded=2]="Loaded"})(g||(g={}));var e=function(){function b(a,b,f,c){function d(a){var b=a.position().left+a.width()/2;a=a.position().top+10;q.openDialogAt(b,a,!1)}var h=this,e=g.NotLoaded,k=$("<div class='ccl-context-dialog-content-container'></div>").hide();a.after(k);var r=null,q=new ContextDialog(k,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,width:420,marginTop:b.height(),marginLeft:-210,
scrollToLastWindowOnClose:!1,cssClass:c}),u=q.closeDialog;q.setCloseFunction(function(a){u(a)});window.addEventListener("orientationchange",function(a){return q.closeDialog(a)});k.click(function(){return q.closeDialog()});b.click(function(a){if(q.isOpened())q.closeDialog();else{var b=$(a.target),c=h.getParams(b);e!==g.Loaded||h.paramsAreEqual(r,c)||(e=g.NotLoaded,k.empty());e===g.Loaded?d($(a.currentTarget)):e===g.NotLoaded&&(e=g.Loading,$.get(f,h.formatUrlParams(c),function(b){b&&(k.append(b),d($(a.currentTarget)));
e=g.Loaded;r=c}).fail(function(){return e=g.NotLoaded}))}})}b.prototype.getParams=function(a){throw Error("Abstract method should be overriden");};b.prototype.paramsAreEqual=function(a,b){throw Error("Abstract method should be overriden");};b.prototype.formatUrlParams=function(a){throw Error("Abstract method should be overriden");};return b}();c.BaseDetailedInfo=e})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(c){function b(a,b){var d=$(".tablelisting"),h=$(".tablelisting > table > tbody > tr > td > a");c.call(this,d,h,a,b)}__extends(b,c);b.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").children("td").eq(1).children().html();return{Period:b,CustomerId:a}};b.prototype.paramsAreEqual=function(a,b){return null==a?!1:a.Period===b.Period&&a.CustomerId===b.CustomerId};b.prototype.formatUrlParams=function(a){return{periodid:a.Period,customerId:a.CustomerId}};
return b}(c.BaseDetailedInfo);c.ListOnlineSitesDetailedInfo=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(c){function b(a,b,f){var d=$(".tabsframe > div");c.call(this,d,a,b,f)}__extends(b,c);b.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").data("c-c");return{Period:b,CountryCode:a}};b.prototype.paramsAreEqual=function(a,b){return null==a?!1:a.Period===b.Period&&a.CountryCode===b.CountryCode};b.prototype.formatUrlParams=function(a){return{periodid:a.Period,countrycode:a.CountryCode}};return b}(c.BaseDetailedInfo);c.ListOnlineSummaryDetailedInfo=
g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b,a){var d=this;this.isUploaderDirty=function(){var a=d.getNewUploaderInstance();return!!a&&0<a.uploadedItems.uploadMetadataArray.length+a.uploadedItems.fileInCloudMetadataArray.length+a.uploadedItems.folderMetadataArray.length};this.isFormDirty=function(){return d.isUploaderDirty()||!d.customScripts.isDescriptionEmpty()||d.$titleInput.val()&&0<d.$titleInput.val().length||0<d.$criteriaWeightsHidden.val().length};this.handleConfirmDialogAndSaveButtonBehaviour=
function(a){switch(a){case UploadStatus.InProgress:d.lockSaveButton(!0);break;case UploadStatus.SucceededWithErrors:case UploadStatus.Succeeded:case UploadStatus.Awaiting:case UploadStatus.Failed:d.lockSaveButton(!1)}d.updateSaveButtonState()};var f=this;window[b.ClientInstanceName]=this;this.settings=b;this.customScripts=a;this.timer=0;this.selectedLoIds=this.settings.LearningObjectiveIds;this.$criteriaWeightsHidden=$("#"+this.settings.ClientIds.CriteriaWeightsHidden);this.$iframe=$("#"+this.settings.ClientIds.Iframe);
this.$manageRubricPopupTriggerLink=$("#"+this.settings.ClientIds.ManageRubricPopupTriggerLink);this.$criteriaWeightsHidden.val(JSON.stringify(this.settings.CriteriaWeights));this.$document=$(document);a="."+this.settings.Css.SaveButton;this.$saveButton=$(a);this.buttonLoadingIndicator=new CCL.ButtonLoadingIndicator(a,this.settings.Css.ButtonInProgress,null,100);this.$titleInput=$("#"+this.settings.ClientIds.Title);this.$titlePanel=$("#"+this.settings.ClientIds.TitlePanel);this.$deepLinkUrl=$("#"+
this.settings.ClientIds.DeepLinkUrl);this.$deepLinkPanel=$("#"+this.settings.ClientIds.DeepLinkUrlPanel);this.linkInput=document.getElementById(this.settings.ClientIds.LinkInput);this.embedLinkTargetCheckBox=document.getElementById(this.settings.ClientIds.EmbedLinkTargetCheckBox);this.isTitleValid=this.validateTitle();this.isDescriptionToolbarExpanded=b.IsDescriptionToolbarExpanded;this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload($("#"+this.settings.ClientIds.Form),this.settings.Terms.BeforeUnloadWarningMessage,
{$cancelButtons:this.$saveButton,callback:this.isFormDirty});this.settings.SubmitButtonLocked&&this.$saveButton.toggleHyperlink(!1);this.settings.OpenDeepLinkInNewTab?this.$titleInput.prop("disabled",!0):(this.$deepLinkPanel.toggle(),this.settings.IsDeepLink&&(b=this.$iframe.height()+this.$titlePanel.outerHeight(!0),this.$titlePanel.toggle(),this.$iframe.css({height:b+"px"})));f.isSettingsValid=!0;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,
function(a){a.extendedData.updateSettings||(f.selectedLoIds=a.extendedData.loIds,f.$criteriaWeightsHidden.val(a.extendedData.criteriaWeights),$(document).trigger(d.settings.EventNames.RubricChanged,{loIds:d.selectedLoIds,criteriaWeights:a.extendedData.criteriaWeights}))});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.deepLinkContentReceived,function(a){a&&a.extendedData&&(f.$extendedData=JSON.stringify(a.extendedData),f.$titlePanel.show(),d.$titleInput.prop("disabled",
!1),f.$titleInput.val(a.extendedData.title),f.isTitleValid=f.validateTitle(),f.$iframe.toggle(),a.extendedData.url&&""!=a.extendedData.url&&(f.$deepLinkUrl.text(a.extendedData.url),f.$deepLinkPanel.show()),f.lockSaveButton(!1),f.updateSaveButtonState())});this.$manageRubricPopupTriggerLink.click(function(){f.initManageManageRubricPopup();window[f.settings.ClientIds.RubricPopup].openDialog();return!1});this.$titleInput.on("blur",function(){f.onTitleChangeHandler()});this.$titleInput.on("input",function(a){f.onInputChangeHandler(a,
f.onTitleChangeHandler)});this.$document.on(this.settings.EventNames.ValidStateChanged,function(a,b){f.isSettingsValid=b;f.updateSaveButtonState()});this.$document.on(this.settings.EventNames.LearningObjectivesChanged,function(a,b){b.isSyncContext||(f.selectedLoIds=b.ids,$(document).trigger(d.settings.EventNames.UpdateMaxScore,{loIds:f.selectedLoIds,criteriaWeights:f.$criteriaWeightsHidden.val()}))});this.$document.on(this.settings.EventNames.ToggleCriteriaWeightsVisibility,function(a,b){d.settings.ShowCriteriaWeights=
b.show});if(!f.settings.IsDescriptionReadOnly)if("undefined"!==typeof CKEDITOR)CKEDITOR.on("instanceReady",function(){var a=f.customScripts.getDescriptionEditorInput();a.on("blur",function(){d.onDescriptionChangeHandler()});a.on("change",function(a){d.onInputChangeHandler(a,d.onDescriptionChangeHandler)});a.on("contentDom",function(){a.document.on("keyup",function(a){d.onInputChangeHandler(a,d.onDescriptionChangeHandler)})});if(f.isDescriptionToolbarExpanded){var b=a.getCommand(f.settings.DescriptionToolbarExpandedCommandName),
c=b.editorFocus;b.editorFocus=!1;a.execCommand(f.settings.DescriptionToolbarExpandedCommandName);b.editorFocus=c}a.on(f.settings.EventNames.DescriptionToolbarExpanded,function(a){f.isDescriptionToolbarExpanded=a.data.expanded;f.toggleDescriptionToolbar()});d.onDescriptionChangeHandler()});else this.onDescriptionChange($(this.customScripts.getDescriptionEditorInput()));this.updateSaveButtonState();this.buttonLoadingIndicator.disableLoadingIndicator=!this.$saveButton.getIfHyperLinkEnabled();$("button."+
this.settings.Css.CancelButton).on("click",function(){window.close()});this.settings.IsTitleHeaderEditable&&(this.titleEditor=new c.Controls.ElementTitleEditor($("#"+this.settings.ClientIds.TitleLabel),this.settings.ElementTitleEditorClientSettings,this.settings.ElementId,this.settings.FolderId))}e.prototype.closeManageRubricDialog=function(){var b=$("#"+this.settings.ClientIds.RubricPopup).find("iframe").get(0).contentWindow;CCL.CommonFunctions.makePostMessageCall(b,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.submitIframe))};
e.prototype.collectContent=function(){var b={};b.Title=this.$titleInput.val();b.Description=this.customScripts.isDescriptionEmpty()?"":this.customScripts.getDescription();b.ExtendedData=this.$extendedData;var a=this.getNewUploaderInstance();a&&(b.SerializedUploadResults=JSON.stringify(a.uploadedItems));this.linkInput&&(b.Link=this.linkInput.value,this.embedLinkTargetCheckBox&&(b.EmbedLinkTarget=this.embedLinkTargetCheckBox.checked));this.settings.IsTitleHeaderEditable&&this.titleEditor&&(b.Title=
c.Controls.ElementTitleEditor.getText());b.SerializedCriteriaWeights=this.$criteriaWeightsHidden.val();return b};e.prototype.lockSaveButton=function(b){this.settings.SubmitButtonLocked=b};e.prototype.validateTitle=function(){if(0<this.$titleInput.length){var b=this.$titleInput.val();return b&&0<b.length}return!0};e.prototype.validateUploads=function(){return this.settings.IsUploadRequired?this.isUploaderDirty():!0};e.prototype.onDescriptionChange=function(b){var a=this;b.on("blur",function(){a.onDescriptionChangeHandler()});
b.on("input",function(b){a.onInputChangeHandler(b,a.onDescriptionChangeHandler)})};e.prototype.onTitleChangeHandler=function(){var b=this.getSettingsEditor();null!=b&&b.stateChanged();this.isTitleValid=this.validateTitle();this.updateSaveButtonState()};e.prototype.getSettingsEditor=function(){null==this.settingsEditor&&(this.settingsEditor=window[this.settings.ClientIds.EditSettingsViewInstanceName]);return this.settingsEditor};e.prototype.typeWatch=function(b,a){clearTimeout(this.timer);this.timer=
setTimeout(b.bind(this),a)};e.prototype.onInputChangeHandler=function(b,a){b=b.which;b>=CCL.CommonConstants.keyCodes.arrowLeft&&b<=CCL.CommonConstants.keyCodes.arrowDown||this.typeWatch(a,500)};e.prototype.onDescriptionChangeHandler=function(){var b=this.getSettingsEditor();null!=b&&b.stateChanged();this.updateSaveButtonState()};e.prototype.initManageManageRubricPopup=function(){var b=this.settings.ManageRubricDialogUrl,a=this.getParameterByName(b,"Ids");b=a?b.replace(a[0],a[0][0]+"Ids="+encodeURIComponent(this.selectedLoIds.join(","))):
b+(-1===b.indexOf("?")?"?":"&")+"Ids="+encodeURIComponent(this.selectedLoIds.join(","));if(a=this.$criteriaWeightsHidden.val()){var d=this.getParameterByName(b,"CriteriaWeights");b=d?b.replace(d[0],d[0][0]+"CriteriaWeights="+encodeURIComponent(a)):b+(-1===b.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(a)}a=this.settings.ShowCriteriaWeights?"1":"0";b=(d=this.getParameterByName(b,"ShowCriteriaWeights"))?b.replace(d[0],d[0][0]+"ShowCriteriaWeights="+a):b+(-1===b.indexOf("?")?"?":"&")+
"ShowCriteriaWeights="+a;window[this.settings.ClientIds.RubricPopup].setIframeUrl(b)};e.prototype.getParameterByName=function(b,a){return RegExp("[?&]"+a+"=([^&]*)").exec(b)};e.prototype.updateSaveButtonState=function(){this.settings.SubmitButtonLocked?this.$saveButton.toggleHyperlink(!1):this.$saveButton.toggleHyperlink(this.isSettingsValid&&this.isTitleValid&&this.validateUploads());this.buttonLoadingIndicator.disableLoadingIndicator=!this.$saveButton.getIfHyperLinkEnabled()};e.prototype.toggleDescriptionToolbar=
function(){CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPersonSetting,data:{key:this.settings.PersonSettingIsDescriptionToolbarExpandedKey,value:this.isDescriptionToolbarExpanded?"true":"false"}})};e.prototype.getNewUploaderInstance=function(){var b=window.document.getElementById(this.settings.ClientIds.UploadAreaClientId);return b?b[this.settings.ClientIds.UploaderControlClientInstanceName]:void 0};return e}();g.AddLearningToolElement=k})(c.LearningToolElement||(c.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(){}e.prototype.validateAndTransferElementStateAfterClick=function(b,a){this.validateElementState(b,a);return this.transferElementState(a)};e.prototype.transferElementStateAfterSave=function(b){return b===c.State.AttachedByUser?c.State.Saved:b===c.State.DetachedByUser?c.State.Empty:b};e.prototype.isElementChecked=function(b){return b===c.State.AttachedByUser||b===c.State.Saved};e.prototype.validateElementState=function(b,a){if(!(b&&!this.isElementChecked(a)||
!b&&this.isElementChecked(a)))throw Error("Incorrect element state occurred IsChecked "+b+" StateBeforeCheck "+a);};e.prototype.transferElementState=function(b){switch(b){case c.State.DetachedByUser:return c.State.Saved;case c.State.Empty:return c.State.AttachedByUser;case c.State.AttachedByUser:return c.State.Empty;case c.State.Saved:return c.State.DetachedByUser;default:throw Error("Unknown State "+b);}};return e}();c.Machine=g})(c.CheckboxStateMachine||(c.CheckboxStateMachine={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){var d=this;this.peerAndSelfAssessmentStateChanged=function(a){d.togglePeerAssessment();$(document).trigger(d.settings.Triggers.StateChanged,[d.activated,d.selfAssessmentActivated])};this.deadlineChanged=function(a){d.enabled=!(d.hasDeadlinePassed||d.groupActivityEnabled)};this.groupActivityStateChanged=function(a,b){d.groupActivityEnabled=b;d.groupActivityEnabled&&(d.activated=!1,d.selfAssessmentActivated=!1);d.enabled=!(d.hasDeadlinePassed||
d.groupActivityEnabled);d.selfAssessmentEnabled=!d.groupActivityEnabled};window[a]=this;this.settings=b;$(function(){d.$peerAssessmentDropDownContainer=$("#"+d.settings.Controls.PeersCountDropDownContainer);d.$peerAssessmentDropDown=$("#"+d.settings.Controls.PeersCountDropDown);d.$container=$("#"+d.settings.Controls.Container);d.$checkbox=$("#"+d.settings.Controls.Checkbox);d.$anonymousPeerAssessmentCheckbox=document.getElementById(d.settings.Controls.AnonymousPeerAssessmentCheckbox);d.$selfAssessmentCheckbox=
$("#"+d.settings.Controls.SelfAssessmentCheckbox);d.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(d.$checkbox);d.$customTooltipForSelfAssessmentCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(d.$selfAssessmentCheckbox);d.deadline=window[d.settings.ClientInstanceNames.Deadline];d.groupActivityEnabled=d.settings.GroupActivityEnabled;d.enabled=d.settings.Enabled;d.selfAssessmentEnabled=!d.settings.GroupActivityEnabled;d.$peerAssessmentDropDown.val(d.settings.PeersCount.toString());
d.togglePeerAssessment(!d.settings.Activated);if(!d.settings.Enabled||!d.settings.HasDeadlinePassed)if($(d.deadline).change(d.deadlineChanged),d.$checkbox.change(d.peerAndSelfAssessmentStateChanged),d.settings.Events.GroupActivityStateChanged)$(document).off(d.settings.Events.GroupActivityStateChanged).on(d.settings.Events.GroupActivityStateChanged,d.groupActivityStateChanged);d.$selfAssessmentCheckbox.change(d.peerAndSelfAssessmentStateChanged)})}Object.defineProperty(b.prototype,"activated",{get:function(){return this.$checkbox.is(":checked")},
set:function(a){this.$checkbox.toggle(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selfAssessmentActivated",{get:function(){return this.$selfAssessmentCheckbox.is(":checked")},set:function(a){this.$selfAssessmentCheckbox.toggle(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"anonymousPeerAssessmentActivated",{get:function(){return this.$anonymousPeerAssessmentCheckbox.checked},set:function(a){this.$anonymousPeerAssessmentCheckbox.checked=a},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"enabled",{set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$checkbox.prop("disabled",!a);this.customTooltipForCheckbox.setToolTipHtml(a?"":this.tooltip);this.customTooltipForCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selfAssessmentEnabled",{set:function(a){this.$selfAssessmentCheckbox.prop("disabled",!a);this.$customTooltipForSelfAssessmentCheckbox.setToolTipHtml(a?
"":this.settings.Terms.SelfAssessmentDisabledWarning);this.$customTooltipForSelfAssessmentCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"peersToAssessCount",{get:function(){return this.$peerAssessmentDropDown.val()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hasDeadline",{get:function(){var a=this.deadline.getState().DateTime;return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"hasDeadlinePassed",{get:function(){return this.hasDeadline?this.deadline.getDateTime()<new Date:!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"tooltip",{get:function(){var a="";this.hasDeadlinePassed?a=this.settings.Terms.DeadlineHasPassedWarning:this.hasDeadline||(a=this.settings.Terms.DeadlineIsEmptyWarning);this.groupActivityEnabled&&(""!==a&&(a+=" "),a+=this.settings.Terms.PeerAssessmentDisabledWarning);return a},enumerable:!0,configurable:!0});b.prototype.togglePeerAssessment=
function(a){void 0===a&&(a=!0);a&&(this.enabled=this.hasDeadline&&!this.hasDeadlinePassed);this.$peerAssessmentDropDownContainer.toggle(this.$checkbox.is(":checked"));this.$peerAssessmentDropDownContainer.prop("disabled",!this.$checkbox.is(":enabled"));this.$peerAssessmentDropDown.prop("disabled",!this.$checkbox.is(":enabled"))};return b}();c.PeerAssessment=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a){var b=this;this.viewModel=a;this.onJQueryReady=function(){b._$controlElement=$("#"+b.viewModel.ContainerId);b._$whenToShowResultElement=$("."+b.viewModel.WhenToShowResultSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerElement=$("."+b.viewModel.WhenToShowQuestionListAndAnswerSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerContainer=$("#"+b.viewModel.WhenToShowQuestionListAndAnswerContainer,
b._$controlElement);b._$revealCorrectAnswerContainer=$("#"+b.viewModel.RevealCorrectAnswerContainer,b._$controlElement);b._$maxAttemptsAllowedElement=$(""+b.viewModel.MaxAttemptsAllowedSelector)};this._$revealCorrectAnswerElement=$("#"+a.RevealCorrectAnswerClientId);this._deadlinePicker=window[a.DeadlineInstanceName];$(this.onJQueryReady)}Object.defineProperty(a.prototype,"$controlElement",{get:function(){return this._$controlElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$whenToShowResultElement",{get:function(){return this._$whenToShowResultElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowResultAllOptionElements",{get:function(){return $("option",this.$whenToShowResultElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerElement",{get:function(){return this._$whenToShowQuestionListAndAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAllOptionElements",
{get:function(){return $("option",this.$whenToShowQuestionListAndAnswerElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"revealCorrectAnswerElement",{get:function(){return this._$revealCorrectAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerContainer",{get:function(){return this._$whenToShowQuestionListAndAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$revealCorrectAnswerContainer",
{get:function(){return this._$revealCorrectAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$maxAttemptsAllowedElement",{get:function(){return this._$maxAttemptsAllowedElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"deadlinePicker",{get:function(){return this._deadlinePicker},enumerable:!0,configurable:!0});a.prototype.appendOptionToWhenToShowResultElement=function(a,b){this.$whenToShowResultElement.append($("<option></option>").prop("value",
a.toString()).text(b))};a.prototype.appendOptionToWhenToShowQuestionListAndAnswerElement=function(a,b){this.$whenToShowQuestionListAndAnswerElement.append($("<option></option>").prop("value",a.toString()).text(b))};Object.defineProperty(a.prototype,"$whenToShowResultAfterDeadlineOptionItem",{get:function(){return this.$getWhenToShowResultOptionItem(c.WhenToShowResult.AfterDeadline)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem",
{get:function(){return this.$getWhenToShowQuestionListAndAnswerOptionItem(c.WhenToShowQuestionListAndAnswer.AfterDeadline)},enumerable:!0,configurable:!0});a.prototype.setTextToWhenToShowResultOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowResultElement).text(b)};a.prototype.setTextToWhenToShowQuestionListAndAnswerOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement).text(b)};a.prototype.$getWhenToShowResultOptionItem=function(a){return $("option[value="+
a.toString()+"]",this.$whenToShowResultElement)};a.prototype.$getWhenToShowQuestionListAndAnswerOptionItem=function(a){return $("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement)};return a}();e.ControlsProvider=b})(c.ResultsAndFeedbackInternals||(c.ResultsAndFeedbackInternals={}))})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(c){var b=function(){function a(){this.handlers=[]}a.prototype.on=function(a){this.handlers.push(a)};a.prototype.trigger=function(a){this.handlers.slice(0).forEach(function(b){return b(a)})};return a}();c.EventHandler=b;var a=function(){return function(a,b){this.previous=a;this.current=b}}();c.MaxAttemptsEventData=a;var d=function(){function d(d,f){var c=this;this.viewModel=d;this.controlsProvider=f;this.deadlineChanged=function(a){c.onDeadlineChangedHandler.trigger(c.hasDeadline)};
this.attemptsChanged=function(b){c.onAttemptsChangedHandler.trigger(new a(c.previousMaxAttemptsAllowed,c.maxAttemptsAllowed));c.previousMaxAttemptsAllowed=c.maxAttemptsAllowed};this.onJQueryReady=function(){c.previousMaxAttemptsAllowed=c.maxAttemptsAllowed;$(c.controlsProvider.deadlinePicker).change(c.deadlineChanged);c.controlsProvider.$maxAttemptsAllowedElement.change(c.attemptsChanged)};this.onDeadlineChangedHandler=new b;this.onAttemptsChangedHandler=new b;$(this.onJQueryReady)}Object.defineProperty(d.prototype,
"onDeadlineChanged",{get:function(){return this.onDeadlineChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"onAttemptsChanged",{get:function(){return this.onAttemptsChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.controlsProvider.$maxAttemptsAllowedElement.val())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasDeadline",{get:function(){var a=this.controlsProvider.deadlinePicker.getState().DateTime;
return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});d.prototype.hasMaxAttemptsChangedToMultiple=function(a,b){return 1===a&&(1<b||b===this.viewModel.UnlimitedAttemptsValue)};d.prototype.hasMaxAttemptsChangedToSingle=function(a,b){return 1===b&&(1<a||a===this.viewModel.UnlimitedAttemptsValue)};return d}();c.ExternalDependenciesController=d})(c.ResultsAndFeedbackInternals||(c.ResultsAndFeedbackInternals={}))})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a,b,h){var d=this;this.viewModel=a;this.controlsProvider=b;this.externalDependenciesController=h;this.removeAfterDeadline=function(){var a=d.whenToShowResult;d.controlsProvider.$whenToShowResultAfterDeadlineOptionItem.remove();a===c.WhenToShowResult.AfterDeadline&&d.controlsProvider.$whenToShowResultElement.val(d.defaultWhenToShowResult).change()};this.addAfterDeadline=function(){if(void 0===d.controlsProvider.$whenToShowResultAfterDeadlineOptionItem[0]){var a=
c.WhenToShowResult.AfterDeadline;d.controlsProvider.appendOptionToWhenToShowResultElement(a,d.getWhenToShowResultOptionText(a))}};this.deadlineChanged=function(a){a?d.addAfterDeadline():d.removeAfterDeadline()};this.replaceEachAttemptWithTheAttempt=function(){d.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){d.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=c.WhenToShowResult.AfterEachAttempt;a=a?d.getWhenToShowResultOptionAlternativeText(b):d.getWhenToShowResultOptionText(b);
d.controlsProvider.setTextToWhenToShowResultOption(b,a)};this.removeAfterAllAttempts=function(a){d.controlsProvider.$getWhenToShowResultOptionItem(c.WhenToShowResult.AfterAllAttempts).remove();a===c.WhenToShowResult.AfterAllAttempts&&d.controlsProvider.$whenToShowResultElement.val(d.defaultWhenToShowResult).change()};this.attachDefaultList=function(){d.controlsProvider.$whenToShowResultAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(d.getWhenToShowResultOptionText(a))});if(void 0===d.controlsProvider.$getWhenToShowResultOptionItem(c.WhenToShowResult.AfterAllAttempts)[0]&&
d.shouldHaveAfterAllAttemptsOption){var a=c.WhenToShowResult.AfterAllAttempts;d.controlsProvider.appendOptionToWhenToShowResultElement(a,d.getWhenToShowResultOptionText(a))}d.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowResultElementValue=function(a,b,f){d.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,b)?f===c.WhenToShowResult.AfterAllAttempts&&d.controlsProvider.$whenToShowResultElement.val(c.WhenToShowResult[c.WhenToShowResult.AfterEachAttempt]).change():d.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,
b)&&(a=c.WhenToShowResult[c.WhenToShowResult.AfterAllAttempts],b===d.viewModel.UnlimitedAttemptsValue&&(a=c.WhenToShowResult[c.WhenToShowResult.AfterEachAttempt]),f===c.WhenToShowResult.AfterEachAttempt&&d.controlsProvider.$whenToShowResultElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:d.replaceEachAttemptWithTheAttempt();d.removeAfterAllAttempts(d.whenToShowResult);break;case d.viewModel.UnlimitedAttemptsValue:d.replaceTheAttemptWithEachAttempt();d.removeAfterAllAttempts(d.whenToShowResult);
break;default:d.attachDefaultList()}d.adjustWhenToShowResultElementValue(a.previous,a.current,d.whenToShowResult)};this.onJQueryReady=function(){d.buildWhenToShowResultList()};h.onDeadlineChanged.on(this.deadlineChanged);h.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowResult",{get:function(){return c.WhenToShowResult[c.WhenToShowResult.AfterEachAttempt]},enumerable:!0,configurable:!0});a.prototype.getWhenToShowResultOptionText=
function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowResultOptionAlternativeText=function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.buildWhenToShowResultList=function(){var a=this;this.controlsProvider.$whenToShowResultElement.empty();$.each(this.viewModel.WhenToShowResultsOptions,function(b,d){d.Value===c.WhenToShowResult.AfterEachAttempt?
1===a.externalDependenciesController.maxAttemptsAllowed?a.controlsProvider.appendOptionToWhenToShowResultElement(d.Value,d.AlternativeText):a.controlsProvider.appendOptionToWhenToShowResultElement(d.Value,d.Text):d.Value===c.WhenToShowResult.AfterDeadline?a.externalDependenciesController.hasDeadline&&a.controlsProvider.appendOptionToWhenToShowResultElement(d.Value,d.Text):d.Value===c.WhenToShowResult.AfterAllAttempts?a.shouldHaveAfterAllAttemptsOption&&a.controlsProvider.appendOptionToWhenToShowResultElement(d.Value,
d.Text):a.controlsProvider.appendOptionToWhenToShowResultElement(d.Value,d.Text)});this.controlsProvider.$whenToShowResultElement.val(this.viewModel.ResultsAndFeedbackState.WhenToShowResult.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,"whenToShowResult",{get:function(){var a=this.controlsProvider.$whenToShowResultElement.val();return c.WhenToShowResult[a]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"whenToShowResultsChanged",{get:function(){return this.whenToShowResult!==this.viewModel.ResultsAndFeedbackState.WhenToShowResult},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return 1!==this.externalDependenciesController.maxAttemptsAllowed&&this.externalDependenciesController.maxAttemptsAllowed!==this.viewModel.UnlimitedAttemptsValue&&this.whenToShowResult!==c.WhenToShowResult.WhenTeacherDecides&&this.whenToShowResult!==c.WhenToShowResult.AfterDeadline},
enumerable:!0,configurable:!0});return a}();e.WhenToShowResultsController=b})(c.ResultsAndFeedbackInternals||(c.ResultsAndFeedbackInternals={}))})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b,a){var d=this;this.controls=b;this.settings=a;this.ajaxParams={};this.afterOkClickCallback=function(a){if(a){d.currentElementStates=c.MapUtils.makeCopy(a);d.saveElementStates();var b=[];a.forEach(function(a,f){d.checkboxStateMachine.isElementChecked(a)&&b.push(f)});d.updateElementListMarkup(b)}};this.currentElementStates=new Map;this.checkboxStateMachine=new c.CheckboxStateMachine.Machine;this.loadElementStates();this.ajaxParams={locationId:this.settings.CourseId,
locationType:c.AddResourceMenu.ElementExternalSourceType.Course};this.ajaxClient=new g.ElementPickerAjaxClient(this.settings.Urls,this.settings.CommonAjaxClientSettings);this.controls.AddButton.click(function(){var a={elementStates:c.MapUtils.makeCopy(d.currentElementStates),elementType:c.ElementLinkDialog.ContentElementType.Files,showAll:!0,allowFolderSelection:!1,header:d.settings.Terms.DialogTitle,afterOkClickCallback:d.afterOkClickCallback,openerPage:c.ElementLinkDialog.ElementsPopupOpener.None,
relatedEntityId:d.settings.CustomActivityId};c.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,d.ajaxParams)});b=$(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.SelectedElementListAppendTarget));b.on("click","."+this.settings.CssClasses.DetachElement,function(a){a=$(a.target).closest("li");var b=a.data(d.settings.DataAttributes.ElementId),f=a.closest("."+d.settings.CssClasses.SelectedElementList),c=a.next().find("a").first();0===c.length&&(c=d.controls.AddButton);
a.remove();0===f.children("li").length&&f.remove();c.focus();d.detachElementFromMap(b)});b.on("mouseenter","."+this.settings.CssClasses.SelectedElementList+" > li",function(a){a=$(a.currentTarget).find("."+d.settings.CssClasses.ElementTitle).get(0);var b=$(a).closest("a"),f=a.offsetWidth;CCL.CommonFunctions.isChrome()&&!CCL.CommonFunctions.isEdge()||f++;b.prop("title",f<a.scrollWidth?a.textContent.trim():"")})}e.prototype.loadElementStates=function(){this.currentElementStates=c.MapUtils.jsonStringToMap(this.controls.PickerResultHidden.val(),
c.MapUtils.numberKeyConverter)};e.prototype.saveElementStates=function(){this.controls.PickerResultHidden.val(c.MapUtils.mapToJsonString(this.currentElementStates))};e.prototype.updateElementListMarkup=function(b){var a=$(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.SelectedElementListAppendTarget));a.empty();this.ajaxClient.getElementListMarkupByIds({CourseId:this.settings.CourseId,ElementIds:b}).done(function(b){return a.append($(b))})};e.prototype.detachElementFromMap=function(b){var a=
this.currentElementStates.get(b);a=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,a);this.currentElementStates.set(b,a);this.saveElementStates()};return e}();g.PickerManager=k})(c.CustomActivityElementPicker||(c.CustomActivityElementPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){var b=function(){function a(a,b,h,e){var d=this;this.viewModel=a;this.controlsProvider=b;this.whenToShowResultsController=h;this.externalDependenciesController=e;this.removeAfterDeadline=function(){d.removeAfterDeadlineSetNewValue(d.defaultWhenToShowQuestionListAndAnswer)};this.addAfterDeadline=function(){if(d.whenToShowResultsController.whenToShowResult!==c.WhenToShowResult.WhenTeacherDecides){if(void 0===d.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem[0]){var a=
c.WhenToShowQuestionListAndAnswer.AfterDeadline;d.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,d.getWhenToShowQuestionListAndAnswerOptionText(a))}}else d.removeAfterDeadlineSetNewValue(d.neverWhenToShowQuestionListAndAnswer)};this.deadlineChanged=function(a){a?d.addAfterDeadline():d.removeAfterDeadline()};this.whenToShowResultChanged=function(a){a=d.whenToShowResultsController.whenToShowResult;a===c.WhenToShowResult.Never&&d.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(c.WhenToShowQuestionListAndAnswer.Never.toString()).change();
d.buildWhenToShowQuestionListAndAnswerList(d.whenToShowQuestionListAndAnswer);d.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(a!==c.WhenToShowResult.Never);d.deadlineChanged(d.externalDependenciesController.hasDeadline)};this.whenToShowQuestionListAndAnswerChanged=function(a){a=d.whenToShowQuestionListAndAnswer;a===c.WhenToShowQuestionListAndAnswer.Never&&d.controlsProvider.revealCorrectAnswerElement.toggle(!1);d.controlsProvider.$revealCorrectAnswerContainer.toggle(a!==c.WhenToShowQuestionListAndAnswer.Never)};
this.replaceEachAttemptWithTheAttempt=function(){d.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){d.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=c.WhenToShowQuestionListAndAnswer.AfterEachAttempt;a=a?d.getWhenToShowQuestionListAndAnswerOptionAlternativeText(b):d.getWhenToShowQuestionListAndAnswerOptionText(b);d.controlsProvider.setTextToWhenToShowQuestionListAndAnswerOption(b,a)};this.removeAfterAllAttempts=function(a){d.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(c.WhenToShowQuestionListAndAnswer.AfterAllAttempts).remove();
a===c.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&d.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(d.defaultWhenToShowQuestionListAndAnswer).change()};this.attachDefaultList=function(){d.controlsProvider.$whenToShowQuestionListAndAnswerAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(d.getWhenToShowQuestionListAndAnswerOptionText(a))});if(void 0===d.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(c.WhenToShowQuestionListAndAnswer.AfterAllAttempts)[0]&&
d.shouldHaveAfterAllAttemptsOption){var a=c.WhenToShowQuestionListAndAnswer.AfterAllAttempts;d.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,d.getWhenToShowQuestionListAndAnswerOptionText(a))}d.whenToShowResultsController.whenToShowResult===c.WhenToShowResult.WhenTeacherDecides&&d.removeAfterAllAttempts(d.whenToShowQuestionListAndAnswer);d.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowQuestionListAndAnswerElementValue=function(a,b,f){d.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,
b)?f===c.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&d.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(c.WhenToShowQuestionListAndAnswer[c.WhenToShowQuestionListAndAnswer.AfterEachAttempt]).change():d.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,b)&&(a=c.WhenToShowQuestionListAndAnswer[c.WhenToShowQuestionListAndAnswer.AfterAllAttempts],b===d.viewModel.UnlimitedAttemptsValue&&(a=c.WhenToShowQuestionListAndAnswer[c.WhenToShowQuestionListAndAnswer.AfterEachAttempt]),
f===c.WhenToShowQuestionListAndAnswer.AfterEachAttempt&&d.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:d.replaceEachAttemptWithTheAttempt();d.removeAfterAllAttempts(d.whenToShowQuestionListAndAnswer);break;case d.viewModel.UnlimitedAttemptsValue:d.replaceTheAttemptWithEachAttempt();d.removeAfterAllAttempts(d.whenToShowQuestionListAndAnswer);break;default:d.attachDefaultList()}d.adjustWhenToShowQuestionListAndAnswerElementValue(a.previous,
a.current,d.whenToShowQuestionListAndAnswer)};this.onJQueryReady=function(){d.buildWhenToShowQuestionListAndAnswerList(d.viewModel.ResultsAndFeedbackState.WhenToShowQuestionListAndAnswer);d.controlsProvider.$whenToShowResultElement.change(d.whenToShowResultChanged);d.controlsProvider.$whenToShowQuestionListAndAnswerElement.change(d.whenToShowQuestionListAndAnswerChanged);d.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(d.whenToShowResultsController.whenToShowResult!==c.WhenToShowResult.Never)};
e.onDeadlineChanged.on(this.deadlineChanged);e.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowQuestionListAndAnswer",{get:function(){return c.WhenToShowQuestionListAndAnswer[c.WhenToShowQuestionListAndAnswer.AfterEachAttempt]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"neverWhenToShowQuestionListAndAnswer",{get:function(){return c.WhenToShowQuestionListAndAnswer[c.WhenToShowQuestionListAndAnswer.Never]},
enumerable:!0,configurable:!0});a.prototype.getWhenToShowQuestionListAndAnswerOptionText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowQuestionListAndAnswerOptionAlternativeText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.removeAfterDeadlineSetNewValue=function(a){var b=this.whenToShowQuestionListAndAnswer;
this.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem.remove();b===c.WhenToShowQuestionListAndAnswer.AfterDeadline&&this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change()};Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return this.whenToShowResultsController.shouldHaveAfterAllAttemptsOption},enumerable:!0,configurable:!0});a.prototype.buildWhenToShowQuestionListAndAnswerList=function(a){var b=this;this.controlsProvider.$whenToShowQuestionListAndAnswerElement.empty();
$.each(this.viewModel.WhenToShowQuestionListAndAnswerOptions,function(a,d){d.Value===c.WhenToShowQuestionListAndAnswer.AfterEachAttempt?b.whenToShowResultsController.whenToShowResult!==c.WhenToShowResult.WhenTeacherDecides&&(1===b.externalDependenciesController.maxAttemptsAllowed?b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(d.Value,d.AlternativeText):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(d.Value,d.Text)):d.Value===c.WhenToShowQuestionListAndAnswer.AfterAllAttempts?
b.shouldHaveAfterAllAttemptsOption&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(d.Value,d.Text):d.Value===c.WhenToShowQuestionListAndAnswer.WithResults?b.whenToShowResultsController.whenToShowResult===c.WhenToShowResult.WhenTeacherDecides&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(d.Value,d.Text):d.Value===c.WhenToShowQuestionListAndAnswer.AfterDeadline?b.externalDependenciesController.hasDeadline&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(d.Value,
d.Text):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(d.Value,d.Text)});void 0!==this.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(a)[0]?this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a.toString()).change():this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(c.WhenToShowQuestionListAndAnswer.Never.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,
"whenToShowQuestionListAndAnswer",{get:function(){var a=this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val();return c.WhenToShowQuestionListAndAnswer[a]},enumerable:!0,configurable:!0});return a}();e.WhenToShowQuestionListAndAnswerController=b})(c.ResultsAndFeedbackInternals||(c.ResultsAndFeedbackInternals={}))})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){return function(){}}();c.AssessmentScaleState=e;e=function(){function b(a,b){var d=this;this.onAssessmentChanged=function(a){var b=d.$assessmentItemDropDown.find("option:selected").val(),f=b===d.settings.Constants.UseScoreItemValue;d.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(d.settings.EventNames.ToggleCriteriaWeightVisibility,{show:b!==d.settings.Constants.DoNotUseAssessmentItemValue});0===d.$assessmentItemDropDown.length&&
(f=d.settings.Permissions.IsScoreUsed);d.$maxScoreFloatingSection.toggle(f);d.onMaxScoreStateChanged();d.settings.Permissions.UseGradeBook&&d.toggleTermAndCategoryPanel();d.$sendToOneRosterCheckbox.prop("checked",!1);(b=parseInt(b))&&d.settings.AssessmentIdsToOneRosterModuleSetupIds[b]?(b=d.settings.AssessmentIdsToOneRosterModuleSetupIds[b][0],d.$sendToOneRosterContainer.show(),d.$sendToOneRosterCheckbox.val(b.toString()),$("#"+d.settings.Controls.SendToOneRosterContainer+" > label > span.ccl-checkbox-label").html(CCL.CommonFunctions.formatString(d.settings.Terms.SendToOneRosterLabel,
d.settings.OneRosterModuleSetupIdsToNames[b.toString()]))):d.$sendToOneRosterContainer.hide();if(void 0!==d.onChangeHandler&&void 0!==a)d.onChangeHandler(a)};window[a]=this;this.settings=b;$(function(){d.$assessmentItemDropDown=$("#"+d.settings.Controls.AssessmentItemDropDown);d.$maxScoreFloatingSection=$("#"+d.settings.Controls.MaxScoreFloatingSection);d.$maxScoreTextBox=$("#"+d.settings.Controls.MaxScoreTextBox);d.$assessmentRecordContainer=$("#"+d.settings.Controls.AssessmentRecordContainer);d.$termAndCategoryContainer=
$("#"+d.settings.Controls.TermAndCategoryContainer);d.$categoryDropDown=$("#"+d.settings.Controls.CategoryDropDown);d.$termDropDown=$("#"+d.settings.Controls.TermDropDown);d.$addToGradeBookCheckbox=$("#"+d.settings.Controls.AddToGradeBookCheckbox);d.$sendToOneRosterContainer=$("#"+d.settings.Controls.SendToOneRosterContainer);d.$sendToOneRosterCheckbox=$("#"+d.settings.Controls.SendToOneRosterCheckbox);if(d.settings.Permissions.UseGradeBook)d.$addToGradeBookCheckbox.on("change",function(a){return d.toggleTermAndCategoryContainer(a)});
d.$assessmentItemDropDown.on("change",function(a){return d.onAssessmentChanged(a)});if(d.$maxScoreTextBox)d.$maxScoreTextBox.on("blur input",function(){return d.onMaxScoreStateChanged()}).on("keydown",function(a){return d.onMaxScoreKeyDown(a)})})}b.prototype.onChange=function(a){this.onChangeHandler=a};b.prototype.getState=function(){var a={};a.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val(),10);a.IsScore=a.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,
10);a.MaxScore=parseInt(this.$maxScoreTextBox.val(),10);this.settings.Permissions.UseGradeBook&&(a.AddToGradeBook=this.$addToGradeBookCheckbox.is(":checked"));this.$categoryDropDown&&(a.CategoryId=parseInt(this.$categoryDropDown.val(),10));this.$termDropDown&&(a.TermId=parseInt(this.$termDropDown.val(),10));this.$sendToOneRosterCheckbox&&this.$sendToOneRosterCheckbox.is(":checked")&&(a.OneRosterModuleExtensionSetupId=this.$sendToOneRosterCheckbox.val());return a};b.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==
this.settings.Constants.DoNotUseAssessmentItemValue};b.prototype.canUseAutoMaxScore=function(){return this.settings.Permissions.CanUseAutoMaxScore};b.prototype.isValid=function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};b.prototype.updateMaxScore=function(a,b,f){var d=this;a&&0!==a.length?CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetCriteriaWeightTotal,
data:{elementId:this.settings.ElementId,courseId:this.settings.CourseId,learningObjectiveIds:a,changedCriteriaWeights:b}}).done(function(a){d.calculateMaxScore(0<a.criteriaWeightTotal,a.criteriaWeightTotal);f&&f()}):this.calculateMaxScore(!1,0)};b.prototype.onMaxScoreStateChanged=function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&($(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient),document.dispatchEvent(new CustomEvent(this.settings.EventNames.MandatoryFieldsStateChangedClient,
{detail:this.getState()})))};b.prototype.calculateMaxScore=function(a,b){a?(this.$maxScoreTextBox.val((b*this.settings.NumberOfAchievementLevels).toString()),this.$maxScoreTextBox.attr("readonly","readonly"),CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$maxScoreTextBox,this.settings.AutoMaxScoreToolTip)):(this.$maxScoreTextBox.removeAttr("readonly"),CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$maxScoreTextBox,""))};b.prototype.validateScore=function(a){if(""===
a)return!1;a=parseFloat(a.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(a)||a<this.settings.MaxScoreMinValue||a>this.settings.MaxScoreMaxValue?!1:!0};b.prototype.toggleTermAndCategoryPanel=function(){var a=this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue;a&&this.$assessmentRecordContainer.is(":visible")||(this.$assessmentRecordContainer.toggle(a),this.$addToGradeBookCheckbox.prop("checked",a).change())};b.prototype.toggleTermAndCategoryContainer=
function(a){a=$(a.target).is(":checked");this.$termAndCategoryContainer.toggle(a)};b.prototype.onMaxScoreKeyDown=function(a){CCL.CommonFunctions.preventInputIncorrectCharacters(a,[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter,CCL.CommonConstants.keyCodes.shift])};return b}();c.AssessmentScale=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){return function(){}}();c.GroupActivityState=e;e=function(){function b(a,b){var d=this;this.peerAndSelfAssessmentStateChanged=function(a,b,f){d.peerAssessmentEnabled=b;d.selfAssessmentEnabled=f;d.enabled=d.canEdit()};this.groupActivityCheckboxChanged=function(a){d.toggleGroupActivity();$(document).trigger(d.settings.Triggers.StateChanged,d.enabled)};window[a]=this;this.settings=b;$(function(){d.peerAssessmentEnabled=d.settings.PeerAssessmentEnabled;
d.selfAssessmentEnabled=d.settings.SelfAssessmentEnabled;d.$checkBox=$("#"+d.settings.Controls.CheckboxId);d.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(d.$checkBox);d.$dropDown=$("#"+d.settings.Controls.DropDownId);d.$container=$("#"+d.settings.Controls.Container);d.enabled=d.canEdit();d.toggleGroupActivity();d.$checkBox.change(d.groupActivityCheckboxChanged);if(d.settings.Events.PeerAndSelfAssessmentStateChanged)$(document).off(d.settings.Events.PeerAndSelfAssessmentStateChanged).on(d.settings.Events.PeerAndSelfAssessmentStateChanged,
d.peerAndSelfAssessmentStateChanged)})}Object.defineProperty(b.prototype,"enabled",{get:function(){return this.$checkBox.is(":checked")&&this.canEdit()},set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$checkBox.prop("disabled",!a);this.customTooltipForCheckbox.setToolTipHtml(a?"":this.tooltip);this.customTooltipForCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});b.prototype.getState=function(){var a={};a.isGroupActivity=this.$checkBox.is(":checked");
a.groupType=this.$dropDown.val();return a};Object.defineProperty(b.prototype,"tooltip",{get:function(){return this.settings.AtLeastOneAnswerExistsForElement?this.settings.Terms.AnswersExistWarning:this.settings.IsLearningPathSubElement?this.settings.Terms.IsLearningPathSubElementWarning:this.peerAssessmentEnabled||this.selfAssessmentEnabled?this.settings.Terms.GroupActivityDisabledWarning:""},enumerable:!0,configurable:!0});b.prototype.toggleGroupActivity=function(){this.$dropDown.toggle(this.$checkBox.is(":checked"))};
b.prototype.canEdit=function(){return!this.settings.AtLeastOneAnswerExistsForElement&&!this.settings.IsLearningPathSubElement&&!this.peerAssessmentEnabled&&!this.selfAssessmentEnabled};return b}();c.GroupActivity=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){var d=this;this.settings=b;window[a]=this;$(function(){d.settings.VisibilitySettings.Activation&&(d.activationControl=window[d.settings.ClientInstanceNames.ActivationControl]);d.settings.VisibilitySettings.WorkloadSetting&&(d.workloadSettingControl=window[d.settings.ClientInstanceNames.WorkloadSettingControl]);d.settingsManager=c.Manager.getInstance();d.$saveSettingsButton=$("."+d.settings.CssClasses.SaveSettingsButton);d.attemptsControl=
d.settings.VisibilitySettings.Attempts?window[d.settings.ClientInstanceNames.AttemptsControl]:null;d.resultsAndFeedbackControl=d.settings.VisibilitySettings.ResultsAndFeedback?window[d.settings.ClientInstanceNames.ResultsAndFeedbackControl]:null;d.settings.VisibilitySettings.AnonymousSubmission&&(d.$anonymousCheckBox=document.getElementById(""+d.settings.Controls.AnonymousSubmissionCheckBox));d.settings.VisibilitySettings.PlagiarismControl&&(d.$plagiarismCheckBox=document.getElementById(""+d.settings.Controls.PlagiarismCheckBox));
if(d.settings.VisibilitySettings.Mandatory&&(d.$notMandatoryCheckBox=document.getElementById(""+d.settings.Controls.NotMandatoryCheckBox),d.settings.VisibilitySettings.AnonymousSubmission)){var a=new CCL.ModernCheckbox.CustomTooltipForCheckbox($("#"+d.settings.Controls.NotMandatoryCheckBox));a.setToolTipHtml(d.settings.Terms.MandatoryTooltipForAnonymousSubmission);a.enableToolTip(d.$anonymousCheckBox.checked);d.$anonymousCheckBox.onchange=function(){var b=d.$anonymousCheckBox.checked;d.$notMandatoryCheckBox.disabled=
b;d.$notMandatoryCheckBox.checked=b;a.enableToolTip(b)}}d.settings.VisibilitySettings.Results&&(d.$resultsCheckBox=document.getElementById(""+d.settings.Controls.ResultsCheckBox));d.settings.VisibilitySettings.Deadline&&(d.deadlinePicker=window[d.settings.ClientInstanceNames.Deadline]);d.settings.VisibilitySettings.Homework&&(d.$homeworkCheckBox=document.getElementById(""+d.settings.Controls.HomeworkCheckBox));d.settings.VisibilitySettings.PeerAssessment&&(d.peerAssessment=window[d.settings.ClientInstanceNames.PeerAssessment]);
d.settings.VisibilitySettings.GroupSubmission&&(d.groupActivitySelector=window[d.settings.ClientInstanceNames.GroupActivitySelector]);d.settings.VisibilitySettings.AssessmentScale&&(d.assessmentScaleSelector=window[d.settings.ClientInstanceNames.AssessmentScaleControl]);d.settings.VisibilitySettings.DescriptionOnSidebar&&(d.$descriptionInput=document.getElementById(""+d.settings.Controls.DescriptionTextArea));d.settings.VisibilitySettings.AssignTo&&(d.assignToSettingControl=window[d.settings.ClientInstanceNames.AssignTo]);
d.initLearningObjectivesListControl();d.initSubmissionStatusControl()});$(document).on(this.settings.EventNames.MandatoryFieldsStateChanged,function(){d.settings.EventNames.ValidStateChanged&&$(document).trigger(d.settings.EventNames.ValidStateChanged,d.validateMandatoryFields())});if(this.settings.CanUseRubric)if(this.settings.IsAddMode)$(document).on(this.settings.EventNames.RubricChanged,function(a,b){d.learningObjectiveList.syncLearningObjectives(b.loIds);d.updateMaxScore(b.loIds,b.criteriaWeights)}),
$(document).on(this.settings.EventNames.UpdateMaxScore,function(a,b){d.updateMaxScore(b.loIds,b.criteriaWeights)});else $(document).on(this.settings.EventNames.LearningObjectiveChanged,function(a,b){d.updateMaxScore(b.ids);d.settingsManager.setRefreshIframeAfterSave()});$(document).on(this.settings.EventNames.MandatoryFieldsStateChanged+" "+this.settings.EventNames.ElementActivationChangedEventName+" "+this.settings.EventNames.DeadlineStateChanged+" "+this.settings.EventNames.WorkloadChanged,function(){d.settings.EventNames.ValidStateChanged&&
$(document).trigger(d.settings.EventNames.ValidStateChanged,d.validateMandatoryFields()&&d.validateElementActivation())});this.settings.VisibilitySettings.Deadline&&this.settings.IsDeadlineRequired&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment&&($(document).on(this.settings.EventNames.ElementActivationChangedEventName,function(){d.activationControl?d.deadlinePicker.mandatory(d.activationControl.isActive()||d.activationControl.hasTimeSpan()):d.deadlinePicker.mandatory(!0)}),
this.activationControl?this.deadlinePicker.mandatory(this.activationControl.isActive()||this.activationControl.hasTimeSpan()):this.deadlinePicker.mandatory(!0),this.stateChanged())}Object.defineProperty(b.prototype,"testSecurity",{get:function(){return window[this.settings.ClientInstanceNames.TestSecurity]},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"customizedScale",{get:function(){return window[this.settings.ClientInstanceNames.CustomizedScale]},enumerable:!0,configurable:!0});
b.prototype.validateMandatoryFields=function(){var a=!0;this.settings.VisibilitySettings.AssessmentScale&&(a=this.assessmentScaleSelector.isValid());var d=!0;this.settings.VisibilitySettings.WorkloadSetting&&(d=this.workloadSettingControl.isValid());return a&&d};b.prototype.validateElementActivation=function(){return this.settings.IsDeadlineRequired&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment?this.settings.VisibilitySettings.Deadline&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment?
this.activationControl?this.activationControl.isActive()||this.activationControl.hasTimeSpan()?this.deadlinePicker.isSet():!0:this.deadlinePicker.isSet():!1:!0};b.prototype.stateChanged=function(){this.settings.EventNames.ValidStateChanged&&$(document).trigger(this.settings.EventNames.ValidStateChanged,this.validateMandatoryFields()&&this.validateElementActivation())};b.prototype.hideFeedback=function(){this.settings.VisibilitySettings.Deadline&&this.deadlinePicker.mandatory(!1)};b.prototype.updateMaxScore=
function(a,d){var b=this;void 0===d&&(d="");this.assessmentScaleSelector.canUseAutoMaxScore()&&this.assessmentScaleSelector.updateMaxScore(a,d,function(){$(document).trigger(b.settings.EventNames.ValidStateChanged,b.validateMandatoryFields())})};b.prototype.initLearningObjectivesListControl=function(){this.learningObjectiveList||(this.learningObjectiveList=window[this.settings.ClientInstanceNames.LearningObjectiveList])};b.prototype.initSubmissionStatusControl=function(){this.settings.VisibilitySettings.SubmissionStatusForTeacher&&
(this.$submissionStatus=document.getElementById(""+this.settings.Controls.SubmissionStatusControl),this.$submissionStatus.value||(this.settingsManager.showFeedbackErrorMessage(this.settings.Terms.NoSubmissionStatusesFound),this.$saveSettingsButton.toggleHyperlink(!1)))};b.prototype.collectSettings=function(){var a={};if(this.settings.VisibilitySettings.Deadline){var d=this.deadlinePicker.getState();a.Deadline=d.DateTime;a.CloseAfterDeadline=d.CloseAfterDeadline}this.settings.VisibilitySettings.Homework&&
(a.Homework=this.$homeworkCheckBox.checked);if(this.settings.VisibilitySettings.AssessmentScale){d=this.assessmentScaleSelector.getState();var b=this.customizedScale?this.customizedScale.getState():null,c={AssessmentScaleId:d.AssessmentScaleId,UseScore:d.IsScore,MaxScore:d.IsScore?d.MaxScore:0,IsCustomized:!1,OneRosterModuleExtensionSetupId:d.OneRosterModuleExtensionSetupId};b&&(c.IsCustomized=b.isCustomized,c.AssessmentItems=b.assessmentItems.map(function(a){return{AssessmentItemId:a.assessmentItemId,
PercentFromAndIncl:a.percentFromAndIncl}}));a.AssessmentState=c;a.IsAddToAssessmentRecord=d.AddToGradeBook;a.TermId=d.TermId;a.CategoryId=d.CategoryId}this.settings.VisibilitySettings.PeerAssessment&&(this.peerAssessment.activated&&0<this.peerAssessment.peersToAssessCount&&(a.PeersToAssessCount=this.peerAssessment.peersToAssessCount,a.EnableAnonymousPeerAssessment=this.peerAssessment.anonymousPeerAssessmentActivated),a.IsSelfAssessmentActivated=this.peerAssessment.selfAssessmentActivated);this.settings.VisibilitySettings.TestSecurity&&
(a.TestSecurityState=this.testSecurity.getState());this.settings.VisibilitySettings.Attempts&&(a.AttemptsState=this.attemptsControl.getState());this.settings.VisibilitySettings.ResultsAndFeedback&&(a.ResultsAndFeedbackState=this.resultsAndFeedbackControl.getState());this.settings.VisibilitySettings.SubmissionStatusForTeacher&&(a.SubmissionStatusId=parseInt(this.$submissionStatus.value,10));this.settings.VisibilitySettings.GroupSubmission&&(d=this.groupActivitySelector.getState(),a.IsGroupActivity=
d.isGroupActivity,a.SubmissionGroupType=d.groupType);this.settings.VisibilitySettings.AnonymousSubmission&&(a.IsAnonymous=this.$anonymousCheckBox.checked);this.settings.VisibilitySettings.PlagiarismControl&&(a.IsCheckPlagiarism=this.$plagiarismCheckBox.checked);this.settings.VisibilitySettings.Mandatory&&(a.IsNotMandatory=this.$notMandatoryCheckBox.checked);this.activationControl&&(d=this.activationControl.getActivationTimeSpanState(),a.Active=d.isActive,a.UseActivationTimespan=d.useActivationTimeSpan,
a.UseActivationTimespan&&(a.ActivationTimespanFrom=d.fromState.dateAsString,a.ActivationTimespanTo=d.toState.dateAsString));this.settings.VisibilitySettings.LearningObjectiveListDialog&&(a.LearningObjectivesIds=this.learningObjectiveList.getLearningObjectiveIds());this.settings.VisibilitySettings.Results&&(a.IsAssessmentVisible=this.$resultsCheckBox.checked);this.settings.VisibilitySettings.WorkloadSetting&&(a.Workload=this.workloadSettingControl.getWorkloadEnabled(),a.WorkloadEstimation=this.workloadSettingControl.getWorkloadEstimation());
this.settings.VisibilitySettings.DescriptionOnSidebar&&(a.DescriptionOnSidebar=this.$descriptionInput.value);this.settings.VisibilitySettings.AssignTo&&(a.AssignTo=this.assignToSettingControl.getPickerResult());return a};b.prototype.validateControls=function(){return this.activationControl?this.activationControl.validateControl():!0};return b}();c.Edit=e})(c.Settings||(c.Settings={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(a){a[a.Hidden=0]="Hidden";a[a.Summary=1]="Summary";a[a.Read=2]="Read";a[a.OverlayEdit=3]="OverlayEdit"})(c.LearningToolElementSettingsView||(c.LearningToolElementSettingsView={}));var e=c.LearningToolElementSettingsView;(function(){return function(){}})();var b=function(){function a(d){var b=this;this.viewAttributesMap={};window[a.clientInstanceName]=this;this.settings=d;$(function(){b.$body=$("body");b.$mainContainer=$("#"+b.settings.Controls.MainContainer);
b.$contentFrameContainer=$("#"+b.settings.Controls.ContentFrame);b.$settingsControlContainer=$("#"+b.settings.Controls.SettingsControl);b.$editSettingsContainer=$("#"+b.settings.Controls.EditSettingsContainer);b.$readSettingsContainer=$("#"+b.settings.Controls.ReadSettingsContainer);b.$background=$("#"+b.settings.Controls.Background);!b.settings.IsAddMode&&b.$contentFrameContainer.get(0)&&(b.iframe=b.$contentFrameContainer.get(0).contentWindow);b.viewAttributesMap=(a={},a[e.Hidden]={isDirty:!0,cssClass:b.settings.CssClasses.Views.Hidden},
a[e.Summary]={$container:b.$readSettingsContainer,isDirty:!1,cssClass:b.settings.CssClasses.Views.Summary,loadViewUrl:b.settings.Urls.ReadSettings,afterLoadFunction:b.afterLoadSummarySettings},a[e.Read]={$container:b.$readSettingsContainer,isDirty:!0,cssClass:b.settings.CssClasses.Views.OverlayRead,loadViewUrl:b.settings.Urls.ReadSettings,afterLoadFunction:b.afterLoadReadSettings},a[e.OverlayEdit]={$container:b.$editSettingsContainer,isDirty:!0,cssClass:b.settings.CssClasses.Views.OverlayEdit,loadViewUrl:b.settings.Urls.EditSettings,
afterLoadFunction:b.afterLoadEditSettings},a);b.attachEventListeners();b.editFocusTracker=new CCL.FocusTracker(b.$settingsControlContainer);b.settings.IsHidden||(b.settings.IsAddMode?b.switchView(e.OverlayEdit,b.settings.CollapsedSettingView):b.settings.CollapsedSettingView?b.switchView(e.Summary,b.settings.CollapsedSettingView):b.switchView(e.Read,b.settings.CollapsedSettingView));var a})}a.getInstance=function(){return window[a.clientInstanceName]};a.prototype.afterLoadSummarySettings=function(){this.stopTrackingFocus()};
a.prototype.afterLoadReadSettings=function(){this.stopTrackingFocus();this.setFocusAndHighlight()};a.prototype.refreshExtensionFrame=function(){this.iframe&&CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.studentWasAssessed))};a.prototype.notifyExtensionSettingsUpdated=function(a){this.iframe&&(a?CCL.CommonFunctions.makePostMessageCallWithData(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged),
a):CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged)))};a.prototype.refreshTreeMenu=function(){var a=itslTop;a&&a.reloadFolder&&!this.settings.IsLearningPathSubElement&&a.reloadFolder()};a.prototype.refreshPageFunctionsMenu=function(a){window[this.settings.ClientInstanceNames.ViewLearningToolElementPage].changePageFunctionsState(a)};a.prototype.showFeedbackErrorMessage=function(a,b){void 0===
b&&(b=!1);CCL.ErrorFeedback.showFeedback(this.$settingsControlContainer,a,null,b)};a.prototype.hideFeedback=function(){var a=this.getSettingsEditor();null!=a&&a.hideFeedback();CCL.ErrorFeedback.hideFeedback(this.$settingsControlContainer)};a.prototype.getSettingsEditor=function(){null==this.settingsEditor&&(this.settingsEditor=window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName]);return this.settingsEditor};a.prototype.setRefreshIframeAfterSave=function(){this.settings.NeedRefreshIframeAfterSave=
!0};a.prototype.attachEventListeners=function(){var a=this,b=$(window);CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.extensionContentChanged,function(b){b.expandRead?a.switchView(e.Read,!0):a.switchView(a.currentView,!0)});CCL.CommonFunctions.attachPostMessageEventListener(b,[CCL.CommonWindowMessages.MessageNames.hideSettings,CCL.CommonWindowMessages.MessageNames.enableFullScreen],function(){a.switchView(e.Hidden)});CCL.CommonFunctions.attachPostMessageEventListener(b,
[CCL.CommonWindowMessages.MessageNames.showSettings,CCL.CommonWindowMessages.MessageNames.disableFullScreen],function(b){a.currentView===e.Hidden&&a.switchView(a.previousView,!b||b.ForceReload)});CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.reloadParentIframe,function(){window.location.reload(!0)});this.settings.IsAddMode&&CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.deepLinkContentReceived,function(b){b&&
b.extendedData&&a.switchView(e.OverlayEdit)});this.$body.on("click","."+this.settings.CssClasses.ChangeOptionsLink,function(){a.switchView(e.OverlayEdit,!0);return!1}).on("click","."+this.settings.CssClasses.SaveSettingsButton,function(){a.$saveSettingsButton||(a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton));a.$saveSettingsButton.getIfHyperLinkEnabled()&&a.save();return!1}).on("click","."+this.settings.CssClasses.SettingsDialogExpandButton,function(){a.isMobileView()||(a.switchView(e.Read),
CCL.CommonFunctions.safeAjaxPost({url:a.settings.Urls.CollapsedSettings}))}).on("click","."+this.settings.CssClasses.Views.Summary+" ."+this.settings.CssClasses.SectionHeaderIconLink,function(b){a.onSummaryIconClick($(b.currentTarget))}).on("click","."+this.settings.CssClasses.ShowMoreOptionsLink,function(){a.toggleMobileOptions(!a.isMobileOptionsExpanded())}).on("keydown",function(b){switch(b.which){case CCL.CommonConstants.keyCodes.escape:a.currentView!==e.Read&&a.currentView!==e.OverlayEdit||a.cancelButtonClick()}});
if(!this.settings.IsAddMode)this.$body.on("click","."+this.settings.CssClasses.CancelEditSettingsButton,function(){return a.cancelButtonClick()}).on("click","."+this.settings.CssClasses.SettingsDialogCollapseButton,function(){a.switchView(e.Summary);CCL.CommonFunctions.safeAjaxPost({url:a.settings.Urls.CollapsedSettings})});this.$background.click(function(){a.hideFeedback();a.cancelButtonClick()});if(this.settings.IsDeadlineRequired)$(document).on(this.settings.ValidStateChanged,function(b,d){a.$saveSettingsButton||
(a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton));a.$saveSettingsButton.toggleHyperlink(d)})};a.prototype.onSummaryIconClick=function(a){this.isMobileView()||(a=parseInt(a.closest("."+this.settings.CssClasses.SettingSection).data(this.settings.LearningToolElementSettingTypeDataAttribute),10),this.switchToExpandedView(a))};a.prototype.afterLoadEditSettings=function(){var a=this;if(this.settings.IsDeadlineRequired&&!this.settings.IsAddMode)$(document).on(this.settings.ValidStateChanged,
function(b,d){a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton);a.$saveSettingsButton.toggleHyperlink(d)});else this.$saveSettingsButton=$("."+this.settings.CssClasses.SaveSettingsButton);this.$cancelEdittingSettingsButton=$("."+this.settings.CssClasses.CancelEditSettingsButton);this.stopTrackingFocus();this.settings.IsAddMode||this.editFocusTracker.startTrackFocus();this.setFocusAndHighlight();new CCL.ButtonLoadingIndicator("."+this.settings.CssClasses.SettingsWrapper+" ."+this.settings.CssClasses.SaveSettingsButton,
this.settings.CssClasses.ButtonInProgress,null,100)};a.prototype.setFocusAndHighlight=function(){var a=this;setTimeout(function(){var b=a.viewAttributesMap[a.currentView].$container.find("."+a.settings.CssClasses.SettingSection);b.removeClass(a.settings.CssClasses.SettingsSectionHighlight);b=a.getSectionToHighlight(b);a.controlToHighlight=0;if(b){b.addClass(a.settings.CssClasses.SettingsSectionHighlight);var d=a.getFirstElementToFocusInContainer(b)}else a.settings.IsAddMode||(d=a.getFirstElementToFocusInContainer(a.getViewContainer(a.currentView)));
a.scrollToElementIfNeed(b).done(function(){d&&!d.prop("disabled")&&d.focus()})},1)};a.prototype.getFirstElementToFocusInContainer=function(a){return a.find("input, a, select").first()};a.prototype.getSectionToHighlight=function(a){var b=this,d=void 0;$.each(a,function(a,f){a=$(f);return b.controlToHighlight===parseInt(a.data(b.settings.LearningToolElementSettingTypeDataAttribute),10)?(d=a,!1):!0});return d};a.prototype.hideAllViews=function(){this.$editSettingsContainer.hide();this.$readSettingsContainer.hide()};
a.prototype.showOverlayDialogIfNeeds=function(a){this.$background.toggle(a===e.OverlayEdit)};a.prototype.switchView=function(a,b){var d=this;void 0===b&&(b=!1);if(a!==this.currentView||b){this.toggleToolTipForCurrentView(!1);var f=this.viewAttributesMap[a];b&&(f.isDirty=!0);f.isDirty&&f.loadViewUrl?$.get(f.loadViewUrl).done(function(b){f.$container.html(b);d.refreshViewUi(a,f);d.toggleToolTipForCurrentView(!0)}).fail(function(){d.alertError()}):(this.refreshViewUi(a,f),this.toggleToolTipForCurrentView(!0))}};
a.prototype.toggleToolTipForCurrentView=function(a){this.currentView===e.Summary&&CCL.UnobtrusiveCustomTooltipManager.enableTooltipOnTarget($("."+this.settings.CssClasses.SettingSection),a)};a.prototype.switchToExpandedView=function(a){this.controlToHighlight=isNaN(a)?0:a;this.switchView(this.settings.CanEdit?e.OverlayEdit:e.Read,this.settings.CanEdit)};a.prototype.alertError=function(a){void 0===a&&(a="");CCL.CommonFunctions.jAlertAjaxError(a?a:this.settings.Terms.SomethingWentWrong,this.settings.Terms.ErrorOccured,
this.settings.Terms.Ok,!1)};a.prototype.refreshViewUi=function(a,b){this.$mainContainer.removeClass().addClass(b.cssClass);this.previousView=this.currentView;this.currentView=a;this.hideAllViews();this.showOverlayDialogIfNeeds(a);(this.afterLoadFunction=b.afterLoadFunction)&&this.afterLoadFunction();this.toggleMobileOptions(this.isMobileOptionsExpanded());b.isDirty=!1;b.$container.show();a=0<this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.ShowOnlyIfMobileOptionsExpanded).length;
this.getShowMoreLinkForCurrentView().toggle(a)};a.prototype.enableSaveCancelButtons=function(a){this.$cancelEdittingSettingsButton.toggleHyperlink(a);this.$saveSettingsButton.toggleHyperlink(a);this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].lockSaveButton(!a)};a.prototype.enableSaveCancelButtonsAndToggleSpinner=function(a){this.enableSaveCancelButtons(a);a&&$(this.$saveSettingsButton).trigger(CCL.ButtonLoadingIndicator.eventRemoveLoadingIndicator)};
a.prototype.cancelButtonClick=function(){this.settings.IsAddMode||(this.hideFeedback(),this.switchView(this.getViewToSwitchBack()));return!1};a.prototype.isMobileView=function(){return $(window).width()<=CCL.CommonConstants.mediaScreenSizes.iPadPortraitMode};a.prototype.getViewToSwitchBack=function(){switch(this.currentView){case e.Read:return e.Summary;case e.OverlayEdit:return this.isMobileView()?e.Read:this.previousView;default:throw"Unsupported view transition";}};a.prototype.save=function(a){var b=
this;void 0===a&&(a=!1);this.hideFeedback();this.enableSaveCancelButtonsAndToggleSpinner(!1);var d=this.collectContentAndSettings(a);window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName].validateControls()?CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.SaveSettings,data:d}).done(function(a){a.Success?b.settings.IsAddMode&&a.ClientScriptToCompleteSaving?eval(a.ClientScriptToCompleteSaving):a.ClientScriptToCompleteSavingExtended?(a=eval(a.ClientScriptToCompleteSavingExtended),
$.when(a).then(function(a){!0===a?b.save(a):b.enableSaveCancelButtonsAndToggleSpinner(!0)})):a.PageUrlToRedirect?window.location.replace(a.PageUrlToRedirect):(b.switchView(b.getViewToSwitchBack(),!0),(b.settings.NeedRefreshIframeAfterSave||a.RefreshExtensionIframe)&&b.refreshExtensionFrame(),b.settings.SettingsUpdateNotification&&b.notifyExtensionSettingsUpdated(d.Settings.NotificationData),b.refreshTreeMenu(),b.refreshPageFunctionsMenu(a.EnableElementActivationPageFeatures)):(b.showFeedbackErrorMessage(a.Errors.join("<br />"),
!0),b.enableSaveCancelButtonsAndToggleSpinner(!0))}).fail(function(){b.alertError();b.enableSaveCancelButtonsAndToggleSpinner(!0)}):(this.enableSaveCancelButtonsAndToggleSpinner(!0),this.showFeedbackErrorMessage(this.settings.Terms.YourInputIsInvalid,!0),this.scrollToElementIfNeed($("."+this.settings.CssClasses.InvalidInput+":first")))};a.prototype.collectContentAndSettings=function(a){var b=window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName],d={};d.ElementId=this.settings.ElementId;
d.IsAddMode=this.settings.IsAddMode;d.Settings=b.collectSettings();d.Settings.IsLearningObjectivesRemovalConfirmed=a;this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&(d.Content=window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].collectContent());return d};a.prototype.toggleMobileOptions=function(a){var b=a?this.settings.Terms.ShowLess:this.settings.Terms.ShowMore;this.getShowMoreLinkForCurrentView().children("span").text(b);this.getViewContainer(this.currentView).toggleClass(this.settings.CssClasses.ExpandMobileOptions,
a)};a.prototype.isMobileOptionsExpanded=function(){var a=this.getViewContainer(this.currentView);return a&&a.hasClass(this.settings.CssClasses.ExpandMobileOptions)};a.prototype.getShowMoreLinkForCurrentView=function(){var a=this.getViewContainer(this.currentView);return a?a.find("."+this.settings.CssClasses.ShowMoreOptionsLink):null};a.prototype.getViewContainer=function(a){return this.viewAttributesMap[a].$container};a.prototype.stopTrackingFocus=function(){this.editFocusTracker.stopTrackFocus()};
a.prototype.scrollToElementIfNeed=function(a){if(!a)return $.when();if(this.settings.IsAddMode)return CCL.CommonFunctions.isElementFullyShownInWindow(a)||window.scrollTo(a.offset().top,0),$.when();var b=this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.OverlayDialogInnerContainer);return CCL.CommonFunctions.isElementFullyShownInContainer(a,b)?$.when():b.animate({scrollTop:a.offset().top},500).promise()};a.prototype.refreshReadView=function(){this.switchView(this.currentView,
!0)};a.clientInstanceName="LearningToolElementSettingsManager";return a}();c.Manager=b})(c.Settings||(c.Settings={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(){}}();c.ManageLearnerDefinedGroupState=g;g=function(){function c(b,a){var d=this;this.renderItem=function(a,b){return $("<li>").append(b.metadata?'<a>\n                            <img alt="" class="'+d.settings.CssClasses.AutoCompleteItem.Image+'" src="'+b.metadata.ImageUrl+'" />\n                            <span class="'+d.settings.CssClasses.AutoCompleteItem.Info+'">\n                                <span>'+b.label+"</span>\n                                "+
(""!==b.metadata.Organization?'<span class="'+d.settings.CssClasses.AutoCompleteItem.Organization+'">'+b.metadata.Organization+"</span>":"")+"\n                            </span>\n                       </a>":'<span class="'+d.settings.CssClasses.AutoCompleteItem.NoMatches+'">'+d.settings.Terms.NoMatches+"</span>").addClass(d.settings.CssClasses.AutoCompleteItem.Item).appendTo(a)};this.participantsAutocomplete=function(a,b){d.participantsAutocompleteRequest&&d.participantsAutocompleteRequest.abort&&
d.participantsAutocompleteRequest.abort();var f=d.getAddedPersonIds();d.participantsAutocompleteRequest=$.getJSON(d.settings.WebMethods.FindParticipants.replace("{elementId}",d.settings.ElementId.toString()).replace("{collaborationId}",d.settings.CollaborationId.toString()),{courseId:d.settings.CourseId,search:a.term}).done(function(a){a=a.filter(function(a){return 0===f.filter(function(b){return b===a.PersonId}).length});a.length?b($.map(a,function(a){return{label:a.Name,value:a.Name,metadata:a}})):
b([{value:b.term}])}).always(function(){d.participantsAutocompleteRequest=void 0})};this.onRemoveClick=function(a){$(a.target).closest("."+d.settings.CssClasses.GroupList.UserContainer).remove()};window[b]=this;this.settings=a;this.$membersContainer=$("#"+this.settings.Controls.MembersContainerId);this.$groupContentContainer=$("#"+this.settings.Controls.GroupContentContainerClientId);$(function(){d.addPerson(d.settings.CurrentPerson,!0);d.settings.GroupMembers&&d.settings.GroupMembers.length&&d.settings.GroupMembers.forEach(function(a){d.addPerson(a,
!1)})});$(document).on(this.settings.Events.OnSelectUser,function(a,b){b&&(a={},a.Name=b.Name,a.ImageUrl=b.ImageUrl,a.PersonId=b.PersonId,d.addPerson(a,!1))})}c.prototype.addPerson=function(b,a){this.$membersContainer.append(this.getPersonHtml(b,a))};c.prototype.getPersonHtml=function(b,a){var d=$('<div class="'+this.settings.CssClasses.GroupList.UserContainer+'"></div>'),f=$('<div class="'+this.settings.CssClasses.GroupList.ImageContainer+'"><img alt="" src="'+b.ImageUrl+'" class="'+this.settings.CssClasses.GroupList.Image+
'" /></div>'),c=$('<div class="'+this.settings.CssClasses.GroupList.NameContainer+'"><span>'+b.Name+"</span></div>");d.data("meta",b).append(f).append(c);b=$('<div class="'+this.settings.CssClasses.GroupList.RemoveLinkContainer+'"></div>');a||(a=$('<a href="#">&times;</a>'),a.click(this.onRemoveClick),b.append(a));d.append(b);return d};c.prototype.getAddedPersonInfos=function(){return $.makeArray(this.$membersContainer.find("div."+this.settings.CssClasses.GroupList.UserContainer).map(function(b,a){return $(a).data("meta")}))};
c.prototype.getAddedPersonIds=function(){return this.getAddedPersonInfos().map(function(b){return b.PersonId})};c.prototype.getState=function(){return{personIds:this.getAddedPersonIds()}};return c}();c.ManageLearnerDefinedGroup=g})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
var BaseMetadata=function(){return function(c,g,k){this.name=c;this.sourceType=g;this.mimeType=k}}(),LocalFileInputHandle=function(){function c(c){this.fileInput=c}c.prototype.get=function(){return this.fileInput};return c}(),LocalFileHandle=function(){function c(c){this.file=c}c.prototype.get=function(){return this.file};return c}(),ExternalSourceFileHandle=function(){function c(c,k,e,b){this.url=c;this.id=k;this.canBeCopied=e;this.canBeShared=b}c.prototype.get=function(){return objectState.isNullOrUndefined(this.id)?
this.url:{url:this.url,id:this.id,canBeCopied:null==this.canBeCopied?!0:this.canBeCopied,canBeShared:null==this.canBeShared?!0:this.canBeShared}};return c}(),SourceType;(function(c){c[c.Dropbox=1]="Dropbox";c[c.Google=2]="Google";c[c.OneDriveForBusiness=3]="OneDriveForBusiness";c[c.Local=4]="Local";c[c.OneDrivePersonal=5]="OneDrivePersonal";c[c.WebDav=6]="WebDav";c[c.Ziggeo=7]="Ziggeo"})(SourceType||(SourceType={}));
(function(c){c.isOneDrive=function(g){return g===c.OneDrivePersonal||g===c.OneDriveForBusiness};c.isCloud=function(g){return g===c.Dropbox||g===c.Google||c.isOneDrive(g)||g===c.WebDav||g===c.Ziggeo}})(SourceType||(SourceType={}));
var FileInOneDriveHandle=function(){function c(c){this.postMessageFile=c}c.prototype.get=function(){return objectState.isNullOrUndefined(this.postMessageFile.id)?this.postMessageFile.url:{url:this.postMessageFile.url,viewUrl:this.postMessageFile.viewUrl,downloadUrl:this.postMessageFile.downloadUrl,id:this.postMessageFile.id,canBeCopied:null==this.postMessageFile.canBeCopied?!0:this.postMessageFile.canBeCopied,canBeShared:null==this.postMessageFile.canBeShared?!0:this.postMessageFile.canBeShared}};
return c}(),PickerFileResult=function(){function c(c,k,e,b,a,d){this.fileHandle=c;this.name=k;this.size=e;this.sourceType=b;this.relativePath=a;this.mimeType=d}c.prototype.getFileHandle=function(){return this.fileHandle.get()};c.createExternalSourcePickerFileResult=function(g,k,e,b,a,d,f,h){return new c(new ExternalSourceFileHandle(g,d,f,h),k,e,b,null,a)};c.createLocalPickerFileResultWithInput=function(g,k){return new c(new LocalFileInputHandle(g),k,null,SourceType.Local)};c.createLocalPickerFileResult=
function(g){return new c(new LocalFileHandle(g),g.name,g.size,SourceType.Local,null,g.type)};c.createFolderPickerFileResultWithRelativePath=function(g,k){return new c(new LocalFileHandle(g),g.name,g.size,SourceType.Local,k,g.type)};c.createPickerFileResultWithFileName=function(g){return new c(new LocalFileHandle(null),g,0,SourceType.Local,null,null)};c.createOneDrivePickerFileResult=function(g){return new c(new FileInOneDriveHandle(g),g.name,g.size,g.sourceType,null,g.mimeType)};return c}(),UploadMetadata=
function(c){function g(g,e,b,a,d,f,h,l,m){c.call(this,e,b,f);this.id=g;this.name=e;this.sourceType=b;this.signature=a;this.signedFileRepoId=d;this.mimeType=f;this.isTemplate=h;this.customId=l;this.originalFileId=m}__extends(g,c);g.castMetadataObjectToUploadMetadata=function(c){return new g(c.id,c.name,c.sourceType,c.signature,c.signedFileRepoId,c.mimeType,!1,c.customId,c.originalFileId)};g.updateName=function(c,e){c.name=e};g.setTemplate=function(c,e){c.isTemplate=e};g.create=function(c,e){var b=
c.name,a=c.sourceType,d=c.mimeType,f=null,h=null,l=null,m=null;c=c.getFileHandle().id;e&&(e.fileGuid&&(f=e.fileGuid),e.signedGuid&&(h=e.signedGuid),e.signedFileRepoId&&(l=e.signedFileRepoId),e.mimeType&&(d=e.mimeType),e.customId&&(m=e.customId));return new g(f,b,a,h,l,d,!1,m,c)};return g}(BaseMetadata);
(function(c){(function(g){var k=c.CheckboxStateMachine.State,e=function(){function b(a,b,f,h,e,g,k,p){var d=this;void 0===p&&(p=void 0);this.courseId=a;this.eventId=b;this.utilityBase=f;this.markupBuilderBase=h;this.callbacks=e;this.addResourceDialogTitle=g;this.ajaxClientBase=k;this.mainContainer=p;this.fileUploadInProgress=this.shouldFileBeAttachedToEventImmediately=!1;this.onAddResourceMenuItemLinkClick=function(a){switch(parseInt($(a.currentTarget).data(d.utilityBase.dataAttributeNames.ElementExternalSource),
10)){case c.AddResourceMenu.ElementExternalSourceType.Course:d.addFromCourse();break;case c.AddResourceMenu.ElementExternalSourceType.Library:d.addFromLibrary();break;case c.AddResourceMenu.ElementExternalSourceType.Computer:d.fileUploadInProgress||d.addFromComputer()}};this.afterOkClickCallback=function(a){a&&(a.forEach(function(a,b){a!==c.CheckboxStateMachine.State.AttachedByUser&&a!==c.CheckboxStateMachine.State.DetachedByUser||d.currentElementStates.set(b,a)}),a=d.getElementIdsToAttach(),d.saveElementStates(),
d.callbacks.afterAttachElements&&0<a.length&&d.callbacks.afterAttachElements(a))};this.currentElementStates=new Map;this.checkboxStateMachine=new c.CheckboxStateMachine.Machine;CCL.CommonFunctions.attachPostMessageEventListener($(window),this.utilityBase.postMessageNames.SendElementIdToCourseFeature,function(a){d.attachElement(a.elementId)})}b.prototype.attachElement=function(a){this.currentElementStates.set(a,k.AttachedByUser);this.saveElementStates();this.callbacks.afterAttachElements&&this.callbacks.afterAttachElements(this.getElementIdsToAttach())};
b.prototype.removeElement=function(a){var b=this.utilityBase.getElementId(a);this.updateElementState(b);this.markupBuilderBase.removeElement(a,this.callbacks.afterDetachElements)};b.prototype.removeElementById=function(a){this.updateElementState(a);this.markupBuilderBase.removeElement(this.utilityBase.getElementByElementId(a),this.callbacks.afterDetachElements)};b.prototype.toggleElementActivation=function(a){this.utilityBase.toggleElementActivation(a)};b.prototype.addFakeItemToElementSection=function(a){this.markupBuilderBase.addFakeItemIntoElementSection(a,
this.mainContainer)};b.prototype.removeFakeItemFromElementSection=function(){this.markupBuilderBase.removeFakeItemFromElementSection()};b.prototype.onFileSelectedImpl=function(a){var b=this;this.toggleAddFromComputerOption(!1);setTimeout(function(){b.fileUploadInProgress&&b.addFakeItemToElementSection(a[0].name)},g.CalendarClientConstants.uploadingFileTimeoutMilliseconds)};b.prototype.onFileUploadSuccessImpl=function(a){var b=this;this.fileUploadInProgress&&(this.addFileRequest=this.ajaxClientBase.createNewFileElementForEvent(this.courseId,
this.eventId,a,this.shouldFileBeAttachedToEventImmediately),this.addFileRequest.done(function(a){b.removeFakeItemFromElementSection();b.toggleAddFromComputerOption(!0);if(a.Success&&(b.attachElement(a.ElementId),b.callbacks.onElementListChanged))b.callbacks.onElementListChanged();b.addFileRequest=void 0}))};b.prototype.onFileUploadFailedImpl=function(a,b){this.cleanRequestsAndOptions();CCL.CommonFunctions.jAjaxConfirm(b,this.utilityBase.terms.FailedFileUploadChoiceDialogTitle,this.utilityBase.terms.FailedFileUploadChoiceDialogUploadNewFile,
this.utilityBase.terms.FailedFileUploadChoiceDialogCancel,function(a){a&&$("#"+Components.ComponentName.localPicker).click()});this.markupBuilderBase.removeFakeItemFromElementSection();if(this.callbacks.onErrorMessageShown)this.callbacks.onErrorMessageShown()};b.prototype.cleanRequestsAndOptions=function(){this.addFileRequest&&(this.addFileRequest.abort(),this.addFileRequest=void 0);this.toggleAddFromComputerOption(!0)};b.prototype.addFromCourse=function(){var a={elementStates:c.MapUtils.makeCopy(this.currentElementStates),
elementType:c.ElementLinkDialog.ContentElementType.All,header:this.addResourceDialogTitle,afterOkClickCallback:this.afterOkClickCallback,showAll:!1,allowFolderSelection:!0,openerPage:c.ElementLinkDialog.ElementsPopupOpener.CalendarEvent,relatedEntityId:this.eventId,maxCountOfAddedElements:this.utilityBase.constants.MaxCountOfAddedElements};c.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,this.ajaxParams)};b.prototype.addFromLibrary=function(){window[this.utilityBase.clientInstanceNamesBase.LibraryBrowserDialog].browseLibrary({CourseId:this.courseId})};
b.prototype.addFromComputer=function(){$("#"+Components.ComponentName.localPicker).click()};b.prototype.getElementIdsToAttach=function(){var a=this,b=[];this.currentElementStates.forEach(function(d,c){a.checkboxStateMachine.isElementChecked(d)&&b.push(c)});return b};b.prototype.updateElementState=function(a){var b=this.currentElementStates.get(a);b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,b);this.currentElementStates.set(a,b);this.saveElementStates()};b.prototype.toggleAddFromComputerOption=
function(a){this.fileUploadInProgress=!a;if(this.callbacks.onUploadFromComputer)this.callbacks.onUploadFromComputer(this.fileUploadInProgress)};return b}();g.AddEditEventElementLinkManagerBase=e})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(k){var e=function(b){function a(d,f,h,e,g,k,p){b.call(this,d,f,h,e,g,h.settings.Terms.AddResourceDialogTitle,k);this.utility=h;this.markupBuilder=e;if(!g.afterAttachElements)throw Error("Argument afterAttachElements is undefined!");this.loadElementStates();this.ajaxParams={locationId:d,locationType:c.AddResourceMenu.ElementExternalSourceType.Course};a.instance=window[p]=this}__extends(a,b);a.onFileUploadSuccess=function(b){a.instance.onFileUploadSuccessImpl(b)};
a.onFileUploadFailed=function(b,f){a.instance.onFileUploadFailedImpl(b,f)};a.onFileSelected=function(b){a.instance.onFileSelectedImpl(b)};a.prototype.cleanAndRemoveElementStates=function(){var a=this,b=[];this.currentElementStates.forEach(function(d,f){a.checkboxStateMachine.isElementChecked(d)&&b.push(f)});for(var c=0;c<b.length;c++)this.removeElementById(b[c]);this.saveElementStates()};a.prototype.refreshElementList=function(){this.callbacks.afterAttachElements(this.getElementIdsToAttach())};a.prototype.loadElementStates=
function(){var a=this.utility.controls.elementIdsWithStatesHidden.val();0<this.utility.controls.elementIdsWithStatesHidden.length&&a&&(this.currentElementStates=c.MapUtils.jsonStringToMap(a,c.MapUtils.numberKeyConverter))};a.prototype.saveElementStates=function(){this.utility.controls.elementIdsWithStatesHidden.val(c.MapUtils.mapToJsonString(this.currentElementStates)).trigger("change")};return a}(g.AddEditEventElementLinkManagerBase);k.ElementLinkManager=e})(g.EditEvent||(g.EditEvent={}))})(c.Calendar||
(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(a){function b(b,d,c,e,g,k){var f=this;a.call(this,b,void 0,d,c,e,d.settings.terms.AddResourceDialogTitle,g,k.mainContainer);this.utility=d;this.markupBuilder=c;this.ajaxClient=g;this.dialog=k;this.setToggleElementInDialog=function(a){a.setToggleElement($("#popup_overlay, #popup_container"))};this.callbacks.onErrorMessageShown=function(){return f.setToggleElementInDialog(k)}}__extends(b,a);b.prototype.getElementIdsHidden=function(){return $(this.utility.dataAttributes.addEventDialogAttachedElementsHidden)};
b.prototype.emptyElementIdsHidden=function(){this.getElementIdsHidden().prop("value","[]")};return b}(c.AddEditEventElementLinkManagerBase);e.ElementLinkManagerDialogBase=b})(g.ElementLink||(g.ElementLink={}))})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(g){(function(e){var b=c.CheckboxStateMachine.State,a=function(a){function d(b,d,f,c,e){var h=this;a.call(this,void 0,b,f,e,d,c);this.refreshElementList=function(a){h.ajaxClient.getElementListMarkupForEventIds(0,h.utility.controls.addEventStartDateHiddenField.value,h.getCurrentCourseId(),a,h.markupBuilder.getCurrentFakeElementTitle()).done(function(a){h.markupBuilder.rebuildElementListMarkup(h.mainContainer,a);h.mainContainer.find("."+h.utility.settings.cssClasses.ElementList).on("click",
"."+h.utility.settings.cssClasses.ElementListItemRemove,function(a){h.removeElement($(a.target).closest(h.utility.selectors.elementListItem))})})};this.eventTypeParser=new g.EventTypeParser(b);this.callbacks.afterAttachElements=this.refreshElementList}__extends(d,a);d.prototype.setParameters=function(a,b){this.ajaxParams={locationId:a,locationType:c.AddResourceMenu.ElementExternalSourceType.Course};this.courseId=a;this.elementListHidden=b;this.loadElementStates()};d.prototype.generateElementSections=
function(a,b){var d=this.mainContainer.find("."+this.utility.settings.cssClasses.ContextDialogContent),f=this.mainContainer.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);0<f.length?(f.empty(),this.emptyElementIdsHidden(),d.find("."+this.utility.settings.cssClasses.AddElementButton).remove()):b&&(f=this.markupBuilder.generateElementListAppendTarget(),d.append(f).append(this.markupBuilder.generateAttachedElementsHidden()));b&&(this.markupBuilder.renderAddButtonWithElementSections(d,
{courseId:a,enableElementLinkManagement:!0,elementListMarkups:{Resources:void 0,ResourceCount:0,Homework:void 0,HomeworkCount:0}},g.EventDetailsType.ContextDialog),this.setParameters(a,this.getElementIdsHidden()))};d.prototype.onFullScreenClosed=function(){this.refreshElementList(this.getElementIdsToAttach())};d.prototype.loadElementStates=function(){var a=this;this.currentElementStates=new Map;var d=this.elementListHidden.val();0<this.elementListHidden.length&&d&&JSON.parse(d).forEach(function(d){a.currentElementStates.set(d,
b.AttachedByUser)})};d.prototype.saveElementStates=function(){var a=[];this.currentElementStates.forEach(function(d,f){d===b.AttachedByUser&&a.push(f)});this.elementListHidden.val(JSON.stringify(a))};d.prototype.setCalendarEventElementLinkManager=function(){e.ElementLinkManagerDialogBase.currentManager=window[this.utility.settings.constants.CalendarEventElementLinkManager]=this};d.prototype.getCurrentCourseId=function(){return this.eventTypeParser.parseCourseId(this.utility.controls.addEventCalendarsDropdown.val())};
return d}(e.ElementLinkManagerDialogBase);e.AddEventElementLinkManager=a})(g.ElementLink||(g.ElementLink={}))})(g.Schedule||(g.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(g){(function(e){var b=c.CheckboxStateMachine.State,a=function(a){function d(b,d,f,c,e){a.call(this,void 0,b,f,e,d,c);this.dialogCallbacks=e;this.isElementDeletionConfirmationShown=!1;this.shouldFileBeAttachedToEventImmediately=!0}__extends(d,a);d.prototype.setCalendarEventElementLinkManager=function(){e.ElementLinkManagerDialogBase.currentManager=window[this.utility.settings.constants.CalendarEventElementLinkManager]=this};d.prototype.setParameters=function(a){this.currentEvent=
a;this.ajaxParams={locationId:this.currentEvent.courseId,locationType:c.AddResourceMenu.ElementExternalSourceType.Course};this.courseId=this.currentEvent.courseId;this.loadElementStates();this.eventId=a.activityId};d.prototype.onRemoveElementClick=function(a,d){var f=this,c=a.closest(this.utility.selectors.elementListItem);a=c.find("."+this.utility.settings.cssClasses.ElementListTitle).text();this.isElementDeletionConfirmationShown=!0;CCL.CommonFunctions.jAjaxConfirm(CCL.CommonFunctions.formatString(this.utility.settings.terms.removeElementConfirmation,
a),CCL.CommonFunctions.formatString(this.utility.settings.terms.RemoveTooltipTemplate,a),this.utility.settings.terms.alertOkButtonCaption,this.utility.settings.terms.AlertCancelButtonCaption,function(a){f.isElementDeletionConfirmationShown=!1;if(a){f.dialogCallbacks.dialogPositionRecalculation();var d=f.utility.getElementForEventData(c);f.ajaxClient.removeElement({EventId:d.EventId,ElementId:d.ElementId}).done(function(){f.currentElementStates.set(d.ElementId,b.DetachedByUser);f.onRemoveElementsComplete(c)})}})};
d.prototype.onFullScreenClosed=function(){var a=this;this.ajaxClient.getElementListMarkupForEvent({eventId:this.eventId,fakeElementTitle:this.markupBuilder.getCurrentFakeElementTitle()}).done(function(b){a.onUpdateEventElementsComplete(b)})};d.prototype.getIfElementDeletionConfirmationIsShown=function(){return this.isElementDeletionConfirmationShown};d.prototype.saveElementStates=function(){var a=this,b=[],d=[];this.currentElementStates.forEach(function(a,f){switch(a){case c.CheckboxStateMachine.State.AttachedByUser:b.push(f);
break;case c.CheckboxStateMachine.State.DetachedByUser:d.push(f)}});(0<b.length||0<d.length)&&this.ajaxClient.updateEventElements({EventId:this.currentEvent.activityId,ElementIdsToAdd:b,ElementIdsToRemove:d,FakeElementTitle:this.markupBuilder.getCurrentFakeElementTitle()}).done(function(b){a.onUpdateEventElementsComplete(b)})};d.prototype.loadElementStates=function(){var a=this;this.currentElementStates=new Map;var b=[];this.currentDialogContainer||(this.currentDialogContainer=this.mainContainer);
this.currentDialogContainer.find("."+this.utility.settings.cssClasses.ElementList).find(this.utility.selectors.elementListItem).each(function(d,f){d=a.utility.getElementForEventData($(f));d.AddedManually&&a.currentElementStates.set(d.ElementId,c.CheckboxStateMachine.State.Saved);d.CanBeRemoved||b.push(d.ElementId)});return b};d.prototype.addFromCourse=function(){var a=this.loadElementStates();a={elementStates:c.MapUtils.makeCopy(this.currentElementStates),disabledElementIds:a,afterOkClickCallback:this.afterOkClickCallback,
maxCountOfAddedElements:this.utility.constants.MaxCountOfAddedElements,elementType:c.ElementLinkDialog.ContentElementType.All,showAll:!0,header:this.utility.settings.terms.AddResourceDialogTitle,allowFolderSelection:!0,openerPage:c.ElementLinkDialog.ElementsPopupOpener.CalendarEvent};c.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,this.ajaxParams)};d.prototype.onUpdateEventElementsComplete=function(a){a&&this.markupBuilder.rebuildElementListMarkup(this.currentDialogContainer,a);
this.dialogCallbacks.onElementListChanged()};d.prototype.onRemoveElementsComplete=function(a){this.markupBuilder.removeElement(a,this.dialogCallbacks.dialogPositionRecalculation);this.dialogCallbacks.onElementListChanged()};return d}(e.ElementLinkManagerDialogBase);e.EditEventElementLinkManager=a})(g.ElementLink||(g.ElementLink={}))})(g.Schedule||(g.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(){function a(a,b){var d=this;this.settings=b;window[a]=this;this.settings=b;this.$saveButton=$("#"+this.settings.Controls.GroupDialogOkButton);this.$cancelButton=$("#"+this.settings.Controls.GroupDialogCancelButton);this.$learnerDefinedGroupLink=$("#"+this.settings.Controls.GroupLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.$withdrawLink=$("#"+this.settings.Controls.WithdrawLink);this.manageGroupDialog=
window[this.settings.Controls.ManageGroupDialog];this.settingManager=c.Settings.Manager.getInstance();$(function(){d.manageGroupDialog.setCustomScripts({afterOpenDialog:function(){setTimeout(function(){$("."+d.settings.Css.ExpandedExtensionIframe).addClass(d.settings.Css.ExpandedExtensionIframeStackedUnderSettings)},100)},beforeCloseDialog:function(){$("."+d.settings.Css.ExpandedExtensionIframe).removeClass(d.settings.Css.ExpandedExtensionIframeStackedUnderSettings)}});d.$submitIndividuallyLink.on("click",
function(){CCL.CommonFunctions.safeAjaxPost({url:d.settings.WebMethods.UseIndividualSubmission.replace("{elementId}",d.settings.ElementId.toString())}).done(function(a){return d.processResponse(a)}).fail(function(){return d.settingManager.alertError()})});d.$learnerDefinedGroupLink.on("click",function(){d.manageGroupDialog.openDialog(!1)});d.$withdrawLink.on("click",function(){d.settings.IsIndividualSubmission?d.withdrawFromGroup():CCL.CommonFunctions.jAjaxConfirm(d.settings.Terms.WithdrawConfirmation,
d.settings.Terms.ConfirmTitle,d.settings.Terms.Yes,d.settings.Terms.No,function(a){a&&d.withdrawFromGroup()})});d.$saveButton.on("click",function(){d.saveGroup()&&CssModal.closeDialog()});d.$cancelButton.on("click",function(){CssModal.closeDialog()})})}a.prototype.saveGroup=function(){var a=this;this.$saveButton.toggleHyperlink(!1);var b=$("#"+this.settings.Controls.ManageGroupDialog).find("iframe").get(0).contentWindow[this.settings.ManageGroupDialogInstanceName].getState();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.CreateCollaborationBasedOnLearnerDefinedGroup.replace("{elementId}",
this.settings.ElementId.toString()),data:{personIds:b.personIds}}).done(function(b){return a.processResponse(b)}).fail(function(){return a.settingManager.alertError()});return!0};a.prototype.withdrawFromGroup=function(){var a=this;CCL.CommonFunctions.safeAjax({type:"DELETE",url:this.settings.WebMethods.WithdrawFromLearnerDefinedGroup.replace("{elementId}",this.settings.ElementId.toString())}).done(function(b){return a.processResponse(b)}).fail(function(){return a.settingManager.alertError()})};a.prototype.processResponse=
function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();e.LearnerDefinedGroups=b})(g.Collaboration||(g.Collaboration={}))})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function a(a,b,c,e,g){this._isActive=a;this._useTimeSpan=b;this._timeZoneOffsetInSeconds=c;this._incorrectFormatTerm=e;this._dateShouldBeSetTerm=g}Object.defineProperty(a.prototype,"isActive",{get:function(){return this._isActive},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"useActivationTimeSpan",{get:function(){return this._useTimeSpan},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromDateTime",{get:function(){return this.fromState.date},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toDateTime",{get:function(){return this.toState.date},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isValid",{get:function(){if(!this.useActivationTimeSpan)return!0;var a=this.validationErrors;return 0===a.fromValidationError.length&&0===a.toValidationError.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromNow",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&
void 0==this.fromDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toInfinity",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&void 0==this.toDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"validationErrors",{get:function(){var a={fromValidationError:"",toValidationError:""};if(!this.useActivationTimeSpan)return a;this.fromState.isValid||(a.fromValidationError=this._incorrectFormatTerm);this.toState.isValid||(a.toValidationError=
this._incorrectFormatTerm);if(0<a.fromValidationError.length||0<a.toValidationError.length)return a;!this.toInfinity&&this.fromNow&&(a.fromValidationError=this._dateShouldBeSetTerm);return a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isActiveAccordingToTimeSpan",{get:function(){if(!this.useActivationTimeSpan)return this.isActive;var a=CCL.DateFunctions.getItslNow(this._timeZoneOffsetInSeconds);return this.fromNow&&this.toInfinity?!0:this.fromNow?this.isFirstLessThanSecond(a,
this.toDateTime):this.toInfinity?this.isFirstLessThanSecond(this.fromDateTime,a):this.isFirstLessThanSecond(this.fromDateTime,a)&&this.isFirstLessThanSecond(a,this.toDateTime)},enumerable:!0,configurable:!0});a.prototype.isFirstLessThanSecond=function(a,b){if(a&&b)return a<b};return a}();c.ActivationTimeSpanState=e;var b=function(){function a(a,b){var d=this;window[a]=this;this.settings=b;this.isElementActiveNow=this.settings.IsActive;this.useTimespan=this.settings.UseActivationTimespan;$(function(){d.fillJQueryElements();
d.fromDateTimePickerInstance=window[d.settings.ClientInstances.FromDateTimePickerClientInstanceName];d.toDateTimePickerInstance=window[d.settings.ClientInstances.ToDateTimePickerClientInstanceName];d.$activationLink.add(d.$activationLabel).click(function(){d.useTimespan&&(d.useTimespan=!1);d.isElementActiveNow=!d.isElementActiveNow;d.updateControlState();CCL.UnobtrusiveCustomTooltipManager.closeTooltip()});d.$toggleTimespanLink.click(function(){d.useTimespan=!d.useTimespan;d.updateControlState()});
d.updateControlState();$(d.fromDateTimePickerInstance).add($(d.toDateTimePickerInstance)).change(function(){return d.updateControlState()})})}a.prototype.getActivationTimeSpanState=function(){var a=new e(this.isElementActiveNow,this.useTimespan,this.settings.TimeZoneOffsetInSeconds,this.settings.Terms.DateMustBeOnTheFormatX,this.settings.Terms.PleaseEnterDate);a.useActivationTimeSpan&&(a.fromState=this.fromDateTimePickerInstance.getDateTimePickerState(),a.toState=this.toDateTimePickerInstance.getDateTimePickerState());
return a};a.prototype.hasTimeSpan=function(){if(!this.useTimespan)return!1;var a=this.getActivationTimeSpanState();return a.fromState.isValid&&!a.fromState.isEmpty};a.prototype.isActive=function(){return this.isElementActiveNow};a.prototype.validateControl=function(){var a=this.getActivationTimeSpanState(),b=a.validationErrors,c={isInvalid:b.toValidationError&&0<b.toValidationError.length,errorMessage:b.toValidationError,highlightInput:!0};this.fromDateTimePickerInstance.toggleValidationError({isInvalid:b.fromValidationError&&
0<b.fromValidationError.length,errorMessage:b.fromValidationError,highlightInput:!0});this.toDateTimePickerInstance.toggleValidationError(c);return a.isValid};a.prototype.isStringNullOrEmpty=function(a){return!a||0===a.length};a.prototype.fillJQueryElements=function(){this.$textAndIconContainer=$("#"+this.settings.Controls.TextAndIconContainer);this.$activationLink=$("#"+this.settings.Controls.ActivationLink);this.$activationImage=this.$activationLink.find("img");this.$activationLabel=$("#"+this.settings.Controls.ActivationLabel);
this.$toggleTimespanLink=$("#"+this.settings.Controls.ToggleTimespanLink);this.$timespanContainer=$("#"+this.settings.Controls.TimespanContainer);this.$fromDateInput=$("#"+this.settings.Controls.FromDateInput);this.$fromHoursDropDown=$("#"+this.settings.Controls.FromHoursDropDown);this.$fromMinutesDropDown=$("#"+this.settings.Controls.FromMinutesDropDown);this.$toDateInput=$("#"+this.settings.Controls.ToDateInput);this.$toHoursDropDown=$("#"+this.settings.Controls.ToHoursDropDown);this.$toMinutesDropDown=
$("#"+this.settings.Controls.ToMinutesDropDown)};a.prototype.updateControlState=function(){var a=this.getActivationTimeSpanState();a.useActivationTimeSpan&&(a=a.isActiveAccordingToTimeSpan,void 0!=a&&(this.isElementActiveNow=a));this.$timespanContainer.toggle(this.useTimespan);this.$toggleTimespanLink.toggleClass(this.settings.Css.AddLink,!this.useTimespan).toggleClass(this.settings.Css.RemoveLink,this.useTimespan);this.$toggleTimespanLink.find("span").text(this.useTimespan?this.settings.Terms.RemoveScheduledVisibility:
this.settings.Terms.AddScheduledVisibility);this.$activationLabel.html(this.isElementActiveNow?this.settings.Terms.ResourceIsVisible:this.settings.Terms.ResourceIsNotVisible);this.$activationImage.attr("src",this.isElementActiveNow?this.settings.Images.Active:this.settings.Images.Inactive);a=this.isElementActiveNow?this.settings.Tooltips.ClickToMakeInvisible:this.settings.Tooltips.ClickToMakeVisible;CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$activationLink,a);CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$activationLabel,
a);this.settings.Events.ElementActivationChangedEventName&&$(document).trigger(this.settings.Events.ElementActivationChangedEventName)};return a}();c.Activation=b})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;window[b]=this;this.settings=a;this.$toggle=$("#"+a.Controls.CompletedToggle);this.$simpleStatusSelector=$("#"+a.Controls.SimpleStatusSelector);if(0<this.$toggle.length||0<this.$simpleStatusSelector.length){this.$score=$("#"+a.Controls.Score);this.$assessment=$("#"+a.Controls.Assessment);var f=$("#"+a.Controls.CompletedToggleLabel),c=$("#"+a.Controls.AssessmentLabel+", #"+a.Controls.ScoreLabel);this.$toggle.on(a.ToggleStateChangedEventName,
function(b,d){b=window[d.toggleInstanceId];b.isChecked()?f.html(a.Terms.CompletedToggleOn):f.html(a.Terms.CompletedToggleOff);c.toggleClass(a.CssClasses.MandatoryMark,b.isChecked())});this.settings.IsAssessmentMandatoryForCompletedStatus&&(this.$score.add(this.$simpleStatusSelector).change(function(){c.toggleClass(a.CssClasses.MandatoryMark,d.isAsessmentMissingForCompleted())}),this.$assessment.on("autocompletechange",function(){c.toggleClass(a.CssClasses.MandatoryMark,d.isAsessmentMissingForCompleted())}))}this.rubricToggleChangeValue=
a.RubricToggleChangeValue;this.$criteriaAssessmentToggle=$("#"+this.settings.Controls.CriteriaAssessment);this.$rubricCriteriaList=$("#"+this.settings.Controls.RubricCriteriaList);this.$criteriaAssessmentToggle.change(function(){return d.toggleCriteriaAssessmentList()})}c.prototype.toggleCriteriaAssessmentList=function(){var b=this.$criteriaAssessmentToggle.val()===this.rubricToggleChangeValue;this.$rubricCriteriaList.toggleClass(this.settings.CssClasses.Hidden,!b)};c.prototype.isAsessmentMissingForCompleted=
function(){return(this.$toggle.is(":checked")||this.$simpleStatusSelector.val()===this.settings.SimpleStatusSelectorCompletedValue)&&(this.$assessment.val()===this.settings.NotAssessedValue||""===this.$score.val())};c.prototype.validateAssessmentForCompleted=function(b,a){a.IsValid=!this.isAsessmentMissingForCompleted()};return c}();c.ActivityMultipleAssessment=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){this.synchronize(b)}Object.defineProperty(c.prototype,"currentClientTime",{get:function(){return(new Date).getTime()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"clientDeltaTime",{get:function(){return this.currentClientTime-this.clientFixedTime},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"currentServerTime",{get:function(){return new Date(this.serverFixedTime+this.clientDeltaTime)},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"currentServerTimeWithoutSeconds",{get:function(){var b=this.currentServerTime;b.setSeconds(0);b.setMilliseconds(0);return b},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isSynchronizeNeeded",{get:function(){return 3E5<this.clientDeltaTime},enumerable:!0,configurable:!0});c.prototype.synchronize=function(b){this.serverFixedTime=b.getTime();this.clientFixedTime=this.currentClientTime};return c}();c.DateTimeSynchronizer=g})(c.Controls||
(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.endDate=new Date;window[b]=this;this.settings=a;this.datePeriod=this.settings.DatePeriod;this.startDate=$.datepicker.parseDate(this.settings.DateFormat,this.settings.StartDate);this.setEndDate();this.weekNumber=this.settings.WeekNumber;this.dayNames=this.settings.DayNames;$(function(){d.$prevButton=$("#"+d.settings.ClientIds.PrevButton);d.$nextButton=$("#"+d.settings.ClientIds.NextButton);d.$dateShortLabel=$("#"+d.settings.ClientIds.DateShortLabel);
d.$datePrefixLabel=$("#"+d.settings.ClientIds.DatePrefixLabel);d.$prevButton.click(function(){return d.goToPreviousPeriod()});d.$nextButton.click(function(){return d.goToNextPeriod()});d.triggerPeriodChangedEvent()})}e.prototype.toggleNavigationButtons=function(b){this.$prevButton.toggleHyperlink(b);this.$nextButton.toggleHyperlink(b)};e.prototype.changeDatePeriod=function(b){this.startDate=$.datepicker.parseDate(this.settings.DateFormat,b);this.setEndDate();this.setWeekNumber();this.updateTitleLabel();
this.triggerPeriodChangedEvent()};e.prototype.toggleWeekDayMode=function(b,a){this.datePeriod=b;switch(this.datePeriod){case c.DatePeriod.Day:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousDay);this.$nextButton.prop("title",this.settings.Terms.GoToTheNextDay);break;case c.DatePeriod.Week:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousWeek),this.$nextButton.prop("title",this.settings.Terms.GoToTheNextWeek)}this.changeDatePeriod(a)};e.prototype.goToPreviousPeriod=
function(){this.$prevButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(-this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent(),this.$prevButton.removeAttr("disabled"),this.$prevButton.focus())};e.prototype.goToNextPeriod=function(){this.$nextButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent(),this.$nextButton.removeAttr("disabled"),this.$nextButton.focus())};e.prototype.setNewPeriodDates=
function(b){this.startDate&&(this.setStartDate(b),this.setEndDate(),this.setWeekNumber())};e.prototype.setStartDate=function(b){this.startDate=this.addDays(this.startDate,b);this.startDate.setHours(0);this.startDate.setMinutes(0)};e.prototype.setEndDate=function(){this.endDate=this.addDays(this.startDate,this.getNumberOfDaysInPeriod()-1);this.endDate.setHours(23);this.endDate.setMinutes(59)};e.prototype.setWeekNumber=function(){this.weekNumber=$.datepicker.iso8601Week(this.startDate)};e.prototype.triggerPeriodChangedEvent=
function(){$(this).trigger(e.periodChangedEventName,{startDate:this.getStartDate(),endDate:this.getEndDate()})};e.prototype.addDays=function(b,a){b=new Date(b.valueOf());b.setDate(b.getDate()+a);return b};e.prototype.updateTitleLabel=function(){var b=this.settings.ShowWeekNumber?String.format(this.settings.Terms.WeekNumberTemplate,this.weekNumber.toString()):"",a=$.datepicker.formatDate(this.settings.DateFormat,this.startDate),d=$.datepicker.formatDate(this.settings.DateFormat,this.endDate);this.$datePrefixLabel.toggle(this.datePeriod===
c.DatePeriod.Day||this.settings.ShowWeekNumber);switch(this.datePeriod){case c.DatePeriod.Day:this.$datePrefixLabel.text(this.dayNames[this.startDate.getDay()]);this.$dateShortLabel.text(a);break;case c.DatePeriod.Week:this.$datePrefixLabel.text(b);this.$dateShortLabel.text(a+" - "+d);break;default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};e.prototype.getNumberOfDaysInPeriod=function(){switch(this.datePeriod){case c.DatePeriod.Day:return 1;case c.DatePeriod.Week:return 7;
default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};e.prototype.getDateTimeAsString=function(b){return b?$.datepicker.formatDate(this.settings.DateFormat,b)+" "+c.DateTimePicker.getNumberAsTwoCharString(b.getHours())+":"+c.DateTimePicker.getNumberAsTwoCharString(b.getMinutes()):""};e.prototype.getStartDate=function(){return this.getDateTimeAsString(this.startDate)};e.prototype.getEndDate=function(){return this.getDateTimeAsString(this.endDate)};e.periodChangedEventName=
"datePeriodSelector:periodChanged";return e}();c.DatePeriodSelector=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(c){function b(a,b,f,h){c.call(this,a,b,f,h)}__extends(b,c);b.prototype.getParams=function(a){var b=a.attr("data-date");a=a.parent().parent().attr("data-kpi-m-id");return{Date:b,MeasurementId:a}};b.prototype.paramsAreEqual=function(a,b){return null==a?!1:a.Date===b.Date&&a.MeasurementId===b.MeasurementId};b.prototype.formatUrlParams=function(a){return{date:a.Date,measurementid:a.MeasurementId}};return b}(c.BaseDetailedInfo);c.FeatureAdoptionDetailedInfo=g})(c.Controls||
(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;window[b]=this;this.settings=a;$(function(){d.$dataHidden=$("#"+d.settings.Controls.DataHidden);d.$listContainer=$("#"+d.settings.Controls.ListContainer);d.$orderChangedHidden=$("#"+d.settings.Controls.OrderChangedHidden);d.$listContainer.on("click","."+d.settings.Css.RemoveLink,function(a){a=$(a.currentTarget).closest("li");a=parseInt(a.data("id"),10);d.deleteElement(a)})})}c.prototype.getElementIds=function(){var b=this.$dataHidden.val();
return b?JSON.parse(b):[]};c.prototype.updateOrder=function(b){for(var a=[],d=0;d<b.length;d++){var f=b[d];f&&f.length&&(f=parseInt(f),isNaN(f)||a.push(f))}0<a.length&&this.$dataHidden.val(JSON.stringify(a));this.$orderChangedHidden.val("true")};c.prototype.addElement=function(b){var a=this;return $.getJSON(this.settings.WebMethods.GetElement.replace("{elementId}",b.toString())).done(function(b){a.addElementItem(b.ElementId,b.Title,b.IsActive,b.IconUrl)})};c.prototype.addElements=function(b){var a=
this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetElements.replace("{courseId}",this.settings.CourseId.toString()),data:{elementIds:b},dataType:"json"}).done(function(b){$.each(b,function(b,d){a.addElementItem(d.ElementId,d.Title,d.IsActive,d.IconUrl)})})};c.prototype.addElementItem=function(b,a,d,f){var c=JSON.parse(this.$dataHidden.val());if(-1===$.inArray(b,c)){var e=this.settings.Terms.RemoveTooltip.replace("{0}",a);d=d?"":this.settings.Css.Inactive;this.$listContainer.append($("<li></li>").attr("data-id",
b).append($("<span></span>").attr("class",this.settings.Css.ListItem).append($("<span></span>").attr("class",this.settings.Css.AssignmentIcon).append($("<img>").attr("src",f)).append($("<span></span>").attr("class",d).text(a)).append("&nbsp;")).append($("<span></span>").attr("class",this.settings.Css.RemoveLink).attr("title",e).text(this.settings.DeleteChar))));c.push(b);this.$dataHidden.val(JSON.stringify(c));this.$orderChangedHidden.val("true")}else b=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",
b)+" span:first-child span:first-child span"),b.text(a),b.toggleClass(this.settings.Css.Inactive,!d)};c.prototype.deleteElement=function(b){var a=JSON.parse(this.$dataHidden.val()),d=a.indexOf(b);-1<d&&(a.splice(d,1),this.$dataHidden.val(JSON.stringify(a)));(b=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",b)))&&b.remove()};c.prototype.deleteElements=function(b){var a=this;$.each(b,function(b,f){a.deleteElement(f)})};return c}();c.ElementList=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){var d=this;this.viewModel=b;window[a]=this;this.controlsProvider=new c.ResultsAndFeedbackInternals.ControlsProvider(b);this.externalDependenciesController=new c.ResultsAndFeedbackInternals.ExternalDependenciesController(b,this.controlsProvider);this.whenToShowResultsController=new c.ResultsAndFeedbackInternals.WhenToShowResultsController(b,this.controlsProvider,this.externalDependenciesController);this.whenToShowQuestionListAndAnswerController=new c.ResultsAndFeedbackInternals.WhenToShowQuestionListAndAnswerController(b,
this.controlsProvider,this.whenToShowResultsController,this.externalDependenciesController);$(function(){d.controlsProvider.$revealCorrectAnswerContainer.toggle(d.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer!==c.WhenToShowQuestionListAndAnswer.Never)})}Object.defineProperty(b.prototype,"revealCorrectAnswer",{get:function(){return this.controlsProvider.revealCorrectAnswerElement.is(":checked")},enumerable:!0,configurable:!0});b.prototype.getState=function(){return{WhenToShowResult:this.whenToShowResultsController.whenToShowResult,
WhenToShowQuestionListAndAnswer:this.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer,RevealCorrectAnswer:this.revealCorrectAnswer,WhenToShowResultsChanged:this.whenToShowResultsController.whenToShowResultsChanged}};return b}();c.ResultsAndFeedback=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){var d=this;this.viewModel=b;this.attemptsChanged=function(a){d.whichAttemptCountsContainer.toggle(1!==d.maxAttemptsAllowed)};window[a]=this;$(function(){d.controlElement=$("#"+b.ContainerId);d.maxAttemptsAllowedElement=$("."+b.MaxAttemptsAllowedSelector,d.controlElement);d.whichAttemptCountsElement=$("."+b.WhichAttemptCountsSelector,d.controlElement);d.whichAttemptCountsContainer=$("#"+b.WhichAttemptCountsContainer,d.controlElement);
d.maxAttemptsAllowedElement.change(d.attemptsChanged).change()})}Object.defineProperty(b.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.maxAttemptsAllowedElement.val(),10)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"whichAttemptCounts",{get:function(){var a=this.whichAttemptCountsElement.val();return c.WhichAttemptCounts[a]},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"timeLimitValue",{get:function(){var a=window[this.viewModel.TimeLimitClientInstanceName];
return null==a?0:a.getState().timeLimit},enumerable:!0,configurable:!0});b.prototype.getState=function(){return{MaxAttemptsAllowed:this.maxAttemptsAllowed,WhichAttemptCounts:this.whichAttemptCounts,WhichAttemptCountsChanged:this.whichAttemptCounts!==this.viewModel.AttemptsState.WhichAttemptCounts,TimeLimit:this.timeLimitValue}};return b}();c.Attempts=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(){}}();c.DateWithAdditionalInfo=g;var e=function(){function b(a,b,f,c){this._dateFormat=a;if(0>f||24<=f||0>c||60<=c)this._isValid=!1;else if(b&&b.length){this._isEmpty=!1;try{this._date=$.datepicker.parseDate(this._dateFormat,b),this._date.setHours(f),this._date.setMinutes(c),this._isValid=!0}catch(l){this._isValid=!1}}else this._isValid=this._isEmpty=!0}Object.defineProperty(b.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"isEmpty",{get:function(){return this._isEmpty},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"date",{get:function(){return this._date},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateAsString",{get:function(){return this.isEmpty||!this.isValid?"":$.datepicker.formatDate(this._dateFormat,this._date)+" "+b.getNumberAsTwoCharString(this._date.getHours())+":"+b.getNumberAsTwoCharString(this._date.getMinutes())},
enumerable:!0,configurable:!0});b.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};return b}();c.DateTimePickerState=e;g=function(){function b(a,b){var d=this;this.getDatesToHighlight=function(a,b){return[]};window[a]=this;this.settings=b;this.$datePickerInput=$("#"+this.settings.Controls.DateInputId);this.$hoursDropDown=$("#"+this.settings.Controls.HoursDropDownId);this.$minutesDropDown=$("#"+this.settings.Controls.MinutesDropDownId);this.$validationMessage=$("#"+
this.settings.Controls.ValidationMessageId);this.$textDescription=$("#"+this.settings.Controls.TextDescriptionId);var c={showOn:"focus",buttonImage:"",buttonImageOnly:!1,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0};c.dateFormat=this.settings.DatePickerOptions.DateFormat;c.firstDay=this.settings.DatePickerOptions.FirstDayOfWeek;c.monthNames=this.settings.DatePickerOptions.MonthNames;c.monthNamesShort=this.settings.DatePickerOptions.MonthNamesShort;c.dayNames=this.settings.DatePickerOptions.DayNames;
c.dayNamesShort=this.settings.DatePickerOptions.AbbreviatedDayNames;c.dayNamesMin=this.settings.DatePickerOptions.AbbreviatedDayNames;c.closeText=this.settings.DatePickerOptions.CloseText;c.prevText=this.settings.DatePickerOptions.PrevText;c.nextText=this.settings.DatePickerOptions.NextText;c.currentText=this.settings.DatePickerOptions.CurrentText;c.showWeek=this.settings.DatePickerOptions.ShowWeek;c.weekHeader=this.settings.DatePickerOptions.WeekHeader;c.onChangeMonthYear=function(a,b,f){d.updateDatesToHighLight(a,
b)};c.beforeShowDay=function(a){var b=!0;d.settings.EnableSelectingDatesInThePast||(b=new Date,b=a>=new Date(b.getFullYear(),b.getMonth(),b.getDate()));d.minDate&&(b=a>=d.minDateAtTheBeginningOfDay);if(!d.datesToHighlight||0===d.datesToHighlight.length)return[b];b=[b,""];for(var f=0;f<d.datesToHighlight.length;f++)if(d.areDatesEqual(a,d.datesToHighlight[f].Date)){b[1]=d.datesToHighlight[f].CssClass;break}return b};c.beforeShow=function(a,b){CCL.DatePickerAccessibilityAdapter.setCurrentDatePicker(d);
a=$(a).datepicker("getDate");null==a&&(a=new Date);d.updateDatesToHighLight(a.getFullYear(),a.getMonth()+1)};c.onSelect=function(a){if(d.datesToHighlight&&0!==d.datesToHighlight.length&&(a=$.datepicker.parseDate(c.dateFormat,a))){for(var b=0,f=0,e=0;e<d.datesToHighlight.length;e++)if(d.areDatesEqual(d.datesToHighlight[e].Date,a)){b=d.datesToHighlight[e].Date.getHours();f=d.datesToHighlight[e].Date.getMinutes();break}0!==b||0!==f?d.setTime(b,f):d.setTime(d.settings.DefaultHours,d.settings.DefaultMinutes)}d.updateTimePickerState();
d.updateDependentPicker();d.settings.EnableAutoSelectCurrentTimeForCurrentDate&&d.dateTimeSync&&d.isDateInputTextValid()&&(a=d.dateTimeSync.currentServerTime,d.areDatesEqual(d.getDateTime(),a)&&d.setTimePickerStateToCurrentTime(a));$(d).trigger("change",d.getDateTime())};c.onClose=function(){if(CCL.CommonFunctions.isIe()){var a=d.$datePickerInput.datepicker("option","showOn");d.$datePickerInput.datepicker("option","showOn","button");setTimeout(function(){d.$datePickerInput.focus();setTimeout(function(){d.$datePickerInput.datepicker("option",
"showOn",a)})})}else d.$datePickerInput.focus()};this.$datePickerInput.on("click",function(a){return d.$datePickerInput.focus()});if(this.$datePickerInput&&(this.$datePickerInput.datepicker(c),""===this.$datePickerInput.val()&&this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes),this.$datePickerInput.change(function(){d.updateTimePickerState();$(d).trigger("change",d.getDateTime())}),this.settings.EnableTriggerDateInputBlurEvent))this.$datePickerInput.add(this.$hoursDropDown).add(this.$minutesDropDown).on("blur",
function(){return $(d).trigger("blur",d.getDateTime())});this.$hoursDropDown.add(this.$minutesDropDown).change(function(){$(d).trigger("change",d.getDateTime());d.toggleValidationError({isInvalid:!1})});this.updateTimePickerState()}Object.defineProperty(b.prototype,"dependentPicker",{set:function(a){this.dependentPickerInstance=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateTimeSynchronizer",{set:function(a){this.dateTimeSync=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"minDate",{get:function(){return this.minDateValue},set:function(a){this.minDateValue=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"minDateAtTheBeginningOfDay",{get:function(){var a=new Date(this.minDateValue.getTime());a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},enumerable:!0,configurable:!0});b.prototype.areDatesEqual=function(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()};b.prototype.setTime=
function(a,b){1<this.settings.MinutesInterval?(a=this.getTimeOfNextInterval(a,b,this.settings.MinutesInterval),this.setDropDownValue(this.$hoursDropDown,a.hours.toString()),this.setDropDownValue(this.$minutesDropDown,a.minutes.toString())):(this.setDropDownValue(this.$hoursDropDown,a.toString()),this.setDropDownValue(this.$minutesDropDown,b.toString()))};b.prototype.getTimeOfNextInterval=function(a,b,f){return 60-b<f?{hours:a+1,minutes:0}:{hours:a,minutes:Math.ceil(b/f)*f}};b.prototype.setDropDownValue=
function(a,b){if(a){var d=!1;a.find("option").each(function(a,f){return f.getAttribute("value")===b?(d=!0,!1):!0});d&&a.val(b)}};b.prototype.getDateTimePickerState=function(){return new e(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val(),this.getDropDownValue(this.$hoursDropDown),this.getDropDownValue(this.$minutesDropDown))};b.prototype.getStringValue=function(){var a=this.$datePickerInput.val();return a?a+" "+b.getNumberAsTwoCharString(this.getHours())+":"+b.getNumberAsTwoCharString(this.getMinutes()):
""};b.prototype.getDateTimeAsString=function(){var a=this.getDateTime();return a?$.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,a)+" "+b.getNumberAsTwoCharString(a.getHours())+":"+b.getNumberAsTwoCharString(a.getMinutes()):""};Object.defineProperty(b.prototype,"isDateValidOrEmpty",{get:function(){return 0===this.$datePickerInput.val().length||this.isDateInputTextValid()},enumerable:!0,configurable:!0});b.prototype.getDateTime=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,
this.$datePickerInput.val())}catch(d){}if(a)return a.setHours(this.getHours()),a.setMinutes(this.getMinutes()),a};b.prototype.setDateTime=function(a){"undefined"===typeof a?(this.$datePickerInput.val(""),this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes)):(this.$datePickerInput.val($.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,a)),this.setTime(a.getHours(),a.getMinutes()));this.updateTimePickerState();this.updateDependentPicker()};b.prototype.toggleValidationError=
function(a){a.isInvalid?(a.errorMessage&&0<a.errorMessage.length&&(this.$validationMessage.text(a.errorMessage).show(),this.$textDescription.hide()),a.highlightInput&&(this.$datePickerInput.addClass(this.settings.CssClasses.InvalidInput),this.$hoursDropDown.addClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.addClass(this.settings.CssClasses.InvalidInput))):(this.$validationMessage.empty().hide(),this.$textDescription.show(),this.$datePickerInput.removeClass(this.settings.CssClasses.InvalidInput),
this.$hoursDropDown.removeClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.removeClass(this.settings.CssClasses.InvalidInput))};b.prototype.highlightOnAutoCorrectInvalidInput=function(a){var b=this;this.$datePickerInput.addClass(this.settings.CssClasses.InvalidInput);this.$hoursDropDown.addClass(this.settings.CssClasses.InvalidInput);this.$minutesDropDown.addClass(this.settings.CssClasses.InvalidInput);setTimeout(function(){b.$datePickerInput.removeClass(b.settings.CssClasses.InvalidInput);
b.$hoursDropDown.removeClass(b.settings.CssClasses.InvalidInput);b.$minutesDropDown.removeClass(b.settings.CssClasses.InvalidInput)},a)};b.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};b.prototype.getHours=function(){return this.getDropDownValue(this.$hoursDropDown)};b.prototype.getMinutes=function(){return this.getDropDownValue(this.$minutesDropDown)};b.prototype.getDropDownValue=function(a){return a?(a=a.val())&&""!==a.toString()?+a:0:0};b.prototype.enable=function(a){this.$datePickerInput.prop("disabled",
!a);this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!a||!this.isDateInputTextValid())};b.prototype.updateDatesToHighLight=function(a,b){this.getDatesToHighlight&&"function"===typeof this.getDatesToHighlight&&(this.datesToHighlight=this.getDatesToHighlight(new Date(a,b-2,25),new Date(a,b,6)))};b.prototype.isDateInputTextValid=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val())}catch(d){}return void 0!==a&&null!==
a};b.prototype.updateTimePickerState=function(){this.toggleValidationError({isInvalid:!1});this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!this.isDateInputTextValid())};b.prototype.setTimePickerStateToCurrentTime=function(a){this.setTime(a.getHours(),a.getMinutes())};b.prototype.updateDependentPicker=function(){this.dependentPickerInstance&&(this.getDateTime()>=this.dateTimeSync.currentServerTime||this.dependentPickerInstance.settings.EnableSelectingDatesInThePast)&&(this.dependentPickerInstance.minDate=
this.getDateTime())};b.prototype.isFocusWithinControl=function(){return this.$datePickerInput.is(":focus")||this.$hoursDropDown.is(":focus")||this.$minutesDropDown.is(":focus")};b.prototype.closePicker=function(){this.$datePickerInput.datepicker("hide")};b.prototype.clearDateAndTime=function(a){this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes);a||this.$datePickerInput.val("")};b.prototype.getDate=function(){return this.getDateTimePickerState().date};b.prototype.setDate=function(a){this.setDateTime(a)};
return b}();c.DateTimePicker=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){return function(){}}();c.DeadlineState=e;e=function(){function b(a,b){var d=this;this.peerAndSelfAssessmentStateChanged=function(a,b,f){d.emptyDeadlineValidationEnabled=b;d.$closeAfterDeadlineCheckBox.prop("checked",b||d.settings.CloseAfterDeadline).change();d.$closeAfterDeadlineCheckBox.prop("disabled",b);d.customTooltipForCheckbox.setToolTipHtml(b?d.settings.Terms.CloseAfterDeadlineDisabledWarning:"");d.initEmptyDeadlineValidation()};window[a]=
this;this.settings=b;$(function(){d.dateTimePicker=window[d.settings.ClientInstanceNames.DateTimePicker];d.$deadlineSection=$("["+d.settings.SectionDataAttribute+"]");d.$deadlineHeaderText=d.$deadlineSection.find("."+d.settings.HeaderTextClass);d.$closeAfterDeadlineCheckBox=$("#"+d.settings.Controls.CloseAfterDeadlineCheckBox);d.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(d.$closeAfterDeadlineCheckBox);if(d.settings.HasDeadlinePassed&&d.settings.PeerAssessmentEnabled)d.enabled=
!1;else{if(d.settings.Events.PeerAndSelfAssessmentStateChanged)$(document).off(d.settings.Events.PeerAndSelfAssessmentStateChanged).on(d.settings.Events.PeerAndSelfAssessmentStateChanged,d.peerAndSelfAssessmentStateChanged);$(d.dateTimePicker).change(function(){d.emptyDeadlineValidationEnabled&&d.dateTimePicker.getDateTimePickerState().isEmpty?d.dateTimePicker.toggleValidationError({isInvalid:!0,errorMessage:b.Terms.SetDeadline,highlightInput:!0}):$(d).trigger("change",d.dateTimePicker.getDateTime())});
d.dateTimePicker&&(d.dateTimePicker.getDatesToHighlight=function(a,b){var f=[];d.settings.WebMethods.GetEventsDateTime&&d.settings.CourseId&&0<d.settings.CourseId&&CCL.CommonFunctions.safeAjax({url:d.settings.WebMethods.GetEventsDateTime,type:"POST",async:!1,data:{startDate:JSON.stringify(a),endDate:JSON.stringify(b),courseId:d.settings.CourseId}}).done(function(a){for(var b=0;b<a.length;b++){var c=a[b],e={};e.Date=d.convertStringToDate(c.Date);e.CssClass=c.CssClass;f.push(e)}});return f},$(d.dateTimePicker).on("change",
function(){d.settings.Events.DeadlineStateChanged&&$(document).trigger(d.settings.Events.DeadlineStateChanged)}))}})}b.prototype.getState=function(){return{CloseAfterDeadline:this.settings.UseCloseAfterDeadline?this.$closeAfterDeadlineCheckBox.is(":checked"):!1,DateTime:this.dateTimePicker.getStringValue()}};b.prototype.isSet=function(){return this.dateTimePicker.getDateTimePickerState().isValid&&!this.dateTimePicker.getDateTimePickerState().isEmpty};b.prototype.getDateTime=function(){return this.dateTimePicker.getDateTime()};
b.prototype.mandatory=function(a){this.$deadlineHeaderText.toggleClass(this.settings.CssClasses.Mandatory,a)};b.prototype.convertStringToDate=function(a){a=a.split(".");return new Date(+a[2],+a[1]-1,+a[0],+a[3],+a[4])};Object.defineProperty(b.prototype,"enabled",{set:function(a){this.$closeAfterDeadlineCheckBox.prop("disabled",!a);this.dateTimePicker.enable(a)},enumerable:!0,configurable:!0});b.prototype.initEmptyDeadlineValidation=function(){this.emptyDeadlineValidationEnabled||this.dateTimePicker.toggleValidationError({isInvalid:!1})};
return b}();c.Deadline=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(e){e.invalidDateAllowEmpty=function(b,a){return c.ValidatorFactory.checkToggle(function(){return!b.isDateValidOrEmpty},b,a)};e.invalidDateDenyEmpty=function(b,a){return c.ValidatorFactory.checkToggle(function(){return void 0===b.getDateTime()},b,a)};e.invalidDateAllowEmptyNoHighlight=function(b,a,d){return c.ValidatorFactory.checkNoHighlight(b,function(){return!b.isDateValidOrEmpty},a,d)};e.invalidDateDenyEmptyNoHighlight=function(b,a,d){return c.ValidatorFactory.checkNoHighlight(b,
function(){return void 0===b.getDateTime()},a,d)};e.compareDates=function(b,a,d,f){return c.ValidatorFactory.checkToggle(function(){return b(a.getDateTime(),d)},a,f)}})(c.DateTimePickerValidatorFactory||(c.DateTimePickerValidatorFactory={}))})(c.Validation||(c.Validation={}))})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){(function(c){function b(a,b,f){f&&b.isInvalid&&f();a.toggleValidationError(b);return!b.isInvalid}c.lessThanOrEqual=function(a,b){return a<=b};c.all=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return function(){return 0===a.filter(function(a){return!a()}).length}};c.until=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return function(){return a.every(function(a){return a()})}};c.checkToggle=function(a,d,f){return function(){return b(d,
{isInvalid:a(),errorMessage:f,highlightInput:!0},void 0)}};c.checkNoHighlight=function(a,d,f,c){return function(){return b(a,{isInvalid:d(),errorMessage:f,highlightInput:!1},c)}}})(c.ValidatorFactory||(c.ValidatorFactory={}))})(c.Validation||(c.Validation={}))})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){this.contentMaxHeight=250;this.settings=b;window[a]=this;this.$mainContainer=$("."+b.ContainerCssClass);this.$showMore=$("#"+b.ShowMoreClientId);this.$showLess=$("#"+b.ShowLessClientId);this.showLess(!0)}b.prototype.showMore=function(){var a=this;this.$showMore.hide();this.expandMainContainer();var b=this.$mainContainer.height();this.$mainContainer.css("height",this.contentMaxHeight).css("overflow","hidden").animate({height:b},
function(){a.expandMainContainer();b>a.contentMaxHeight&&a.$showLess.show()})};b.prototype.showLess=function(a){var b=this;this.$showLess.hide();this.expandMainContainer();this.$mainContainer.height()<=this.contentMaxHeight||this.$mainContainer.css("overflow","hidden").animate({height:this.contentMaxHeight},a?0:400,function(){b.$mainContainer.css("position","relative");b.$showMore.show();b.$mainContainer.find(":tabbable:visible").on("focus",function(a){b.showMoreWhenOutOfView(a)})})};b.prototype.showMoreWhenOutOfView=
function(a){a=$(a.currentTarget).offset().top;var b=this.$mainContainer.offset().top+this.contentMaxHeight-this.$showMore.height();a>b&&(this.showMore(),this.$mainContainer.find(":tabbable:visible").off("focus"))};b.prototype.expandMainContainer=function(){this.$mainContainer.css("height","").css("overflow","").css("position","")};return b}();c.ShowMoreLessLinks=e})(c.Widgets||(c.Widgets={}))})(c.Dashboard||(c.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(g){(function(e){var b=function(){function a(a,b){var d=this;this.controls=a;this.settings=b;this.eventDialog=window[this.settings.ClientInstanceNames.EventDialog];this.currentDatePeriod=this.settings.DatePeriod;this.ajaxClient=new e.AgendaAjaxClient(this.settings.WebMethods,this.settings.WidgetSettings);this.utility=new e.AgendaUtility(this.settings.DataAttributes,this.controls);this.eventPreview=new e.AgendaEventPreview(this.settings.ClientInstanceNames.EventDialog,
a.EventDialog,b.WebMethods.GetEventDetails,b.WebMethods.DeleteEvent,b.WidgetSettings,b.Terms,{name:b.AntiForgeryTokenName,value:b.AntiForgeryTokenValue},b.EventNames.LoadPlanCards,b.CssClasses.PlansContainer);this.setupEventItemClick();this.setupHideTaskItemClick();this.controls.DayViewLink.add(this.controls.WeekViewLink).click(function(a){return d.changeDatePeriod(d.utility.getExpectedDatePeriod(a.currentTarget))});this.contentBlockExpander=new CCL.ContentBlockExpander(this.controls.Container,{maxHeight:this.settings.ExpanderMaxPixelHeight,
collapseHeight:this.settings.ExpanderCollapsePixelHeight,lang:{showLess:this.settings.Terms.ShowLess,showMore:this.settings.Terms.ShowMore}});$(function(){d.datePeriodSelector=window[d.settings.ClientInstanceNames.DatePeriodSelector];$(d.datePeriodSelector).on(c.Controls.DatePeriodSelector.periodChangedEventName,function(a,b){return d.loadAgenda(d.ajaxClient.createGetAgendaDayListContainerAjaxRequest(b.startDate,b.endDate,d.currentDatePeriod))})})}a.prototype.afterUpdateWidget=function(){this.contentBlockExpander.reRenderShowMoreLink()};
a.prototype.clearEventDialogContent=function(){this.eventPreview.resetDialog()};a.prototype.changeDatePeriod=function(a){this.currentDatePeriod!==a&&(this.currentDatePeriod=a,this.controls.DayViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,this.currentDatePeriod===c.Controls.DatePeriod.Day),this.controls.WeekViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,this.currentDatePeriod===c.Controls.DatePeriod.Week),this.datePeriodSelector.toggleWeekDayMode(this.currentDatePeriod,
this.currentDatePeriod===c.Controls.DatePeriod.Week?this.settings.FirstDayOfTheWeek:this.settings.Today))};a.prototype.setupEventItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventTimeRangeLink),function(b){b=$(b.currentTarget);b.getIfHyperLinkEnabled()&&(b=b.closest("."+a.settings.CssClasses.EventItemContainer),a.eventPreview.open(a.utility.getEventId(b),a.utility.getEventTitle(b),a.utility.getEventCategory(b),
a.utility.getEventUrl(b),a.utility.getEventColorSchema(b),a.utility.getEventUrlTarget(b),a.utility.getEditEventUrl(b),a.utility.getEditRecurringEventUrl(b)))})};a.prototype.setupHideTaskItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.TaskHideId),function(b){return a.loadAgenda(a.ajaxClient.createHideTaskAjaxRequest(a.utility.getTaskHideId($(b.currentTarget)),a.datePeriodSelector.getStartDate(),a.datePeriodSelector.getEndDate(),
a.currentDatePeriod))})};a.prototype.loadAgenda=function(a){var b=this;this.currentLoadingSession&&this.currentLoadingSession.abort&&this.currentLoadingSession.abort();this.controls.AjaxLoadingWheel.show();this.controls.DayListContainer.empty().hide();this.contentBlockExpander.reRenderShowMoreLink();this.currentLoadingSession=a();this.currentLoadingSession.done(function(a){return b.controls.DayListContainer.append(a.html).show()}).always(function(){b.controls.AjaxLoadingWheel.hide();b.contentBlockExpander.renderShowMoreLinkIfNeed(!1);
b.currentLoadingSession=void 0})};return a}();e.AgendaContentBlock=b})(g.Agenda||(g.Agenda={}))})(g.Widgets||(g.Widgets={}))})(c.Dashboard||(c.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){this.controls=b;this.settings=a;this.selectors={elementLinkItem:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkItemId),listItemFocusedArea:"."+this.settings.CssClasses.ListItemFocusedArea,elementLinkFolderActionExpand:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderActionExpand)}}c.prototype.isListItemFocusedArea=function(b){return b.is(this.selectors.listItemFocusedArea)};c.prototype.closestListItemFocusedArea=
function(b){return b.closest(this.selectors.listItemFocusedArea)};c.prototype.closestElementItem=function(b){return b.closest(this.selectors.elementLinkItem)};c.prototype.getElementId=function(b){return b.data(this.settings.DataAttributes.ElementLinkItemId)};c.prototype.getCheckbox=function(b){return $("#"+this.settings.ElementItemPrefix+b)};return c}();c.Utility=g})(c.ElementLinkDialog||(c.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.ElementLinkDialog||(c.ElementLinkDialog={});c=c.ElementsPopupOpener||(c.ElementsPopupOpener={});c[c.None=0]="None";c[c.Plan=1]="Plan";c[c.WorkingPortfolioTask=2]="WorkingPortfolioTask";c[c.WorkingPortfolioPersonalizedTask=3]="WorkingPortfolioPersonalizedTask";c[c.CalendarEvent=4]="CalendarEvent";c[c.LearningPath=5]="LearningPath"})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this.controls=b;this.settings=a;this.getParticipantCheckBox=function(a){return $("#"+d.settings.ControlIds.DialogPersonItemCheckBoxPrefix+a)};this.getGroupCheckBox=function(a){return $("#"+d.settings.ControlIds.DialogGroupItemCheckBoxPrefix+a)};this.controls.ParticipantListTBody=this.controls.ParticipantList.children("tbody");this.controls.GroupListTBody=this.controls.GroupList.children("tbody")}c.prototype.getItemId=function(b){return b.data(this.settings.DataAttributes.ItemId)};
c.prototype.getItemType=function(b){return b.data(this.settings.DataAttributes.ItemType)};c.prototype.getItemTitle=function(b){return b.data(this.settings.DataAttributes.ItemTitle)};c.prototype.findLoadMoreItemsPointer=function(b){return b.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LoadMoreItems))};c.prototype.getVirtualCount=function(b){return b.data(this.settings.DataAttributes.VirtualCount)};c.prototype.findListItems=function(b){return b.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};
c.prototype.closestListItem=function(b){return b.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};c.prototype.closestSelectedItem=function(b){return b.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};return c}();c.Utility=g})(c.ElementParticipantPicker||(c.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(c){function b(a){c.call(this,a.controls.RadioButtonGroup,[[g.ItemType.Participant,a.controls.ParticipantsRadioButton],[g.ItemType.Group,a.controls.GroupsRadioButton]])}__extends(b,c);return b}(c.OptionRadioButton.OptionRadioButtonManagerBase);g.OptionRadioButtonManager=k})(c.ElementParticipantPicker||(c.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(e,b){this.utility=e;this.itemType=b;this.checkboxStateManager=new c.CheckboxStateManager;switch(b){case c.ItemType.Participant:this.itemList=this.utility.controls.ParticipantListTBody;this.selectAllCheckBox=this.utility.controls.SelectAllParticipantsCheckBox;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoParticipantsFound,noItemsInCourse:this.utility.settings.Terms.NoParticipantsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForParticipants};
this.getCheckbox=this.utility.getParticipantCheckBox;break;case c.ItemType.Group:this.itemList=this.utility.controls.GroupListTBody;this.selectAllCheckBox=this.utility.controls.SelectAllGroupsCheckBox;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoGroupsFound,noItemsInCourse:this.utility.settings.Terms.NoGroupsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForGroups};this.getCheckbox=this.utility.getGroupCheckBox;break;default:throw Error("Unknown ItemType "+b);
}}}();c.DialogItemModeDependentObjects=g})(c.ElementParticipantPicker||(c.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(){this.checkboxStateMachine=new c.CheckboxStateMachine.Machine;this.committedStateMap=new Map;this.pendingStateMap=new Map;this.ignoreCheckboxEvents=!1}e.prototype.setInitiallySelectedItemIds=function(b){for(var a=0;a<b.length;a++)this.committedStateMap.set(b[a],c.CheckboxStateMachine.State.Saved)};e.prototype.getSelectedItemIds=function(){var b=this,a=[];this.committedStateMap.forEach(function(d,f){b.isStateChecked(d)&&a.push(f)});return a};e.prototype.isItemPendingChecked=
function(b){return this.isStateChecked(this.pendingStateMap.get(b)||c.CheckboxStateMachine.State.Empty)};e.prototype.initializePendingStateMap=function(){this.pendingStateMap=c.MapUtils.makeCopy(this.committedStateMap)};e.prototype.commitPendingStateMap=function(){this.committedStateMap=c.MapUtils.makeCopy(this.pendingStateMap)};e.prototype.withIgnoreCheckboxEvents=function(b){this.ignoreCheckboxEvents=!0;try{b()}finally{this.ignoreCheckboxEvents=!1}};e.prototype.transferPendingState=function(b){var a=
b.itemId;b=b.isChecked;if(!this.ignoreCheckboxEvents){var d=this.pendingStateMap.get(a)||c.CheckboxStateMachine.State.Empty;b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(b,d);this.pendingStateMap.set(a,b)}};e.prototype.transferCommittedStateToUnchecked=function(b){var a=this.committedStateMap.get(b);a=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,a);this.committedStateMap.set(b,a)};e.prototype.isStateChecked=function(b){return b===c.CheckboxStateMachine.State.Saved||
b===c.CheckboxStateMachine.State.AttachedByUser};return e}();g.CheckboxStateManager=k})(c.ElementParticipantPicker||(c.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.controls=b;this.settings=a;this.searchTimeoutMilliseconds=1E3;this.testToolExtensionId=5002;this.assignmentExtensionId=5006;this.pageIndex=0;this.searchDebouncer=new CCL.CallbackDebouncer(function(){return d.search()});this.onCheckboxStateChanged=function(a){var b=$(a.currentTarget),f=b.is(":checked"),e=d.utility.closestListItem(b);b=d.utility.getItemId(e);var h=d.utility.getItemType(e);e=d.utility.getItemTitle(e);a.bubbles&&
d.updateSelectAllCheckBoxValue();d.currentObjects.checkboxStateManager.transferPendingState({itemId:b,isChecked:f});h===c.ItemType.Group?d.groupItemsSelected=d.updateSelectedOnChange(f,d.groupItemsSelected,b,e):d.personItemsSelected=d.updateSelectedOnChange(f,d.personItemsSelected,b,e)};this.onResultsRowClick=function(a){var b=$(a.currentTarget);0<b.find("label").find($(a.target)).length||d.optionRadioManager.isSelected(c.ItemType.Participant)&&b.find("a").get(0).contains(a.target)||(d.toggleOptionCheckBox(d.utility.getItemId(b),
function(a){return!a}),d.updateSelectAllCheckBoxValue())};this.onSelectAllCheckBoxStateChange=function(a){var b=a.currentTarget.checked;d.utility.findListItems(d.currentObjects.itemList).each(function(a,f){d.toggleOptionCheckBox(d.utility.getItemId($(f)),b)})};this.utility=new c.Utility(b,a);this.modalDialog=window[this.settings.ClientInstanceNames.Dialog];this.personObjects=new c.DialogItemModeDependentObjects(this.utility,c.ItemType.Participant);this.groupObjects=new c.DialogItemModeDependentObjects(this.utility,
c.ItemType.Group);this.currentObjects=this.settings.InitialItemType===c.ItemType.Group?this.groupObjects:this.personObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups();this.optionRadioManager=new c.OptionRadioButtonManager(this.utility);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.setupOkButtonClickHandler();this.groupItemsSelected=this.settings.InitiallySelectedGroups;this.personItemsSelected=this.settings.InitiallySelectedParticipants;this.controls.ChangeLink.click(function(a){d.openDialog();
d.personObjects.checkboxStateManager.initializePendingStateMap();d.groupObjects.checkboxStateManager.initializePendingStateMap();d.updateCheckboxes();a.preventDefault()});b=this.controls.ParticipantListTBody.add(this.controls.GroupListTBody);b.on((f={},f.change=this.onCheckboxStateChanged,f),"input:checkbox");b.on("click","tr",this.onResultsRowClick);this.controls.SelectAllParticipantsCheckBox&&this.controls.SelectAllParticipantsCheckBox.addEventListener("change",this.onSelectAllCheckBoxStateChange);
this.controls.SelectAllGroupsCheckBox&&this.controls.SelectAllGroupsCheckBox.addEventListener("change",this.onSelectAllCheckBoxStateChange);this.setupLoadMoreOnScroll(this.controls.ParticipantList);this.setupLoadMoreOnScroll(this.controls.GroupList);this.setupRadioButtonChangeHandler();this.setupSearch();this.personObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedParticipantIds);this.groupObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedGroupIds);
this.updateParticipantsText();this.updatePickerResultHidden();this.controls.DialogContent.keypress(function(a){a.which!==CCL.CommonConstants.keyCodes.enter||d.controls.OkButton.is(":focus")||a.preventDefault()});var f}e.prototype.setupLoadMoreOnScroll=function(b){var a=this;b.on((this.isIosDevice?"touchmove":"")+" scroll",function(){var b=a.currentObjects.itemList,f;!a.isLoadingInProgress&&0<a.utility.findLoadMoreItemsPointer(b).length&&CCL.CommonFunctions.isOnScreen((f=a.utility.findListItems(b)).eq(Math.max(0,
f.length-3)),.1,.1,a.isIosDevice?window.parent:window)&&a.loadMoreItems()})};e.prototype.setupRadioButtonChangeHandler=function(){var b=this;this.optionRadioManager.addOnChangeHandler(function(){b.switchCurrentObjects();b.search()})};e.prototype.setupSearch=function(){var b=this;this.controls.SearchTextBox.on("input",function(a){""===b.controls.SearchTextBox.val()?b.search():b.searchDebouncer.invokeCallback(void 0,b.searchTimeoutMilliseconds);a.preventDefault()})};e.prototype.search=function(){this.pageIndex=
0;this.loadMoreItems({cleanExistingEntries:!0})};e.prototype.loadMoreItems=function(b){var a=this;b=(void 0===b?{}:b).cleanExistingEntries;var d=this.currentObjects.itemList;this.isLoadingInProgress=!0;if(void 0===b?0:b)d.empty(),this.controls.NoItemsFoundPanel.hide(),this.controls.AjaxLoader.show(),this.controls.GroupList.hide(),this.controls.ParticipantList.hide();this.itemsRequest&&this.itemsRequest.abort&&this.itemsRequest.abort();this.itemsRequest=this.searchOrLoadMore();this.itemsRequest.done(function(b){a.utility.findLoadMoreItemsPointer(d).remove();
d.append(b);var f=a.utility.findLoadMoreItemsPointer(d);b=a.utility.findListItems(d).length;var c=0!==b;f=0<f.length?a.utility.getVirtualCount(f):b;a.controls.PageInfo.toggle(c).text(CCL.CommonFunctions.formatString(a.settings.Terms.ShowingXofYLabelFormat,b,f));d.toggle(c);a.controls.NoItemsFoundPanel.toggle(!c);a.pageIndex++;a.updateCheckboxes()}).always(function(){a.itemsRequest=void 0;a.isLoadingInProgress=!1;a.controls.AjaxLoader.hide();a.utility.controls.ParticipantList.toggle(a.currentObjects.itemType===
c.ItemType.Participant);a.utility.controls.GroupList.toggle(a.currentObjects.itemType===c.ItemType.Group);0===a.utility.findListItems(d).length&&(a.controls.GroupList.hide(),a.controls.ParticipantList.hide())})};e.prototype.setupOkButtonClickHandler=function(){var b=this;this.controls.OkButton.click(function(a){b.applySelectedItems();b.applyKpiOnSave();CssModal.closeDialog();a.preventDefault()})};e.prototype.applySelectedItems=function(){this.personObjects.checkboxStateManager.commitPendingStateMap();
this.groupObjects.checkboxStateManager.commitPendingStateMap();this.updatePickerResultHidden();this.updateParticipantsText()};e.prototype.updateParticipantsText=function(){var b=0<this.personItemsSelected.length+this.groupItemsSelected.length;this.controls.ParticipantText.toggle(b);this.controls.NoOneIsChosenLabel.toggle(!b);b&&this.controls.ParticipantText.text(this.getParticipantsText(this.personItemsSelected,this.groupItemsSelected))};e.prototype.getParticipantsText=function(b,a){return 0===b.length?
0===a.length?null:1===a.length?this.settings.Terms.TaskAssignedToX.replace("{0}",a[0].Title):this.settings.Terms.TaskAssignedToXGroups.replace("{0}",a.length):1===b.length?0===a.length?this.settings.Terms.TaskAssignedTo1Participant:1===a.length?this.settings.Terms.TaskAssignedTo1ParticipantY.replace("{0}",a[0].Title):this.settings.Terms.TaskAssignedTo1ParticipantYGroups.replace("{0}",a.length):0===a.length?this.settings.Terms.TaskAssignedToXParticipants.replace("{0}",b.length):1===a.length?this.settings.Terms.TaskAssignedToXParticipantsY.replace("{0}",
b.length).replace("{1}",a[0].Title):this.settings.Terms.TaskAssignedToXParticipantsYGroups.replace("{0}",b.length).replace("{1}",a.length)};e.prototype.updateCheckboxes=function(){var b=this;this.currentObjects.checkboxStateManager.withIgnoreCheckboxEvents(function(){b.utility.findListItems(b.currentObjects.itemList).each(function(a,d){a=$(d);a=b.utility.getItemId(a);b.toggleOptionCheckBox(a,b.currentObjects.checkboxStateManager.isItemPendingChecked(a))})});this.updateSelectAllCheckBoxValue()};e.prototype.openDialog=
function(){this.controls.SearchTextBox.focus();this.modalDialog.openDialog(!1);this.controls.SearchTextBox.val("");this.search()};e.prototype.searchOrLoadMore=function(){var b={ElementOrParentFolderId:this.settings.ElementOrParentFolderId,PageIndex:this.pageIndex,Search:this.controls.SearchTextBox.val(),IsGroups:this.optionRadioManager.isSelected(c.ItemType.Group)};return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetParticipantOrGroupListContent,data:b,dataType:"html"})};e.prototype.updateSelectAllCheckBoxValue=
function(){var b=Array.from(this.currentObjects.itemList.get(0).querySelectorAll("input[type=checkbox]"));this.currentObjects.selectAllCheckBox&&(this.currentObjects.selectAllCheckBox.checked=b.every(function(a){return a.checked}))};e.prototype.updateSelectedOnChange=function(b,a,d,f){b?a.some(function(a){return a.Id===d})||a.push({Id:d,Title:f}):a=a.filter(function(a){return a.Id!==d});return a};e.prototype.updatePickerResultHidden=function(){var b={ParticipantIds:this.personObjects.checkboxStateManager.getSelectedItemIds(),
GroupIds:this.groupObjects.checkboxStateManager.getSelectedItemIds()};this.controls.PickerResultHidden.val(JSON.stringify(b))};e.prototype.toggleOptionCheckBox=function(b,a){if(b=this.currentObjects.getCheckbox(b))a="boolean"===typeof a?a:a(b.is(":checked")),b.is(":checked")!==a&&(b.prop("checked",a),b.trigger("change"))};e.prototype.switchCurrentObjects=function(){this.currentObjects=this.optionRadioManager.isSelected(c.ItemType.Participant)?this.personObjects:this.groupObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups()};
e.prototype.updateUiAfterSwitchBetweenParticipantsAndGroups=function(){this.utility.controls.ParticipantList.toggle(this.currentObjects.itemType===c.ItemType.Participant);this.utility.controls.GroupList.toggle(this.currentObjects.itemType===c.ItemType.Group);this.utility.controls.SearchTextBox.prop("placeholder",this.currentObjects.terms.searchPlaceholder)};e.prototype.applyKpiOnSave=function(){null!=this.settings.KpiModel&&0<this.settings.KpiModel.ElementType&&(this.settings.KpiModel.ExtensionId===
this.assignmentExtensionId||this.settings.KpiModel.ExtensionId===this.testToolExtensionId)&&CCL.CommonFunctions.measureKpi(this.settings.KpiModel.Url,this.settings.KpiModel.Section,this.settings.KpiModel.Measurement,this.settings.KpiModel.Context)};return e}();c.PickerManager=g})(c.ElementParticipantPicker||(c.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){var a=this;c.enrolInCoursesInstance=this;this.coursesTableSelector=b.CoursesTableSelector;this.checkboxColumnSelector=b.CheckboxColumnSelector;this.alertMessageText=b.AlertMessageText;$(b.ToolbarSelector+" a").click(function(b){return a.checkBeforeEnrolWithdraw(b)})}e.prototype.isAnyCourseSelected=function(){return 0<$(this.coursesTableSelector+" "+this.checkboxColumnSelector+" input:checked").length};e.prototype.checkBeforeEnrolWithdraw=function(b){if(!this.isAnyCourseSelected())return b.preventDefault(),
jAlert(this.alertMessageText),!1};return e}();c.EnrolInCourses=g})(c.Courses||(c.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this.isTopicSelected=function(){return parseInt(d.topicPickerInstance.getSelectedItem().id,10)>d.settings.NotChosenOptionValue};this.settings=b;this.controls=a;$(function(){d.controls.ShowInPlannerCheckbox.change(function(){var a=d.controls.ShowInPlannerCheckbox.is(":checked");a||(d.topicPickerInstance.closeMenu(),d.planPickerInstance.closeMenu());d.controls.TopicPlanPanel.toggle(a)});d.settings.UseTopics&&(d.planPickerInstance.toggleEnabled(d.isTopicSelected()&&
d.controls.ShowInPlannerCheckbox.is(":enabled")),d.topicPickerInstance.onchange(function(){d.planPickerInstance.toggleEnabled(!1);d.isTopicSelected()||!d.planPickerInstance.hasAnyItems()?(d.topicPickerInstance.toggleEnabled(!1),d.controls.PlanPicker.hide(),d.controls.NoPlansLabel.hide(),d.controls.Loader.show(),$.ajax({type:"GET",url:d.settings.Actions.GetPlansForCourseAndTopic,data:{courseId:d.settings.CourseId,topicId:d.topicPickerInstance.getSelectedItem().id,selectPlanLabel:d.settings.Resources.SelectPlan}}).always(function(){d.controls.Loader.hide();
d.planPickerInstance.toggleEnabled(d.isTopicSelected());d.topicPickerInstance.toggleEnabled(!0)}).done(function(a){var b=1<a.length||!d.isTopicSelected();d.planPickerInstance.loadMenu(a);d.planPickerInstance.selectItem(2===a.length?a[1].id:d.settings.NotChosenOptionValue);d.controls.PlanPicker.toggle(b);d.controls.NoPlansLabel.toggle(!b);d.planPickerInstance.resizeComponent()})):(d.planPickerInstance.selectItem(d.settings.NotChosenOptionValue),d.controls.PlanPicker.show(),d.controls.NoPlansLabel.hide(),
d.planPickerInstance.resizeComponent())}))})}Object.defineProperty(c.prototype,"topicPickerInstance",{get:function(){return"undefined"===typeof this.topicPickerInstanceValue?this.topicPickerInstanceValue=window[this.settings.ClientInstanceNames.Topic]:this.topicPickerInstanceValue},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"planPickerInstance",{get:function(){return"undefined"===typeof this.planPickerInstanceValue?this.planPickerInstanceValue=window[this.settings.ClientInstanceNames.Plan]:
this.planPickerInstanceValue},enumerable:!0,configurable:!0});return c}();c.ElementPlanPicker=g})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=c.CalendarControllerModels.EventType,b=function(){function a(a){this.utility=a}a.prototype.parseEventType=function(a){if(this.hasEventTypePrefix(this.coursePrefix,a)){var b=e.Course;a=parseInt(a.substring(this.coursePrefix.length),10)}else this.hasEventTypePrefix(this.projectPrefix,a)?(b=e.Project,a=parseInt(a.substring(this.projectPrefix.length),10)):(b=e.Person,a=0);return{eventType:b,locationId:a}};a.prototype.parseCourseId=function(a){var b=this.parseEventType(a);
if(b.eventType!==e.Course)throw Error("Invalid location: expected course, got "+a);return b.locationId};a.prototype.hasEventTypePrefix=function(a,b){return b&&b.startsWith(a)&&b.length>a.length};Object.defineProperty(a.prototype,"coursePrefix",{get:function(){return this.utility.settings.locationPrefixes.courseValuePrefix},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"projectPrefix",{get:function(){return this.utility.settings.locationPrefixes.projectValuePrefix},enumerable:!0,
configurable:!0});return a}();g.EventTypeParser=b})(c.Schedule||(c.Schedule={}))})(c.Calendar||(c.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(e){var b=this;this.findSectionOrMeasurement=function(a,d){$.getJSON(b.settings.FindSectionOrMeasurementUrl,{search:a.term},function(a){d($.map(a,function(a){return{value:a.Name,isMeasurement:a.IsMeasurement,id:a.Id}}))})};this.renderSearchBoxItem=function(a,b){return $("<li/>").append("<span "+(b.isMeasurement?"":"class='h-fnt-bd'")+">"+b.value+"</span>").appendTo(a)};this.selectSearchBoxItem=function(a,d){b.searchKpiContent(d.item.value,
d.item.id)};this.searchKpiContent=function(a,d){window.location.search="?"+b.settings.SearchStringParamName+"="+a+"&"+b.settings.SearchValueParamName+"="+(d?d:"")};c.measureFilterInstance=this;this.settings=e;this.settings.Controls.SearchBoxContainer.on(this.settings.TextSearchEvent,function(a,d){return b.searchKpiContent(d,null)})}}();c.MeasureFilter=g})(c.FeatureAdoption||(c.FeatureAdoption={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){c[c.SingleFile=1]="SingleFile";c[c.MultipleFiles=2]="MultipleFiles";c[c.MultipleFilesAndFolders=3]="MultipleFilesAndFolders"})(c.UploadType||(c.UploadType={}));(function(c){c[c.Pending=1]="Pending";c[c.InProgress=2]="InProgress";c[c.Success=3]="Success";c[c.Error=4]="Error";c[c.PartialSuccess=5]="PartialSuccess"})(c.UploadStatus||(c.UploadStatus={}))})(c.Folder||(c.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(c,b,a){var d=this;this.settings=c;this.summaryParser=b;this.feedbackManager=a;this.handleInitialUploadSummary=function(a){a.IsProcessingInProgress?(d.feedbackManager.showInformationFeedback(d.settings.uploadInProgressMessage),d.wasPollingStarted=!0,d.checkStatusAfterInterval()):d.handleUploadsFinished(a)};this.checkStatusAfterInterval=function(){setTimeout(d.checkUploadStatus,d.settings.pollingIntervalInMilliseconds)};this.checkUploadStatus=
function(){$.getJSON(d.settings.statusServiceUrl,{folderId:d.settings.folderId}).then(d.handleSubsequentUploadSummary).fail(d.handleErrorResponse)};this.handleSubsequentUploadSummary=function(a){a.IsProcessingInProgress?d.checkStatusAfterInterval():d.handleUploadsFinished(a)};this.handleUploadsFinished=function(a){d.feedbackManager.hideInformationFeedback();d.summaryParser.isThereOnlyOneSingleFileUpload(a)?d.handleOneSingleFileUploadFinished(a):d.summaryParser.areThereAnyUploadsToHandle(a)&&d.handleManyFileUploadsFinished(a)};
this.handleOneSingleFileUploadFinished=function(a){d.summaryParser.areAllUploadsFinishedWithSuccess(a)?(a=d.summaryParser.getFileNamesForSingleFileUploads(a)[0],a=CCL.CommonFunctions.htmlEncode(a),a=d.settings.singleFileXUploadSuccessMessage.replace("{0}","<strong>"+a+"</strong>"),d.feedbackManager.showInformationFeedback(a),d.refreshTreeMenuIfNeeded()):d.feedbackManager.showErrorFeedback(d.settings.singleFileUploadErrorMessage)};this.handleManyFileUploadsFinished=function(a){d.summaryParser.areAllUploadsFinishedWithSuccess(a)?
d.displayMessageWithRefreshInstructionsIfNeeded(d.settings.multipleFileUploadSuccessMessage):d.summaryParser.areUploadsFinishedWithPartialSuccess(a)?d.displayMessageWithRefreshInstructionsIfNeeded(d.settings.partialSuccessMessage):d.feedbackManager.showErrorFeedback(d.settings.multipleFileUploadErrorMessage)};this.displayMessageWithRefreshInstructionsIfNeeded=function(a){d.shouldDisplayRefreshButton()?d.feedbackManager.showInformationFeedback("<strong>"+a+"</strong> "+d.settings.pleaseRefreshThePageToSeeThemMessage,
d.refreshElementsList):(d.refreshTreeMenuIfNeeded(),d.feedbackManager.showInformationFeedback(a))};this.shouldDisplayRefreshButton=function(){return d.wasPollingStarted};this.handleErrorResponse=function(a){401===a.status?d.redirectToLogOutPage():d.checkStatusAfterInterval()};this.redirectToLogOutPage=function(){window.itslTop.location.replace(d.settings.logOutPageUrl)};this.refreshElementsList=function(){d.refreshTreeMenuIfNeeded();d.refreshWindow()};this.refreshTreeMenuIfNeeded=function(){if(d.settings.isTreeMenuRendered){var a=
new CCL.CommonWindowMessages.GenericMessage(d.settings.refreshTreeMenuPostMessageName);CCL.CommonFunctions.makePostMessageCall(window.parent,a)}};this.refreshWindow=function(){location.reload()};b.areThereAnyUploadsToHandle(c.initialSummary)&&this.handleInitialUploadSummary(c.initialSummary)}}();c.UploadStatusChecker=g})(c.Folder||(c.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(c,b,a){var d=this;this.refreshButtonText=a;this.showInformationFeedback=function(a,b){var c={disableAutomaticHiding:!0};b&&(c.extraButtonName=d.refreshButtonText,c.extraButtonCallback=b);CCL.InformationFeedback.showFeedback(d.informationFeedbackContainer,a,c)};this.showErrorFeedback=function(a){CCL.CommonFunctions.isMobileDevice();CCL.ErrorFeedback.showFeedback(d.errorFeedbackContainer,a,function(){})};this.hideInformationFeedback=function(){CCL.InformationFeedback.hideFeedback(d.informationFeedbackContainer)};
this.informationFeedbackContainer=$("#"+c);this.errorFeedbackContainer=$("#"+b)}}();c.UploadStatusFeedbackManager=g})(c.Folder||(c.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(){var e=this;this.areThereAnyUploadsToHandle=function(b){return b&&(b.IsProcessingInProgress||b.UploadInfos&&0<b.UploadInfos.length)};this.isThereOnlyOneSingleFileUpload=function(b){return b&&b.UploadInfos&&1===b.UploadInfos.length&&b.UploadInfos[0].UploadType===c.UploadType.SingleFile};this.areAllUploadsFinishedWithSuccess=function(b){return b&&b.UploadInfos&&0<b.UploadInfos.length&&b.UploadInfos.every(function(a){return a.Status===c.UploadStatus.Success})};
this.areUploadsFinishedWithPartialSuccess=function(b){return b&&b.UploadInfos&&(b.UploadInfos.some(function(a){return a.Status===c.UploadStatus.PartialSuccess})||b.UploadInfos.some(function(a){return a.Status===c.UploadStatus.Success})&&b.UploadInfos.some(function(a){return a.Status===c.UploadStatus.Error}))};this.getFileNamesForSingleFileUploads=function(b){return b&&b.UploadInfos?b.UploadInfos.filter(function(a){return a.UploadType===c.UploadType.SingleFile}).map(e.getSingleFileUploadFileName):
[]};this.getSingleFileUploadFileName=function(b){return b.Details&&b.Details.Name?b.Details.Name:""}}}();c.UploadSummaryParser=g})(c.Folder||(c.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b){this.settings=b;this.elementLinkDialogManagerInstance=c.ElementLinkDialog.elementLinkDialogManagerInstance;g.learningObjectiveStateRepositoryManagerInstance=this;this.hasAnyChanges=!1}e.prototype.openDialog=function(b,a){var d=this,f=[];a={elementStates:g.LearningObjectiveRepositoryHelper.convertElementIdsToElementStateMapping(a,c.CheckboxStateMachine.State.AttachedByUser),disabledElementIds:a,showAll:!0,header:this.settings.Terms.Header,elementType:c.ElementLinkDialog.ContentElementType.LearningObjectives,
allowFolderSelection:!0,openerPage:c.ElementLinkDialog.ElementsPopupOpener.None,afterOkClickCallback:function(a){a&&(a.forEach(function(a,b){a!==c.CheckboxStateMachine.State.AttachedByUser&&a!==c.CheckboxStateMachine.State.Saved||f.push(b)}),0<f.length&&(d.hasAnyChanges=!0,d.connectElementsToState(f,b)))},afterCloseDialogCallback:function(){d.hasAnyChanges&&setTimeout(function(){location.reload()},100)}};this.elementLinkDialogManagerInstance.openDialog(a,{countryCode:this.settings.CountryCode})};
e.prototype.deleteLearningObjectivesFromState=function(b,a){$.ajax({type:"DELETE",url:this.settings.Urls.DeleteLearningObjectivesFromState,data:{learningObjectiveId:b,stateId:a},dataType:"html"}).done(function(){location.reload()})};e.prototype.connectElementsToState=function(b,a){$.ajax({type:"PUT",url:this.settings.Urls.AddLearningObjectivesToState,data:{learningObjectiveIds:b,stateId:a},dataType:"html"}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};return e}();g.LearningObjectiveStateRepositoryManager=
k})(c.LearningObjectiveRepository||(c.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){var a=this;this.dialogSelfClickHandler=function(b){b.stopPropagation();a.contextDialog.isOpened()&&window.setTimeout(function(){a.contextDialog.closeDialog()},100)};this.contextDialogControlId="#"+b.ContextDialogControlId;this.alignmentReportItemSelector=$(b.ReportItemSelector);this.contextDialogActivatorSelector=$(b.ContextDialogActivatorSelector);this.activeItemClassName=b.ActiveItemClassName;this.contextDialogContentContainerSelector=b.ContextDialogContentContainerSelector;
this.filterContainer=$(b.FilterContainerSelector);this.filterDataAttributeSuffix=b.FilterDataAttributeSuffix;this.itemsContainer=$(b.ItemsContainerSelector);this.measureViewAlignedUrl=b.MeasureViewAlignedUrl;this.measureViewNotAlignedUrl=b.MeasureViewNotAlignedUrl;this.measureViewAttachedDataUrl=b.MeasureViewAttachedDataUrl;this.initContextDialog();this.initReportItem();this.initFilter()}c.prototype.openContextDialog=function(b){this.contextDialog.isOpened()&&this.contextDialog.closeDialog();this.contextDialog.openDialogAt(b.x,
b.y)};c.prototype.initReportItem=function(){var b=this;this.contextDialogActivatorSelector.on("click",function(a){var d=$(a.currentTarget);d.addClass(b.activeItemClassName);var c=d.find(b.contextDialogContentContainerSelector).html();b.contextDialog.setContent(c);d=d.position();b.openContextDialog({x:d.left,y:d.top});b.contextDialog.setBeforeCloseDialog(function(){$(a.currentTarget).removeClass(b.activeItemClassName)});$.ajax(b.measureViewAttachedDataUrl)})};c.prototype.initContextDialog=function(){var b=
this;this.contextDialog=new ContextDialog(this.contextDialogControlId,{showHeader:!1,blackThemeActivated:!1,showCloseLink:!0,width:"404px",scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!0,marginTop:35,marginLeft:-2,marginRight:0,marginBottom:0,cssClass:"itsl-lo-alignment-report-context-dialog"});$(document).on({"contextdialog:show":function(){window.setTimeout(function(){b.contextDialog.mainContainer.on("click",b.dialogSelfClickHandler)},100)},"contextdialog:close":function(){b.contextDialog.mainContainer.off("click",
b.dialogSelfClickHandler)}})};c.prototype.initFilter=function(){var b=this,a=this.filterContainer.find("a[data-"+this.filterDataAttributeSuffix+"]"),d=a.map(function(a,d){return $(d).data(b.filterDataAttributeSuffix)}).get().join(" ");a.click(function(c){c=$(c.target);a.removeClass(b.activeItemClassName);c.addClass(b.activeItemClassName);c=c.data(b.filterDataAttributeSuffix);b.itemsContainer.removeClass(d).addClass(c);"filter-aligned"===c?$.ajax(b.measureViewAlignedUrl):"filter-not-aligned"===c&&
$.ajax(b.measureViewNotAlignedUrl)})};return c}();c.AlignmentReport=g})(c.LearningObjective||(c.LearningObjective={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){this._settings=b;this._parameters=b.ParametersNames}c.prototype.browseLibrary=function(b){var a=CCL.CommonFunctions.setQueryStringParameter(this._settings.BrowseLibraryUrl,this._parameters.CourseId,b.CourseId||this._settings.CourseId);b.RelatedEntityId&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.RelatedEntityId,b.RelatedEntityId));b.ElementCategory&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.ElementType,
b.ElementCategory));b.CustomId&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.CustomId,b.CustomId));b.LearningObjectivesIds&&0<b.LearningObjectivesIds.length&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.LearningObjectiveId,b.LearningObjectivesIds.join(",")));b.FolderId&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.FolderId,b.FolderId));this.browserDialog.setIframeUrl(a,!0);this.browserDialog.openDialog()};c.prototype.setDialogCustomScripts=
function(b){this.browserDialog.setCustomScripts(b)};Object.defineProperty(c.prototype,"browserDialog",{get:function(){return window[this._settings.ModalId]},enumerable:!0,configurable:!0});return c}();c.LibraryBrowser=g})(c.Library||(c.Library={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){var a=this;this.settings=b;this.iframeHolders=$();this.loadEmbedContentDebouncer=new CCL.CallbackDebouncer(function(){return a.loadEmbedContentAsync()});this.loadEmbedContentTimeoutInMilliseconds=300;this.embedConsideredVisibleRatio=.2;this.loadEmbedContentAftercallTimes=5;this.embedIframeShowAnimationSpeedInMilliseconds=500;$(window).on(this.settings.isIosDevice?"touchmove":"scroll",function(){return a.loadEmbedContentDebouncer.invokeCallback(0,
a.loadEmbedContentTimeoutInMilliseconds)})}c.prototype.loadEmbedContentAsync=function(b){var a=this;void 0===b&&(b=-1);var d=this.getPendingIframeHolder();if(d){var c=this.createAjaxLoader();-1<b&&c.height(b);var e=this.createIframe(this.getEmbedIframeUrl(d),!1);this.findClosestEmbedBox(d).append(c);d.append(e);e.one("load",function(){e.fadeIn(a.embedIframeShowAnimationSpeedInMilliseconds);a.loadEmbedContentAftercallIterationNumber=1;a.loadEmbedContentDebouncer.invokeCallback(0,a.loadEmbedContentTimeoutInMilliseconds)})}else 0<
this.loadEmbedContentAftercallIterationNumber&&(this.loadEmbedContentDebouncer.invokeCallback(0,this.loadEmbedContentAftercallIterationNumber*this.loadEmbedContentTimeoutInMilliseconds),this.loadEmbedContentAftercallIterationNumber+=1,this.loadEmbedContentAftercallIterationNumber>this.loadEmbedContentAftercallTimes&&(this.loadEmbedContentAftercallIterationNumber=0))};c.prototype.findIframeHolders=function(b){return b.find("[data-"+this.settings.dataAttributes.embedIframeUrl+"]")};c.prototype.appendIframeHolders=
function(b){this.iframeHolders=this.iframeHolders.add(this.findIframeHolders(b))};c.prototype.getEmbedIframeUrl=function(b){return b.data(this.settings.dataAttributes.embedIframeUrl)};c.prototype.createAjaxLoader=function(){return $("<div class='"+this.settings.cssClasses.ajaxLoader+"'></div>")};c.prototype.findAjaxLoader=function(b){return b.find("."+this.settings.cssClasses.ajaxLoader)};c.prototype.createIframe=function(b,a){return $("<iframe src='"+b+"' width='100%' height='100%' scrolling='no' class='"+
this.settings.cssClasses.noBorder+"' allowfullscreen "+(a?"":"style='display:none'")+"></iframe>")};c.prototype.removeAjaxLoader=function(b){b.find("."+this.settings.cssClasses.ajaxLoader).remove()};c.prototype.isEmbedInProgress=function(b){return 0<this.findAjaxLoader(b).length};c.prototype.getPendingIframeHolder=function(){for(var b=0;b<this.iframeHolders.length;b++){var a=this.iframeHolders.eq(b),d=this.findClosestBulletinItem(a);if(!this.isEmbedInProgress(a)&&!c.isEmbedFinished(a)&&!this.isEmbedError(d)&&
this.isOnScreen(d))return a}};c.isEmbedFinished=function(b){return 0<b.find("iframe").length};c.prototype.isEmbedError=function(b){return 0<b.find("."+this.settings.cssClasses.oembedError).length};c.prototype.isOnScreen=function(b){return CCL.CommonFunctions.isOnScreen(b,this.embedConsideredVisibleRatio,this.embedConsideredVisibleRatio,this.settings.isIosDevice?window.parent:window)};c.prototype.findClosestEmbedBox=function(b){return b.closest(this.settings.selectors.embedBox)};c.prototype.findClosestBulletinItem=
function(b){return b.closest(this.settings.selectors.bulletinItem)};return c}();c.EmbedAsynchronousLoader=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=c.Controls.Validation.ValidatorFactory,e=c.Controls.Validation.DateTimePickerValidatorFactory,b=function(){function a(a){var b=this;this.utility=a;this.undoBadInputActiveFrom=function(){b.activeFrom.highlightOnAutoCorrectInvalidInput(500);setTimeout(function(){b.activeFrom.setDateTime(b.currentStrategyValue.activeFromDate)},500)};this.undoBadInputActiveTo=function(){b.activeTo.highlightOnAutoCorrectInvalidInput(500);setTimeout(function(){b.activeTo.minDate=b.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds;
b.activeTo.minDate.setMinutes(b.activeTo.minDate.getMinutes()+5);b.activeTo.setDateTime(!b.currentStrategyValue.activeToDate||b.currentStrategyValue.activeToDate<b.activeTo.minDate?b.activeTo.minDate:b.currentStrategyValue.activeToDate)},500)};this.runCheckOnBlurEvent(this.activeFrom,k.until(e.invalidDateDenyEmptyNoHighlight(this.activeFrom,this.utility.settings.Resources.InvalidDateFormat,this.undoBadInputActiveFrom),k.checkNoHighlight(this.activeFrom,function(){return b.activeFrom.getDateTime()<
b.activeFrom.minDate},"",this.undoBadInputActiveFrom)));this.runCheckOnBlurEvent(this.activeTo,k.until(e.invalidDateAllowEmptyNoHighlight(this.activeTo,this.utility.settings.Resources.InvalidDateFormat,this.undoBadInputActiveTo),k.checkNoHighlight(this.activeTo,function(){return b.activeTo.getDateTime()<=b.activeTo.minDate},"",this.undoBadInputActiveTo),k.checkNoHighlight(this.activeTo,function(){return b.activeTo.getDateTime()<=b.activeFrom.getDateTime()},this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate,
void 0)))}Object.defineProperty(a.prototype,"currentStrategy",{set:function(a){this.currentStrategyValue=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeFrom",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeTo",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},enumerable:!0,configurable:!0});a.prototype.validateDates=function(){var a=
this;return k.all(e.invalidDateDenyEmpty(this.activeFrom,this.utility.settings.Resources.InvalidDateFormat),k.until(k.checkNoHighlight(this.activeFrom,function(){return a.activeFrom.getDateTime()<a.activeFrom.minDate},"",this.undoBadInputActiveFrom),e.invalidDateAllowEmpty(this.activeTo,this.utility.settings.Resources.InvalidDateFormat),k.checkNoHighlight(this.activeTo,function(){return a.activeTo.getDateTime()<=a.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds},"",this.undoBadInputActiveTo),
e.compareDates(k.lessThanOrEqual,this.activeTo,this.activeFrom.getDateTime(),this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate)))()};a.prototype.runCheckOnBlurEvent=function(a,b){$(a).on("blur",function(){setTimeout(function(){a.isFocusWithinControl()||b()},1)})};return a}();g.ScheduleDialogInputValidator=b})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){this.inputValidator=a;this.utilityValue=b;this.activeFromPickerInstance.dependentPicker=this.activeToPickerInstance}Object.defineProperty(c.prototype,"activeFromDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"activeToDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"strategicData",{get:function(){return this.strategicDataValue},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"utility",{get:function(){return this.utilityValue},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"activeFromPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"activeToPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},
enumerable:!0,configurable:!0});c.prototype.loadDialogState=function(b,a){this.strategicDataValue=a;this.inputValidator.currentStrategy=this;this.utility.synchronizeDateTimePicker(this.activeFromPickerInstance);this.activeFromPickerInstance.toggleValidationError({isInvalid:!1});this.activeToPickerInstance.toggleValidationError({isInvalid:!1});this.loadDialogStateDone(b)};c.prototype.persistDialogState=function(){this.inputValidator.validateDates()&&(this.persistValidatedDialogState(),this.inputValidator.currentStrategy=
void 0)};c.prototype.loadDialogStateDone=function(b){throw Error("Abstract method should be overriden");};c.prototype.persistValidatedDialogState=function(){throw Error("Abstract method should be overriden");};return c}();c.ScheduleDialogBaseStorageStrategy=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(c){function b(a,b){c.call(this,a,b);this.resetStorage()}__extends(b,c);Object.defineProperty(b.prototype,"activeFromDate",{get:function(){return this.storage.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeToDate",{get:function(){return this.storage.activeTo},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeFrom",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom)},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeTo",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)},enumerable:!0,configurable:!0});b.prototype.resetStorage=function(){this.storage={activeFrom:void 0,activeTo:void 0}};b.prototype.loadDialogStateDone=function(a){a.OkButton.val(this.utility.settings.Resources.ApplyButtonText);a=this.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds;if(!this.storage.activeFrom||this.storage.activeFrom<
a)this.storage.activeFrom=a;this.storage.activeTo&&this.storage.activeTo<a&&(this.storage.activeTo=a);this.activeFromPickerInstance.minDate=a;this.activeToPickerInstance.minDate=a;this.activeFromPickerInstance.setDateTime(this.storage.activeFrom);this.activeToPickerInstance.setDateTime(this.storage.activeTo)};b.prototype.persistValidatedDialogState=function(){this.storage={activeFrom:this.activeFromPickerInstance.getDateTime(),activeTo:this.activeToPickerInstance.getDateTime()};this.storage.activeFrom||
this.storage.activeTo?this.utility.ajaxClient.getTimeSpan({ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom),ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)}).done(this.strategicData.onSuccess).always(CssModal.closeDialog):CssModal.closeDialog()};return b}(c.ScheduleDialogBaseStorageStrategy);c.ScheduleDialogTemporaryStorageStrategy=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(e){function b(a,b){e.call(this,a,b)}__extends(b,e);Object.defineProperty(b.prototype,"activeFromDate",{get:function(){return this.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeToDate",{get:function(){return this.activeTo},enumerable:!0,configurable:!0});b.prototype.loadDialogStateDone=function(a){var b=this;a.OkButton.val(this.utility.settings.Resources.OkButtonText);this.activeFromPickerInstance.setDateTime(void 0);this.activeToPickerInstance.setDateTime(void 0);
this.activeTo=this.activeFrom=void 0;this.utility.ajaxClient.getSchedule(this.strategicData.lightBulletinId).done(function(a){return c.GenericResponseHandler.handle(a,function(){var d=a.ResponseData;b.activeFrom=CCL.SerializableDateTimeConverter.toDate(d.ActiveFrom);b.activeTo=CCL.SerializableDateTimeConverter.toDate(d.ActiveTo);b.activeFromPickerInstance.setDateTime(b.activeFrom);b.activeFromPickerInstance.minDate=CCL.SerializableDateTimeConverter.toDate(d.Created);b.activeToPickerInstance.setDateTime(b.activeTo);
b.activeToPickerInstance.minDate=new Date},function(){CssModal.closeDialog();a.Code===c.GenericResponseCode.LightBulletinNotFound&&b.utility.removeBulletin(b.utility.getBulletinById(b.strategicData.lightBulletinId))})})};b.prototype.persistValidatedDialogState=function(){this.utility.ajaxClient.updateSchedule(this.strategicData.lightBulletinId,{ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.activeFromPickerInstance.getDateTime()),ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.activeToPickerInstance.getDateTime())},
this.strategicData.bulletinsDisplayMode).done(this.strategicData.onSuccess).always(CssModal.closeDialog)};return b}(c.ScheduleDialogBaseStorageStrategy);c.ScheduleDialogAjaxStorageStrategy=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){this.utility=b}Object.defineProperty(c.prototype,"areCommentsDisabledForNewBulletins",{get:function(){return this.areCommentsDisabledForNewBulletinsValue},set:function(b){this.areCommentsDisabledForNewBulletinsValue=b;this.utility.controls.AddMenu.ToggleCommentsOptionSpan.text(this.getToggleCommentsTerm(b));this.utility.controls.CommentsAvailabilityStatusPlaceHolder.toggle(b)},enumerable:!0,configurable:!0});c.prototype.resetCommentsDisabledForNewBulletins=
function(){this.areCommentsDisabledForNewBulletins=this.utility.settings.DisableLightBulletinCommentsDefaultValue};c.prototype.togglePossibilityToAddComments=function(b,a,d){d&&CCL.DomElementClass.GetInstanceForElement(b.CommentControlClientInstanceName).togglePossibilityToAddComments(!b.DisableComments);a.text(this.getToggleCommentsTerm(b.DisableComments))};c.prototype.getToggleCommentsTerm=function(b){return b?this.utility.settings.Resources.EnableComments:this.utility.settings.Resources.DisableComments};
return c}();c.LightBulletinCommentToggler=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){this.scrollTopTimeoutMilliseconds=200;this.animationTimeInMilliseconds=b.animationTimeInMilliseconds}c.prototype.animateShow=function(b,a){b.slideDown(this.animationTimeInMilliseconds,function(){a&&a();b.css("overflow","")})};c.prototype.animateHideAndRemove=function(b,a){this.animateHide(b,function(){b.remove();a&&a()})};c.prototype.animateScrollTop=function(b,a,d){var c=this;void 0===d&&(d=!1);setTimeout(function(){$("html, body").animate({scrollTop:b},
{duration:d?0:c.animationTimeInMilliseconds,complete:a})},this.scrollTopTimeoutMilliseconds)};c.prototype.animateHide=function(b,a){b.slideUp(this.animationTimeInMilliseconds,a)};return c}();c.LightBulletinAnimator=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){c=c.LightBulletin||(c.LightBulletin={});c=c.LightBulletinConstants||(c.LightBulletinConstants={});c.maxCountOfAddedElements=50;c.animationTimeInMilliseconds=250;c.watchEmbedsPasteTimeoutInMilliseconds=50;c.watchEmbedsKeyUpTimeoutInMilliseconds=1500;c.renderShowMoreDelayInMilliseconds=500;c.domainPartOfEmailRegexParams={regex:/(^|\s)[^a-z0-9._%+-]*(@[a-z0-9.-]+\.[a-z]{2,3})/ig,replaceGroupIndex:1};c.dataAttributeNames={pendingProcessId:"pending-process-id",loadedProcessId:"loaded-process-id"}})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b){this.utility=b;this.elementStates=new Map;this.settings=b.settings;this.checkboxStateMachine=new c.CheckboxStateMachine.Machine;this.newsContentBlock=this.utility.controls.Container.parents("."+this.settings.CssClasses.WidgetCbNews)}e.prototype.onResourceButtonClick=function(b,a,d,f,e){var h=this,m=this.elementStates.has(b)?this.elementStates.get(b):this.initiallyLoadElementStatesFromUi(b,a),k={locationId:this.settings.CourseId,locationType:this.settings.LocationTypeCourse};
c.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog({elementStates:c.MapUtils.makeCopy(m),afterOkClickCallback:function(g){return h.onDialogAddButtonClick(b,a,c.MapUtils.makeCopy(g),d,f,e)},afterCloseDialogCallback:function(){h.utility.animator.animateScrollTop(0<b?a.offset().top:h.newsContentBlock.offset().top,function(){return a.find("."+h.settings.CssClasses.EditorTextarea).focus()},h.settings.IsIeBrowser)},maxCountOfAddedElements:g.LightBulletinConstants.maxCountOfAddedElements,elementType:c.ElementLinkDialog.ContentElementType.All,
showAll:!0,header:this.settings.Resources.ElementLinkDialogHeader,allowFolderSelection:!0},k)};e.prototype.onDetachResourceButtonClick=function(b,a,d,f){var h=d.data(this.settings.DataAttributes.ElementLinkElementId);this.elementStates.has(b)||this.elementStates.set(b,this.initiallyLoadElementStatesFromUi(b,a));var e=this.elementStates.get(b),g=e.get(h);g=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,g);e.set(h,g);g===c.CheckboxStateMachine.State.Empty?(d.remove(),f()):g===
c.CheckboxStateMachine.State.DetachedByUser&&this.hideWhenEditOrRemoveWhenNew(b,d,f);this.toggleDetailedView(this.utility.getElementLinkList(this.utility.getCurrentBulletinItemOrNew(a)))};e.prototype.resetUnsavedElementLinks=function(b,a){if(this.elementStates.has(b)){var d=this.utility.getElementLinkList(a),f=[],e=[];this.forEachElementState(b,function(a,b){a===c.CheckboxStateMachine.State.AttachedByUser?f.push(b):a===c.CheckboxStateMachine.State.DetachedByUser&&e.push(b)});b=this.elementStates.get(b);
var g=void 0;for(g=0;g<f.length;g++){var m=f[g];d.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+m+'"]').remove();b.delete(m)}for(g=0;g<e.length;g++)m=e[g],this.utility.animator.animateShow(d.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+m+'"]')),b.set(m,c.CheckboxStateMachine.State.Saved);this.toggleDetailedView(this.utility.getElementLinkList(a))}};e.prototype.getElementIdsForBulletin=function(b){var a=[],d=[];this.forEachElementState(b,function(b,e){b===
c.CheckboxStateMachine.State.AttachedByUser?a.push(e):b===c.CheckboxStateMachine.State.DetachedByUser&&d.push(e)});return{elementsToAttach:a,elementsToDetach:d}};e.prototype.cleanAppendData=function(b,a){var d=this;if(0===b)this.elementStates.delete(b);else{var f=this.elementStates.get(b),e=[];this.forEachElementState(b,function(a,b){a!==c.CheckboxStateMachine.State.AttachedByUser&&a!==c.CheckboxStateMachine.State.DetachedByUser||e.push(b)});var g=this.utility.getElementLinkList(a);e.forEach(function(a){var b=
d.checkboxStateMachine.transferElementStateAfterSave(f.get(a));f.set(a,b);b===c.CheckboxStateMachine.State.Empty&&g.find("[data-"+d.settings.DataAttributes.ElementLinkElementId+'="'+a+'"]').remove()})}};e.prototype.onDialogAddButtonClick=function(b,a,d,f,e,l){var h=this;e();this.elementStates.set(b,d);var k=this.utility.getElementLinkList(a);0===k.length&&(k=$(this.utility.controls.Container.data(this.settings.DataAttributes.ElementLinkList)),a.find("[data-"+this.settings.DataAttributes.ElementLinkAppendTarget+
"]").append(k));var p=[],r=[];this.forEachElementState(b,function(a,d){var f=k.find("[data-"+h.settings.DataAttributes.ElementLinkElementId+'="'+d+'"]');switch(a){case c.CheckboxStateMachine.State.Empty:f.remove();break;case c.CheckboxStateMachine.State.AttachedByUser:0===f.length?r.push(d):p.push(d);break;case c.CheckboxStateMachine.State.Saved:h.utility.animator.animateShow(f);p.push(d);break;case c.CheckboxStateMachine.State.DetachedByUser:h.hideWhenEditOrRemoveWhenNew(b,f)}});0<r.length?this.utility.ajaxClient.elementLinkItemsContent(r).done(function(b){b&&
(k.append($(b)),h.sortElementLinks(k),h.toggleDetailedView(k),a.find("."+h.settings.CssClasses.ElementLinkDelete).show(),l&&l())}).fail(function(a,b,d){f();CCL.CommonFunctions.alertAjaxError(a,b,d)}):this.toggleDetailedView(k);r.length+p.length>=g.LightBulletinConstants.maxCountOfAddedElements&&this.utility.toggler.toggleResourceButton(a,!1)};e.prototype.sortElementLinks=function(b){var a=this;b.children("li").get().sort(function(b,c){var d=a.settings.IsElementListSortOrderAscending?c:b,f="data-"+
a.settings.DataAttributes.ElementLinkListItemSortExpression;return $(a.settings.IsElementListSortOrderAscending?b:c).attr(f).localeCompare($(d).attr(f))}).forEach(function(a){b.append(a)})};e.prototype.toggleDetailedView=function(b){b=b.children("li").removeClass(this.settings.CssClasses.ElementLinkListItemDetailedView).filter(":visible");1===b.length&&b.addClass(this.settings.CssClasses.ElementLinkListItemDetailedView)};e.prototype.initiallyLoadElementStatesFromUi=function(b,a){var d=this,f=new Map;
this.utility.getElementLinkList(a).children("li").each(function(a,b){a=$(b).data(d.settings.DataAttributes.ElementLinkElementId);f.set(a,c.CheckboxStateMachine.State.Saved)});this.elementStates.set(b,f);return f};e.prototype.forEachElementState=function(b,a){(b=this.elementStates.get(b))&&b.forEach(a)};e.prototype.hideWhenEditOrRemoveWhenNew=function(b,a,d){0===b?a.remove():a.hide();"function"===typeof d&&d()};return e}();g.ElementLinkBuilder=k})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){this.oembedErrorCssClasses=b;this.oembedErrorResources=a;this.linkParser=new CCL.LinkParser}c.prototype.hasOembedError=function(b){return 0!==b.find("."+this.oembedErrorCssClasses.OembedBoxError).length};c.prototype.generateOembedError=function(b,a,d,c){var f=this;b.oembedPlaceHolder.find("iframe").remove();var e=$("<a>").prop("target","_blank").prop("href",b.originalEmbedCode).text(this.linkParser.getDomain(b.originalEmbedCode));e=CCL.CommonFunctions.formatString(this.oembedErrorResources.OembedErrorMessage,
e.get(0).outerHTML);e=$('<div class="'+this.oembedErrorCssClasses.OembedErrorContentBlock+'"></div>').append('<p class="'+this.oembedErrorCssClasses.OembedErrorTitle+'">'+this.oembedErrorResources.OembedErrorTitle+"</p>").append('<span class="'+this.oembedErrorCssClasses.OembedErrorMessage+'">'+e+"</span>").append("<br />").append($('<button type="button" class="'+this.oembedErrorCssClasses.OembedErrorTryAgain+'">'+this.oembedErrorResources.OembedErrorTryAgain+"</button>").on("click",function(){var e=
"function"===typeof d?d():0,h=b.oembedPlaceHolder.find("."+f.oembedErrorCssClasses.OembedBoxError),g=h.outerHeight();h.remove();b.oembedPlaceHolder.find("iframe").remove();a.loadEmbedContentAsync(g+e);"function"===typeof c&&c()}));return $('<div class="'+this.oembedErrorCssClasses.OembedBoxError+" "+this.oembedErrorCssClasses.Clearfix+'"></div>').append('<span class="'+this.oembedErrorCssClasses.OembedErrorImageBox+'"></span>').append(e)};return c}();c.EmbedError=g})(c.LightBulletin||(c.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){this.utility=b;this.settings=b.settings;this.controls=b.controls}e.prototype.getBulletinEditor=function(b){return this.utility.isAddMode(b)?this.controls.NewBulletinText:b.data(e.bulletinEditorDataAttribute)};e.prototype.getBulletinEditorInstance=function(b){return b.data(e.bulletinEditorInstanceDataAttribute)};e.prototype.makeEditorAutoResizable=function(b){setTimeout(function(){return b.autogrow({whiteSpaceMatters:!0})})};e.prototype.createBulletinEditor=
function(b){var a=new c.LightBulletinEditorInstance(this.utility,b);b.data(e.bulletinEditorInstanceDataAttribute,a);return a};e.prototype.removeBulletinEditorInstanceDataAttribute=function(b){b.removeData(e.bulletinEditorInstanceDataAttribute)};e.prototype.resetEditor=function(b,a){b.removeAttr("style");a&&b.focus();this.utility.watchEmbeds.watchEmbeds(b)};e.bulletinEditorDataAttribute="bulletinEditor";e.bulletinEditorInstanceDataAttribute="bulletinEditorInstance";return e}();c.LightBulletinEditor=
g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){this.utility=b;this.bulletinItem=a;b=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorButtonsTemplate));this.editor=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorTemplate));this.editorButtons=b;this.cancelButton=b.find(this.utility.selectors.cancelEditAction);this.applyButton=b.find(this.utility.selectors.applyEditAction);this.bulletinId=
this.utility.getBulletinId(a)}c.prototype.removeBulletinEditor=function(){this.bulletinItem.find("[data-"+this.utility.settings.DataAttributes.BulletinItemEditorTarget+"]").children().remove();this.editorButtons.remove()};return c}();c.LightBulletinEditorInstance=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){this.utility=b}c.prototype.applyNewImageLoadingComplete=function(b){var a=this,d=this.filterNewImageBoxes(this.utility.getImageBox(b));this.utility.getImage(d).one("load",function(){return d.removeClass(a.utility.settings.CssClasses.ImageBoxLoading)})};c.prototype.hideOrRemoveImageBoxFromContainer=function(b){this.hideOrRemoveImageBox(this.utility.getImageBox(b))};c.prototype.hideOrRemoveImageBox=function(b){this.filterNewImageBoxes(b).remove();
this.filterNotNewImageBoxes(b).hide()};c.prototype.resetUnsavedImage=function(b){var a=this.utility.getImageBox(b);this.filterNewImageBoxes(a).remove();this.filterNotNewImageBoxes(a).show();this.removeImageError(b);this.clearAddImageButtonFileInputValue(b)};c.prototype.getParsedUploadResult=function(b){return this.parseSerialzedImageData(this.filterNewImageBoxes(this.utility.getImageBox(b)).last().find("input[type='hidden']"))};c.prototype.getDeleteAttachedImageValue=function(b){b=this.utility.getImageBox(b);
var a;return 0===this.filterNewImageBoxes(b).length&&0<(a=this.filterNotNewImageBoxes(b)).length&&a.length===a.not(":visible").length};c.prototype.applyImageEditsIfNeeded=function(b,a){var d=this.utility.getImageBox(b),c=this.filterNewImageBoxes(d);d=this.filterNotNewImageBoxes(d);var e=d.filter(":hidden");0<c.length&&(d.remove(),this.utility.setImageIsNew(c,!1),a&&c.find("[data-"+this.utility.settings.DataAttributes.BulletinAttachedImageLink+"]").prop("href",a));0<e.length&&e.remove();this.removeImageError(b)};
c.prototype.removeImageError=function(b){this.utility.getImageError(b).remove()};c.prototype.addImageButtonFileInputHasValue=function(b){return!!b.find(this.utility.selectors.addImageButtonFileInput).val()&&0<this.utility.getVisibleImageBox(b).length};c.prototype.clearAddImageButtonFileInputValue=function(b){b.find(this.utility.selectors.addImageButtonFileInput).val("")};c.prototype.filterNewImageBoxes=function(b){var a=this;return b.filter(function(b,c){return a.utility.getImageIsNew($(c))})};c.prototype.filterNotNewImageBoxes=
function(b){var a=this;return b.filter(function(b,c){return!a.utility.getImageIsNew($(c))})};c.prototype.parseSerialzedImageData=function(b){return 0<b.length?CCL.CommonFunctions.safeParseJson(b.val()):void 0};return c}();c.LightBulletinImageBox=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(){this.fragments=[];this.createPlaceholder=function(b){return"@@LightBulletinTextObfuscator"+b+"@@"}}c.prototype.replaceTextFragmentsWithPlaceholders=function(b,a){var d=this;return b.replace(a.regex,function(b){for(var c=[],f=1;f<arguments.length;f++)c[f-1]=arguments[f];c=c[a.replaceGroupIndex];f=d.createPlaceholder(d.fragments.length);d.fragments.push(c);return b.replace(c,f)})};c.prototype.replacePlaceholdersWithTextFragments=function(b){var a=
this;b=this.fragments.reduce(function(b,c,e){return b.replace(a.createPlaceholder(e),c)},b);this.fragments=[];return b};return c}();c.LightBulletinTextObfuscator=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b){var a=this;this.utility=b;this.watchEmbedsDebouncer=new CCL.CallbackDebouncer(function(b){return a.switchWatchEmbeds(b.element,b.enabled)})}e.prototype.toggleOembedEditClasses=function(b,a){b.find("."+this.utility.settings.CssClasses.OembedBoxHeader).toggle(!a.isViewMode);this.utility.getVisibleOembedBox(b).toggleClass(this.utility.settings.CssClasses.OembedBoxEditMode,!a.isViewMode&&!a.isEmbedInProgress)};e.prototype.toggleAddBulletinMenu=
function(b){this.utility.controls.AddMenu.LinkContainer.toggle(b)};e.prototype.switchWatchEmbeds=function(b,a){this.utility.watchEmbeds.switchWatchEmbedsInBulletinItem(b,a)};e.prototype.toggleResourceButton=function(b,a){this.utility.getCurrentBulletinItemOrNew(b).find(this.utility.selectors.addResourceAction).prop("disabled",!a)};e.prototype.toggleAddEditButton=function(b,a){this.utility.getAddEditButton(b).prop("disabled",!a)};e.prototype.toggleAddImageButton=function(b,a){b=this.utility.getAddImageButton(b);
b.prop("disabled",!a);b.find(this.utility.selectors.addImageButtonFileInput).toggle(a)};e.prototype.toggleAddToOtherCoursesButton=function(b,a){this.utility.getAddToOtherCoursesButton(b).prop("disabled",!a)};e.prototype.toggleControlsInBulletin=function(b,a){var d=this.utility.getAddEditButton(b);this.utility.isAddMode(b)?d.prop("disabled",!a.canBePosted):d.prop("disabled",a.isEmbedInProgress);this.toggleAttachingActionsToBulletin(b,a)};e.prototype.toggleAttachingActionsToBulletin=function(b,a){b=
this.utility.getCurrentBulletinItemOrNew(b);this.toggleResourceButton(b,!(a.hasVisibleOembedBox||a.isEmbedInProgress||a.maxCountOfAddedElementsReached||a.hasVisibleImage||a.isMultiCourseLightBulletin));var d=a.hasVisibleOembedBox||a.isEmbedInProgress||a.hasAttachedElementLinks||a.hasVisibleImage;this.toggleAddImageButton(b,!(a.hasVisibleOembedBox||a.isEmbedInProgress||a.hasAttachedElementLinks));var f=c.Controls.MultipleCourseSearchSelector.multipleCourseSearchSelectorDialogClientInstance.getAvailableCoursesCount();
this.toggleAddToOtherCoursesButton(b,!a.hasAttachedElementLinks&&0<f);this.watchEmbedsDebouncer.invokeCallback({element:b,enabled:!d},500)};e.prototype.toggleBulletinAttachmentButtons=function(b,a){this.toggleResourceButton(b,a);this.toggleAddImageButton(b,a)};return e}();g.LightBulletinToggler=k})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){g.linkifyNodes=function(e){var b=new c.LightBulletinTextObfuscator;e.each(function(a,d){d.innerHTML=b.replaceTextFragmentsWithPlaceholders(d.innerHTML,c.LightBulletinConstants.domainPartOfEmailRegexParams);d.innerHTML=linkifyHtml(d.innerHTML,CCL.LinkifyOptionsProvider.getDefaults());d.innerHTML=b.replacePlaceholdersWithTextFragments(d.innerHTML)})}})(c.LightBulletinLinkifyWrapper||(c.LightBulletinLinkifyWrapper={}))})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b,a,d,c){this.controls=b;this.settings=a;this.initSelectors();this.initClasses(d,c)}e.prototype.synchronizeDateTimePicker=function(b){var a=this;b.dateTimeSynchronizer=this.dateTimeSynchronizer;this.dateTimeSynchronizer.isSynchronizeNeeded&&this.ajaxClient.getCurrentDateTime().done(function(b){return a.dateTimeSynchronizer.synchronize(CCL.SerializableDateTimeConverter.toDateWithSeconds(b))})};e.prototype.validateBulletinAndToggleControls=function(b){var a=
this.textValidator.validateBulletin(this.editor.getBulletinEditor(b),this.getCurrentBulletinItemOrNew(b));this.toggler.toggleControlsInBulletin(b,a);this.isAddMode(b)&&this.toggler.toggleAddBulletinMenu(a.passedEmptyTextValidation);return a};e.prototype.linkifyTextNodes=function(b){this.linkifyNodes(b.find("[data-"+this.settings.DataAttributes.Text+"]"))};e.prototype.linkifyNodes=function(b){g.LightBulletinLinkifyWrapper.linkifyNodes(b)};e.prototype.isAddMode=function(b){return 0===b.length||b.get(0)===
this.controls.NewBulletinItem.get(0)};e.prototype.isViewMode=function(b){return 0===this.getAddEditButton(b).length};e.prototype.getBulletinId=function(b){return b.data(this.settings.DataAttributes.BulletinId)||0};e.prototype.getBulletinById=function(b){return this.controls.Container.find("[data-"+this.settings.DataAttributes.BulletinId+"='"+b+"']")};e.prototype.findBulletinItemByChild=function(b){return b.closest(this.selectors.bulletinItem)};e.prototype.getCurrentBulletinItemOrNew=function(b){return this.isAddMode(b)?
this.controls.NewBulletinItem:b};e.prototype.getAddEditButton=function(b){return this.isAddMode(b)?this.controls.PostNewBulletin:b.find(this.selectors.applyEditAction)};e.prototype.getAddImageButton=function(b){return this.getCurrentBulletinItemOrNew(b).find(this.selectors.addImageButton)};e.prototype.getAddToOtherCoursesButton=function(b){return this.controls.AddMenu.AddToOtherCoursesButton};e.prototype.removeBulletin=function(b){this.animator.animateHideAndRemove(b.closest("li"))};e.prototype.getOembedBox=
function(b){return b.find("."+this.settings.CssClasses.OembedBox)};e.prototype.getVisibleOembedBox=function(b){return this.getOembedBox(b).filter(":visible")};e.prototype.hasVisibleOembedBox=function(b){return 0<this.getVisibleOembedBox(b).length};e.prototype.getHiddenOembedBox=function(b){return this.getOembedBox(b).filter(":hidden")};e.prototype.getImageBox=function(b){return b.find("."+this.settings.CssClasses.ImageBox)};e.prototype.getImageError=function(b){return b.find("."+this.settings.CssClasses.ImageError)};
e.prototype.getVisibleImageBox=function(b){return this.getImageBox(b).filter(":visible")};e.prototype.hasVisibleImage=function(b){return 0<this.getVisibleImageBox(b).length};e.prototype.getHiddenImageBox=function(b){return this.getImageBox(b).filter(":hidden")};e.prototype.hasHiddenImage=function(b){return 0<this.getHiddenImageBox(b).length};e.prototype.getImageIsNew=function(b){return b.data(this.settings.DataAttributes.ImageIsNew)};e.prototype.setImageIsNew=function(b,a){b.data(this.settings.DataAttributes.ImageIsNew,
a)};e.prototype.getImage=function(b){return b.find("[data-"+this.settings.DataAttributes.BulletinAttachedImage+"]")};e.prototype.getTimeSpan=function(b){return b.find("."+this.settings.CssClasses.TimeSpan)};e.prototype.getAuthorContainer=function(b){return b.find("."+this.settings.CssClasses.Author)};e.prototype.hasOembedAttachedOrLoading=function(b,a){b=this.getCurrentBulletinItemOrNew(b);return this.hasVisibleOembedBox(b)||a.isEmbedInProgress(b)};e.prototype.getElementLinkList=function(b){return b.find("[data-"+
this.settings.DataAttributes.ElementLinkList+"]")};e.prototype.getCoursesContainer=function(b){return b.find("."+this.settings.CssClasses.Courses)};e.prototype.countResourcesOnUi=function(b){return this.getElementLinkList(this.getCurrentBulletinItemOrNew(b)).find("li").filter(":visible").length};e.setTabindexToHiddenElements=function(b,a,d){var c=0<a.length?a.get(0).getBoundingClientRect().top:0;b.find(d).each(function(b,d){b=d.getBoundingClientRect().top;c<b&&a.is(":visible")?$(d).attr("tabindex",
"-1"):$(d).removeAttr("tabindex")})};e.prototype.initSelectors=function(){this.selectors={applyEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionApplyEditValue+'"]',addResourceAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionAddResourceValue+'"]',cancelEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionCancelEditValue+
'"]',bulletinItem:"[data-"+this.settings.DataAttributes.BulletinId+"]",mediaAppendTarget:"[data-"+this.settings.DataAttributes.MediaAppendTarget+"]",addImageButton:"."+this.settings.CssClasses.AddImageButton,addImageButtonFileInput:"."+this.settings.CssClasses.AddImageButtonFileInput,lightBulletinActionDropDownItem:"[data-"+this.settings.SingleItemDataDataAttributes.LightBulletinActionDropDownItem+"]"}};e.prototype.initClasses=function(b,a){this.editor=new g.LightBulletinEditor(this);this.watchEmbeds=
new g.LightBulletinWatchEmbeds(b,this);this.imageBox=new g.LightBulletinImageBox(this);this.toggler=new g.LightBulletinToggler(this);this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.embedAsynchronousLoader=new g.EmbedAsynchronousLoader({isIosDevice:this.settings.IsIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+
this.settings.CssClasses.OembedBox+":visible",bulletinItem:this.selectors.bulletinItem},dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.textValidator=new g.LightBulletinTextValidator(this);this.ajaxClient=new g.LightBulletinAjaxClient(this.settings,a);this.animator=new g.LightBulletinAnimator({animationTimeInMilliseconds:g.LightBulletinConstants.animationTimeInMilliseconds});this.commentToggler=new g.LightBulletinCommentToggler(this);this.elementLinkBuilder=new g.ElementLinkBuilder(this);
this.oembedError=new g.EmbedError(this.settings.OembedErrorCssClasses,this.settings.OembedErrorResources);this.linkParser=new CCL.LinkParser;this.dateTimeSynchronizer=new c.Controls.DateTimeSynchronizer(CCL.SerializableDateTimeConverter.toDateWithSeconds(this.settings.Today));this.singleItemDataManager=new g.LightBulletinSingleItemDataManager(this.settings.SingleItemDataDataAttributes,this.settings.SingleItemDataResources)};return e}();g.LightBulletinUtility=k})(c.LightBulletin||(c.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.utility=a;this.tryAgainBulletinIds=[];this.watchEmbedsPasteHandler=function(a){d.embedCallbackDebouncer.invokeCallback($(a.currentTarget),c.LightBulletinConstants.watchEmbedsPasteTimeoutInMilliseconds)};this.watchEmbedsKeyUpHandler=function(a){var b=$(a.currentTarget);a.which===CCL.CommonConstants.keyCodes.space||a.which===CCL.CommonConstants.keyCodes.enter?d.embedCallbackDebouncer.invokeCallback(b,0):d.embedCallbackDebouncer.invokeCallback(b,
c.LightBulletinConstants.watchEmbedsKeyUpTimeoutInMilliseconds)};this.embedCallbackDebouncer=new CCL.CallbackDebouncer(b)}e.prototype.switchWatchEmbedsInBulletinItem=function(b,a){a?this.watchEmbedsInBulletinItem(b):this.stopWatchEmbedsInBulletinItem(b)};e.prototype.watchEmbedsInBulletinItem=function(b){b=this.utility.editor.getBulletinEditor(b);this.watchEmbeds(b)};e.prototype.watchEmbeds=function(b){b&&(this.stopWatchEmbeds(b),b.on("paste",this.watchEmbedsPasteHandler).keyup(this.watchEmbedsKeyUpHandler))};
e.prototype.stopWatchEmbedsInBulletinItem=function(b){b=this.utility.editor.getBulletinEditor(b);this.stopWatchEmbeds(b)};e.prototype.stopWatchEmbeds=function(b){b.off("paste",this.watchEmbedsPasteHandler).off("keyup",this.watchEmbedsKeyUpHandler)};e.prototype.shouldAppendOembedError=function(b){var a=b.oembedPlaceHolder;if(this.utility.oembedError.hasOembedError(b.oembedPlaceHolder))return!1;b=this.utility.findBulletinItemByChild(a);var d=this.utility.getBulletinId(b);return-1===this.tryAgainBulletinIds.indexOf(d)&&
(this.utility.isAddMode(b)||a.data(this.utility.settings.DataAttributes.OembedIsNew))?(a.remove(),!1):0>=this.utility.countResourcesOnUi(b)};e.prototype.appendOembedError=function(b){var a=this,d=b.oembedPlaceHolder,c=this.utility.findBulletinItemByChild(d),e=this.utility.getBulletinId(c),g=this.tryAgainBulletinIds.indexOf(e);-1!==g&&(d.data(this.utility.settings.DataAttributes.OembedIsNew,!1),this.tryAgainBulletinIds.splice(g,1));d.append(this.utility.oembedError.generateOembedError(b,this.utility.embedAsynchronousLoader,
function(){a.tryAgainBulletinIds.push(e);var d=b.oembedPlaceHolder.outerHeight();a.utility.toggler.toggleOembedEditClasses(c,{isViewMode:a.utility.isViewMode(c),isEmbedInProgress:!0});d-=b.oembedPlaceHolder.outerHeight();a.utility.linkParser.removeFromSkipUrl(b.originalEmbedCode);return d},function(){a.utility.isViewMode(c)||a.utility.validateBulletinAndToggleControls(c)}));d.removeClass(this.utility.settings.CssClasses.OembedBoxLoading)};return e}();c.LightBulletinWatchEmbeds=g})(c.LightBulletin||
(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){var b=this;this.controls=a;this.modalDialog=window[this.dialogId];this.controls.OkButton.click(function(a){a.preventDefault();b.currentStrategy.persistDialogState()})}Object.defineProperty(b.prototype,"dialogId",{get:function(){return this.controls.Container.prop("id")},enumerable:!0,configurable:!0});b.prototype.openDialog=function(a){this.currentStrategy=a.strategy;this.modalDialog.openDialog(!1);this.currentStrategy.loadDialogState(this.controls,
a.strategicData)};return b}();c.ScheduleDialogManager=e})(c.ScheduleDialog||(c.ScheduleDialog={}))})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){this.settings=b;this.textExpander=a}c.prototype.renderShowMoreLink=function(b,a,d){var c=this;void 0===d&&(d=function(){});b.each(function(b,f){b=$(f);c.textExpander.renderShowMoreTextSection(c.findClickablePlaceholder(b),c.findCollapsibleTextContainer(b),c.findContent(b),a,d)})};c.prototype.renderShowMoreLinkOnEmbedResize=function(b){b=b.closest("[data-"+this.settings.DataAttributes.BulletinId+"]");0===b.find("."+this.settings.CssClasses.EditorTextarea).length&&
this.renderShowMoreIfNeeded(b,function(){})};c.prototype.renderShowMoreWithImagesHack=function(b,a,d,c){var f=this;b.find(a).one("load",function(a){return f.renderShowMoreIfNeeded($(a.currentTarget).closest(d),c)});this.renderShowMoreLink(b,!1,c)};c.prototype.findClickablePlaceholder=function(b){return this.findByDataAttribute(b,this.settings.DataAttributes.ClickablePlaceholder)};c.prototype.findCollapsibleTextContainer=function(b){return this.findByDataAttribute(b,this.settings.DataAttributes.CollapsibleTextContainer)};
c.prototype.renderShowMoreIfNeeded=function(b,a){var d=this.findClickablePlaceholder(b);d.is(":visible")&&!this.textExpander.isCollapsed(d)&&this.textExpander.hasEnoughHeightForRenderingShowMore(this.findContent(b))||this.renderShowMoreLink(b,!1,a)};c.prototype.findContent=function(b){return this.findByDataAttribute(b,this.settings.DataAttributes.Content)};c.prototype.findByDataAttribute=function(b,a){return b.find("[data-"+a+"]")};return c}();c.ShowMoreLinkRenderer=g})(c.LightBulletin||(c.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){this.utility=b;this.settings=b.settings;this.modernInput=new CCL.ModernInput(this.settings.ModernInputCssClasses,this.settings.ModernInputDataAttributes)}e.prototype.validateEditorTextMaxLength=function(b,a){b=b.length;var d=b<=this.settings.TextMaxLength;this.modernInput.toggleTextError(a,this.createTextTooLongMessage(b),!d);return d};e.prototype.validateBulletin=function(b,a){var d=this.utility.embedAsynchronousLoader.isEmbedInProgress(a);b=
this.checkNotEmpty(b.val());var f=this.utility.hasVisibleOembedBox(a),e=this.utility.countResourcesOnUi(a),g=c.lightBulletinContentBlockInstance.isMultiCourseLightBulletin(a);return{canBePosted:!d&&(b||f),passedEmptyTextValidation:b||f&&!d,isEmbedInProgress:d,hasVisibleOembedBox:f,maxCountOfAddedElementsReached:e===c.LightBulletinConstants.maxCountOfAddedElements,hasAttachedElementLinks:0<e,hasVisibleImage:this.utility.hasVisibleImage(a),isMultiCourseLightBulletin:g}};e.prototype.toggleNoTextYetErrorMessage=
function(b,a){this.modernInput.toggleTextError(b,this.settings.Resources.NoTextYetError,!a.passedEmptyTextValidation)};e.prototype.checkNotEmpty=function(b){return 0<$.trim(b).length};e.prototype.createTextTooLongMessage=function(b){return CCL.CommonFunctions.formatString(this.settings.Resources.TextTooLongError,this.settings.TextMaxLength,b)};return e}();c.LightBulletinTextValidator=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(c){function b(a,b){c.call(this,a.CommonAjaxClientSettings,b);this.settings=a}__extends(b,c);b.prototype.page=function(a,b,c){return $.ajax({type:"GET",url:this.settings.Urls.Page,data:{courseId:this.settings.CourseId,boundaryLightBulletinId:a,boundaryLightBulletinActiveFromTicks:b,displayMode:c}})};b.prototype.createLightBulletin=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.CreateLightBulletin,data:{inputData:a},dataType:"html"})};
b.prototype.updateLightBulletin=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.UpdateLightBulletin,data:{inputData:a},dataType:"json"})};b.prototype.getSchedule=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetSchedule,data:{lightBulletinId:a},dataType:"json"})};b.prototype.getCurrentDateTime=function(){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetCurrentDateTime,dataType:"json"})};b.prototype.getTimeSpan=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetTimeSpan,
data:{schedule:a},dataType:"html"})};b.prototype.updateSchedule=function(a,b,c){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.UpdateSchedule,data:{lightBulletinId:a,schedule:b,bulletinsDisplayMode:c},dataType:"html"})};b.prototype.deleteLightBulletinPermanently=function(a,b){return CCL.CommonFunctions.safeAjax({type:"DELETE",url:b?this.settings.Urls.DeleteLightBulletinFromAllCoursesPermanently:this.settings.Urls.DeleteLightBulletinPermanently,data:{bulletinId:a},dataType:"json"})};
b.prototype.setBulletinCommentsAvailability=function(a,b){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.SetBulletinCommentsAvailability,data:{bulletinId:a,disableComments:b},dataType:"json"})};b.prototype.toggleLightBulletinSubscriptionForPerson=function(a,b){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,subscribe:b},dataType:"json"})};b.prototype.embed=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.Embed,
data:{embedUrl:a},dataType:"html"})};b.prototype.elementLinkItemsContent=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.ElementLinkItemsContent,data:{elementIds:a},dataType:"html"})};b.prototype.getBulletinElementLinksAnnouncementCompleted=function(a){return $.get(this.settings.Urls.IsBulletinElementLinksAnnouncementCompletedUrl+"?courseId="+a)};b.prototype.uploadImage=function(a,b,c){return $.ajax({type:"PUT",url:this.settings.Urls.UploadImage+"?courseId="+a+"&lightBulletinId="+
b,contentType:!1,processData:!1,dataType:"html",data:c})};b.prototype.callInsertOrUpdatePersonSettingService=function(a,b){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.InsertOrUpdateSetting,data:{name:a,value:b}})};return b}(c.CommonAjaxClient);g.LightBulletinAjaxClient=k})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(){}c.listenToEmbedSizePostmessages=function(b,a,d,c,e){CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentSize,function(f){var h=b.find("#"+f.oembedPlaceHolderId),g=h.hasClass(a)?h:h.find("."+a);f.height&&(g.css("height",f.height),d.renderShowMoreLinkOnEmbedResize(h),c.removeAjaxLoader(h.parent()),e&&e(h))})};return c}();c.EmbedResizer=g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(g){var k=c.Controls.MultipleCourseSearchSelector.MultipleCourseSearchSelector,e=function(){function b(a,b){var d=this;this.controls=a;this.settings=b;this.pendingEmbedProcessManager=new g.PendingEmbedProcessManager;this.embedBufferMap=new Map;this.renderShowMoreCallbackDebouncer=new CCL.CallbackDebouncer(function(a){return d.renderShowMoreInAddMode(a)});this.uploadImagePromiseQueue=new CCL.PromiseQueue;this.maskNavigationBarMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.maskNavigationBar);this.unmaskNavigationBarMessage=
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.unmaskNavigationBar);this.expandContentIframeMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame);this.collapseContentIframeMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame);this.afterAddingComment=function(a){a=a.userData.sourceId;var b=d.utility.getBulletinById(a);d.singleItemDataManager.subscribeToCommentsIfNeeded(b,
a)};this.lightBulletinMenuClicked=function(a){var b=d.singleItemDataManager.getLightBulletinActionDropDownItem(a),c=d.utility.getBulletinById(b.LightBulletinId);switch(b.ActionType){case g.LightBulletinDropDownMenuActionType.Edit:d.appendBulletinEditor(d.editor.createBulletinEditor(c));d.toggleViewEditMode(c,!1);break;case g.LightBulletinDropDownMenuActionType.SetCommentsAvailability:var f=!d.singleItemDataManager.getSingleItemData(c).DisableComments;d.ajaxClient.setBulletinCommentsAvailability(b.LightBulletinId,
f).done(function(b){g.GenericResponseHandler.handle(b,function(){var b=d.singleItemDataManager.refreshSingleItemData(c,function(a){return a.DisableComments=f});d.commentToggler.togglePossibilityToAddComments(b,a,d.settings.AllowedToCommentAnnouncements)},function(){b.Code===g.GenericResponseCode.LightBulletinNotFound&&d.utility.removeBulletin(c)})}).fail(d.ajaxClient.handleAjaxError);d.resetFocusOnCurrentItem(c);break;case g.LightBulletinDropDownMenuActionType.ScheduleBulletin:g.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:d.ajaxStorageStrategy,
strategicData:{lightBulletinId:b.LightBulletinId,bulletinsDisplayMode:d.activationFilterCurrentValue,onSuccess:function(a){a=$(a);a.hasClass(d.settings.CssClasses.TimeSpan)?d.utility.getTimeSpan(c).replaceWith(a):(d.utility.removeBulletin(c),d.showInformationFeedback(a,d.settings.Resources.BulletinHasBeenEditedButDoesNotMatchFilter))}}});d.resetFocusOnCurrentItem(c);break;case g.LightBulletinDropDownMenuActionType.Delete:var e=void 0,h=d.utility.getCoursesContainer(c).find("li").length;e=1<h?d.settings.Resources.DeleteGroupConfirmationText.replace("{0}",
h.toString()):d.settings.Resources.DeleteConfirmationText;var k=[];k.push(new CCL.ConfirmButtonMetaData(0===h?d.settings.Resources.Delete:d.settings.Resources.DeleteFromThisCourse,d.settings.CssClasses.DeleteButton,"confirm_delete"));1<h&&k.push(new CCL.ConfirmButtonMetaData(d.settings.Resources.DeleteFromAllCourses,d.settings.CssClasses.DeleteButton,"confirm_delete_from_all"));k.push(new CCL.ConfirmButtonMetaData(d.settings.Resources.Cancel,"","confirm_cancel"));d.toggleDeleteConfirmationAdditionalStyles(!0);
CCL.CommonFunctions.jAjaxMultiButtonConfirm(e,d.settings.Resources.DeleteBulletin,k,function(a){d.toggleDeleteConfirmationAdditionalStyles(!1);!a||"confirm_delete"!==a.customId&&"confirm_delete_from_all"!==a.customId||(d.ajaxClient.deleteLightBulletinPermanently(b.LightBulletinId,"confirm_delete_from_all"===a.customId).done(function(a){return g.GenericResponseHandler.handle(a,function(){return d.utility.removeBulletin(c)},function(){a.Code===g.GenericResponseCode.LightBulletinNotFound&&d.utility.removeBulletin(c)})}).fail(d.ajaxClient.handleAjaxError),
d.setFocusOnPreviousItem(c))});break;case g.LightBulletinDropDownMenuActionType.ToggleSubscription:var u=d.singleItemDataManager.getSingleItemData(c).SubscriptionStatus!==g.PersonSubscriptionStatus.Subscribed;d.ajaxClient.toggleLightBulletinSubscriptionForPerson(b.LightBulletinId,u).done(function(b){return g.GenericResponseHandler.handle(b,function(){return d.singleItemDataManager.updateSubscriptionStatus(c,a,u)},function(){b.Code===g.GenericResponseCode.LightBulletinNotFound&&d.utility.removeBulletin(c)})}).fail(d.ajaxClient.handleAjaxError);
d.resetFocusOnCurrentItem(c);break;case g.LightBulletinDropDownMenuActionType.ImmersiveReader:window.fetch("/restapi/personal/immersivereader/v1?ResourceType=Bulletin&ResourceId="+b.LightBulletinId).then(function(a){if(a.ok)a.json().then(function(a){window.ImmersiveReader.launchAsync(a.AccessToken,a.SubDomain,{title:a.Title,chunks:[{content:a.Text}]},{uiLang:a.UiLang,uiZIndex:1E6})});else throw Error(a.statusText);})}};this.toggleMobileMode=function(a){CCL.CommonFunctions.makePostMessageCall(window.parent,
a?d.expandContentIframeMessage:d.collapseContentIframeMessage);IframeResizer.reportSetIframeDefaultHeight()};this.onDeleteImageButtonClick=function(a){a=$(a.target);var b=d.utility.getCurrentBulletinItemOrNew(d.utility.findBulletinItemByChild(a));d.utility.imageBox.hideOrRemoveImageBox(a.closest("."+d.settings.CssClasses.ImageBox));d.utility.imageBox.clearAddImageButtonFileInputValue(b);d.focusOnTextArea(b);d.utility.validateBulletinAndToggleControls(b)};this.checkInputForEmbedUrl=function(a){d.watchEmbeds.stopWatchEmbeds(a);
var b=d.utility.findBulletinItemByChild(a),c=d.utility.getCurrentBulletinItemOrNew(b),f=d.utility.isAddMode(b)?a.closest(d.selectors.mediaAppendTarget):b.find(d.selectors.mediaAppendTarget);if(!d.utility.hasVisibleOembedBox(f)&&0===d.utility.countResourcesOnUi(b)){var e=d.utility.linkParser.getFirstLink(a.val());if(e&&e.length<=d.settings.EmbedUrlMaxLength){d.toggler.toggleBulletinAttachmentButtons(b,!1);d.toggler.toggleAddEditButton(b,!1);d.utility.imageBox.removeImageError(c);var h=d.embedAsynchronousLoader.createAjaxLoader();
f.append(h);var k=d.pendingEmbedProcessManager.createProcess(d.ajaxClient.embed(e));h.data(g.LightBulletinConstants.dataAttributeNames.pendingProcessId,k.processId);k.ajaxRequest.done(function(a){a=$(a);f.append(a);a=d.embedAsynchronousLoader.findIframeHolders(a);var b=d.embedAsynchronousLoader.createIframe(d.embedAsynchronousLoader.getEmbedIframeUrl(a),!0);a.append(b);a.data(g.LightBulletinConstants.dataAttributeNames.loadedProcessId,k.processId);d.pendingEmbedProcessManager.clearProcessAjaxRequest(k)}).fail(function(l){h.remove();
k.pendingStatus!==g.PendingProcessStatus.Aborted&&(d.pendingEmbedProcessManager.setProcessFailed(k),d.ajaxClient.handleAjaxError(l),d.watchEmbeds.watchEmbeds(a),d.watchEmbeds.shouldAppendOembedError({originalEmbedCode:e,oembedPlaceHolder:f})&&d.watchEmbeds.appendOembedError({originalEmbedCode:e,oembedPlaceHolder:f}),d.toggler.toggleOembedEditClasses(c,{isViewMode:!1,isEmbedInProgress:!0}),d.utility.validateBulletinAndToggleControls(b))})}else d.watchEmbeds.watchEmbeds(a)}};g.lightBulletinContentBlockInstance=
this;this.utility=new g.LightBulletinUtility(a,b,this.checkInputForEmbedUrl,function(){return d.formCheckBeforeUnload.DetachHandler()});this.watchEmbeds=this.utility.watchEmbeds;this.selectors=this.utility.selectors;this.editor=this.utility.editor;this.toggler=this.utility.toggler;this.embedAsynchronousLoader=this.utility.embedAsynchronousLoader;this.textValidator=this.utility.textValidator;this.commentToggler=this.utility.commentToggler;this.ajaxClient=this.utility.ajaxClient;this.elementLinkBuilder=
this.utility.elementLinkBuilder;this.singleItemDataManager=this.utility.singleItemDataManager;if(this.settings.CanAddNewBulletins||this.settings.HasOwnBulletin)this.scheduleDialogInputValidator=new g.ScheduleDialogInputValidator(this.utility),this.temporaryStorageStrategy=new g.ScheduleDialogTemporaryStorageStrategy(this.utility,this.scheduleDialogInputValidator),this.ajaxStorageStrategy=new g.ScheduleDialogAjaxStorageStrategy(this.utility,this.scheduleDialogInputValidator);this.boundaryLightBulletinId=
this.settings.InitialPageData.BoundaryLightBulletinId;this.boundaryLightBulletinActiveFromTicks=this.settings.InitialPageData.BoundaryLightBulletinActiveFromTicks;this.activationFilterCurrentValue=this.settings.BulletinsDisplayMode;this.setupFormCheckBeforeUnload();this.setupControls();this.setupControlsEvents();this.setupEventListeners()}b.prototype.isMultiCourseLightBulletin=function(a){return 0<this.utility.getBulletinId(a)?this.singleItemDataManager.getSingleItemData(a).IsMultiCourseLightBulletin:
this.postedToCoursesInNewBulletin&&0<this.postedToCoursesInNewBulletin.length};b.prototype.onActivationFilterChanged=function(a){this.activationFilterCurrentValue=parseInt(a,10);this.ajaxClient.callInsertOrUpdatePersonSettingService(this.settings.BulletinsContentBlockDisplayModePersonSettingName,a).done(WidgetLayout._reloadWindow)};b.prototype.setFocusOnPreviousItem=function(a){var b=$(this.controls.Container).children();a=b.index(a.parent().first());0<a&&a--;$(b[a]).find(".itsl-light-bulletins-person-name > a").first().focus()};
b.prototype.resetFocusOnCurrentItem=function(a){$(a).find(".itsl-light-bulletins-person-name > a").first().focus()};b.prototype.toggleDeleteConfirmationAdditionalStyles=function(a){this.adjustDialogPositionOnIosDevice(a);CCL.CommonFunctions.isPhoneScreenSize()?this.toggleMobileMode(a):CCL.CommonFunctions.makePostMessageCall(window.parent,a?this.maskNavigationBarMessage:this.unmaskNavigationBarMessage);$.alerts.dialogClass=a?this.settings.DeleteConfirmationStyle.DialogCssClass:""};b.prototype.adjustDialogPositionOnIosDevice=
function(a){CCL.CommonFunctions.isIosDevice()&&$("body").toggleClass(this.settings.CssClasses.BodyIosPositioningFix,a)};b.prototype.focusOnTextArea=function(a){this.utility.editor.getBulletinEditor(a).focus()};b.prototype.uploadImage=function(a){var b=this,f=$(a.target).closest(this.utility.selectors.addImageButtonFileInput);if(!f.prop("disabled")){var e=c.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a.target).formData;if(e){var g=this.utility.findBulletinItemByChild(f),m=this.utility.isAddMode(g)?
f.closest(this.selectors.mediaAppendTarget):g.find(this.selectors.mediaAppendTarget),k=this.utility.getCurrentBulletinItemOrNew(g);this.utility.imageBox.hideOrRemoveImageBoxFromContainer(m);this.utility.imageBox.removeImageError(m);this.watchEmbeds.stopWatchEmbedsInBulletinItem(g);this.toggler.toggleResourceButton(g,!1);this.toggler.toggleAddImageButton(g,!1);m.append(this.embedAsynchronousLoader.createAjaxLoader());this.uploadImagePromiseQueue.enqueue(function(){return b.ajaxClient.uploadImage(b.settings.CourseId,
b.utility.getBulletinId(g),e).always(function(){b.editor.getBulletinEditor(g).focus();b.embedAsynchronousLoader.removeAjaxLoader(m)}).done(function(a){b.utility.isViewMode(k)||b.utility.hasVisibleImage(k)||(m.append($(a)),b.utility.validateBulletinAndToggleControls(g),b.utility.imageBox.applyNewImageLoadingComplete(m),0<b.utility.getImageError(k).length&&b.utility.imageBox.clearAddImageButtonFileInputValue(k))}).fail(function(a){b.utility.validateBulletinAndToggleControls(g);b.utility.imageBox.clearAddImageButtonFileInputValue(k);
b.ajaxClient.handleAjaxError(a)})})}}};b.prototype.setupEventListeners=function(){this.listenToEmbedPostmessages();this.listenToEmbedSizePostmessages()};b.prototype.setupControls=function(){var a=this;this.loadEmbedContent(this.controls.Container);this.setupShowMoreLink();this.utility.linkifyTextNodes(this.controls.Container);this.settings.CanAddNewBulletins&&this.setupEditorAndApplyButton({editor:this.controls.NewBulletinText,applyButton:this.controls.PostNewBulletin},function(){return a.createLightBulletin()});
this.commentToggler.resetCommentsDisabledForNewBulletins();this.controls.NewBulletinItem.length&&this.utility.validateBulletinAndToggleControls(this.controls.NewBulletinItem)};b.prototype.setupFormCheckBeforeUnload=function(){var a=this;if(this.settings.CanAddNewBulletins){CCL.DialogWhiteList.allowDialogWithId(c.ElementLinkDialog.elementLinkDialogManagerInstance.getDialogId());CCL.DialogWhiteList.allowDialogWithId(g.ScheduleDialog.ScheduleDialogManager.instance.dialogId);CCL.DialogWhiteList.allowDialogWithId(k.instance.dialogId);
var b={enabled:!0,clearStateCallback:function(){a.resetUnsavedTextInAddMode();a.utility.imageBox.resetUnsavedImage(a.controls.NewBulletinItem);a.resetUnsavedEmbed(a.controls.NewBulletinItem,0,{preserveAjaxLoader:!1});a.elementLinkBuilder.resetUnsavedElementLinks(0,a.controls.NewBulletinItem);a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);a.textValidator.validateEditorTextMaxLength("",a.controls.NewBulletinItem);a.controls.Container.find(a.selectors.bulletinItem).each(function(b,
d){b=$(d);a.utility.isViewMode(b)||a.cancelEditMode(a.editor.getBulletinEditorInstance(b))})}}}else b={enabled:!1,clearStateCallback:function(){}};this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.Container.closest("form"),this.settings.Resources.FormBeforeUnloadWarning,{callback:function(){return a.isAddingEditingBulletinsNotFinished()},whiteList:b})};b.prototype.setupShowMoreLink=function(){var a=this;this.showMoreRenderer=new g.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,
this.utility.textExpander);this.renderShowMoreWithImagesHack(this.controls.Container.find(this.selectors.bulletinItem));this.controls.Container.find(this.selectors.bulletinItem).each(function(b,c){b=$(c);g.LightBulletinUtility.setTabindexToHiddenElements(b,a.showMoreRenderer.findClickablePlaceholder(b),"."+a.settings.CssClasses.ElementLink)})};b.prototype.renderShowMoreWithImagesHack=function(a){var b=this;this.showMoreRenderer.renderShowMoreWithImagesHack(a,"[data-"+this.settings.DataAttributes.BulletinAttachedImage+
"]",this.utility.selectors.bulletinItem,function(a,d){g.LightBulletinUtility.setTabindexToHiddenElements(a,d,"."+b.settings.CssClasses.ElementLink)})};b.prototype.loadEmbedContent=function(a){this.embedAsynchronousLoader.appendIframeHolders(a);this.embedAsynchronousLoader.loadEmbedContentAsync()};b.prototype.setupControlsEvents=function(){var a=this;this.controls.ShowMoreLink.click(function(b){a.controls.ShowMoreLink.hide();a.ajaxClient.page(a.boundaryLightBulletinId,a.boundaryLightBulletinActiveFromTicks,
a.settings.BulletinsDisplayMode).done(function(b){var d=void 0;b=0<$.trim(b).length?(d=$(b)).filter("[data-"+a.settings.DataAttributes.PageData+"]"):$();if(0<b.length&&d){var c=b.data(a.settings.DataAttributes.PageData);a.utility.linkifyTextNodes(d);a.controls.Container.append(d);b.remove();a.renderShowMoreWithImagesHack(d.find(a.selectors.bulletinItem));a.boundaryLightBulletinId=c.BoundaryLightBulletinId;a.boundaryLightBulletinActiveFromTicks=c.BoundaryLightBulletinActiveFromTicks;a.controls.ShowMoreLink.toggle(c.NeedToShowMore);
a.loadEmbedContent(d)}}).fail(a.ajaxClient.handleAjaxError);b.preventDefault()});this.controls.Container.on("click","."+this.settings.CssClasses.OembedDelete,function(b){return a.lightBulletinDeleteEmbedClicked(b)});this.controls.Container.on("click",this.selectors.addResourceAction,function(b){b=$(b.target);if(!b.closest(a.selectors.addResourceAction).prop("disabled")){var d=a.utility.findBulletinItemByChild(b),c=a.utility.getCurrentBulletinItemOrNew(d);b=function(){a.watchEmbeds.stopWatchEmbedsInBulletinItem(d);
a.toggler.toggleAddImageButton(d,!1);a.toggler.toggleResourceButton(d,!0);var b=a.utility.getVisibleOembedBox(c);a.embedAsynchronousLoader.removeAjaxLoader(b.closest(a.selectors.mediaAppendTarget));a.removeOembedBox(b,d);a.utility.imageBox.removeImageError(c)};var e=function(){a.watchEmbeds.watchEmbedsInBulletinItem(d);a.toggler.toggleAddImageButton(d,!0)};if(!a.utility.hasVisibleOembedBox(c))a.elementLinkBuilder.onResourceButtonClick(a.utility.getBulletinId(d),c,e,b,function(){a.utility.validateBulletinAndToggleControls(d)})}});
this.controls.Container.on("click","."+this.settings.CssClasses.ElementLinkDelete,function(b){b=$(b.currentTarget).closest("."+a.settings.CssClasses.ElementLinkListItem);var d=a.utility.findBulletinItemByChild(b);a.elementLinkBuilder.onDetachResourceButtonClick(a.utility.getBulletinId(d),d,b,function(){a.focusOnTextArea(d);a.utility.validateBulletinAndToggleControls(d)})});this.controls.Container.on("click","."+this.settings.CssClasses.ImageDelete,this.onDeleteImageButtonClick);this.controls.Container.on("click",
this.utility.selectors.addImageButtonFileInput,function(b){var d=a.utility.getCurrentBulletinItemOrNew(a.utility.findBulletinItemByChild($(b.target)));a.utility.hasVisibleImage(d)&&!confirm(a.settings.Resources.ReloadImageConfirmation)&&b.preventDefault()});this.controls.Container.on("change",this.utility.selectors.addImageButtonFileInput,function(b){return a.uploadImage(b)});this.controls.Container.on("click",this.utility.selectors.addImageButton,function(b){return a.clickOnFileInputInsideAddImageButton($(b.target))});
this.utility.controls.AddMenu.Menu.on(this.utility.settings.IsIosDevice?"touchstart":"click","a, button",function(b){b.preventDefault();b=b.currentTarget;switch(b){case a.utility.controls.AddMenu.ToggleCommentsOptionButton.get(0):a.commentToggler.areCommentsDisabledForNewBulletins=!a.commentToggler.areCommentsDisabledForNewBulletins;break;case a.utility.controls.AddMenu.ScheduleOptionButton.get(0):g.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:a.temporaryStorageStrategy,strategicData:{onSuccess:function(b){a.utility.getTimeSpan(a.utility.controls.NewBulletinItem).remove();
a.utility.getAuthorContainer(a.utility.controls.NewBulletinItem).append($(b))}}});break;case a.utility.controls.AddMenu.AddToOtherCoursesButton.get(0):b=$(b);if(b.prop("disabled"))return;var d=a.utility.findBulletinItemByChild(b),e=a.utility.getCurrentBulletinItemOrNew(d);k.instance.openDialog(a.postedToCoursesInNewBulletin,function(){CssModal.closeDialog();a.setPostedToCourses(e,c.Controls.MultipleCourseSearchSelector.multipleCourseSearchSelectorDialogClientInstance.selectedCourses);a.utility.validateBulletinAndToggleControls(d)})}a.resetFocusOnCurrentItem(a.utility.controls.NewBulletinItem)});
this.singleItemDataManager.registerDropDownMenuClickHandler(this.utility.settings.IsIosDevice,this.lightBulletinMenuClicked)};b.prototype.clickOnFileInputInsideAddImageButton=function(a){a.prop("disabled")||a.find(this.utility.selectors.addImageButtonFileInput).click()};b.prototype.setPostedToCourses=function(a,b){this.postedToCoursesInNewBulletin=b;a=this.utility.getCoursesContainer(a);a.empty();if(b&&0<b.length){var d=$('<ul class="'+this.settings.CssClasses.CoursesList+'"></ul>');d.append("<li>"+
this.settings.CourseTitle+"</li>");b.map(function(a){return a.Title}).sort(function(a,b){a=a?a.toLowerCase():"";b=b?b.toLocaleLowerCase():"";return a<b?-1:a>b?1:0}).forEach(function(a){d.append("<li>"+CCL.CommonFunctions.htmlEncode(a)+"</li>")});a.append(d)}this.utility.controls.AddMenu.AddToOtherCoursesSpan.text(this.postedToCoursesInNewBulletin&&0<this.postedToCoursesInNewBulletin.length?this.utility.settings.Resources.EditListOfCourses:this.utility.settings.Resources.AddToOtherCourses)};b.prototype.listenToEmbedPostmessages=
function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var d=a.controls.Container.find("#"+b.oembedPlaceHolderId),c=a.utility.findBulletinItemByChild(d),e={originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:d},m=a.embedAsynchronousLoader.findIframeHolders(d),k=m.data(g.LightBulletinConstants.dataAttributeNames.loadedProcessId),p=a.pendingEmbedProcessManager.getProcessById(k);b.isPlainLink||0<
a.utility.countResourcesOnUi(c)||d.data(a.settings.DataAttributes.OembedIsNew)&&a.utility.isViewMode(c)||p&&p.pendingStatus===g.PendingProcessStatus.Aborted?(a.controls.Container.removeClass(a.settings.CssClasses.OembedBoxLoading),a.embedAsynchronousLoader.removeAjaxLoader(d.closest(a.selectors.mediaAppendTarget)),d.removeClass(a.settings.CssClasses.OembedContent),b.isPlainLink&&a.utility.linkParser.skipUrl(b.originalEmbedCode),a.watchEmbeds.shouldAppendOembedError(e)?(a.embedBufferMap.set(a.utility.getBulletinId(c),
e),a.watchEmbeds.appendOembedError(e),a.showMoreRenderer.renderShowMoreLink(c,!1)):d.remove(),k&&(a.pendingEmbedProcessManager.removeProcessById(k),m.removeData(g.LightBulletinConstants.dataAttributeNames.loadedProcessId))):(a.embedBufferMap.set(a.utility.getBulletinId(c),e),d.removeClass(a.settings.CssClasses.OembedBoxLoading),d.data(a.settings.DataAttributes.OembedIsNew)&&(a.embedAsynchronousLoader.removeAjaxLoader(d.closest(a.selectors.mediaAppendTarget)),d.find("."+a.settings.CssClasses.OembedBoxHeader).show()),
a.toggler.toggleOembedEditClasses(c,{isViewMode:a.utility.isViewMode(c),isEmbedInProgress:!1}));a.utility.validateBulletinAndToggleControls(c)})};b.prototype.listenToEmbedSizePostmessages=function(){var a=this;g.EmbedResizer.listenToEmbedSizePostmessages(this.controls.Container,this.settings.CssClasses.OembedContent,this.showMoreRenderer,this.embedAsynchronousLoader,function(b){var d=a.utility.findBulletinItemByChild(b);a.utility.isViewMode(d)||a.utility.validateBulletinAndToggleControls(d);b=a.embedAsynchronousLoader.findIframeHolders(b);
if(d=b.data(g.LightBulletinConstants.dataAttributeNames.loadedProcessId))a.pendingEmbedProcessManager.removeProcessById(d),b.removeData(g.LightBulletinConstants.dataAttributeNames.loadedProcessId)})};b.prototype.lightBulletinDeleteEmbedClicked=function(a){var b=$(a.target);a=this.utility.findBulletinItemByChild(b);b=b.closest("."+this.settings.CssClasses.OembedBox+":visible");this.removeOembedBox(b,a,b.data(this.settings.DataAttributes.OembedIsNew));this.focusOnTextArea(a);this.utility.validateBulletinAndToggleControls(a)};
b.prototype.toggleViewEditMode=function(a,b){var d=a.find("[data-"+this.settings.DataAttributes.Text+"]"),c=this.showMoreRenderer.findClickablePlaceholder(a);b||this.utility.textExpander.expand(this.showMoreRenderer.findCollapsibleTextContainer(a),c);d.toggle(b&&0<d.html().length);c.toggle(b);g.LightBulletinUtility.setTabindexToHiddenElements(a,c,"."+this.settings.CssClasses.ElementLink);a.find("."+this.settings.CssClasses.ListItemAction).toggle(b);this.toggler.toggleOembedEditClasses(a,{isViewMode:b,
isEmbedInProgress:this.embedAsynchronousLoader.isEmbedInProgress(a)});b||this.utility.validateBulletinAndToggleControls(a);a.find("."+this.settings.CssClasses.ElementLinkDelete).toggle(!b);a.find("."+this.utility.settings.CssClasses.ImageBoxHeader).toggle(!b);a.find("."+this.settings.CssClasses.ImageBox).toggleClass(this.settings.CssClasses.ImageBoxEditMode,!b)};b.prototype.isAddingEditingBulletinsNotFinished=function(){return this.isPostingNewBulletin()||0<this.controls.NewBulletinItem.find("li[data-"+
this.settings.DataAttributes.ElementLinkElementId+"]").length||this.utility.imageBox.addImageButtonFileInputHasValue(this.controls.NewBulletinItem)||0<this.controls.Container.find(this.selectors.applyEditAction).length};b.prototype.isPostingNewBulletin=function(){return this.settings.CanAddNewBulletins&&(!this.controls.PostNewBulletin.prop("disabled")||this.textValidator.checkNotEmpty(this.controls.NewBulletinText.val()))};b.prototype.createLightBulletin=function(){var a=this,b=this.controls.NewBulletinText.val(),
f=this.embedBufferMap.get(0);f=f?f.originalEmbedCode:void 0;this.removeOembedBox(this.utility.getOembedBox(this.controls.NewBulletinItem),this.controls.NewBulletinItem);var e=this.elementLinkBuilder.getElementIdsForBulletin(0),l=this.postedToCoursesInNewBulletin?this.postedToCoursesInNewBulletin.map(function(a){return a.CourseId}):[];b={CourseId:this.settings.CourseId,AdditionalCourseIds:l,Text:b,EmbedUrl:f,DisableComments:this.commentToggler.areCommentsDisabledForNewBulletins,ElementIdsToAttach:e.elementsToAttach,
UploadResult:this.utility.imageBox.getParsedUploadResult(this.controls.NewBulletinItem),Schedule:{ActiveFrom:this.temporaryStorageStrategy.activeFrom,ActiveTo:this.temporaryStorageStrategy.activeTo},BulletinsDisplayMode:this.activationFilterCurrentValue};this.controls.PostNewBulletin.prop("disabled",!0);this.resetUnsavedTextInAddMode();this.ajaxClient.createLightBulletin(b).done(function(b){if(b){var d=$(b);if(d.is(":visible")){document.dispatchEvent(new CustomEvent("removeEmptyState__24bd5932b78346e894e1964a50ae7cbe"));
var f=$("<li style='display:none;'>"+b+"</li>").addClass(a.settings.CssClasses.ListItem).addClass(a.settings.CssClasses.PositionRelative);a.utility.linkifyTextNodes(f);a.controls.NewBulletinItem.after(f);a.utility.animator.animateShow(f);a.renderShowMoreInAddMode(f);a.utility.getImage(f).one("load",function(){a.renderShowMoreInAddMode(f);a.renderShowMoreCallbackDebouncer.invokeCallback(f,g.LightBulletinConstants.renderShowMoreDelayInMilliseconds)}).each(function(){this.complete&&$(this).load()});
b=a.embedAsynchronousLoader.findIframeHolders(f);0<b.length&&(d=a.embedAsynchronousLoader.createAjaxLoader(),f.find(a.selectors.mediaAppendTarget).append(d),b.append(a.embedAsynchronousLoader.createIframe(a.embedAsynchronousLoader.getEmbedIframeUrl(b),!0)))}else a.showInformationFeedback(d,a.settings.Resources.BulletinHasBeenCreatedButDoesNotMatchFilter)}a.elementLinkBuilder.cleanAppendData(0,void 0);a.temporaryStorageStrategy.resetStorage();a.commentToggler.resetCommentsDisabledForNewBulletins();
a.toggler.toggleAddBulletinMenu(!1);a.setPostedToCourses(a.controls.NewBulletinItem,[]);c.Controls.MultipleCourseSearchSelector.multipleCourseSearchSelectorDialogClientInstance.clear();a.utility.getVisibleImageBox(a.controls.NewBulletinItem).remove();a.utility.imageBox.clearAddImageButtonFileInputValue(a.controls.NewBulletinItem);a.utility.imageBox.removeImageError(a.controls.NewBulletinItem);a.utility.getElementLinkList(a.controls.NewBulletinItem).remove();a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);
a.utility.getTimeSpan(a.controls.NewBulletinItem).remove()}).fail(function(b){a.controls.PostNewBulletin.prop("disabled",!0);a.ajaxClient.handleAjaxError(b)})};b.prototype.showInformationFeedback=function(a,b){var d=this,c=a.data(this.settings.DataAttributes.InformationFeedbackButtonText),e=a.data(this.settings.DataAttributes.ActivationFilterValueToShowBulletin);CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.InformationFeedbackMainContainer,b,c,function(){CCL.InformationFeedback.hideFeedback(d.controls.InformationFeedbackMainContainer);
d.onActivationFilterChanged(e)})};b.prototype.renderShowMoreInAddMode=function(a){var b=this;this.showMoreRenderer.renderShowMoreLink(a,!0,function(a,d){g.LightBulletinUtility.setTabindexToHiddenElements(a,d,"."+b.settings.CssClasses.ElementLink)})};b.prototype.setupEditorAndApplyButton=function(a,b){var d=this,c=!0,e=this.utility.getCurrentBulletinItemOrNew(this.utility.findBulletinItemByChild(a.editor)),m=function(f){c&&!a.applyButton.prop("disabled")&&(f=d.utility.validateBulletinAndToggleControls(e),
d.textValidator.toggleNoTextYetErrorMessage(e,f),f.canBePosted?b():a.editor.focus())};e.data(g.LightBulletinEditor.bulletinEditorDataAttribute,a.editor);a.applyButton.click(m);this.editor.makeEditorAutoResizable(a.editor);this.editor.resetEditor(a.editor,!1);a.editor.keyup(function(a){a.ctrlKey&&a.which===CCL.CommonConstants.keyCodes.enter&&m(a)}).on("input paste remove",function(b){c=d.textValidator.validateEditorTextMaxLength("remove"===b.type?"":a.editor.val(),e);d.utility.isAddMode(e)&&d.utility.validateBulletinAndToggleControls(e)});
this.utility.validateBulletinAndToggleControls(e)};b.prototype.appendBulletinEditor=function(a){var b=this,c=a.bulletinItem.find("[data-"+this.settings.DataAttributes.Text+"]"),e=c.attr("data-"+this.settings.DataAttributes.Text);a.editor.val(e);a.bulletinItem.find("[data-"+this.settings.DataAttributes.BulletinItemEditorTarget+"]").append(a.editor);a.bulletinItem.find("[data-"+this.settings.DataAttributes.BulletinItemEditorButtonsTarget+"]").append(a.editorButtons);a.editor.focus();this.setupEditorAndApplyButton(a,
function(){var d=b.embedBufferMap.get(a.bulletinId),f=b.elementLinkBuilder.getElementIdsForBulletin(a.bulletinId);b.ajaxClient.updateLightBulletin({BulletinId:a.bulletinId,Text:a.editor.val(),EmbedUrl:d?d.originalEmbedCode:void 0,ElementIdsToAttach:f.elementsToAttach,ElementIdsToDetach:f.elementsToDetach,UploadResult:b.utility.imageBox.getParsedUploadResult(a.bulletinItem),DeleteAttachedImage:b.utility.imageBox.getDeleteAttachedImageValue(a.bulletinItem)}).done(function(d){g.GenericResponseHandler.handle(d,
function(){b.utility.getHiddenOembedBox(a.bulletinItem).remove();var f=d.ResponseData;b.embedAsynchronousLoader.removeAjaxLoader(a.bulletinItem);a.removeBulletinEditor();c.html(f.OutputText).attr("data-"+b.settings.DataAttributes.Text,f.DataAttributeText);b.utility.getVisibleOembedBox(a.bulletinItem).data(b.settings.DataAttributes.OembedIsNew,!1);b.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0,function(a,d){g.LightBulletinUtility.setTabindexToHiddenElements(a,d,"."+b.settings.CssClasses.ElementLink)});
b.toggleViewEditMode(a.bulletinItem,!0);b.utility.linkifyNodes(c);b.elementLinkBuilder.cleanAppendData(a.bulletinId,a.bulletinItem);b.utility.imageBox.applyImageEditsIfNeeded(a.bulletinItem,f.LargeImageUrl)},function(){b.cancelEditMode(a);d.Code===g.GenericResponseCode.LightBulletinNotFound&&b.utility.removeBulletin(a.bulletinItem)})}).fail(function(d,c,f){b.cancelEditMode(a);b.ajaxClient.handleAjaxError(d)})});a.cancelButton.click(function(){b.cancelEditMode(a)})};b.prototype.resetUnsavedTextInAddMode=
function(){this.editor.resetEditor(this.controls.NewBulletinText.val(""),!0)};b.prototype.cancelEditMode=function(a){var b=this;this.resetUnsavedEmbed(a.bulletinItem,a.bulletinId,{preserveAjaxLoader:!0});this.utility.imageBox.resetUnsavedImage(a.bulletinItem);a.removeBulletinEditor();this.editor.removeBulletinEditorInstanceDataAttribute(a.bulletinItem);this.toggleViewEditMode(a.bulletinItem,!0);this.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0,function(a,d){g.LightBulletinUtility.setTabindexToHiddenElements(a,
d,"."+b.settings.CssClasses.ElementLink)});this.elementLinkBuilder.resetUnsavedElementLinks(a.bulletinId,a.bulletinItem)};b.prototype.resetUnsavedEmbed=function(a,b,c){var d=this.utility.getVisibleOembedBox(a),f=this.embedAsynchronousLoader.findIframeHolders(d).data(g.LightBulletinConstants.dataAttributeNames.loadedProcessId)||this.embedAsynchronousLoader.findAjaxLoader(a).data(g.LightBulletinConstants.dataAttributeNames.pendingProcessId);f&&this.pendingEmbedProcessManager.cancelProcess(f);(f=d.data(this.settings.DataAttributes.OembedIsNew))&&
this.removeOembedBox(d,a);d=this.utility.getHiddenOembedBox(a);if(0<d.length){d.show();var e=d.data(this.settings.DataAttributes.OembedUrl);this.embedBufferMap.set(b,{oembedPlaceHolder:d,originalEmbedCode:e})}c.preserveAjaxLoader&&!f||this.embedAsynchronousLoader.removeAjaxLoader(a)};b.prototype.removeOembedBox=function(a,b,c){void 0===c&&(c=!0);if(0<a.length){var d=this.embedBufferMap.get(this.utility.getBulletinId(b));d&&a.data(this.settings.DataAttributes.OembedUrl,d.originalEmbedCode);c?a.remove():
a.hide();this.embedBufferMap.delete(this.utility.getBulletinId(b))}};b.prototype.setupOnboardingFeatures=function(){var a=this;this.settings.CanAddNewBulletins&&this.ajaxClient.getBulletinElementLinksAnnouncementCompleted(this.settings.CourseId).done(function(b){b&&a.setupElementLinksAnnouncementContextDialog(b)}).fail(this.ajaxClient.handleAjaxError)};b.prototype.setupElementLinksAnnouncementContextDialog=function(a){var b=this,c=$(this.selectors.addResourceAction);if(c.is(":visible")){c.after(a);
var e="#"+this.utility.settings.ElementLinksAnnouncementContainerClientId,g=new ContextDialog(e,{marginTop:c.height(),marginLeft:(c.width()-420)/2,valign:"bottom",width:420,zIndex:1,blackThemeActivated:!0,closeWithOutsideClick:!1,showHeader:!1,showCloseLink:!1,scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!1,allowAccessToParentWindow:!1,expandParentFrame:!1});this.controls.Container.on("click",e+","+this.selectors.addResourceAction,function(){$(e).is(":visible")&&g.closeDialog()});var m,k=function(){if(CCL.CommonFunctions.isOnScreen(c,
.5,.5,b.utility.settings.IsIosDevice?window.parent:window)){var a=c.position().left+c.width()/2+10,d=c.position().top+10;g.openDialogAt(a,d,!1);return!0}return!1};if(!(m=k()))$(window).on(this.utility.settings.IsIosDevice?"touchmove":"scroll",function(){m||k()})}else setTimeout(this.setupElementLinksAnnouncementContextDialog,50)};return b}();g.LightBulletinContentBlock=e})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){this.utility=b}c.prototype.folderContent=function(b){return $.ajax({type:"GET",url:this.utility.settings.Urls.FolderContent,data:b,dataType:"html"})};return c}();c.ElementLinkDialogAjaxClient=g})(c.ElementLinkDialog||(c.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k;(function(b){b[b.Expanded=1]="Expanded";b[b.Collapsed=2]="Collapsed";b[b.Loading=3]="Loading"})(k||(k={}));var e=function(){function b(a,b){var d=this;this.controls=a;this.settings=b;this.inputTypeCheckboxSelector="input:checkbox";this.updateElementStateAndToggleOkButtonEnabled=function(a){var b=$(a.target);a=d.utility.closestElementItem(b);b=d.updateElementState(a,b.is(":checked"));d.controls.OkButton.prop("disabled",!d.currentParams.allowEmptySubmit&&(0===b||b>d.currentParams.maxCountOfAddedElements));
a.find(d.inputTypeCheckboxSelector).first().focus();if(d.currentParams.disallowMultipleSelection){var c=d.utility.getElementId(a);a=d.getCheckedElements();if(1<a.length){var f=[];$.each(a,function(a,b){b!==c&&f.push(b)});a=d.utility.getCheckbox(f[0]);a.prop("checked",!1);a.trigger("change")}}};this.utility=new g.Utility(a,b);this.modalDialog=window[this.getDialogId()];this.ajaxClient=new g.ElementLinkDialogAjaxClient(this.utility);this.checkboxStateMachine=new c.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler();
this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){return d.onFolderContentLoaded()},afterCloseDialog:function(){void 0!==d.currentParams.afterCloseDialogCallback&&d.currentParams.afterCloseDialogCallback()}});this.preventExternalFormSubmitAndMakeSaveOnEnterKey()}b.prototype.openDialog=function(a,b){this.currentParams=a;$.extend(b,{elementType:this.currentParams.elementType,showAll:this.currentParams.showAll});this.ajaxParams=b;this.currentParams.openerPage&&
(b.openerPage=this.currentParams.openerPage);this.currentParams.relatedEntityId&&(b.relatedEntityId=this.currentParams.relatedEntityId);this.currentParams.learningObjectiveId&&(b.learningObjectiveId=this.currentParams.learningObjectiveId);this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,b,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1);this.modalDialog.setPreferredSize(this.settings.PreferredWidth,0);a=this.countCheckedElements();a=void 0!=this.currentParams.maxCountOfAddedElements&&
a>this.currentParams.maxCountOfAddedElements?!1:this.currentParams.allowEmptySubmit||0<a&&0<this.countElementsChanged();this.controls.OkButton.prop("disabled",!a)};b.prototype.refreshDialog=function(a){a=void 0===a?{}:a;var b=a.showAll;b=void 0===b?!1:b;a=a.isFilteredByLearningObjectives;this.isFilteredByLearningObjectives=void 0===a?!1:a;this.ajaxParams.showAll=b;this.currentParams.showAll=b;this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,this.ajaxParams,!0)};b.prototype.closeDialog=
function(){CssModal.closeDialog()};b.prototype.getDialogId=function(){return this.controls.Container.prop("id")};b.prototype.onFolderContentLoaded=function(){var a=this;this.currentParams.elementStates.forEach(function(b,c){a.checkboxStateMachine.isElementChecked(b)&&(b=a.utility.getCheckbox(c))&&b.length&&b.prop("checked",!0)});this.currentParams.disabledElementIds&&this.currentParams.disabledElementIds.forEach(function(b){(b=a.utility.getCheckbox(b))&&b.length&&b.prop("disabled",!0)})};b.prototype.setupOkButtonClickHandler=
function(){var a=this;this.controls.OkButton.on("click",function(b){b.preventDefault();a.controls.OkButton.is(":visible")&&a.controls.OkButton.is(":enabled")&&(a.currentParams.afterOkClickCallback(a.currentParams.elementStates),CssModal.closeDialog())})};b.prototype.setupListItemFocusedAreaClickHandler=function(){var a=this;this.controls.Container.on((b={},b.change=this.updateElementStateAndToggleOkButtonEnabled,b),this.inputTypeCheckboxSelector);this.controls.Container.on("click",this.utility.selectors.listItemFocusedArea,
function(b){b=$(b.target);var d=a.utility.closestElementItem(b);a.isClickTargetEnabled(b,d)?a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(d):a.utility.isListItemFocusedArea(b)&&a.isCheckboxExistAndEnabled(d)&&(b=a.utility.getCheckbox(a.utility.getElementId(d)),b.toggle(!b.is(":checked"))):a.isFolder(d)&&a.expandOrCollapseFolder(d)});this.controls.Container.on("keyup",this.utility.selectors.listItemFocusedArea,function(b){b.which!==CCL.CommonConstants.keyCodes.space||CCL.CommonFunctions.isFirefox()||
(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.utility.closestElementItem(b)))});var b};b.prototype.preventExternalFormSubmitAndMakeSaveOnEnterKey=function(){var a=this;this.controls.DialogContent.keypress(function(b){b.which!==CCL.CommonConstants.keyCodes.enter||a.controls.OkButton.is(":focus")||(b.preventDefault(),a.controls.OkButton.click())})};b.prototype.isClickTargetEnabled=function(a,b){return 0===b.find(this.utility.selectors.elementLinkFolderActionExpand).length||
this.targetIsFolderActionExpand(a)||this.currentParams.allowFolderSelection&&(!this.isFilteredByLearningObjectives||this.currentParams.showAll)&&this.isCheckboxExistAndEnabled(b)};b.prototype.targetIsFolderActionExpand=function(a){return a.is(this.utility.selectors.elementLinkFolderActionExpand)||0<a.closest(this.utility.selectors.elementLinkFolderActionExpand).length};b.prototype.isFolder=function(a){return 0<a.find(this.utility.selectors.elementLinkFolderActionExpand).length};b.prototype.updateElementState=
function(a,b){a=this.utility.getElementId(a);var d=this.currentParams.elementStates.get(a)||c.CheckboxStateMachine.State.Empty;b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(b,d);this.currentParams.elementStates.set(a,b);return this.countCheckedElements()};b.prototype.countElementsChanged=function(){return c.MapUtils.reduce(this.currentParams.elementStates,function(a,b,f){return f===c.CheckboxStateMachine.State.AttachedByUser||f===c.CheckboxStateMachine.State.DetachedByUser?
a+1:a},0)};b.prototype.countCheckedElements=function(){var a=this;return c.MapUtils.reduce(this.currentParams.elementStates,function(b,c,e){return a.checkboxStateMachine.isElementChecked(e)?b+1:b},0)};b.prototype.getCheckedElements=function(){var a=this;return c.MapUtils.reduce(this.currentParams.elementStates,function(b,c,e){a.checkboxStateMachine.isElementChecked(e)&&b.push(c);return b},[])};b.prototype.expandOrCollapseFolder=function(a){var b=this,c=a.find(this.utility.selectors.elementLinkFolderActionExpand).first(),
e=c.data(this.settings.DataAttributes.ElementLinkFolderActionExpand),g=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderAppendTarget)).first();e?e===k.Expanded?this.setFolderState(g,c,k.Collapsed):e===k.Collapsed&&this.setFolderState(g,c,k.Expanded):(this.setFolderState(g,c,k.Loading),this.ajaxClient.folderContent({folderId:this.utility.getElementId(a),elementType:this.currentParams.elementType,openerPage:this.currentParams.openerPage,relatedEntityId:this.currentParams.relatedEntityId,
learningObjectiveId:this.currentParams.learningObjectiveId,showAll:this.currentParams.showAll}).done(function(a){g.append(a);b.setFolderState(g,c,k.Expanded);b.onFolderContentLoaded()}))};b.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.utility.getCheckbox(this.utility.getElementId(a)))&&a.is(":enabled")};b.prototype.setFolderState=function(a,b,c){a.toggle(c===k.Expanded);this.utility.closestListItemFocusedArea(b).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
c===k.Expanded);b.data(this.settings.DataAttributes.ElementLinkFolderActionExpand,c);a=b.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,c!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,c===k.Expanded);a.closest("."+this.settings.CssClasses.ExpandButton).attr("aria-label",c===k.Expanded?this.settings.Terms.CollapseFolder:this.settings.Terms.ExpandFolder)};
b.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};return b}();g.ElementLinkDialogManager=e})(c.ElementLinkDialog||(c.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){window[b]=this;this.settings=a;this.eventNames=a.EventNames;this.initialize()}c.prototype.initialize=function(){!this.settings.UsesNestedLearningObjectiveSelectorMode&&this.settings.LearningObjectivesEditorClientId&&(this.objectivesEditor=window.parent[this.settings.LearningObjectivesEditorClientId]);var b=this;$(document).on(this.eventNames.EmptyStateChangedEventName,function(a,d){$(b.settings.ClientCssSelectorOfTopWarningFeedbackSelector).toggle(d.isAnyEmpty);
b.objectivesEditor&&b.objectivesEditor.handleCriteriaEmptyStateChangedEvent(d.isAnyEmpty,d.loUpdate)}).on(this.eventNames.DeleteLearningObjectiveEventName,function(a,d){b.settings.UsesNestedLearningObjectiveSelectorMode&&(d.reloadPage?(b.haveChangedLos=!0,b.removeLearningObjective(d.learningObjectiveId,d.learningObjectiveGroupId),b.updateUrlAndReload()):b.removeLearningObjective(d.learningObjectiveId,d.learningObjectiveGroupId))}).on(this.eventNames.CriteriaWeightsChangedEventName,function(a,d){b.objectivesEditor?
(b.objectivesEditor.updateCriteriaWeights(d.data),b.objectivesEditor.updateLearningObjectivesCriteriaWeights(d.loCriteriaWeights)):$("#"+b.settings.CriteriaWeightsHiddenClientId).val(JSON.stringify(d.data))});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.submitIframe,function(){var a=$("#"+b.settings.CriteriaWeightsHiddenClientId).val(),d=[];$.each(window[b.settings.LearningObjectivesControlClientId].selectedIds,function(a,b){d.push(parseInt(b))});
CCL.CommonFunctions.makePostMessageCall(window.parent,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,{loIds:d,criteriaWeights:a}))})};c.prototype.updateUrlAndReload=function(){if(this.haveChangedLos){var b=document.location.href,a=this.getParameterByName(b,"Ids"),d=window[this.settings.LearningObjectivesControlClientId].selectedIds;b=a?b.replace(a[0],a[0][0]+"Ids="+encodeURIComponent(d.join(","))):b+(-1==b.indexOf("?")?"?":"&")+"Ids="+
encodeURIComponent(d.join(","));if(a=$("#"+this.settings.CriteriaWeightsHiddenClientId).val())b=(d=this.getParameterByName(b,"CriteriaWeights"))?b.replace(d[0],d[0][0]+"CriteriaWeights="+encodeURIComponent(a)):b+(-1==b.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(a);a=this.settings.ShowCriteriaWeights?"1":"0";b=(d=this.getParameterByName(b,"ShowCriteriaWeights"))?b.replace(d[0],d[0][0]+"ShowCriteriaWeights="+a):b+(-1==b.indexOf("?")?"?":"&")+"ShowCriteriaWeights="+a;document.location.replace(b)}};
c.prototype.addLearningObjectives=function(b){for(var a=[],d=0;d<b.length;d++)a.push(parseInt(b[d]));window[this.settings.LearningObjectivesControlClientId].setSelectedIds(a,!0);$(document).trigger(this.eventNames.SelectionSavedEventName);window[this.settings.LearningObjectivesControlClientId].showSuccessFeedback();this.haveChangedLos=!0;this.triggerLearningObjectivesDescription()};c.prototype.closeDialogAndRedirect=function(b){var a=window.parent;a.CssModal.closeDialog();a.location=b};c.prototype.removeLearningObjective=
function(b,a){var d=window[this.settings.LearningObjectivesControlClientId].selectedIds;b=this.getLearningObjectiveIdsFromGroup(b,a,d);for(a=0;a<b.length;a++)d.splice(d.indexOf(b[a].toString()),1);window[this.settings.LearningObjectivesControlClientId].setSelectedIds(d,!0);this.triggerLearningObjectivesDescription()};c.prototype.getLearningObjectiveIdsFromGroup=function(b,a,d){var c=[];if(a){b=JSON.parse($("#"+this.settings.LearningObjectiveGroupsHiddenClientId).val()||"{}");for(var e=0;e<d.length;e++){var g=
d[e];b[g.toString()]&&b[g.toString()]===a&&c.push(g)}}else c.push(b);return c};c.prototype.triggerLearningObjectivesDescription=function(){var b=window[this.settings.LearningObjectivesControlClientId].selectedIds;$("#"+this.settings.AddLearningObjectiveDescriptionClientId).toggle(0==b.length)};c.prototype.getParameterByName=function(b,a){return RegExp("[?&]"+a+"=([^&]*)").exec(b)};return c}();c.ManageMultipleCriteriaPopup=g})(c.Rubric||(c.Rubric={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(){function b(a){var d=this;this.showManageRubricModal=function(){$.get(d.settings.WebMethods.GetCriteria).done(function(a){var b=window[d.settings.RubricDialogClientInstanceName],c="&Ids="+a.LoIds.join(","),f="";a.UseAssessmentOrScore&&(f="&ShowCriteriaWeights=True&CriteriaWeights="+JSON.stringify(a.CriteriaWeights));b.setIframeUrl(d.settings.WebMethods.ManageRubricDialogUrl+(c+f));b.openDialog()})};this.updateCriteria=function(a){a=a.extendedData;
if(!a.updateSettings&&void 0!==a.loIds&&void 0!==a.criteriaWeights){var b={};b.LoIds=a.loIds;a.criteriaWeights&&(b.CriteriaWeights=JSON.parse(a.criteriaWeights));CCL.CommonFunctions.safeAjaxPost({url:d.settings.WebMethods.UpdateCriteria,data:b}).done(function(){c.Settings.Manager.getInstance().refreshReadView()})}};this.settings=a;window[b.clientInstanceName]=this;a=$(window);CCL.CommonFunctions.attachPostMessageEventListener(a,CCL.CommonWindowMessages.MessageNames.assignmentShowManageRubric,function(){d.showManageRubricModal()});
CCL.CommonFunctions.attachPostMessageEventListener(a,CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,function(a){d.updateCriteria(a)})}b.clientInstanceName="AssignmentListenerClientInstanceName";return b}();g.AssignmentListener=e})(c.Controls||(c.Controls={}))})(c.LearningToolElement||(c.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){c.makeCopy=function(c){var e=new Map;c.forEach(function(b,a,d){e.set(a,b)});return e};c.reduce=function(c,e,b){var a=b;c.forEach(function(b,c,h){a=e(a,c,b)});return a};c.mapToJsonString=function(c){var e=Object.create(null);c.forEach(function(b,a){return e[a.toString()]=b});return JSON.stringify(e)};c.jsonStringToMap=function(c,e){c=c?JSON.parse(c):{};for(var b=new Map,a=0,d=Object.keys(c);a<d.length;a++){var f=d[a];b.set(e(f),c[f])}return b};c.stringKeyConverter=function(c){return c};
c.numberKeyConverter=function(c){return parseInt(c,10)}})(c.MapUtils||(c.MapUtils={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){this.defaultLabelColor=null;this.animate=!1;c.assessmentLettersInstance=this;this.context=a;if(c.assessmentLettersInstance.context.Settings.IsMentorCanSendReminders)$("#"+c.assessmentLettersInstance.context.Controls.SendReminderButtonId).on("click",this.SendReminder);this.SetTimestamp(c.assessmentLettersInstance.context.Settings.SendDate)}b.prototype.SendReminder=function(){CCL.CommonFunctions.safeAjaxPost({url:c.assessmentLettersInstance.context.WebMethods.SendReminderUrl,
data:{termId:c.assessmentLettersInstance.context.Settings.TermId,organisationId:c.assessmentLettersInstance.context.Settings.OrganisationId}}).done(function(a){c.assessmentLettersInstance.SetTimestamp(a)}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};b.prototype.SetTimestamp=function(a){if(null!==a){var b=$("#"+c.assessmentLettersInstance.context.Controls.TimestampLabelId),f=b.text();b.text(CCL.CommonFunctions.formatString(c.assessmentLettersInstance.context.Settings.TimestampText,
a));f&&this.blink(b)}};b.prototype.blink=function(a){this.animate||(this.animate=!0,this.defaultLabelColor||(this.defaultLabelColor=a.css("color")),a.css("color","#F9F5BE"),a.animate({color:this.defaultLabelColor},1E3,function(){c.assessmentLettersInstance.animate=!1}))};return b}();c.TermAssessmentOverview=e})(c.Mentor||(c.Mentor={}))})(c.Assessment||(c.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){this.onboardingControlUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();c.FinalModalLoader=e;e=function(b){function a(a,c){b.call(this,c);this.context=a}__extends(a,b);a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$finalModalOverlayModal.overlayModal("open")};a.prototype.initEvents=function(){var a=this;$(document).on(CCL.OverlayModalEvents.hide,function(b,d){a.onOverlayModalHide(b,d)})};a.prototype.onOverlayModalHide=function(a,b){(b.closeType===CCL.OverlayModalCloseType.CloseButtonClicked||b.closeType===CCL.OverlayModalCloseType.EscapeKeyPressed)&&this.$finalModalOverlayModal.get(0).id===b.activeElement.id&&CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close()};return a}(OnboardingSystem.OnboardingControl);
c.FinalModal=e})(c.Calendar||(c.Calendar={}))})(c.Onboarding||(c.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){this.onboardingControlUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();c.RecurringEventModalLoader=e;e=function(b){function a(a,c){b.call(this,c);this.context=a}__extends(a,b);a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this)};
return a}(OnboardingSystem.OnboardingControl);c.RecurringEventModal=e})(c.Calendar||(c.Calendar={}))})(c.Onboarding||(c.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){this.onboardingControlUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();c.CalendarModalLoader=e;e=function(b){function a(a,c){b.call(this,c);this.context=a}__extends(a,b);a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$welcomeModalOverlayModal.overlayModal("open")};a.prototype.initEvents=function(){var a=this;this.$LetsGoButton.click(function(){a.onLetsGoButtonClick()});this.$NoThanksButton.click(function(){a.onNoThanksButtonClick()});$(document).on(CCL.OverlayModalEvents.hide,function(b,d){a.onOverlayModalHide(b,d)})};a.prototype.hideWelcomeModalAndCompleteFeature=function(a){CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(b={},b[this.context.AntiForgerySettings.HeaderName]=
this.context.AntiForgerySettings.HeaderValue,b)});this.raiseEvent(OnboardingSystem.ControlEvents.courseModernExistingWelcomeModalCompleted);var b};a.prototype.onLetsGoButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!1)};a.prototype.onNoThanksButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!0)};a.prototype.onOverlayModalHide=function(a,b){b.closeType!==CCL.OverlayModalCloseType.CloseButtonClicked&&b.closeType!==
CCL.OverlayModalCloseType.EscapeKeyPressed||this.$welcomeModalOverlayModal.get(0).id!==b.activeElement.id||(this.hideWelcomeModalAndCompleteFeature(!0),CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close())};return a}(OnboardingSystem.OnboardingControl);c.CalendarModal=e})(c.Calendar||(c.Calendar={}))})(c.Onboarding||(c.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a,b){this.coursesMenuCallToActionUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.coursesMenuCallToActionUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b),a.$targetElement.find(".ccl-context-dialog-arrow").css("left",a.$targetElement.outerWidth()/2))})};return b}();c.CoursesMenuCallToActionLoader=e;e=function(b){function a(a,c){b.call(this,
c);this.context=a}__extends(a,b);a.prototype.onGotItClick=function(){$("."+this.context.Controls.CoursesMenuCallToActionId).hide()};a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);var a=this,b=$("."+a.context.Controls.CoursesMenuCallToActionId);b.click(function(){return a.onGotItClick()});b.show();this.coursesMenuItemIsVisible()&&CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(c={},c[this.context.AntiForgerySettings.HeaderName]=
this.context.AntiForgerySettings.HeaderValue,c)});var c};a.prototype.coursesMenuItemIsVisible=function(){return $(this.context.Controls.CoursesMenuItemSelector).is(":visible")};return a}(OnboardingSystem.OnboardingControl);c.CoursesMenuCallToAction=e})(c.TopMenu||(c.TopMenu={}))})(c.Onboarding||(c.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.context=a;this.controls=b;this.getExternalGrades();$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return d.pagerEventHandler(b)})}e.prototype.refreshGrid=function(b,a){var d=this;$.post(this.context.WebMethods.GetExternalGradebookContent,{courseId:this.context.CourseId,pageIndex:b,pageSize:a}).done(function(a){null!=a&&(a=$(a),d.controls.Container.replaceWith(a),
d.controls.Container=a,d.getExternalGrades())}).fail(function(a){c.Utils.handleAjaxError(a)})};e.prototype.pagerEventHandler=function(b){b===this.context.Pager.Name&&(b=window[b],this.refreshGrid(b.pageNumber,b.pageSize))};e.prototype.getExternalGrades=function(){var b=this;$.post(this.context.WebMethods.GetExternalGradesForCourse,{courseId:this.context.CourseId}).done(function(a){null!=a&&null!=a.length&&0<a.length?b.fillGrades(a):b.clearGrades()}).fail(function(){b.clearGrades()})};e.prototype.fillGrades=
function(b){var a=this;this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").each(function(d,c){d=$(c);var f=d.data(a.context.DataAttributes.LineItemSourcedId),g=d.data(a.context.DataAttributes.PersonSourcedId),m=e.defaultCellText;$.each(b,function(b,d){if(f===d.LineItemSourcedId&&g===d.PersonSourcedId)return m=a.getCellText(d),!1});d.text(m)})};e.prototype.getCellText=function(b){var a=e.defaultCellText;null!=b.Score&&0<b.Score.length&&(a=b.Score);var d=e.defaultCellText;
null!=b.Scale&&0<b.Scale.length&&(d=b.Scale);return a+" / "+d};e.prototype.clearGrades=function(){this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").empty().text(e.defaultCellText)};e.defaultCellText="-";return e}();c.ExternalGradebook=g})(c.OneRoster||(c.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.context=b;this.controls=a;this.mappingTypesList.on("change",function(){return d.onMappingTypeChanged()});this.existingAssessmentsList.on("change",function(){return d.onGradeBookItemChanged()});this.existingAssessmentScalesList.on("change",function(){return d.onAssessmentScaleChanged()});this.bindButtonsToEvent()}Object.defineProperty(e.prototype,"mappingTypesList",{get:function(){return this.controls.MappingTypesList},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"existingAssessmentsList",{get:function(){return this.controls.ExistingAssessmentsList},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"existingAssessmentScalesList",{get:function(){return this.controls.ExistingAssessmentScalesList},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"currentButton",{get:function(){return this.controls.SendButton.length?this.controls.SendButton:this.controls.SaveButton},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"settings",{get:function(){return this.context.Settings},enumerable:!0,configurable:!0});e.addOrUpdateDraftItem=function(b){var a=!0;$.each(e.draftItems,function(d,c){if(b.SyncKey.toLowerCase()===c.SyncKey.toLowerCase())return c.GradeType=b.GradeType,c.AssessmentRecordItemId=b.AssessmentRecordItemId,c.AssessmentScaleId=b.AssessmentScaleId,a=!1});a&&e.draftItems.push(b)};e.getDraftItemsBySyncKeys=function(b){var a=[];$.each(b,function(b,c){$.each(e.draftItems,
function(b,d){if(d.SyncKey.toLowerCase()===c.toLowerCase())return a.push(d),!1})});return a};e.prototype.bindButtonsToEvent=function(){var b=this,a=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";if(!this.controls.SaveButton.is(":disabled"))this.controls.SaveButton.on(a,function(){return b.saveResults()});if(!this.controls.SendButton.is(":disabled"))this.controls.SendButton.on(a,function(){return b.sendResults()})};e.prototype.onMappingTypeChanged=function(){this.setControlAvailability(this.mappingTypesList,
!1);var b=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.mappingTypesList.toggleClass(this.context.CssClasses.DefaultMappingType,b===this.context.Settings.MappingTypeEnum.NotLinked);var a=this.settings.LineItemsSyncKeys;switch(b){case this.context.Settings.MappingTypeEnum.NotLinked:this.hideAndClearAssessmentsDropDownList();this.hideAssessmentScalesDropDownList();this.createDraftVersion(this.context.Settings.MappingTypeEnum.NotLinked,a);break;case this.context.Settings.MappingTypeEnum.OverallAverage:this.hideAndClearAssessmentsDropDownList();
this.setButtonAvailability(!1);if(this.settings.DoesOverallAverageHaveMultipleScales)this.showAssessmentScalesDropDownList();else this.onAssessmentScaleChanged();break;case this.context.Settings.MappingTypeEnum.Assessment:case this.context.Settings.MappingTypeEnum.FinalAssessment:this.hideAssessmentScalesDropDownList();this.setButtonAvailability(!1);this.populateAndShowAssessmentsDropDownList();break;case this.context.Settings.MappingTypeEnum.Manual:this.hideAssessmentScalesDropDownList(),this.hideAndClearAssessmentsDropDownList(),
this.createDraftVersion(this.context.Settings.MappingTypeEnum.Manual,a)}this.setControlAvailability(this.mappingTypesList,!0)};e.prototype.onGradeBookItemChanged=function(){this.setControlAvailability(this.existingAssessmentsList,!1);var b=parseInt(this.existingAssessmentsList.find("option:selected").val(),10);if(b!==this.context.Settings.ExistingAssessmentDefaultValue){this.setControlAvailability(this.mappingTypesList,!1);var a=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.createDraftVersion(a,
this.settings.LineItemsSyncKeys,b);this.setControlAvailability(this.mappingTypesList,!0)}else this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentsList,!0)};e.prototype.hideAndClearAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.hide().empty()};e.prototype.populateAndShowAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.empty();var b=parseInt(this.controls.MappingTypesList.find("option:selected").val(),10),a={courseId:this.settings.CourseId,
termId:this.settings.TermId};b===this.context.Settings.MappingTypeEnum.Assessment?this.populateGradebookItemsList(this.context.WebMethods.GetNormalAssessments,a):b===this.context.Settings.MappingTypeEnum.FinalAssessment&&this.populateGradebookItemsList(this.context.WebMethods.GetFinalAssessments,a);this.controls.ExistingAssessmentsList.show()};e.prototype.onAssessmentScaleChanged=function(){this.setControlAvailability(this.existingAssessmentScalesList,!1);var b=parseInt(this.existingAssessmentScalesList.find("option:selected").val(),
10);b!==this.context.Settings.AssessmentScaleDefaultValue?(this.setControlAvailability(this.mappingTypesList,!1),this.createDraftVersion(this.context.Settings.MappingTypeEnum.OverallAverage,this.settings.LineItemsSyncKeys,null,b),this.setControlAvailability(this.existingAssessmentScalesList,!0)):this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentScalesList,!0)};e.prototype.showAssessmentScalesDropDownList=function(){this.existingAssessmentScalesList.show()};e.prototype.hideAssessmentScalesDropDownList=
function(){this.existingAssessmentScalesList.hide()};e.prototype.populateGradebookItemsList=function(b,a){var d=this;$.get(b,a).done(function(a){d.controls.ExistingAssessmentsList.append($("<option />").val(d.context.Settings.ExistingAssessmentDefaultValue.toString()).text(d.context.LanguageTerms.ExistingAssessmentDefaultText));$.each(a,function(a,b){d.controls.ExistingAssessmentsList.append($("<option />").val(b.GradeBookItemId.toString()).text(b.Title))})}).fail(function(a){c.Utils.handleAjaxError(a)})};
e.prototype.createDraftVersion=function(b,a,d,f){null==d&&(d=this.context.Settings.ExistingAssessmentDefaultValue);null==f&&(f=this.context.Settings.AssessmentScaleDefaultValue);$.each(a,function(a,c){e.addOrUpdateDraftItem({SyncKey:c,GradeType:b,AssessmentRecordItemId:d,AssessmentScaleId:f})});this.updateGradingPeriodSection();c.LineItemsResults.refreshGrid(this.settings.AggregatedSyncItemId)};e.prototype.setButtonAvailability=function(b){this.setControlAvailability(this.currentButton,b)};e.prototype.setControlAvailability=
function(b,a){a?b.removeAttr("disabled"):b.attr("disabled","disabled")};e.prototype.disableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!1);this.setControlAvailability(this.existingAssessmentsList,!1);this.setControlAvailability(this.existingAssessmentScalesList,!1);this.currentButton.addClass(this.context.CssClasses.ButtonWithLoader)};e.prototype.enableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!0);this.setControlAvailability(this.existingAssessmentsList,
!0);this.setControlAvailability(this.existingAssessmentScalesList,!0);this.currentButton.removeClass(this.context.CssClasses.ButtonWithLoader);this.currentButton.blur()};e.prototype.sendResults=function(){this.handleButtonClick(this.context.WebMethods.SendResults,{courseId:this.settings.CourseId,lineItemIds:this.settings.LineItemsSyncKeys})};e.prototype.saveResults=function(){this.handleButtonClick(this.context.WebMethods.SaveResults,{courseId:this.settings.CourseId,termId:this.settings.TermId,draftItems:e.getDraftItemsBySyncKeys(this.settings.LineItemsSyncKeys)})};
e.prototype.handleButtonClick=function(b,a){var d=this;this.currentButton.is(":disabled")||(this.disableMappingControls(),$.post(b,a).done(function(a){var b=d.controls.InformationFeedbackPlaceholder.offset();d.updateGradingPeriodSection();c.LineItemsResults.refreshGrid(d.settings.AggregatedSyncItemId);a&&a.feedbackMessage&&0<a.feedbackMessage.length&&$(document).trigger(c.GradeExport.showFeedbackEventTitle,[a.feedbackMessage,b]);d.enableMappingControls()}).fail(function(a){c.Utils.handleAjaxError(a);
d.enableMappingControls()}))};e.prototype.updateGradingPeriodSection=function(b,a){void 0===b&&(b=!0);void 0===a&&(a=!1);c.GradingPeriod.refreshSection(this.context.Settings.GradingPeriodId,b,a)};e.draftItems=[];return e}();c.AggregatedSyncItem=g})(c.OneRoster||(c.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(b,a,d,c,e,g,m){this.courseId=b;this.assessmentRecordId=a;this.termId=d;this.gradingPeriodId=c;this.isExpanded=g;this.isSentAreaExpanded=m;this.draftLineItemGradeTypes=e}}(),e=function(){function b(a,d){var c=this;this.context=a;this.controls=d;a=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";this.controls.GradingPeriodsSectionHeader.on(a,function(){return c.onGradingPeriodsHeaderClick()});this.controls.SentLineItemsSectionHeader.on(a,
function(){return c.onSentLineItemsHeaderClick()});$(document).off(b.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId));$(document).on(b.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId),function(a,b,d,f){return c.updateGradingPeriodSection(b,d,f)})}b.prototype.onGradingPeriodsHeaderClick=function(){this.controls.AllLineItemsSection.slideToggle("slow");this.controls.GradingPeriodsSection.toggleClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass);this.controls.GradingPeriodsSectionHeader.toggleClass(this.context.CssClasses.GradingPeriodSectionHeaderCollapsedClass)};
b.prototype.onSentLineItemsHeaderClick=function(){this.controls.SentLineItems.slideToggle("slow");this.controls.SentLineItemsSectionHeader.toggleClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass)};b.getUpdateSectionEventTitle=function(a){return""+b.updateSectionEventTitle+a};b.refreshSection=function(a,d,f){void 0===d&&(d=!0);void 0===f&&(f=!1);$(document).trigger(b.getUpdateSectionEventTitle(a),[d,f,c.AggregatedSyncItem.draftItems])};b.prototype.updateGradingPeriodSection=function(a,
b,f){var d=this,e=!this.controls.GradingPeriodsSection.hasClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass),m=!this.controls.SentLineItemsSectionHeader.hasClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass);a=new g(this.context.Settings.CourseId,this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,this.context.Settings.GradingPeriodId,f,e||a,m||b);$.post(this.context.WebMethods.GradingPeriod,a).done(function(a){a&&0!==a.length&&(a=$(a),$(d.controls.GradingPeriodsSection).replaceWith(a),
$(d.controls.GradingPeriodsSection).removeClass(d.context.CssClasses.GradingPeriodSectionCollapsedClass))}).fail(function(a){c.Utils.handleAjaxError(a)})};b.updateSectionEventTitle="GradingPeriod:UpdateGradingPeriodSection";return b}();c.GradingPeriod=e})(c.OneRoster||(c.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(a,b,c,e,g){this.courseId=a;this.personId=b;this.lineItemSyncKey=c;this.scoreListItemExtensionId=e;this.currentScore=g}}(),e=function(){return function(a,b,c,e,g,m){void 0===g&&(g="");void 0===m&&(m="");this.courseId=a;this.assessmentRecordId=b;this.termId=c;this.studentNameSearchText=g;this.selectedAggregatedLineItemId=m;this.draftLineItemGradeTypes=e}}(),b=function(){function a(b,f){var d=this;this.context=f;this.controls=b;this.initSearch();
$(document).off(a.refreshGridEventTitle);$(document).on(a.refreshGridEventTitle,function(a,b){return d.updateLineItemsResultsSection(new e(d.context.Settings.CourseId,d.context.Settings.AssessmentRecordId,d.context.Settings.TermId,c.AggregatedSyncItem.draftItems,"",b))})}a.refreshGrid=function(b){$(document).trigger(a.refreshGridEventTitle,b)};a.prototype.initSearch=function(){var a=this;this.controls.SearchImage.on("click",function(){return a.onSearchStudentClick()});this.controls.SearchInput.on("keydown",
function(b){return a.onSearchInputKeyDown(b)})};a.prototype.onSearchStudentClick=function(){this.searchStudents(this.controls.SearchInput.val())};a.prototype.preventEventPropagation=function(a){a.cancelBubble=!0;a.returnValue=!1;a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation()};a.prototype.onSearchInputKeyDown=function(a){a.keyCode===CCL.CommonConstants.keyCodes.enter&&(this.preventEventPropagation(a),this.searchStudents($(a.target).val()))};a.prototype.searchStudents=function(a){this.updateLineItemsResultsSection(new e(this.context.Settings.CourseId,
this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,c.AggregatedSyncItem.draftItems,a?a:""))};a.prototype.updateLineItemsResultsSection=function(a){var b=this;$.post(this.context.WebMethods.LineItemsResults,a).done(function(d){if(d&&0!==d.length){var c=b.controls.SearchInput.attr("id");d=$(d);b.controls.LineItemsResultsTable.parent().empty().prepend(d);a.studentNameSearchText&&$("#"+c).val(a.studentNameSearchText)}}).fail(function(a){c.Utils.handleAjaxError(a)})};a.prototype.handleAjaxError=
function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&a.responseText&&alert(a.responseText)};a.refreshGridEventTitle="LineItemsResults:refreshGrid";return a}();c.LineItemsResults=b;b=function(){function a(a,b){var d=this;this.lineItemCellSelectionChangedEventName="LineItemResultCell:LineItemCellSelectionChanged";this.controls=a;this.context=b;this.isSelected=!1;a=CCL.CommonFunctions.isMobileDevice();this.controls.LineItemResultCell.on(a?"touchstart":"click",function(){return d.focusCell()});
if(!a)this.controls.LineItemResultCell.on("mouseenter",function(){return d.focusCell()});this.controls.LineItemResultCell.focus(function(){return d.onLineitemResultCellFocus()});this.controls.LineItemResultCell.find("*").addBack().blur(function(){return d.onLineitemResultCellBlur()});$(document).on(this.lineItemCellSelectionChangedEventName,function(a,b){d.isSelected&&b!==d.controls.LineItemResultCell.attr("id")&&d.controls.LineItemResultCell.blur()});this.controls.AssessmentScaleItemsList.on("change",
function(a){return d.onAssessmentScaleItemChanged(a)})}a.prototype.focusCell=function(){this.isSelected||this.controls.LineItemResultCell.focus()};a.prototype.onLineitemResultCellFocus=function(){this.isSelected||($(document).trigger(this.lineItemCellSelectionChangedEventName,this.controls.LineItemResultCell.attr("id")),this.controls.LineItemResultCell.addClass(this.context.CssClasses.SelectedCellCssClass),this.controls.LineItemResultCell.height(this.controls.LineItemResultCell.innerHeight()),this.isSelected=
!0)};a.prototype.onLineitemResultCellBlur=function(){var a=this;setTimeout(function(){var b=$(document.activeElement);b.is(a.controls.LineItemResultCell)||0!==a.controls.LineItemResultCell.has(b).length||(a.controls.LineItemResultCell.removeClass(a.context.CssClasses.SelectedCellCssClass),a.controls.LineItemResultCell.css("height",""),a.isSelected=!1)},0)};a.prototype.onAssessmentScaleItemChanged=function(a){a=$(a.target);a.attr("disabled","disabled");var b=this.controls.AssessmentScaleItemsList.val();
b=new g(this.context.Settings.CourseId,this.context.Settings.PersonId,this.context.Settings.LineItemSyncKey,b,this.context.Settings.CurrentScore);this.setCustomScoreListItemExtensionForPerson(b);a.removeAttr("disabled")};a.prototype.setCustomScoreListItemExtensionForPerson=function(a){var b=this;a=JSON.stringify(a);$.ajax({type:"POST",url:this.context.WebMethods.SetCustomScoreListItemExtensionForPerson,data:a,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(){b.controls.AssessmentScaleCurrentItemLabel.text(b.controls.AssessmentScaleItemsList.find("option:selected").text())}).fail(function(a){c.Utils.handleAjaxError(a)})};
return a}();c.LineItemResultCell=b})(c.OneRoster||(c.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(){}c.handleAjaxError=function(b){b.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=b.responseText&&0<b.responseText.length||null!=b.statusText&&0<b.statusText.length)&&alert(null!=b.responseText&&0<b.responseText.length?b.responseText:b.statusText)};return c}();c.Utils=g})(c.OneRoster||(c.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;window[b]=this;this.settings=a;$(a.AccordionSelector+" "+a.SectionSelector).click(function(a){d.ShowFeedbackItems(a)})}c.prototype.ShowFeedbackItems=function(b){b=$(b.currentTarget);if(!b.data(this.settings.AccordionSectionLoadedDataAttribute)){b.data(this.settings.AccordionSectionLoadedDataAttribute,!0);var a=b.find(this.settings.ContentSelector);b=a.children().first().data(this.settings.CourseIdDataAttribute);$.ajax({type:"GET",
url:this.settings.WebMethod,data:b?{courseId:b,termId:this.settings.TermId,personId:this.settings.PersonId,personCustomerId:this.settings.PersonCustomerId,reportRoleEnumValue:this.settings.ReportRoleEnumValue,readOnly:this.settings.ReadOnly,returnUrl:this.settings.ReturnUrl,linksTarget:this.settings.LinksTarget}:{termId:this.settings.TermId,personId:this.settings.PersonId},success:function(b,c,e){a.empty().append($(b))},error:function(b,c,e){a.empty();CCL.CommonFunctions.alertAjaxError(b,c,e)}})}};
return c}();c.PersonAssessment=g})(c.Person||(c.Person={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this.planLoadingProcessId=null;window[b]=this;c.instanceName=b;this.settings=a;this.terms=a.Terms;this.css=a.Css;this.webMethods=a.WebMethods;this.currentDisplayMode=a.CurrentDisplayMode;$("."+this.css.ExpanderLink).click(function(a){d.expanderLinkClick(a)});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==d.currentDisplayMode&&(d.currentDisplayMode=
a,d.toggleEnableDisplayModeSwitcher(!1),CCL.CommonFunctions.safeAjaxPost({url:d.webMethods.TogglePlannerDisplayMode,data:{plannerDisplayMode:d.currentDisplayMode}}).done(function(){d.toggleEnableDisplayModeSwitcher(!0);d.refreshExpandedGrids()}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c);d.toggleEnableDisplayModeSwitcher(!0)}))});setTimeout(function(){d.startLoadingMonitor()},100)}c.getInstance=function(){return window[c.instanceName]};c.prototype.openViewCellContentDialog=function(b,
a,d,c,e,g){a=a||window.event;a=a.target||a.srcElement;if(!(a&&0<$(a).closest("a,input,button,textarea").length)){var f=window[this.settings.ViewHtmlTextCellContentDialog];null!=f&&null!=this.webMethods.GetPlanHtmlTextCellContent&&(f.setAjaxUrl(this.webMethods.GetPlanHtmlTextCellContent,{courseId:d,planId:c,columnId:e,childId:0,filterPersonId:g}),b=$(b).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),f.setTitle(b),f.setAfterOpenDialogAjaxDynamicallySuccess(function(){CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(f.getContent())}),
f.openDialog())}};c.prototype.expanderLinkClick=function(b){b.preventDefault();b=$(b.currentTarget);var a=b.parent(),d=b.closest("."+this.css.CoursePlansContainer).find("."+this.css.Plans),c=b.data("grid");c=window[c];a.toggleClass(this.css.Expanded);a.hasClass(this.css.Expanded)?(this.refreshPlanGrid(c),b.prop("title",this.terms.CollapseTooltip)):b.prop("title",this.terms.ExpandTooltip);d.slideToggle("fast")};c.prototype.refreshExpandedGrids=function(){var b=this;$("."+this.css.ExpanderLink).each(function(a,
d){d=$(d);a=d.parent();d=d.data("grid");d=window[d];d.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=b.currentDisplayMode;d.setMode(b.currentDisplayMode===b.settings.DisplayModes.Table?b.css.GridViewModes.TableView:b.css.GridViewModes.DefaultView);a.hasClass(b.css.Expanded)&&b.refreshPlanGrid(d)})};c.prototype.refreshPlanGrid=function(b){if(b.isLoadingInProgress())return!1;this.startLoadingMonitor();b.refresh()};c.prototype.startLoadingMonitor=function(){var b=this;if(null==this.planLoadingProcessId){this.toggleEnableDisplayModeSwitcher(!1);
var a=$("."+this.css.ExpanderLink);this.planLoadingProcessId=setInterval(function(){var d=!0;a.each(function(a,b){a=$(b).data("grid");if(window[a].isLoadingInProgress())return d=!1});d&&(clearTimeout(b.planLoadingProcessId),b.planLoadingProcessId=null,b.toggleEnableDisplayModeSwitcher(!0),a.each(function(a,b){a=$(b).data("grid");a=$("#"+window[a].gridClientID);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a)}))},500)}};c.prototype.toggleEnableDisplayModeSwitcher=function(b){window[this.settings.DisplayModeSwitcher].toggleEnableSwitcher(b)};
return c}();c.AggregatedPlanner=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(){function a(b,f){var d=this;window[b]=this;a.clientInstanceName=b;this.settings=f;this.inlineEditorOptions={multiline:{multiline:!0,autoResize:!0,editFieldCssClass:this.settings.Css.EditModeTextboxMultiline,watermarkCssClass:this.settings.Css.Watermark},singleline:{submitOnEnter:!0,editFieldAutoWidth:!1,editFieldCssClass:this.settings.Css.EditModeTextboxSingleline,watermarkCssClass:this.settings.Css.Watermark,editFieldDisplayInline:!0}};
$(function(){var a={};a[c.PlannerConstants.events.HybridEditorItemInlineModeChanged]=function(a,b){d.onColumnInlineModeChanged(a,b)};a[c.PlannerConstants.events.HybridEditorItemTextUpdated]=function(a,b){d.onColumnTextUpdated(a,b)};a[c.PlannerConstants.events.HybridEditorItemAjaxError]=function(a,b){d.onAjaxError(a,b)};a[c.PlannerConstants.events.HybridEditorItemSaveError]=function(a,b){d.onSaveError(a,b)};$(document).on(a,"div["+c.PlannerConstants.dataAttributes.HybridEditorItem+"]")})}a.prototype.replaceMediaContentWithPlaceholders=
function(){return!1};a.prototype.getSettings=function(a){var b=this.settings.Css.Watermark;switch(a.Type){case c.ClientColumnType.TopicTitle:var d=this.settings.WebMethods.UpdateTopicTitle;var e={courseId:this.settings.CourseId,topicId:a.EntityId};var g="inline";var k=this.settings.Terms.TopicTitleWatermark;b="";break;case c.ClientColumnType.TopicDescription:d=this.settings.WebMethods.UpdateTopicDescription;e={courseId:this.settings.CourseId,topicId:a.EntityId};g="hybrid";k=this.settings.Terms.ClickToAddText;
break;case c.ClientColumnType.PlanDescription:d=this.settings.WebMethods.UpdatePlanDescription;e={courseId:this.settings.CourseId,planId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()};g="hybrid";k=this.settings.Terms.PlanDescriptionWatermark;break;case c.ClientColumnType.PlanTitle:d=this.settings.WebMethods.UpdatePlanTitle;e={courseId:this.settings.CourseId,planId:a.EntityId};g="inline";k=this.settings.Terms.PlanTitleWatermark;b="";break;case c.ClientColumnType.ClassHours:d=
this.settings.WebMethods.UpdateClassHours;e={courseId:this.settings.CourseId,planId:a.EntityId};g="inline";k="0";b="";break;default:d=this.settings.WebMethods.UpdateCustomColumnContent,g="hybrid",k=this.settings.Terms.ClickToAddText,e={courseId:this.settings.CourseId,columnId:a.ColumnId,entityId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()}}return{hybridEditorClientId:this.settings.HybridEditorClientId,editModeEnabled:g,webMethodParams:e,saveContentWebUrl:d,
inlineEditorOptions:this.getInlineEditorOptions(a),editorDialogTitle:this.settings.Terms.Edit+" "+a.ColumnTitle,textContainerWatermark:k,textContainerWatermarkCssClass:b}};a.prototype.getInlineEditorOptions=function(b){var d=this.inlineEditorOptions.singleline;this.isMultilineColumn(b.Type)?d=this.inlineEditorOptions.multiline:b.Type===c.ClientColumnType.PlanTitle?d=$.extend({},this.inlineEditorOptions.singleline,a.planTitleMaxLength):b.Type===c.ClientColumnType.ClassHours&&(d=$.extend({},this.inlineEditorOptions.singleline,
a.classHoursMaxLength));return d};a.prototype.isMultilineColumn=function(a){return a===c.ClientColumnType.TopicDescription||a===c.ClientColumnType.PlanDescription||a===c.ClientColumnType.RichText};a.prototype.onColumnInlineModeChanged=function(a,b){a=$("#"+a.target.id);var d=this.getColumnData(a);d&&(b.isEditMode||b.isNewTextSaved||d.Type!==c.ClientColumnType.ClassHours||this.removeErrorControlFromCell(a))};a.prototype.onSaveError=function(a,b){a=$("#"+a.target.id);b=b.errorText;var d=this.getColumnData(a);
d&&b&&b.length&&d.Type===c.ClientColumnType.ClassHours&&!this.getErrorControl(a).length&&(a.append(this.renderErrorControl(b)),a.addClass(this.settings.Css.Error))};a.prototype.onAjaxError=function(a,b){b.xhrObject.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(b.xhrObject.responseText?CCL.CommonFunctions.htmlDecode(b.xhrObject.responseText):this.settings.Terms.ErrorMessage)};a.prototype.onColumnTextUpdated=function(a,b){a=$("#"+a.target.id);var d=this.getColumnData(a);a&&(d&&d.Type===
c.ClientColumnType.ClassHours&&this.removeErrorControlFromCell(a),this.updateNoPrintContent(a,b.html),CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a),d.Type===c.ClientColumnType.TopicTitle&&b.customData&&c.PlannerUtility.updateTopicFolderNode(b.customData.folderId,b.customData.folderName),this.measureKpiEditPlan())};a.prototype.removeErrorControlFromCell=function(a){var b=this.getErrorControl(a);b.length&&($(a).removeClass(this.settings.Css.Error),b.remove())};a.prototype.updateNoPrintContent=
function(a,b){a.closest("."+this.settings.Css.CellWrapper).toggleClass(this.settings.Css.NoPrint,0===$.trim(b).length)};a.prototype.getErrorControl=function(a){return $(a).children("div.error")};a.prototype.renderErrorControl=function(a){return"<div class='error'>"+a+"</div>"};a.planTitleMaxLength=255;a.classHoursMaxLength=5;a.hybridEditorItemIdDataAttr="hybrid-editor-item-id";return a}();e.PlannerInlineCellBase=b})(g.InlineCell||(g.InlineCell={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(a){function b(b,d){a.call(this,b,d)}__extends(b,a);b.prototype.getEditorItemSettings=function(b){b=$("#"+b);b=this.getColumnData(b);return a.prototype.getSettings.call(this,b)};b.prototype.measureKpiEditPlan=function(){c.CbPlanner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){var b=a.closest("."+this.settings.Css.CbCellContainer),d=a.closest("."+this.settings.Css.CbPlanContainer);a=parseInt(b.data(c.PlannerConstants.dataAttributes.ColumnId),
10);var f=parseInt(b.data(c.PlannerConstants.dataAttributes.ColumnType),10);d=parseInt(d.data(c.PlannerConstants.dataAttributes.PlanId),10);b=b.data(c.PlannerConstants.dataAttributes.ColumnTitle);return{ColumnId:a,Type:f,IsPlanColumn:!0,EntityId:d,ColumnTitle:b}};return b}(e.PlannerInlineCellBase);e.PlannerCBInlineCell=b})(g.InlineCell||(g.InlineCell={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(){function a(a){var b=this;this.settings=a;this.terms=a.Terms;this.css=a.Css;this.contextDialog=new ContextDialog("#"+this.settings.TimeSpanPickerContentPanelId,{title:this.terms.DateContextDialogTitle,footerContent:this.settings.TimeSpanPickerFooterPanelId,setFocus:!1,width:592,zIndex:5});this.closeContextDialog=this.contextDialog.closeDialog;$(function(){b.contextDialog.setCloseFunction(function(a){return b.onCloseDialog(a)});
$(document).on("click","."+b.css.EditPlanTimeSpan,function(a){b.contextDialog.mainContainer.is(":visible")||b.editPlanDate(a)});$("#"+b.settings.CloseContextDialogButton).click(function(){return b.saveChanges()})})}a.prototype.hasPreservedEvents=function(a){var b=!1;(a=this.getTimeSpanData(a))&&a.Events&&(b=0<a.Events.filter(function(a){return 0<a.PreservePlanConnection}).length);return b};a.prototype.editPlanDate=function(a){var b=this,d=$(a.currentTarget),c=this.getDatePicker();this.contextDialog.mainContainer.removeClass(this.css.CellError);
this.currentPlanId=this.getCurrentPlanId(d);this.setDefaultDate();c.setShowPopUpCallback(function(){b.openContextDialog(a);b.contextDialog.mainContainer.find(":radio:checked:first").focus()});c.showTimeSpan(this.getTimeSpanData(this.currentPlanId),this.currentPlanId)};a.prototype.onCloseDialog=function(a){a&&$(a.target).parents().andSelf().hasClass("ui-datepicker")||this.closeContextDialog()};a.prototype.saveChanges=function(){var a=this,b=this.getDatePicker();if(this.hasPreservedEvents(this.currentPlanId))this.closeContextDialog();
else{var d=void 0;switch(b.getCurrentMode()){case c.DatePickerMode.TimeSpan:d=this.updatePlanTimeSpan(this.currentPlanId);break;case c.DatePickerMode.WeekAndDay:d=this.updatePlanWeekAndDay(this.currentPlanId);break;case c.DatePickerMode.Event:d=this.updatePlanEvents(this.currentPlanId)}d&&d.always(function(){return a.focusOnDateEditAction(a.currentPlanId)})}};a.prototype.getTimeSpanHidden=function(a){return $("."+this.css.CellContent).find("input:hidden"+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,
a))};a.prototype.getTimeSpanData=function(a){a=this.getTimeSpanHidden(a);return JSON.parse(a.val())};a.prototype.closeDatePicker=function(){this.closeContextDialog()};a.prototype.getDatePicker=function(){return window[this.settings.TimeSpanPickerInstanceName]};return a}();b.PlanDateCellBase=a})(e.DateCell||(e.DateCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(a){function b(b){a.call(this,b);this.courseId=b.CourseId;this.$contentBlockContainer=$("#"+b.ContentBlockClientId);this.cbPlanner=c.CbPlanner.getInstance()}__extends(b,a);b.prototype.updatePlanTimeSpan=function(a){var b=this,d=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanTimeSpan,data:{courseId:this.courseId,planId:a,start:d.getStartDate(),stop:d.getStopDate(),filterStartDate:this.cbPlanner.getFilterStartDate(),
filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?b.finalizeUpdateDate(a):d.showErrorMsg(c.DatePickerMode.TimeSpan)}).fail(function(){d.showErrorMsg(c.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,d=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanWeekAndDay,data:{courseId:this.courseId,planId:a,start:d.getStartWeek(),stop:d.getStopWeek(),filterStartDate:this.cbPlanner.getFilterStartDate(),
filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?b.finalizeUpdateDate(a):d.showErrorMsg(c.DatePickerMode.WeekAndDay)}).fail(function(){d.showErrorMsg(c.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,d=this.getDatePicker(),f=d.getEvents();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanEvents,data:{courseId:this.courseId,planId:a,activityIds:f,filterStartDate:this.cbPlanner.getFilterStartDate(),filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?
b.finalizeUpdateDate(a):d.showErrorMsg(c.DatePickerMode.Event)}).fail(function(){d.showErrorMsg(c.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(){this.getDatePicker().setDefaultDate(this.cbPlanner.getFilterStartDate())};b.prototype.openContextDialog=function(a){var b=$(a.target).closest("."+this.settings.Css.CellContent);a=b.position();b=b.offset();this.contextDialog.openDialogAt(a.left+b.left+10,a.top+b.top-70,!1)};b.prototype.focusOnDateEditAction=function(a){$("."+this.css.EditPlanTimeSpan).focus()};
b.prototype.updateContent=function(a,b){a=$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.css.CellContent);var d=a.parent();a.replaceWith(b);this.cbPlanner.toggleTooltipForField(d.find("."+this.css.CellContent),!0,this.settings.Terms.Tooltip)};b.prototype.getCurrentPlanId=function(a){return parseInt(a.closest("."+this.settings.Css.PlanContainer).data(c.PlannerConstants.dataAttributes.PlanId).toString(),10)};b.prototype.finalizeUpdateDate=
function(a){this.closeDatePicker();a.hidePlan?(this.showFeedback(a.message,a.extraButtonText,a.navigationUrl,a.periodStartDate),this.hidePlan(a.planId)):this.updateContent(a.planId,a.dateCell)};b.prototype.showFeedback=function(a,b,d,c){var f=this;CCL.InformationFeedback.showFeedbackWithextraButton(this.$contentBlockContainer,a,b,function(){d?window.location.href=d:c&&f.cbPlanner.changeDatePeriod(c);CCL.InformationFeedback.hideFeedback(f.$contentBlockContainer)})};b.prototype.hidePlan=function(a){1<
$("."+this.settings.Css.PlanContainer).length?$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,a)).remove():this.cbPlanner.reloadPlans()};return b}(b.PlanDateCellBase);b.PlanCbDateCell=a})(e.DateCell||(e.DateCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(){function a(b,d,c){var f=this;a.clientInstanceName=b;window[b]=this;this.settings=d;this.$plannerContainer=c;$(function(){f.loSelector=window[f.settings.LearningObjectiveSelectorInstanceName];f.attachEvents()})}a.getPlanLearningObjectivesCellInstance=function(){return window[a.clientInstanceName]};a.prototype.updateContent=function(a,b){this.getLearningObjectivesListCell(b).html(a)};a.prototype.updateLearningObjectives=
function(a){var b=this,d=this.currentPlanId;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.AddPlanLearningObjectives,data:{courseId:this.settings.CourseId,learningObjectiveIds:a,planId:d}}).done(function(a){a&&b.updateContent(a.ControlHtml,d)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.removeLOFromPlan=function(a,b,d){a={courseId:this.settings.CourseId,planId:a,learningObjectiveId:b};void 0!=d&&(a.showCollapsedList=d);return CCL.CommonFunctions.safeAjax({type:"DELETE",
url:this.settings.WebMethods.RemovePlanLearningObjective,data:a}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.attachEvents=function(){var a=this;this.$plannerContainer.on("click","."+this.settings.Css.AddLearningObjectives,function(b){a.currentPlanId=a.getCurrentPlanId($(b.currentTarget));a.loSelector.setSelectedIds(a.getLearningObjectiveIds(a.currentPlanId,!1),!0);a.loSelector.openDialog()});$(document).on("click","."+this.settings.Css.RemoveLearningObjective,function(b){b=$(b.currentTarget);
a.removeLearningObjective(b)})};a.prototype.getLearningObjectiveDataAttribute=function(a){return a?c.PlannerConstants.dataAttributes.RepositoryLearningObjectiveId:c.PlannerConstants.dataAttributes.LearningObjectiveId};return a}();b.PlanLearningObjectivesCellBase=a})(e.LearningObjectivesCell||(e.LearningObjectivesCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(a){function b(b,d){a.call(this,b,d,c.CbPlanner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var d=this,f=this.getCurrentPlanId(b),e=parseInt(b.closest("."+this.settings.Css.LearningObjectivesListItem).data(c.PlannerConstants.dataAttributes.LearningObjectiveId),10);a.prototype.removeLOFromPlan.call(this,f,e).done(function(){b.closest("."+d.settings.Css.LearningObjectivesListItem).remove()})};
b.prototype.getCurrentPlanId=function(a){a=a.closest("."+this.settings.Css.CbPlanContainer);return parseInt(a.data(c.PlannerConstants.dataAttributes.PlanId),10)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.CbPlanContainer+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.AddLearningObjectives).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getLearningObjectiveIds=function(a,b){a=this.getLearningObjectivesListCell(a);
var d=this.getLearningObjectiveDataAttribute(b);b=a.find("."+this.settings.Css.LearningObjectivesListItem+CCL.CommonFunctions.getDataSelector(d));return $.map(b,function(a){return parseInt($(a).data(d),10)})};return b}(b.PlanLearningObjectivesCellBase);b.PlanCbLearningObjectivesCell=a})(e.LearningObjectivesCell||(e.LearningObjectivesCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(b,a){this.planId=b;this.columnId=a}}();c.PlanColumnId=g;var e=function(){function b(a,d){var f=this;window[a]=this;b.instanceName=a;this.settings=d;this.events=d.Events;this.css=d.Css;this.webMethods=d.WebMethods;this.terms=d.Terms;this.data=d.DataAttributes;this.currentDisplayMode=d.CurrentDisplayMode;this.kpi=d.Kpi;this.courseId=this.settings.CourseId;this.container=$("#"+d.Controls.ContainerId);this.plannerFilter=$("#"+d.Controls.PlannerFilterId);
this._ajaxLoader=$("#"+d.Controls.AjaxLoader);this._ajaxLoaderOverlay=$("#"+d.Controls.AjaxLoaderOverlay);setTimeout(function(){f.showNoTopicMessageIfNecessary()},0);var e=this;if(this.settings.Events&&this.settings.Events.TimelineControlInitialized&&this.currentDisplayMode===this.settings.DisplayModes.Timeline)$(document).on(this.settings.Events.TimelineControlInitialized,function(){f.toggleEnableDisplayModeSwitcher(!1);f.toggleTimelineMode(!0);f.toggleEnableDisplayModeSwitcher(!0)});CCL.CommonFunctions.attachPostMessageEventListener($(window),
CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==e.currentDisplayMode&&(e.currentDisplayMode=a,null!=e.webMethods&&null!=e.webMethods.Common&&null!=e.webMethods.Common.TogglePlannerDisplayMode?(e.toggleEnableDisplayModeSwitcher(!1),CCL.CommonFunctions.safeAjaxPost({url:e.webMethods.Common.TogglePlannerDisplayMode,data:{courseId:e.settings.CourseId,plannerDisplayMode:e.currentDisplayMode,childId:e.settings.ChildId}}).done(function(){e.toggleEnableDisplayModeSwitcher(!0);
e.changeDisplayMode()}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d);e.toggleEnableDisplayModeSwitcher(!0)})):e.changeDisplayMode())});this.settings.ReadOnlyMode||(CCL.CommonFunctions.attachPostMessageEventListener($(window),c.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){c.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,a.customId,!0)}),$.fn.scrollParent=function(){return $(document)})}
b.prototype.changeDisplayMode=function(){var a=this;this.toggleTimelineMode(this.isTimelineCurrentMode());this.isTimelineCurrentMode()||$.each(c.Cards.TopicCard.getAllTopicCards(),function(b,c){c.changeDisplayMode(a.currentDisplayMode)})};b.getInstance=function(){return window[b.instanceName]};b.prototype.getSetDateDialog=function(){return window[this.settings.Controls.SetDateDialog]};b.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};b.prototype.getTopicColorPicker=
function(){return window[this.settings.TopicColorPickerInstanceName]};b.prototype.openViewCellContentDialog=function(a,b,c,e){b=b||window.event;b=b.target||b.srcElement;if(!(b&&0<$(b).closest("a,input,button,textarea").length)){var d=window[this.settings.Controls.ViewHtmlTextCellContentDialog];null!=d&&null!=this.webMethods.Column.GetPlanHtmlTextCellContent&&(d.setAjaxUrl(this.webMethods.Column.GetPlanHtmlTextCellContent,null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planId:c,
columnId:e,childId:this.settings.ChildId,filterPersonId:0}:{publicAccessKey:this.settings.PublicAccessKey,planId:c,columnId:e}),a=$(a).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),d.setTitle(a),d.setAfterOpenDialogAjaxDynamicallySuccess(function(){CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(d.getContent())}),d.openDialog())}};b.prototype.getContainer=function(){return this.container};b.prototype.getPlannerFilter=function(){return this.plannerFilter};
b.prototype.getPlannerFeedback=function(){return window[this.settings.Controls.Feedback]};b.prototype.showConfirmDialog=function(a,b,c,e){void 0===c&&(c="");void 0===e&&(e="");CCL.CommonFunctions.jAjaxConfirm(a,this.terms.ConfirmTitle,""===c?this.terms.Yes:c,""===e?this.terms.No:e,b)};b.prototype.parseDateFromString=function(a){return null!=a?$.datepicker.parseDate(this.settings.DateFormat,a):null};b.prototype.showNoTopicMessageIfNecessary=function(){this.isTimelineCurrentMode()||this.settings.UseTopics&&
this.container.find("."+this.css.NoTopicsMessage).toggle(!this.hasTopicsOrPlansWithoutTopic())};b.prototype.togglePlannerSharing=function(){$("#"+this.settings.Controls.ShareMenuItem).toggle(this.hasTopics());$("#"+this.settings.Controls.StopSharingMenuItem).toggle(this.hasTopics())};b.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};b.prototype.hasTopicCardContainers=function(a){return this.settings.UseTopics?
0<c.Cards.TopicCard.getAllTopicCardContainers(a).length:!1};b.prototype.hasTopics=function(){return this.hasTopicCardContainers(!0)};b.prototype.hasTopicsOrPlansWithoutTopic=function(){return this.hasTopicCardContainers(!1)};b.prototype.getPlannerCellCssClass=function(){return this.currentDisplayMode===this.settings.DisplayModes.Table?this.css.TableCell:this.css.ListCell};b.prototype.toggleEnableDisplayModeSwitcher=function(a){window[this.settings.Controls.DisplayModeSwitcher].toggleEnableSwitcher(a)};
b.prototype.isTimelineCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Timeline};b.prototype.getCurrentDisplayMode=function(){return this.currentDisplayMode};b.prototype.isTableCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Table};b.prototype.toggleTimelineMode=function(a){var b=$("#"+this.settings.Controls.GridContainerId);b&&(this.settings.UseTopics?b.toggle(!a):c.Cards.TopicCard.getAllTopicCards()[0].getPlanGrid().getRowsContainer().toggle(!a));
(b=c.PlannerTimeline.getInstance())&&b.toggleTimeline(a,this.settings.UseTopics?this.hasTopics():!0);this.disableTopicToolbarActionItems(a);this.toggleSearch(!a)};b.prototype.disableTopicToolbarActionItems=function(a){if(!this.settings.ReadOnlyMode)if(this.settings.UseTopics){var b=$("#"+this.settings.Controls.AddTopicLink),f=$("#"+this.settings.Controls.ActionLink),e=[];e.push(b);e.push(f);c.Cards.TopicCard.disableMenuItems(e,a,this.settings.Css.DisabledMenuItem,this.settings.Css.DisabledMenuItemContainer,
this.settings.Terms.DisableTopicMenuTooltip)}else c.Cards.TopicCard.getAllTopicCards()[0].disablePlanMenu(a)};b.prototype.toggleSearch=function(a){var b=document.querySelector(this.settings.Controls.SearchField);null!=b&&(b.style.display=a?"":"none")};b.prototype.loadLargePlanTextContent=function(a){var b=this,c=$("."+CCL.CommonFunctions.getDataSelector(this.data.TopicId,a)).find("."+this.css.HtmlTextContentPlaceHolder);if(0===c.length)this.completeLoadingLargePlanContent(a);else{var e=[];$.each(c,
function(a,d){a=$(d);e.push(new g(a.data(b.data.PlanId),a.data(b.data.ColumnId)))});this.processPlanColumnChunks(this.prepareChunks(e)).done(function(){return b.completeLoadingLargePlanContent(a)})}};b.prototype.stopSharingPlanner=function(){var a=this;this.showConfirmDialog(this.settings.Terms.StopSharingPlannerConfirmText,function(b){b&&(a.toggleLoading(!0),CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.ShareablePlanner.StopSharingPlanner,data:{courseId:a.settings.CourseId,plannerShareableObjectId:a.settings.ShareableObjectId}}).done(function(){window.location=
window.location}).fail(function(b,d,c){a.toggleLoading(!1);CCL.CommonFunctions.alertAjaxError(b,d,c)}))})};b.prototype.processPlanColumnChunks=function(a){var b=this,c=a.splice(0,this.settings.ChunkSizeForLoadingLargeText);return 0===c.length?$.when():$.when.apply($,c.map(function(a){return b.getPlanCellsWithLargeTextPromise(a)})).then(function(){b.processPlanColumnChunks(a)})};b.prototype.prepareChunks=function(a){if(!a||0===a.length)return[];for(var b=[],c=!0;c;)c=a.splice(0,this.settings.ChunkSizeForLoadingLargeText),
b.push(c),c=0<a.length;return b};b.prototype.getPlanCellsWithLargeTextPromise=function(a){var b=this,f=[],e=[];a.forEach(function(a){f.push(a.planId);e.push(a.columnId)});return CCL.CommonFunctions.safeAjaxPost({url:this.webMethods.Plan.LoadCellsWithLargeText,data:null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planIds:f,columnIds:e,childId:this.settings.ChildId,currentDisplayMode:this.currentDisplayMode}:{publicAccessKey:this.settings.PublicAccessKey,planIds:f,columnIds:e,currentDisplayMode:this.currentDisplayMode}}).fail(function(a,
b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)}).done(function(a){if(a&&($.each(a.cellList,function(a,d){a=b.getPlanTextContentPlaceHolder(d.PlanId,d.ColumnId);a.replaceWith(d.Content);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a)}),a.columnDataList)){var d=c.Cells.InlineCell.PlannerInlineCell.getInstance();d&&d.addColumnsToEdit(a.columnDataList)}})};b.prototype.getPlanTextContentPlaceHolder=function(a,b){return $("."+this.css.HtmlTextContentPlaceHolder+CCL.CommonFunctions.getDataSelector(this.data.PlanId,
a)+CCL.CommonFunctions.getDataSelector(this.data.ColumnId,b))};b.prototype.toggleLoading=function(a){this._ajaxLoaderOverlay.toggle(a);this._ajaxLoader.toggle(a)};b.prototype.completeLoadingLargePlanContent=function(a){a=c.Cards.TopicCard.getInstance(a);a.removePlanGridMessage();a.loadingLargePlanContentCompleted=!0};return b}();c.Planner=e})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(){function b(a){var d=this;this.loadingLargePlanContentCompleted=!0;this.isSearching=!1;window[b.getTopicCardInstanceName(a.TopicId)]=this;this._settings=a;var f=c.Planner.getInstance();this._topicId=this._settings.TopicId;f.settings.ReadOnlyMode||(this._termStartDate=f.parseDateFromString(this._settings.TermStartDate),this._termEndDate=f.parseDateFromString(this._settings.TermEndDate));this.hasPlans=this._settings.HasPlans;this.hasConnectedFolder=
this._settings.HasConnectedFolder;this.isSearching=this._settings.IsSearching;$(function(){d._planGrid=window[d._settings.PlanGridInstanceName];d._container=$("#"+d._settings.ContainerId);d._topicExpander=d._container.find("."+b.css.TopicExpander);d._topicCheckBox=$("#"+d._settings.TopicCheckBoxId);d._topicExpanderLink=d._container.find("#"+d._settings.TopicExpanderLinkId);d._topicColorPickerLink=d._container.find("#"+d._settings.TopicColorPickerLinkId);d.attachEvents();d.isTopicExpanded()&&!f.isTimelineCurrentMode()&&
$(function(){d.refreshPlanGrid();0<d._settings.PlanIdToScroll&&(d._planIdToScroll=d._settings.PlanIdToScroll)})})}b.setCommonSettings=function(a){b.planner=c.Planner.getInstance();b.commonSettings=a;b.css=b.commonSettings.Css;b.terms=b.commonSettings.Terms;b.isIos=b.planner.settings.IsIos;b.URL=window.URL;var d=(new b.URL(document.location)).searchParams;b.searchText=d.has("SearchText")?d.get("SearchText"):null;b.planner.settings.ReadOnlyMode||b.hideTopicMoveOptionsIfNecessary();null!=a.DisplayModeSwitcher&&
(b.planner.settings.Controls.DisplayModeSwitcher=a.DisplayModeSwitcher)};b.getInstance=function(a){return window[b.getTopicCardInstanceName(a)]};b.getInstanceByContainer=function(a){a=a.data(b.planner.data.TopicId);return window[b.getTopicCardInstanceName(a)]};b.prototype.getColorPickerLink=function(){return this._topicColorPickerLink};b.prototype.getColorSchema=function(){return this._settings.TopicColorSchema};b.prototype.getTopicCardContainer=function(){return this._container};b.topicCardsExist=
function(){return null!=b.commonSettings};b.getAllTopicCardContainers=function(a){if(!b.topicCardsExist())return $();var d="";a&&(d="[data-"+b.planner.data.TopicId+"!=0]");return $("."+b.commonSettings.Css.TopicContainer+d)};b.getAllTopicCards=function(){var a=[];b.getAllTopicCardContainers().each(function(d,c){d=b.getInstanceByContainer($(c));null!=d&&a.push(d)});return a};b.getTopicCardsForTopicIds=function(a){var d=[];null!=a&&0<a.length&&b.getAllTopicCardContainers().each(function(c,e){c=b.getInstanceByContainer($(e));
null!=c&&-1<a.indexOf(c._topicId)&&d.push(c)});return d};b.getPlansForAllTopics=function(){return b.topicCardsExist()?$("."+b.css.Plans+" ."+b.css.PlanContainer):$()};b.getParentTopicCardContainer=function(a){return a.closest("."+b.commonSettings.Css.TopicContainer)};b.getParentTopicCard=function(a){a=b.getParentTopicCardContainer(a);return b.getInstanceByContainer(a)};b.getParentPlanContainer=function(a){return a.closest("."+b.commonSettings.Css.PlanContainer)};b.prototype.getPlanGrid=function(){return this._planGrid};
b.prototype.getSelectedPlanIds=function(a){var d=this._planGrid.getSelectedValues();return d.length?d:(a&&(a=c.Planner.getInstance().terms,CCL.CommonFunctions.jAjaxAlert(b.terms.NothingSelected,a.Alert,a.Ok)),null)};b.prototype.clearPlanSelection=function(){return this._planGrid.toggleSelectAll(!1)};b.clearAllTopicSelection=function(){b.planner.getContainer().find("."+b.css.TopicSelector).each(function(a,d){(a=b.getParentTopicCard($(d)))&&a.isTopicSelected()&&a._topicCheckBox&&(a._topicCheckBox.prop("checked",
!1),a.toggleTopicSelection())})};b.getSelectedTopicIds=function(a){var d=[];b.topicCardsExist()&&b.planner.getContainer().find("."+b.css.TopicSelector).each(function(a,c){(a=b.getParentTopicCard($(c)))&&a.isTopicSelected()&&d.push(a._topicId)});return d.length?d:(a&&(a=c.Planner.getInstance().terms,CCL.CommonFunctions.jAjaxAlert(a.NoTopicsSelected,a.Alert,a.Ok)),null)};b.prototype.showPlanFeedbackMessage=function(a,b){this._planGrid.getFeedback().showMessage(a,b)};b.prototype.appendNewPlan=function(a,
d){this._planGrid.removeEmptyText();this._planGrid.getRowsContainer().append(a);b.planner.currentDisplayMode===b.planner.settings.DisplayModes.Table&&this._planGrid.updateHeaderRowCheckBoxSelection();d&&this.scrollToPlan(d);c.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop(this._container)};b.prototype.removePlansFromGrid=function(a,b){for(var d in a)a.hasOwnProperty(d)&&this.getPlanContainerById(a[d]).remove();this._planGrid.updateFreezeState();
0===this._planGrid.getRowsCount()&&this._planGrid.getRowsContainer().html(b)};b.prototype.getPlanContainerById=function(a){return this._planGrid.getRowById(a)};b.prototype.sortPlans=function(a){for(var b in a)a.hasOwnProperty(b)&&this._planGrid.getRowsContainer().append(this.getPlanContainerById(a[b]))};b.prototype.refreshPlanGrid=function(a,d){var c=this;d={isSearching:this.isSearching,searchText:b.searchText,planIds:d};if(this._planGrid.isLoadingInProgress())return!1;b.startLoadingMonitor();b.planner.settings.ReadOnlyMode||
this.disablePlanMenu(!0);this._planGrid.refresh(d).done(function(){CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(c._planGrid.getRowsContainer());a&&a()})};b.prototype.getTopicExpander=function(){return this._topicExpander};b.prototype.getTopicExpanderLink=function(){return this._topicExpanderLink};b.prototype.updateTopicExpanderLink=function(a){this._topicExpanderLink.html(a)};b.prototype.toggleTopicSelection=function(){var a=this.isTopicSelected();this._planGrid.toggleSelectAll(a);
this._planGrid.toggleDisableAll(a);this.disablePlanMenu(a,b.terms.DisabledMenuItemTooltip);this.toggleDisablePlanActionMenu(a)};b.prototype.isTopicSelected=function(){return this._topicCheckBox?this._topicCheckBox.is(":checked"):!1};b.prototype.getTopicId=function(){return this._topicId};b.prototype.getTopicName=function(){return this._settings.TopicName};b.prototype.setTopicColorSchema=function(a,d){this._settings.TopicColorSchema=a;this._container.find("."+b.css.TopicColorContainer).removeClass().addClass(b.css.TopicColorContainer).addClass(d)};
b.prototype.getLastPlanId=function(){return this._planGrid.getRowPrimaryKeyValueByIndex(this._planGrid.getRowsCount()-1)};b.prototype.getPlanIds=function(){return this._planGrid.getAllValues()};b.prototype.containsPlanElements=function(a){var b=this,f=!1;$.each(a,function(a,d){return 0<b.getPlanContainerById(d).find(c.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getActivityResourceListItemSelector()).length?(f=!0,!1):!0});return f};b.prototype.updatePlanCellsCallback=function(a){if(null!=a){for(var b=
{needToReloadFolders:!1},c=0;c<a.length;c++)this.refreshCell(a[c],b);a=itslTop;b.needToReloadFolders&&a.reloadFolder&&a.reloadFolder("item0","planner",!0,!0)}};b.prototype.redirectToSharePlans=function(a){a=CCL.CommonFunctions.formatString(this._settings.SharePlansPageUrlTemplate,a);window.location=a};b.prototype.redirectToShareTopic=function(){var a=CCL.CommonFunctions.formatString(this._settings.ShareTopicPageUrlTemplate,this._topicId);window.location=a};b.setDefaultDate=function(a,d){if(d=b.getInstance(d)){var c=
Date.now();d=null!=d._termStartDate&&c<d._termStartDate||null!=d._termEndDate&&c>d._termEndDate?d._termStartDate:null;a.setDefaultDate(void 0!=d?d:null)}};b.prototype.setTermDates=function(a,b){this._termStartDate=a;this._termEndDate=b};b.hideTopicMoveOptionsIfNecessary=function(){var a=b.getAllTopicCardContainers(!0);0<a.length&&$.each(a,function(d,c){if(c=$(c).find(CCL.CommonFunctions.getDataSelector(b.planner.data.DropDownMenuClientId)).attr("data-"+b.planner.data.DropDownMenuClientId))if(c=$(document).find("#"+
c))c.find(CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveUpMenu)+","+CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveDownMenu)).show(),0===d&&c.find(CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveUpMenu)).hide(),d===a.length-1&&c.find(CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveDownMenu)).hide()})};b.prototype.showPlanActionMenu=function(){$("."+b.planner.css.PlanActionMenu).show()};b.prototype.hidePlanMoveOptionsIfNecessary=function(){var a=this._planGrid.getRows();
if(0<a.length){$("."+b.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.TopicId,this._topicId)).show();$("."+b.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.TopicId,this._topicId)).show();var d=a.first().data(b.planner.data.GridRowId);$("."+b.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.PlanId,d)).hide();a=a.last().data(b.planner.data.GridRowId);$("."+b.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.PlanId,
a)).hide()}};b.topicExpanderLinkClick=function(a){a.preventDefault();a=$(a.currentTarget);var d=b.getParentTopicCardContainer(a),c=b.getInstanceByContainer(d);d=d.find("."+b.css.Plans);var e=c.getTopicExpander(),g=c.getPlanGrid();e.toggleClass(b.css.TopicExpanded);e.hasClass(b.css.TopicExpanded)?(g.getFeedback().hide(),c.refreshPlanGrid(),a.prop("title",b.terms.CollapseTooltip)):a.prop("title",b.terms.ExpandTooltip);d.slideToggle("fast")};b.prototype.scrollToPlan=function(a){var d=this,c=0,e=window,
g=!1;b.isIos&&window!==itslTop&&(c+=$('iframe[name="mainmenu"]',itslTop.document).offset().top,e=itslTop,g=!0);$("html, body",e.document).stop().animate({scrollTop:c+this.getPlanContainerById(a).offset().top-this._planGrid.getToolbarElement().outerHeight()},function(){b.isIos&&d._planGrid.updateFreezeState(g)})};b.prototype.changeDisplayMode=function(a){this.updateGridView(a);a=a!==b.planner.settings.DisplayModes.Timeline;b.planner.settings.UseTopics&&(a=a&&this.isTopicExpanded());a&&this.refreshPlanGrid()};
b.disableMenuItems=function(a,b,c,e,g){$.each(a,function(a,d){a=$(d);d=a.parent("li");var f=a.html(),h=a.attr("class");d.children("span."+c).remove();b?(d.addClass(e),a.hide(),d=$("<span>").attr("class",h).attr("disabled","disabled").addClass(c).html(f),null!=g&&d.prop("title",g),a.after(d)):(d.removeClass(e),a.show())})};b.prototype.disablePlanMenu=function(a,d){var c=this._container.find("."+b.css.PlanGridToolbar).children("."+b.css.PlanGridToolbarItemsLeft).find("."+b.css.IconLink);b.disableMenuItems(c,
a,b.css.DisabledMenuItem,b.css.DisabledMenuItemContainer,d)};b.prototype.toggleDisablePlanActionMenu=function(a){var d=this._container.find($("."+b.planner.css.PlanActionMenu));$.each(d,function(d,c){d=$(c);d.toggleHyperlink(!a);d.prop("title",a?b.terms.DisabledMenuItemTooltip:"")})};b.prototype.removePlanGridMessage=function(){this._planGrid.removeGridMessage()};b.prototype.scrollToSelectedPlanOnLoad=function(a){var d=this;0>=a||setTimeout(function(){d._container.find("."+b.planner.css.HtmlTextCellViewer+
" img[height]").each(function(a,b){a=$(b);b=parseInt(a.attr("height"))/parseInt(a.attr("width"));isNaN(b)||a.height()||(a.addClass("temp-height"),a.height(b*a.width()))});d.scrollToPlan(d._settings.PlanIdToScroll);$(window).one("resize",function(){$(".temp-height").removeClass("temp-height").height("")})},500)};b.getTopicCardInstanceName=function(a){return b.commonSettings.TopicCardInstanceNamePrefix+a};b.prototype.isTopicExpanded=function(){return this._topicExpander.hasClass(b.css.TopicExpanded)};
b.prototype.refreshCell=function(a,b){switch(a.ColumnType){case c.ColumnType.Date:this.refreshDateCell(a);break;case c.ColumnType.LearningObjectives:this.refreshPlanLoCell(a);break;case c.ColumnType.Resources:case c.ColumnType.Activities:case c.ColumnType.Elements:this.refreshElementCell(a),b.needToReloadFolders=!0}};b.prototype.refreshDateCell=function(a){c.Cells.Plan.DateCell.PlanDateCell.getPlanDateCellInstance().updateContent(a.Content,a.PlanId,a.Properties.planActive);a.Properties.expanderText&&
this.updateTopicExpanderLink(a.Properties.expanderText)};b.prototype.refreshElementCell=function(a){c.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(a.Content,a.PlanId,a.ColumnId,!1,!1)};b.prototype.refreshPlanLoCell=function(a){c.Cells.Plan.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(a.Content,a.PlanId)};b.prototype.attachEvents=function(){var a=this;b.planner.settings.ReadOnlyMode||
($(document).on(b.planner.events.PlanActivationChanged,function(b,c){b=c.planActivations;null!=b&&$.each(b,function(b,d){0<a.getPlanContainerById(d.planId).length&&a._planGrid.toggleRowStatus(d.planId,d.planActive)})}),this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,function(){a.showPlanActionMenu();a.toggleTopicSelection();a.hidePlanMoveOptionsIfNecessary()}));this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,function(){a.loadLargePlanTextContent();
null!=a._planIdToScroll&&(a.scrollToSelectedPlanOnLoad(a._planIdToScroll),a._planIdToScroll=null)});this._topicExpanderLink.click(b.topicExpanderLinkClick);this._topicCheckBox&&this._topicCheckBox.change(function(){return a.toggleTopicSelection()});b.planner.settings.ReadOnlyMode||this._topicColorPickerLink.click(function(){a._container.off(b.planner.events.ColorPickerColorChange);0<a._topicId&&(b.planner.getTopicColorPicker().setupAndOpenTopicColorPicker(a._topicId),a._container.on(b.planner.events.ColorPickerColorChange,
function(d,c){b.planner.getTopicColorPicker().updateTopicColor(a._topicId,c)}))})};b.prototype.loadLargePlanTextContent=function(){0<this._planGrid.totalCount&&(this.loadingLargePlanContentCompleted=!1,this._planGrid.addGridLoadingMessage(),b.planner.loadLargePlanTextContent(this._topicId))};b.prototype.updateGridView=function(a){this._planGrid.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=a;this._planGrid.setMode(a===b.planner.settings.DisplayModes.Table?b.planner.css.GridViewModes.TableView:
b.planner.css.GridViewModes.DefaultView)};b.startLoadingMonitor=function(){if(null==b.planLoadingProcessId){b.planner.toggleEnableDisplayModeSwitcher(!1);var a=b.getAllTopicCards();b.planLoadingProcessId=setInterval(function(){var d=!0;$.each(a,function(a,b){return b.getPlanGrid().isLoadingInProgress()||!b.loadingLargePlanContentCompleted?d=!1:!0});d&&(clearTimeout(b.planLoadingProcessId),b.planLoadingProcessId=null,b.planner.toggleEnableDisplayModeSwitcher(!0),b.planner.settings.ReadOnlyMode||c.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop())},
500)}};b.planLoadingProcessId=null;return b}();g.TopicCard=e})(c.Cards||(c.Cards={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(){function a(b,f){window[b]=this;a.instanceName=b;this.settings=f;this.css=this.settings.Css;this._planner=c.Planner.getInstance()}a.getInstance=function(){return window[a.instanceName]};a.prototype.togglePlanContentExpanderLink=function(a,b,c){a=$(a);a.hasClass(this.css.ExpanderLinkExpanded)?this.collapsePlanContentItems(a):this.expandPlanContentItems(a,b,c)};a.prototype.collapsePlanContentItems=function(a){var b=a.parent().find("li").toArray();
b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay);$.each(b,function(a,b){$(b).hide()});a.children("span").first().text(this.settings.Terms.ShowMore);a.removeClass(this.css.ExpanderLinkExpanded)};a.prototype.expandPlanContentItems=function(a,b,c){a.parent().find("ul").hasClass(this.css.ContentListPartiallyLoaded)?c&&c(a):(b=a.parent().find("li").toArray(),b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay),$.each(b,function(a,b){$(b).show()}),a.children("span").first().text(this.settings.Terms.ShowLess),
a.addClass(this.css.ExpanderLinkExpanded))};a.prototype.loadAllPlanElements=function(a,b,c){var d=this;$.get(this.settings.WebMethods.LoadAllPlanElements,$.param(null==this._planner.settings.PublicAccessKey?{courseId:this._planner.settings.CourseId,planId:b,columnId:c,childId:this._planner.settings.ChildId,dashboardHierarchyId:this._planner.settings.DashboardHierarchyId,dashboardName:this._planner.settings.DashboardName}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b,columnId:c},
!0)).done(function(f){d._planner.settings.ReadOnlyMode?a.closest("."+d._planner.getPlannerCellCssClass()).html(f.ControlHtml):e.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(f.ControlHtml,b,c,!1,!1)}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};a.prototype.loadAllLearningObjectives=function(a,b){var d=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadAllPlanLearningObjectives,data:null==this._planner.settings.PublicAccessKey?
{courseId:this._planner.settings.CourseId,planId:b,childId:this._planner.settings.ChildId}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b}}).done(function(c){d._planner.settings.ReadOnlyMode?a.closest("."+d._planner.getPlannerCellCssClass()).html(c.ControlHtml):e.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(c.ControlHtml,b)}).fail(CCL.CommonFunctions.alertAjaxError)};return a}();e.PlanExpandableContentCellCommonLogic=b})(g.Plan||
(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(k){(function(e){(function(b){var a=function(){function a(a,b,d){this.fileUploadInProgress=!1;this.fakeElementItemId="fakeElementItemId";this.uploadProgressDataAttributeName="upload-in-progress";this.settings=a;this.courseId=b;this.controls=d}a.prototype.multipleFilesUploadedToResourcesCell=function(a,b){var d=new CCL.CommonWindowMessages.GenericMessage("showMultipleFilesUploadToPlannerFeedback");CCL.CommonFunctions.makePostMessageCallWithData(window.itslTop,d,{planId:a,
columnId:b,uploadStarted:!0})};a.prototype.attachEvents=function(){var a=this;$(document).on("click","."+this.settings.Css.RemoveFromPlanLink,function(b){b=$(b.currentTarget);a.removeElementFromPlan(b)}).on("click","."+this.settings.Css.AddElementMenuItem+", ."+this.settings.Css.AddElementShowAllMenuItem,function(b){b=$(b.currentTarget);switch(a.getDataAttributeValueAsNumber(b,g.PlannerConstants.dataAttributes.ElementExternalSource)){case c.AddResourceMenu.ElementExternalSourceType.Library:a.addFromLibrary(b);
break;case c.AddResourceMenu.ElementExternalSourceType.Course:a.addFromCourse(b);break;case c.AddResourceMenu.ElementExternalSourceType.Computer:1===a.getDataAttributeValueAsNumber(b,a.uploadProgressDataAttributeName)?CCL.CommonFunctions.jAlertAjaxError(a.settings.Terms.WaitUntilPreviousFileIsUploaded,"",a.settings.Terms.Ok,!1):a.addFromComputer(b)}CCL.AlternativeChoiceManager.closeOpenedDialog()}).on("click","."+this.settings.Css.AddElementLink,function(b){a.openElementSelector($(b.currentTarget))});
this.attachSpecificEvents()};a.prototype.openElementSelector=function(a){var b=this,d=this.getPlanId(a),f=this.getElementType(a),e=this.getColumnId(a),k=this.getFolderId(a);f=this.settings.ElementSelectorClientInstanceNameTemplate.replace("{0}",f.toString());f=window[f];var r=f.getFirstColumn().find("a");r.each(function(a,c){a=$(c);a.attr("href",b.updateAddLinkUrl(a.attr("href"),d,k))});f.getSecondColumn().find("a").each(function(a,b){$(b).attr("data-"+g.PlannerConstants.dataAttributes.PlanId,d).attr("data-"+
g.PlannerConstants.dataAttributes.ColumnId,e).attr("data-"+g.PlannerConstants.dataAttributes.FolderId,k)});var q=f.getSecondColumn().find(CCL.CommonFunctions.getDataSelector(g.PlannerConstants.dataAttributes.ElementExternalSource,c.AddResourceMenu.ElementExternalSourceType.Computer));q.css("opacity",this.fileUploadInProgress?"0.5":"");q.attr("data-"+this.uploadProgressDataAttributeName,this.fileUploadInProgress?"1":"0");f.openDialog(a,this.getElementDialogOffset());CCL.CommonFunctions.isMobileDevice()||
r.first().focus()};a.prototype.deletePlanElement=function(a,b,d){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.DeletePlanElement,data:{courseId:this.courseId,planId:a,elementId:b,deleteFromCourse:d}}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.addFromLibrary=function(a){var b=this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.ElementType),d=this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.PlanId),c=this.getDataAttributeValueAsNumber(a,
g.PlannerConstants.dataAttributes.FolderId),f=this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.ColumnId);a=this.getLibraryBrowserDialog();b={RelatedEntityId:d,ElementCategory:this.getElementCategoryAsStringByElementType(b),FolderId:c,CustomId:f.toString()};b.LearningObjectivesIds=this.getLearningObjectiveIds(d,!0);a.browseLibrary(b)};a.prototype.addFromCourse=function(a){var b=this,d=this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.ElementType),f=this.getDataAttributeValueAsNumber(a,
g.PlannerConstants.dataAttributes.PlanId),e=this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.ColumnId);a={locationId:this.courseId,locationType:c.AddResourceMenu.ElementExternalSourceType.Course};var k=[],r=new Map;this.loadCurrentElementStates(f,e,r);d={elementStates:r,elementType:d,showAll:!1,header:this.getElementLinkDialogTitle(d),afterOkClickCallback:function(a){a&&(a.forEach(function(a,b){a!==c.CheckboxStateMachine.State.AttachedByUser&&a!==c.CheckboxStateMachine.State.Saved||
k.push(b)}),0<k.length&&b.updatePlanElements(f,k,e))},allowFolderSelection:d!==c.ElementLinkDialog.ContentElementType.Activities,openerPage:c.ElementLinkDialog.ElementsPopupOpener.Plan,relatedEntityId:f};c.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(d,a)};a.prototype.addFromComputer=function(a){this.currentPlanId=this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.PlanId);this.currentColumnId=this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.ColumnId);
$("#"+Components.ComponentName.localPicker).click()};a.prototype.onFileUploadSuccess=function(a){var b=this;this.fileUploadInProgress&&CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.CreateNewFileForPlan,data:{courseId:this.courseId,planId:this.currentPlanId,fileName:a.name,fileId:a.id,signedFileId:a.signature}}).done(function(a){a.Success?b.refreshResourcesCell(b.currentPlanId,b.currentColumnId,!0):($("#"+b.fakeElementItemId).remove(),CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,
b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1))}).fail(function(){$("#"+b.fakeElementItemId).remove();CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1)}).always(function(){b.fileUploadInProgress=!1;b.currentColumnId=void 0;b.currentPlanId=void 0})};a.prototype.onFileUploadFailed=function(a,b){var d=this;this.fileUploadInProgress=!1;CCL.CommonFunctions.jAjaxConfirm(b,this.settings.Terms.FailedFileUploadChoiceDialogTitle,
this.settings.Terms.FailedFileUploadChoiceDialogUploadNewFile,this.settings.Terms.FailedFileUploadChoiceDialogCancel,function(a){a?$("#"+Components.ComponentName.localPicker).click():(d.currentColumnId=void 0,d.currentPlanId=void 0)});$("#"+this.fakeElementItemId).remove()};a.prototype.onFileSelected=function(a){this.fileUploadInProgress=!0;a='<li id="'+this.fakeElementItemId+'" class="'+this.settings.Css.ActivityResourceListItem+'">\n    <div class="'+this.settings.Css.FakeElementContainer+'">\n        <i class="'+
this.settings.Css.FakeElementTitle+'">'+a[0].name+"</i>\n    </div>\n</li>";this.getActivityResourceList(this.currentPlanId,this.currentColumnId).append($(a));$("#"+this.fakeElementItemId+" ."+this.settings.Css.FakeElementContainer).prepend($(this.controls.LoadingWheel).addClass(""+this.settings.Css.FakeElementImage))};a.prototype.updatePlanElements=function(a,b,d){var c=this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanElements,data:{courseId:this.courseId,planId:a,
elementIds:b,columnId:d}}).done(function(){c.refreshResourcesCell(a,d,!0)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getDataAttributeValueAsNumber=function(a,b){return parseInt(a.attr("data-"+b),10)};a.prototype.getElementLinkDialogTitle=function(a){return a===c.ElementLinkDialog.ContentElementType.Activities?this.settings.Terms.AddActivityModalTitle:this.settings.Terms.AddResourceModalTitle};a.prototype.getElementCategoryAsStringByElementType=function(a){switch(a){case c.ElementLinkDialog.ContentElementType.Resources:return g.ElementCategory[g.ElementCategory.Resource];
case c.ElementLinkDialog.ContentElementType.Activities:return g.ElementCategory[g.ElementCategory.Activity]}};a.prototype.loadCurrentElementStates=function(a,b,d){CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetPlanElements,data:{courseId:this.courseId,planId:a,columnId:b}}).done(function(a){a&&$.each(a.elementIds,function(a,b){d.set(b,c.CheckboxStateMachine.State.Saved)})}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getPlanContainer=function(a){return a.closest("."+this.settings.Css.PlanContainer)};
a.prototype.updateAddLinkUrl=function(a,b,d){var c=a.lastIndexOf("?"),f=a.substring(0,c);a=a.substring(c+1).split("&");for(c=0;c<a.length;c++){var e=a[c].substring(0,a[c].indexOf("="));e.toLowerCase()===this.settings.RequestParameters.FolderId.toLowerCase()?a[c]=e+"="+d:e.toLowerCase()===this.settings.RequestParameters.RelatedEntityId.toLowerCase()&&(a[c]=e+"="+b)}return f+"?"+a.join("&")};a.prototype.getElementType=function(a){return this.getDataAttributeValueAsNumber(a,g.PlannerConstants.dataAttributes.ElementType)};
return a}();b.PlanResourcesCellBase=a})(e.ResourcesCell||(e.ResourcesCell={}))})(k.Plan||(k.Plan={}))})(g.Cells||(g.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(a){function b(d,f,e){a.call(this,f,f.CourseId,e);window[d]=this;b.instanceName=d;this.attachEvents();this.cbPlanner=c.CbPlanner.getInstance()}__extends(b,a);b.getPlanActivityResourceCellInstance=function(){return window[b.instanceName]};b.onFileUploadSuccess=function(a){b.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};b.onFileUploadFailed=function(a,d){b.getPlanActivityResourceCellInstance().onFileUploadFailed(a,
d)};b.onFileSelected=function(a){b.getPlanActivityResourceCellInstance().onFileSelected(a)};b.prototype.refreshResourcesCell=function(a,b,d){this.reloadPlanElements(a,b);d&&this.measureKpiEditPlan()};b.prototype.refreshResourcesCellWithElement=function(a){(a=this.cbPlanner.getContainer().find("."+this.settings.Css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.ElementId,a)))&&this.reloadPlanElements(this.getPlanId(a),this.getColumnId(a))};b.prototype.attachSpecificEvents=
function(){var a=this;$(document).on("click","."+this.settings.Css.AddHomework,function(b){a.openElementSelector($(b.currentTarget))})};b.prototype.removeElementFromPlan=function(b){var d=this,f=b.closest("."+this.settings.Css.ActivityResourceListItem);b=this.getPlanId(b);var e=this.getDataAttributeValueAsNumber(f,c.PlannerConstants.dataAttributes.ElementId);a.prototype.deletePlanElement.call(this,b,e,!1).done(function(){f.remove();d.measureKpiEditPlan()})};b.prototype.getLibraryBrowserDialog=function(){return this.cbPlanner.getLibraryBrowserDialog()};
b.prototype.getActivityResourceCell=function(a,b){return this.getActivityResourceList(a,b).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getActivityResourceList=function(a,b){return $("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.ActivityResourceCell)};b.prototype.getLearningObjectiveIds=function(a,b){var d=e.LearningObjectivesCell.PlanLearningObjectivesCellBase.getPlanLearningObjectivesCellInstance();
return d?d.getLearningObjectiveIds(a,b):[]};b.prototype.measureKpiEditPlan=function(){this.cbPlanner.measureEditPlan()};b.prototype.reloadPlanElements=function(a,b){var d=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ReloadPlanElements,data:{courseId:this.courseId,planId:a,columnId:b}}).done(function(c){d.getActivityResourceCell(a,b).html(c.ControlHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};b.prototype.getPlanId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,
c.PlannerConstants.dataAttributes.PlanId)};b.prototype.getColumnId=function(a){return 0};b.prototype.getElementDialogOffset=function(){return-35};b.prototype.getFolderId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,c.PlannerConstants.dataAttributes.FolderId)};return b}(b.PlanResourcesCellBase);b.PlanCbResourcesCell=a})(e.ResourcesCell||(e.ResourcesCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this.name=b;this.settings=a;window[this.name]=this;c.instanceName=this.name;this.settings=a;this.$useTopicsCheckbox=$("#"+this.settings.ClientIds.UseTopics);this.topicColumnsGrid=window[this.settings.TopicColumnsGridInstanceName];this.planColumnsGrid=window[this.settings.PlanColumnsGridInstanceName];this.$enableAnonymousAccessCheckbox=$("#"+this.settings.ClientIds.EnableAnonymousAccess);this.$addPlanRichTextColumnLink=$("#"+this.settings.ClientIds.AddPlanColumnLink);
this.countOfPlanRichTextColumns=this.settings.PlanRichColumnsCount;this.deletedTopicColumns=[];this.deletedPlanColumns=[];$(function(){d.toggleTopicSettings();d.togglePublicCopyLink();d.togglePlanDefaultStatusContainer();d.toggleAddPlanRichTextColumnLink();d.toggleElementsColumns();d.disableDragAndDropForColumnsByIds(d.settings.NotReorderableTopicColumnIds,!0);d.disableDragAndDropForColumnsByIds(d.settings.NotReorderablePlanColumnIds,!1);d.attachEvents();d.findRowTeplates()})}c.getInstance=function(){return window[c.instanceName]};
c.prototype.deleteCustomColumn=function(b,a){var d=this;b=$(b);var c=b.closest("."+this.settings.Css.GridRow);b.data(this.settings.DataAttributes.HasData)?this.showConfirmDialog(a?this.settings.Terms.DeleteCustomTopicColumnConfirmText:this.settings.Terms.DeleteCustomPlanColumnConfirmText,function(b){b&&(d.cacheDeletedItem(c,a),c.remove())}):(this.cacheDeletedItem(c,a),c.remove());a||(this.countOfPlanRichTextColumns--,this.toggleAddPlanRichTextColumnLink());return!1};c.prototype.afterOpenCopyPublicLinkDialog=
function(){CCL.CommonFunctions.safeAjaxPost({url:this.settings.MeasureCopyPublicLinkUrl})};c.prototype.save=function(){var b=!0;this.$useTopicsCheckbox.prop("checked")&&(b=this.validateColumnNames(this.topicColumnsGrid,!0));b=this.validateColumnNames(this.planColumnsGrid,b)&&b;if(!b)return event.stopPropagation(),!1;this.collectDataForSaving();return!0};c.prototype.showConfirmDialog=function(b,a){CCL.CommonFunctions.jAjaxConfirm(b,this.settings.Terms.ConfirmTitle,this.settings.Terms.Yes,this.settings.Terms.No,
a)};c.prototype.cacheDeletedItem=function(b,a){var d={};d.Id=b.data(this.settings.DataAttributes.GridRowId);d.IsDeleted=!0;0<d.Id&&(a?this.deletedTopicColumns.push(d):this.deletedPlanColumns.push(d))};c.prototype.addTopicCustomColumn=function(){this.addGridRow(this.topicColumnsGrid,this.$topicColumnTemplate)};c.prototype.addPlanCustomColumn=function(){this.$addPlanRichTextColumnLink.getIfHyperLinkEnabled()&&(this.addGridRow(this.planColumnsGrid,this.$planColumnTemplate),this.countOfPlanRichTextColumns++,
this.toggleAddPlanRichTextColumnLink())};c.prototype.findRowTeplates=function(){this.$topicColumnTemplate=this.topicColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$topicColumnTemplate.detach();this.$planColumnTemplate=this.planColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$planColumnTemplate.detach()};c.prototype.addGridRow=function(b,a){var d=a.clone(!0).data(this.settings.DataAttributes.GridRowId,this.settings.NewColumnId);b.getRowsContainer().append(d);b=a.find(this.settings.ShowOnCoursePageInputSelector);
0<b.length&&(a=CCL.CommonFunctions.formatString(this.settings.ToggleInstanceNameTemplate,b[0].id),b=window[a],a=a+"_clone"+(new Date).getTime(),b.clone(d,a));d.find("input."+this.settings.Css.ColumnTitle).focus()};c.prototype.validateColumnNames=function(b,a){var d=this,c=!0,e;b.getRowsContainer().find("input."+this.settings.Css.ColumnTitle+":visible").each(function(a,b){a=$(b);c=d.validateColumnName(a)&&c;null!=e||c||(e=a)});null!=e&&a&&window.scrollTo(0,e.offset().top);return c};c.prototype.validateColumnName=
function(b){if(0===b.val().trim().length)return b.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","visible"),!1;b.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","");return!0};c.prototype.toggleTopicSettings=function(){var b=this.$useTopicsCheckbox.prop("checked");$("#"+this.settings.ClientIds.TopicsHolder).toggle(b);var a=$("#"+this.settings.ClientIds.CreateFolderForEachNewTopic);b?(a.removeProp("readonly"),a.off("click",this.disabledCheckboxOnClick)):(a.prop("readonly",
"readonly"),a.on("click",this.disabledCheckboxOnClick))};c.prototype.togglePublicCopyLink=function(){var b=this.$enableAnonymousAccessCheckbox.prop("checked");$("#"+this.settings.ClientIds.CopyPublicLink).toggle(b)};c.prototype.togglePlanDefaultStatusContainer=function(){var b=$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).val()===this.settings.PlanActivationTypeManually;$("#"+this.settings.ClientIds.AutoActivationInfoContainer).toggle(!b);$("#"+this.settings.ClientIds.PlanDefaultStatusContainer).toggle(b)};
c.prototype.toggleElementsColumns=function(){for(var b=$("#"+this.settings.ClientIds.ElementColumnsRadioList+" input:checked").val()===this.settings.UseGenericElementsColumn,a=this.planColumnsGrid,d=0;d<this.settings.SeparateElementColumnIds.length;d++)$(a.getRowById(this.settings.SeparateElementColumnIds[d])).toggle(!b);$(a.getRowById(this.settings.GenericElementsColumnId)).toggle(b)};c.prototype.reorderFieldSuccess=function(){$("#"+this.settings.ClientIds.ReorderDataHiddenField).val("true")};c.prototype.collectDataForSaving=
function(){if(this.$useTopicsCheckbox.prop("checked")){var b=$("#"+this.settings.ClientIds.TopicColumnDataHiddenField),a=this.topicColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(b,a,this.deletedTopicColumns)}b=$("#"+this.settings.ClientIds.PlanColumnDataHiddenField);a=this.planColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(b,a,this.deletedPlanColumns)};c.prototype.collectData=function(b,a,d){var c=this,e=[];a.each(function(a,
b){a=$(b);b=a.find("."+c.settings.Css.ColumnTitle);var f=a.find("."+c.settings.Css.ColumnType),h=a.find("."+c.settings.Css.ColumnVisibleFor),g=a.find(c.settings.ShowOnCoursePageInputSelector),l={};l.Id=a.data(c.settings.DataAttributes.GridRowId);l.Title=b.val().trim();l.ColumnType=f.val();l.VisibleFor=h.val();l.ShowOnCoursePage=g.is(":checked");l.IsDeleted=!1;e.push(l);e=e.concat(d)});b.val(JSON.stringify(e))};c.prototype.attachEvents=function(){var b=this;this.$useTopicsCheckbox.on("change",function(){b.toggleTopicSettings()});
this.$enableAnonymousAccessCheckbox.on("change",function(){b.togglePublicCopyLink()});$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).on("change",function(){b.togglePlanDefaultStatusContainer()});this.topicColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(a){a=$(a.currentTarget);b.validateColumnName(a)});this.planColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(a){a=$(a.currentTarget);
b.validateColumnName(a)});$("#"+this.settings.ClientIds.ElementColumnsRadioList).on("change",function(){b.toggleElementsColumns()})};c.prototype.disableDragAndDropForColumnsByIds=function(b,a){a=a?this.topicColumnsGrid:this.planColumnsGrid;for(var d=0;d<b.length;d++)a.getRowById(b[d]).removeClass(this.settings.Css.ReorderableGridRow)};c.prototype.toggleAddPlanRichTextColumnLink=function(){var b=this.countOfPlanRichTextColumns<this.settings.MaxNumberOfRichTextColumnsInPlan;this.$addPlanRichTextColumnLink.toggleHyperlink(b);
b?this.$addPlanRichTextColumnLink.removeAttr("title"):this.$addPlanRichTextColumnLink.attr("title",this.settings.Terms.AddPlanRichTextColumnLinkDisabledTooltip)};c.prototype.disabledCheckboxOnClick=function(){return!1};c.prototype.CopyToClipboard=function(){var b=document.querySelector('[id$="SharePlanPublicLink"]').value;window.navigator.clipboard?window.navigator.clipboard.writeText(b):document.execCommand("copy");document.getElementsByClassName("feedback")[0].setAttribute("style","visibility:visible")};
c.prototype.HideFeedbackMessage=function(){"visible"==document.getElementsByClassName("feedback")[0].style.visibility&&document.getElementsByClassName("feedback")[0].setAttribute("style","visibility:hidden")};return c}();c.CustomizePlanner=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){return function(){}}();c.CurrentParameters=e;e=function(){function b(a,b){window[a]=this;this.settings=b;this.$container=$("#"+this.settings.Controls.ContainerId)}b.prototype.clearContainer=function(){this.$container&&(this.$container.find("iframe,object").css("visibility","hidden"),this.$container.html(""))};b.prototype.openDialog=function(a,b,c,e,g){this.currentParameters||(this.currentParameters={});this.currentParameters.EventId=b;this.currentParameters.CourseId=
a;null!=c&&window[this.settings.Controls.DialogTarget].setTitle(c);void 0!=e&&(this.currentParameters.ViewForPersonId=e);void 0!=g&&(this.currentParameters.ChildId=g);this.clearContainer();window[this.settings.Controls.DialogTarget].openDialog()};b.prototype.loadEventPlans=function(){if(this.currentParameters){var a=this.$container;a&&$.ajax({type:"GET",url:this.settings.WebMethods.GetEventPlansXhtml,async:!1,data:{courseId:this.currentParameters.CourseId,eventUniqueId:this.currentParameters.EventId,
childId:null==this.currentParameters.ChildId?0:this.currentParameters.ChildId,viewForPersonId:null==this.currentParameters.ViewForPersonId?0:this.currentParameters.ViewForPersonId,dashboardHierarchyId:this.settings.DashboardHierarchyId}}).done(function(b){a.html(b.contentHtml);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a)}).fail(function(b){return a.html(b.responseText)})}};b.prototype.togglePlanDetails=function(a,b,c,e,g,m){var d=this,f=this,h=$(a),l=h.parent().find("."+this.settings.CssClasses.PlanContainerCss);
a=l.is(":visible");h.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.PlanDetailsExpanderImage)).toggleClass(this.settings.CssClasses.ForwardImage,a).toggleClass(this.settings.CssClasses.ChevronDownImage,!a);l.data(this.settings.DataAttributes.PlanDetailsContentLoaded)||$.ajax({type:"GET",url:this.settings.WebMethods.GetSinglePlanXhtml,async:!1,data:{courseId:b,planId:c,childId:e,viewForPersonId:g,showFullPlannerLink:m,dashboardHierarchyId:this.settings.DashboardHierarchyId}}).done(function(a){l.html(a.contentHtml);
l.data(f.settings.DataAttributes.PlanDetailsContentLoaded,"true");CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(l)}).fail(function(a){return l.html(a.responseText)});l.slideToggle("fast",function(){h.prop("title",l.is(":visible")?d.settings.Terms.HideDetails:d.settings.Terms.ViewDetails);l.css("overflow","")})};return b}();c.EventPlansDialog=e})(c.Dialogs||(c.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(){function b(a,d){var f=this;window[a]=this;b.instanceName=a;this._settings=d;this._planner=c.Planner.getInstance();document.getElementById(d.MoveToTopicOkButtonId).addEventListener("click",function(){f.movePlansToTopicOkBtnClick()},!1);document.getElementById(d.MoveToTopicCancelButtonId).addEventListener("click",function(){f.movePlansToTopicCancelBtnClick()},!1)}b.getInstance=function(){return window[b.instanceName]};b.prototype.openDialog=function(a,
b){void 0===b&&(b=null);var d=c.Cards.TopicCard.getInstance(a);null==b&&(b=d.getSelectedPlanIds(!0));null!=b&&(this.initTopicDropDownListControl(),this._topicId=a,this._planIds=b,this.reloadTopicList(),this._topicDropDownList.value=a.toString(),0<this._topicDropDownList.childNodes.length&&this.getCssModal().openDialog())};b.prototype.movePlansToTopicOkBtnClick=function(){var a=this,b=this._topicId,f=Number.parseInt(this._topicDropDownList.value);if(b==f)CssModal.closeDialog();else{var e=c.Cards.TopicCard.getInstance(b),
g=c.Cards.TopicCard.getInstance(f),m=e.getPlanGrid(),k=g?g.getPlanGrid():null;CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Plan.MovePlansToTopic,data:{courseId:this._planner.settings.CourseId,srcTopicId:b,dstTopicId:f,planIds:this._planIds,start:this._planner.settings.FilterStartDate,end:this._planner.settings.FilterEndDate,showPlanDates:this._planner.settings.ShowDates}}).done(function(b){m.toggleSelectAll(!1);e.hasPlans=b.srcTopicHasPlans;if(g&&k){k.removeEmptyText();var d=!g.hasPlans&&
a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table;g.hasPlans=!0}if(k&&k.getGridElement().is(":visible"))if(d)for(g.refreshPlanGrid(),d=0;d<b.sortedPlanIds.length;d++)m.getRowById(b.sortedPlanIds[d]).remove();else{d=k.getRowsContainer();for(var c=0;c<b.sortedPlanIds.length;c++)d.append(m.getRowById(b.sortedPlanIds[c]));a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table&&k.updateHeaderRowCheckBoxSelection();g&&g.isTopicSelected()&&g.toggleTopicSelection()}else for(d=
0;d<b.sortedPlanIds.length;d++)m.getRowById(b.sortedPlanIds[d]).remove();0===m.getRowsCount()&&m.getRowsContainer().html(b.emptyGridText);e.updateTopicExpanderLink(b.srcExpanderText);e.hidePlanMoveOptionsIfNecessary();g&&(g.updateTopicExpanderLink(b.dstExpanderText),g.hidePlanMoveOptionsIfNecessary());CssModal.closeDialog()}).always(function(b){a.emptyTopicDropdownListControl()})}};b.prototype.movePlansToTopicCancelBtnClick=function(){this.emptyTopicDropdownListControl()};b.prototype.initTopicDropDownListControl=
function(){null==this._topicDropDownList&&(this._topicDropDownList=document.getElementById(this._settings.TopicDropDownListId))};b.prototype.emptyTopicDropdownListControl=function(){for(;this._topicDropDownList.lastChild;)this._topicDropDownList.removeChild(this._topicDropDownList.lastChild)};b.prototype.reloadTopicList=function(){var a=this;this.emptyTopicDropdownListControl();CCL.CommonFunctions.safeAjax({url:this._planner.webMethods.Topic.GetTopicIdsAndNames+"/"+this._planner.settings.CourseId,
async:!1}).done(function(b){for(var d in b){var c=b[d],e=document.createElement("option");e.appendChild(document.createTextNode(c));e.value=d;a._topicDropDownList.appendChild(e)}})};b.prototype.getCssModal=function(){return window[this._settings.MoveToTopicCssModalId]};return b}();g.PlanMoveToTopicDialog=e})(c.Dialogs||(c.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e;(function(a){a[a.Initial=0]="Initial";a[a.Progress=1]="Progress";a[a.Error=2]="Error";a[a.Result=3]="Result"})(e||(e={}));var b;(function(a){a[a.CopyPlans=0]="CopyPlans";a[a.CopyTopics=1]="CopyTopics"})(b||(b={}));var a=function(){function a(b,d){this.settings=d;window[b]=this;a.instanceName=b;this.terms=d.Terms;this.css=d.Css;this.controls=d.Controls;this.webMethods=d.WebMethods;this.controlInitialized=!1}a.prototype.open=function(a,d,c,g){if(null!=d){this.initControls();
this.idsToCopy=d();if(a){if(null==this.idsToCopy||!this.idsToCopy.length){CCL.CommonFunctions.jAlertAjaxError(this.terms.NoTopicsSelected,this.terms.Alert,this.terms.Ok,!1);return}this.currentCopyMode=b.CopyTopics;1==this.idsToCopy.length?(a=document.querySelector('div[data-topic-id="'+this.idsToCopy[0]+'"] input[type="hidden"]').getAttribute("value"),this.$selectCourseLabel.text(this.terms.CopyXTo.replace("{0}",a))):this.$selectCourseLabel.text(this.terms.CopyTopicsToCourse)}else{if(null==this.idsToCopy||
!this.idsToCopy.length){CCL.CommonFunctions.jAlertAjaxError(this.terms.NoPlansSelected,this.terms.Alert,this.terms.Ok,!1);return}this.currentCopyMode=b.CopyPlans;this.$selectCourseLabel.text(this.terms.CopyPlansToCourse)}this.clearSelectionCallback=c;this.topicIdForCopyPlans=g;this.setCopyStage(e.Initial);this.getCssModal().openDialog()}};a.prototype.copy=function(){this.$coursesList.val()?(this.setCopyStage(e.Progress),this.copyInternal(this.currentCopyMode===b.CopyPlans?this.webMethods.CopyPlans:
this.webMethods.CopyTopics)):this.$selectCourseErrorContainer.show()};a.prototype.copyInternal=function(a){var b=this,d=0<this.$optionOverwriteAssessmentCriteria.length?this.$optionOverwriteAssessmentCriteria.prop("checked"):!1;CCL.CommonFunctions.safeAjaxPost({url:a,data:{sourceCourseId:this.settings.CourseId,targetCourseId:parseInt(this.$coursesList.val()),targetTopicId:parseInt(this.$targetCourseTopicsDropdown.val()),copyDates:this.$optionCopyDates.prop("checked"),copyResourcesAndActivities:this.$optionCopyResourcesAndActivities.prop("checked"),
overwriteAssessmentCriteria:d,elementIds:this.idsToCopy}}).done(function(a){b.$resultMessageHolder.html(a.ResultMessage);b.$resultNotesHolder.hide();0<a.ResultWarningNotes.length&&(b.$resultNotesHolder.show(),b.$resultNotesHolder.find("ol").html(a.ResultWarningNotes).show());b.setCopyStage(e.Result)}).fail(function(){b.setCopyStage(e.Error)})};a.prototype.updateTopicsDropdown=function(a){var b=this;0!==a&&(this.$targetCourseTopicsDropdown.children().remove(),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetTopics,
data:{courseId:this.settings.CourseId,targetCourseId:a,originalTopicId:this.topicIdForCopyPlans}}).done(function(a){0===a.length&&b.$targetCourseTopicsPanel.hide();var d=b.settings.TopicsDropdownDefaultValue;d=$.grep(a,function(a){return!a.IsNewGroup});d=b.addItemsToTopicDropdown(d,b.$targetCourseTopicsDropdown);a=$.grep(a,function(a){return a.IsNewGroup});if(a.length){var c=$("<optgroup></optgroup>").attr("label",b.terms.CreateNewTopic);b.addItemsToTopicDropdown(a,c);c.appendTo(b.$targetCourseTopicsDropdown)}b.$targetCourseTopicsDropdown.val(d.toString())}).fail(function(){b.setCopyStage(e.Error)}))};
a.prototype.addItemsToTopicDropdown=function(a,b){var d=this.settings.TopicsDropdownDefaultValue;$.each(a,function(a,c){b.append($("<option />").val(c.TopicId.toString()).text(c.Name));c.Selected&&(d=c.TopicId)});return d};a.prototype.getCssModal=function(){return window[this.settings.CssModalClientInstance]};a.prototype.initControls=function(){var a=this;this.controlInitialized||(this.$selectCourseLabel=$("#"+this.controls.SelectCourseLabel),this.$coursesList=$("#"+this.controls.CoursesList),this.$optionCopyDates=
$("#"+this.controls.OptionCopyDates),this.$optionOverwriteAssessmentCriteria=$("#"+this.controls.OptionOverwriteAssessmentCriteria),this.$optionCopyResourcesAndActivities=$("#"+this.controls.OptionCopyResourcesAndActivities),this.$resultMessageHolder=$("#"+this.controls.ResultMessageHolder),this.$resultNotesHolder=$("#"+this.controls.ResultNotesHolder),this.$overwriteAssessmentCriteriaPanel=$("#"+this.controls.OverwriteAssessmentCriteriaPanel),this.$dialogCancelButton=$("#"+this.controls.DialogCancelButton),
this.$dialogOkButton=$("#"+this.controls.DialogOkButton),this.$dialogCloseButton=$("."+this.css.DialogCloseButton),this.$initialPanel=$("#"+this.controls.InitialPanel),this.$progressPanel=$("#"+this.controls.ProgressPanel),this.$resultPanel=$("#"+this.controls.ResultPanel),this.$errorPanel=$("#"+this.controls.ErrorPanel),this.$copyOptions=$("#"+this.controls.CopyOptions),this.$targetCourseTopicsPanel=$("#"+this.controls.TargetCourseTopicsPanel),this.$targetCourseTopicsDropdown=$("#"+this.controls.TargetCourseTopicsList),
this.$selectCourseErrorContainer=this.$initialPanel.find("."+this.css.CopyError),this.$coursesList.on("change",function(b){a.onCourseListChange(b)}),this.controlInitialized=!0)};a.prototype.setCopyStage=function(a){switch(a){case e.Initial:this.$coursesList.val(null);this.$optionCopyDates.prop("checked",!1);this.$optionCopyResourcesAndActivities.prop("checked",!0);0<this.$overwriteAssessmentCriteriaPanel.length&&(this.$overwriteAssessmentCriteriaPanel.show(),this.setOverwriteAssessmentCriteriaControlsState(c.CopyDialogOverwriteAssessmentCriteriaState.Show,
!0));this.$targetCourseTopicsPanel.hide();this.$dialogOkButton.text(this.terms.Copy);this.$copyOptions.hide();this.$selectCourseErrorContainer.hide();break;case e.Result:null!=this.clearSelectionCallback&&this.clearSelectionCallback();break;case e.Error:this.$dialogOkButton.text(this.terms.Retry)}this.$dialogCloseButton.toggle(a!==e.Progress);this.$dialogCancelButton.toggle(a!==e.Progress).text(a===e.Initial?this.terms.Cancel:this.terms.Close);this.$dialogOkButton.toggle(a===e.Initial||a===e.Error);
this.$initialPanel.toggle(a===e.Initial);this.$progressPanel.toggle(a===e.Progress);this.$resultPanel.toggle(a===e.Result);this.$errorPanel.toggle(a===e.Error)};a.prototype.setOverwriteAssessmentCriteriaControlsState=function(a,b){0<this.$optionOverwriteAssessmentCriteria.length&&(this.$optionOverwriteAssessmentCriteria.prop("disabled",a===c.CopyDialogOverwriteAssessmentCriteriaState.Disable),this.$overwriteAssessmentCriteriaPanel.toggleClass(this.css.Inactive,a===c.CopyDialogOverwriteAssessmentCriteriaState.Disable),
this.$overwriteAssessmentCriteriaPanel.find("#"+this.controls.OverwriteAssessmentCriteriaLabel).toggle(a===c.CopyDialogOverwriteAssessmentCriteriaState.Disable),b&&this.$optionOverwriteAssessmentCriteria.prop("checked",!1))};a.prototype.onCourseListChange=function(a){var d=$(a.currentTarget).val();this.$selectCourseErrorContainer.toggle(!d);this.$copyOptions.toggle(0!==d.length);if(this.currentCopyMode===b.CopyPlans&&0!==d.length){var f=!0;this.settings.CourseIdsNotUsedTopics&&($.each(this.settings.CourseIdsNotUsedTopics,
function(a,b){return b===d?f=!1:!0}),this.$targetCourseTopicsPanel.toggle(f));f&&this.updateTopicsDropdown(d)}0<this.$overwriteAssessmentCriteriaPanel.length&&(this.settings.OverwriteAssessmentCriteriaStateData?(a=parseInt(this.settings.OverwriteAssessmentCriteriaStateData[d]),this.$overwriteAssessmentCriteriaPanel.toggle(a!==c.CopyDialogOverwriteAssessmentCriteriaState.Hide),0<this.$optionOverwriteAssessmentCriteria.length&&this.setOverwriteAssessmentCriteriaControlsState(a,!1)):this.$overwriteAssessmentCriteriaPanel.toggle(d!==
this.settings.CourseId))};return a}();c.PlannerCopyDialog=a})(c.Dialogs||(c.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){window[b]=this;e.instanceName=b;this._settings=a;this._terms=a.Terms;this._planner=c.Planner.getInstance();this._courseId=this._planner.settings.CourseId}e.getInstance=function(){return window[e.instanceName]};e.prototype.addTopic=function(b,a,d,c){CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.AddTopic,data:{courseId:this._courseId,topicName:b,topicColorSchema:a},success:function(a){null!=d&&d();a&&a.refreshUrl&&(window.location.href=
a.refreshUrl)},error:function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d);null!=c&&c()}})};e.prototype.shareTopic=function(b,a){var d=this;if(b){var f=c.Cards.TopicCard.getInstance(b);CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.ShareablePlanner.CheckTopicDataForSharing,data:{courseId:this._courseId,topicId:b,isTopicSharedByAnotherAuthor:a}}).done(function(a){a&&a.conflictMessage?CCL.CommonFunctions.jAjaxAlert(a.conflictMessage,d._planner.terms.Alert,d._planner.terms.Ok):a&&
a.warningMessage?d._planner.showConfirmDialog(a.warningMessage,function(a){a&&f.redirectToShareTopic()}):f.redirectToShareTopic()}).fail(CCL.CommonFunctions.alertAjaxError)}};e.prototype.stopSharingTopic=function(b,a){var d=this;a&&CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.ShareablePlanner.StopSharingTopic,data:{courseId:this._courseId,topicId:a}}).done(function(a){a&&a.message?CCL.CommonFunctions.jAjaxAlert(a.message,d._planner.terms.Alert,d._planner.terms.Ok):window.location=
window.location}).fail(CCL.CommonFunctions.alertAjaxError)};e.prototype.deleteTopic=function(b){this.deleteTopics([b],!1)};e.prototype.deleteTopics=function(b,a){var d=this;void 0===b&&(b=null);void 0===a&&(a=!0);a&&null==b&&(b=c.Cards.TopicCard.getSelectedTopicIds(!0));null!=b&&(a=this.getDeleteTopicsConfirmationMessage(b),this._planner.showConfirmDialog(a,function(a){a&&CCL.CommonFunctions.safeAjaxPost({url:d._planner.webMethods.Topic.DeleteTopics,data:{courseId:d._courseId,topicIds:b}}).done(function(a){0<
a.deletedTopics.length&&($.each(a.deletedTopics,function(a,b){b.topicId&&0<b.topicId&&(c.Cards.TopicCard.getInstance(b.topicId).getTopicCardContainer().remove(),d.updateFilterAfterDeleting(b.topicId));b.folderId&&0<b.folderId&&c.PlannerUtility.deleteTopicFolderNode(b.folderId)}),c.Cards.TopicCard.hideTopicMoveOptionsIfNecessary(),d._planner.showNoTopicMessageIfNecessary(),d.showTopicFeedbackMessage(a.restoreText),d._planner.togglePlannerSharing())}).fail(CCL.CommonFunctions.alertAjaxError)},this._planner.terms.Delete,
this._planner.terms.Cancel))};e.prototype.restoreTopics=function(b){CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.RestoreTopics,data:{courseId:this._courseId,topicIds:b}}).done(function(a){a&&a.refreshUrl&&(window.location.href=a.refreshUrl)}).fail(CCL.CommonFunctions.alertAjaxError)};e.prototype.moveUpTopic=function(b){if(b){var a=c.Cards.TopicCard.getInstance(b).getTopicCardContainer(),d=a.prev();if(d){var f=c.Cards.TopicCard.getInstanceByContainer(d).getTopicId();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.SwapTopics,
data:{courseId:this._courseId,firstTopicId:b,secondTopicId:f},success:function(b){b&&(a.insertBefore(d),c.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};e.prototype.moveDownTopic=function(b){if(b){var a=c.Cards.TopicCard.getInstance(b).getTopicCardContainer(),d=a.next();if(d){var f=c.Cards.TopicCard.getInstanceByContainer(d).getTopicId();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.SwapTopics,data:{courseId:this._courseId,
firstTopicId:b,secondTopicId:f},success:function(b){b&&(a.insertAfter(d),c.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};e.prototype.updateFilterAfterDeleting=function(b){var a=this._planner.getPlannerFilter().find("optgroup[label='Topic']");a.find("option[value='t"+b+"']").remove();0===a.find("option[value^='t']").length&&a.remove()};e.prototype.showTopicFeedbackMessage=function(b){this._planner.getPlannerFeedback().showMessage(CCL.FeedbackType.Information,
b)};e.prototype.getDeleteTopicsConfirmationMessage=function(b){if(null==b||0===b.length)return"";var a=!1;c.Cards.TopicCard.getTopicCardsForTopicIds(b).forEach(function(b){b.hasConnectedFolder&&(a=!0)});b=1<b.length;var d="";return d=a?b?this._terms.DeleteTopicsConnectedToFolderConfirmText:this._terms.DeleteOneTopicConnectedToFolderConfirmText:b?this._terms.DeleteTopicsConfirmText:this._terms.DeleteOneTopicConfirmText};return e}();c.TopicCommonLogic=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){var d=this;window[b.instanceName]=this;this.playPlanContentItemIdAttributeName=a;$("body").on("click",CCL.CommonFunctions.getDataSelector(this.playPlanContentItemIdAttributeName),function(a){a.preventDefault();(a=$(a.currentTarget))&&(a=a.data(d.playPlanContentItemIdAttributeName))&&b.openPlayPlanDialog(a)});if((a=itslTop.history.state)&&a.playPlanDialogState){var c=a.playPlanDialogState;c.itemId&&$(function(){b.openPlayPlanDialog(c.itemId)})}}b.openPlayPlanDialog=
function(a){var b=a.split("_")[0];c.PlayPlanDialog.getClientInstance().open(b,a);(new CCL.EdgeImmersiveReaderHelper).removeEdgeReadableMetaTag()};b.getInstance=function(){return window[b.instanceName]};b.instanceName="playPlanDialogOpenerClientInstanceName";return b}();c.PlayPlanDialogOpener=e})(c.Dialogs||(c.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){var d=this;this.indexDialogWidth=500;this.itemIdDataAttributeName="itemId";this.lastTreeLinkIdToNavigate=this.lastPlanItemIndexBeforeNavigateByTreeLink=void 0;this.onEscape=function(a){a.which===CCL.CommonConstants.keyCodes.escape&&(d.indexDialog.isOpened()?d.indexDialog.closeDialog():d.toggleDialog(!1))};this.closeTooltip=function(a){setTimeout(function(){return d.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,c){setTimeout(function(){d.toolTip.isTooltipOpened()||
d.$tooltipContentLabel.html(b);d.toolTip.openTooltip(a,d.tooltipPositionSettings)},c)};window[b.clientInstanceName]=this;this.settings=a;$(function(){d.$body=$("body");d.$bodyWrapper=$("."+d.settings.CssClasses.BodyWrapper);d.$dialog=$("#"+d.settings.Controls.Dialog);d.$topicColumnNameLabel=$("#"+d.settings.Controls.TopicColumnNameLabel);d.$planColumnNameLabel=$("#"+d.settings.Controls.PlanColumnNameLabel);d.$topicTitleLabel=$("#"+d.settings.Controls.TopicTitleLabel);d.$planTitleLabel=$("#"+d.settings.Controls.PlanTitleLabel);
d.$errorLabel=$("#"+d.settings.Controls.ErrorMessageLabel);d.$frame=$("#"+d.settings.Controls.Frame);d.$loadingIndicator=$("#"+d.settings.Controls.LoadingIndicator);d.$prevButtons=$("."+d.settings.CssClasses.PrevButton);d.$nextButtons=$("."+d.settings.CssClasses.NextButton);d.$indexButtons=$("."+d.settings.CssClasses.IndexButton);d.$indexCancelMobileButton=$("#"+d.settings.Controls.IndexMobileCancelButton);d.$closeButton=$("#"+d.settings.Controls.CloseButton);d.$tooltipContentLabel=$("#"+d.settings.Controls.TooltipContentLabel);
d.$indexDialogContainer=$("#"+d.settings.Controls.IndexContainer);d.focusTracker=new CCL.FocusTracker(d.$dialog);d.$prevButtons.click(function(){return d.goToPreviousItem()});d.$nextButtons.click(function(){return d.goToNextItem()});d.$indexButtons.click(function(a){a.preventDefault();d.openIndexDialog()});d.$indexCancelMobileButton.click(function(){return d.indexDialog.closeDialog()});d.$closeButton.click(function(){d.toggleDialog(!1);d.settings.CustomerSettings.IsEdgeImmersiveReaderEnabled&&(new CCL.EdgeImmersiveReaderHelper).setReadableIframe(window.name)});
d.initTooltip();d.toggleToolTip(d.$indexButtons,d.settings.Terms.ShowAllResources,!0);d.toggleToolTip(d.$closeButton,d.settings.Terms.CloseThisPlan,!0);d.indexDialog=new ContextDialog(d.$indexDialogContainer,{setFocus:!0,showHeader:!1,showCloseLink:!1,showArrow:!0,expandParentFrame:!1,closeOnEscape:!1,footerContent:d.settings.Controls.IndexMobileCancelContainer,width:d.indexDialogWidth,zIndex:5,marginTop:1,marginLeft:0,align:"right",valign:"bottom",arrowOffset:"manual",arrowLeft:d.indexDialogWidth-
d.$indexButtons.outerWidth()/2});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.fullScreenDialogOpening,function(a,b){d.notifyFullScreenDialog(b)}.bind(d))})}b.prototype.registerTreeLinkCustomHandler=function(){var a=this;CCL.CustomTreeLinkNavigationManager.registerCustomHandler(function(b){a.handleTreeLinkNavigationEvent(b)})};b.prototype.removeTreeLinkCustomHandler=function(){CCL.CustomTreeLinkNavigationManager.removeCustomHandler()};b.prototype.handleTreeLinkNavigationEvent=
function(a){var b=this;this.lastTreeLinkIdToNavigate=a.linkId;this.lastPlanItemIndexBeforeNavigateByTreeLink=this.currentPlanItemIndex;if(!a.linkId||0>=a.sourceId)this.showInformationFeedback(a.context===CCL.TreeLinkContext.library?this.settings.TreeLinkHandlerSettings.Terms.TreeLinkIsInLibrary:this.settings.TreeLinkHandlerSettings.Terms.ErrorOccurred);else{var c=this.settings.TreeLinkHandlerSettings.TreeLinksGetInfoForCustomNavigation.replace("{id}",a.linkId).replace("{sourceElementId}",a.sourceId.toString()),
e=function(){return b.lastTreeLinkIdToNavigate!==a.linkId||b.lastPlanItemIndexBeforeNavigateByTreeLink!==b.currentPlanItemIndex?!0:!1};$.get(c).done(function(d){if(!e())if(d.HasError)b.showInformationFeedback(d.ErrorDescription);else{var c=b.settings.TreeLinkHandlerSettings.KpiSettings;CCL.CommonFunctions.measureKpi(c.url,c.section,c.clickOnTreeLinkMeasurement,c.context).always(function(){if("_blank"===a.target)window.open(d.TargetElementContentUrl,"_blank");else{var c=b.playPlanItems.filter(function(a){return a.ElementId===
d.TargetElementId});c.length?b.loadPlayPlanItem(c[0]):itslTop.location.assign(d.TargetElementUrl)}})}}).fail(function(){e()||b.showInformationFeedback(b.settings.TreeLinkHandlerSettings.Terms.ErrorOccurred)})}};b.getClientInstance=function(){return window[b.clientInstanceName]};b.prototype.open=function(a,b){this.playPlanItems=null;this.disableNavigationButtonsIfNeeds();this.clearContentFrame();this.toggleDialog(!0);this.loadPlanItems(a,b)};b.prototype.notifyFullScreenDialog=function(a){a&&CCL.CommonFunctions.makePostMessageCall(a,
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.fullScreenDialogCollapseTitle))};b.prototype.displayOnboardingIfNeeds=function(){var a=this;this.isNavigationButtonDisabled(this.$nextButtons)||$.get(this.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl).done(function(b){b.IsCompleted||(a.openTooltip(a.$nextButtons,a.settings.Terms.GoToNextResource,500),CCL.CommonFunctions.safeAjax({url:a.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl,type:"PUT",
headers:(d={},d[a.settings.AntiforgerySettings.HeaderName]=a.settings.AntiforgerySettings.HeaderValue,d)}));var d})};b.prototype.adjustDialogPositionOnIosDevice=function(a){if(CCL.CommonFunctions.isIosDevice()){var b=$(itslTop).height()-this.$closeButton.height();this.$bodyWrapper.css("overflow",a?"hidden":"");this.$bodyWrapper.height(a?""+b:"auto")}};b.prototype.toggleDialog=function(a){this.suspendUpdateBreadCrumbsAndNavigation(a);this.toggleEscapeHandler(a);this.adjustDialogPositionOnIosDevice(a);
this.$body.css("overflow",a?"hidden":"");this.$dialog.toggle(a);a?(this.hideInformationFeedback(!1),CCL.CommonFunctions.makePostMessageCall(window.itslTop,{messageName:CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame}),this.suspendExpandCollaplseContentAreaFrame(!0),this.registerTreeLinkCustomHandler(),this.$startLink=$(":focus"),this.$closeButton.focus(),this.focusTracker.startTrackFocus()):(this.clearContentFrame(),this.suspendExpandCollaplseContentAreaFrame(!1),CCL.CommonFunctions.makePostMessageCall(window.itslTop,
{messageName:CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame}),this.removeTreeLinkCustomHandler(),this.focusTracker.stopTrackFocus(),this.$startLink.focus());IframeResizer.reportSetIframeDefaultHeight()};b.prototype.toggleEscapeHandler=function(a){if(a)this.$body.on("keyup",this.onEscape);else this.$body.off("keyup",this.onEscape)};b.prototype.clearContentFrame=function(){this.hideInformationFeedback();this.updateHistoryState(null);this.setFrameUrl("about:blank")};b.prototype.loadPlanItems=
function(a,b){var d=this;this.loadPlanItemsInProgress||(this.loadPlanItemsInProgress=!0,this.toggleHeaderLoadingText(!0),this.$errorLabel.hide(),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadItems,data:{planId:a}}).done(function(a){d.toggleHeaderLoadingText(!1);a&&(a.TopicColumnName&&d.$topicColumnNameLabel.text(a.TopicColumnName+":"),a.PlanColumnName&&d.$planColumnNameLabel.text(a.PlanColumnName+":"),a.TopicTitle&&d.$topicTitleLabel.text(a.TopicTitle),a.PlanTitle&&d.$planTitleLabel.text(a.PlanTitle),
d.$topicColumnNameLabel.toggle(a.UseTopics),d.$topicTitleLabel.toggle(a.UseTopics),d.$planColumnNameLabel.toggle(a.UseTopics),d.playPlanItems=a.Items,d.updateIndexDialogContainer(),d.currentPlanItemIndex=-1,(a=d.playPlanItems.filter(function(a){return a.ItemId===b})[0])?d.loadPlayPlanItem(a):d.navigateToPlayPlanItem(0),d.displayOnboardingIfNeeds(),CCL.CommonFunctions.applyIframely())}).fail(function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=a.responseText&&0<a.responseText.length||
null!=a.statusText&&0<a.statusText.length)?d.showErrorMessage(null!=a.responseText&&0<a.responseText.length?a.responseText:a.statusText):d.showUnableToShowPlanErrorMessage()}).always(function(){d.loadPlanItemsInProgress=!1}))};b.prototype.toggleHeaderLoadingText=function(a){a?(this.$topicColumnNameLabel.add(this.$planColumnNameLabel).add(this.$topicTitleLabel).text(""),this.$planTitleLabel.text(this.settings.Terms.Loading)):this.$planTitleLabel.text("")};b.prototype.loadPlayPlanItem=function(a){this.hideInformationFeedback();
this.updateHistoryState(a);a?(this.currentPlanItemIndex=this.playPlanItems.indexOf(a),this.disableNavigationButtonsIfNeeds(),this.markCurrentItemAsSelected(a),this.setFrameUrl(a.ContentUrl)):this.showUnableToShowPlanErrorMessage()};b.prototype.updateHistoryState=function(a){var b=itslTop.history.state||{};a?b.playPlanDialogState={itemId:a.ItemId}:b.playPlanDialogState&&delete b.playPlanDialogState;itslTop.history.replaceState(b,null)};b.prototype.markCurrentItemAsSelected=function(a){this.$indexDialogContainer.find("."+
this.settings.CssClasses.IndexItem).removeClass(this.settings.CssClasses.IndexSelectedItem);a=CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,a.ItemId);this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem+a).addClass(this.settings.CssClasses.IndexSelectedItem)};b.prototype.navigateToPlayPlanItem=function(a){this.currentPlanItemIndex!==a&&this.loadPlayPlanItem(this.playPlanItems[a])};b.prototype.goToPreviousItem=function(){this.isNavigationButtonDisabled(this.$prevButtons)||
1<=this.currentPlanItemIndex&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex-1])};b.prototype.goToNextItem=function(){this.isNavigationButtonDisabled(this.$nextButtons)||this.currentPlanItemIndex<this.playPlanItems.length-1&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex+1])};b.prototype.openIndexDialog=function(){if(!this.isNavigationButtonDisabled(this.$indexButtons)){var a=this.$indexButtons.offset().left+this.$indexButtons.outerWidth()-this.indexDialogWidth,
b=this.$indexButtons.outerHeight();this.indexDialog.openDialogAt(a,b,!1);this.closeTooltip(0);if(a=this.playPlanItems[this.currentPlanItemIndex-1])a=this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem+CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,a.ItemId)),this.$indexDialogContainer.animate({scrollTop:a.offset().top})}};b.prototype.updateIndexDialogContainer=function(){var a=this;this.$indexDialogContainer.html("");var b=$('<ul class="'+this.settings.CssClasses.IndexList+
'"></ul>');$.each(this.playPlanItems,function(d,c){a.renderItem(b,c,d)});b.appendTo(this.$indexDialogContainer)};b.prototype.renderItem=function(a,b,c){var d=this;$("<li data-"+this.itemIdDataAttributeName+"="+b.ItemId+">").append('<a href="javascript:void(0);">\n                             <img alt="" src="'+b.IconUrl+'" class="'+this.settings.CssClasses.IndexItemIcon+'"/>\n                             <span class="'+this.settings.CssClasses.IndexItemTitle+'">'+b.ItemTitle+"</span>\n                        </a>").addClass(this.settings.CssClasses.IndexItem).appendTo(a).click(function(){d.indexDialog.closeDialog();
d.navigateToPlayPlanItem(c)})};b.prototype.showUnableToShowPlanErrorMessage=function(){this.showErrorMessage(this.settings.Terms.UnableToShowPlan)};b.prototype.showErrorMessage=function(a){this.$errorLabel.text(a);this.$errorLabel.show();this.$loadingIndicator.hide()};b.prototype.showInformationFeedback=function(a){CCL.InformationFeedback.showFeedback(this.$dialog,a,{disableAutomaticHiding:!0})};b.prototype.hideInformationFeedback=function(a){void 0===a&&(a=!0);CCL.InformationFeedback.hideFeedback(this.$dialog,
a)};b.prototype.disableNavigationButtonsIfNeeds=function(){this.disableNavigationButton(this.$nextButtons,null==this.playPlanItems||this.currentPlanItemIndex===this.playPlanItems.length-1,this.settings.Terms.GoToNextResource);this.disableNavigationButton(this.$prevButtons,null==this.playPlanItems||0===this.currentPlanItemIndex,this.settings.Terms.GoToPreviousResource);this.disableNavigationButton(this.$indexButtons,null==this.playPlanItems||1===this.playPlanItems.length,this.settings.Terms.ShowAllResources)};
b.prototype.disableNavigationButton=function(a,b,c){var d=this.isNavigationButtonDisabled(a)!==b;a.toggleHyperlink(!b);d&&this.toggleToolTip(a,c,!b)};b.prototype.suspendUpdateBreadCrumbsAndNavigation=function(a){CCL.CommonFunctions.makePostMessageCall(itslTop,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendUpdateBreadCrumbsAndNavigation,{suspend:a}))};b.prototype.suspendExpandCollaplseContentAreaFrame=function(a){CCL.CommonFunctions.makePostMessageCall(itslTop,
new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame,{suspend:a}))};b.prototype.setFrameUrl=function(a){a?(this.$frame.prop("src",a),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};b.prototype.isNavigationButtonDisabled=function(a){return!a.getIfHyperLinkEnabled()};b.prototype.initTooltip=function(){this.tooltipPositionSettings={My:"right+23 top",At:"center bottom+10",
Arrow:"bottom"};this.$toolTipContainer=$("#"+this.settings.Controls.TooltipContainer);this.toolTip=new CCL.CustomTooltip("playPlanToolTip",{contentContainer:this.$toolTipContainer,zIndex:10},this.settings.CssClasses.CustomTooltipCssClasses);this.$toolTipContainer.show()};b.prototype.toggleToolTip=function(a,b,c){var d=this;if(!CCL.CommonFunctions.isMobileDevice())if(c)a.on("mouseover",function(){d.indexDialog.isOpened()||d.openTooltip(a,b,0)}).on("mouseleave",function(){return d.closeTooltip(0)});
else this.closeTooltip(0),a.off("mouseover mouseleave")};b.clientInstanceName="playPlanDialogClientInstanceName";return b}();c.PlayPlanDialog=e})(c.Dialogs||(c.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(k){var e=function(){function b(a,b){this.settings=b;window[a]=this;this.$okButton=$("#"+this.settings.Controls.OkButton);this.$cancelButton=$("#"+this.settings.Controls.CancelButton)}b.prototype.open=function(a,b,f,e){var d=this;if(null!=a){this.updateGridViewCallback=b;this.clearSelectionCallback=f;this.planIdList=a;this.toggleInProcess(!1);this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker];this.setPlanDatesModal=window[this.settings.ClientInstanceNames.SetPlanDatesModal];
this.datePicker.callbacks.onUserSelectionUpdated||(this.datePicker.callbacks.onUserSelectionUpdated=function(){d.setPlanDatesModal.adjustWindowSize()});this.datePicker.clearData();this.datePicker.setRecurringMode(this.planIdList);this.datePicker.showCurrentMode();var h=g.Cells.Plan.DateCell.PlanDateCell.getPlanDateCellInstance();a=a.filter(function(a){return h.hasPreservedEvents(a)});this.datePicker.togglePreservedEventsWillNotBeUsedPanel(0<a.length);null!=e&&c.Planner.Cards.TopicCard.setDefaultDate(this.datePicker,
e);this.setPlanDatesModal.openDialog()}};b.prototype.setPlanDates=function(){this.toggleInProcess(!0);this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker];if(null!=this.datePicker&&this.datePicker.validateDates())switch(this.datePicker.getCurrentMode()){case g.DatePickerMode.TimeSpan:this.updatePlansTimeSpan();break;case g.DatePickerMode.WeekAndDay:this.updatePlansWeekAndDay();break;case g.DatePickerMode.Event:this.updatePlansEvents()}else this.toggleInProcess(!1)};b.prototype.toggleInProcess=
function(a){this.$okButton.toggleClass(this.settings.CssClasses.InProgress,a);a?(this.$okButton.attr("disabled","disabled"),this.$cancelButton.attr("disabled","disabled")):(this.$okButton.removeAttr("disabled"),this.$cancelButton.removeAttr("disabled"))};b.prototype.updatePlansTimeSpan=function(){var a=this,b=this.datePicker.getWeekDays();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansTimeSpan,data:{courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartDate(),
stop:this.datePicker.getStopDate(),weekNumber:this.datePicker.getWeekNumber(),weekDays:0===b.length?"":JSON.stringify(b),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,d,c){CCL.CommonFunctions.alertAjaxError(b,d,c);a.toggleInProcess(!1)})};b.prototype.updatePlansWeekAndDay=function(){var a=this,b=this.datePicker.getWeekDays();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansWeekAndDay,
data:{courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartWeek(),stop:this.datePicker.getStopWeek(),weekNumber:this.datePicker.getWeekNumber(),weekDays:0===b.length?"":JSON.stringify(b),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,d,c){CCL.CommonFunctions.alertAjaxError(b,d,c);a.toggleInProcess(!1)})};
b.prototype.updatePlansEvents=function(){var a=this,b=this.datePicker.getEvents();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansEvents,data:{courseId:this.settings.CourseId,planIds:this.planIdList,firstPlanEventIds:b,filterStartDate:this.settings.FilterStartDateTime,filterStopDate:this.settings.FilterStopDateTime,isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();
a.closeDialog()}).fail(function(){a.datePicker.showErrorMsg(g.DatePickerMode.Event);a.toggleInProcess(!1)})};b.prototype.closeDialog=function(){window.location.href=this.settings.DefaultTarget};return b}();k.SetPlanDatesDialog=e})(g.Dialogs||(g.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(){function b(a,b){var d=this;window[a]=this;this.settings=b;$(function(){d.topicColorPicker=window[d.settings.ColorPickerClientInstanceName];d.planner=c.Planner.getInstance()})}b.prototype.setupAndOpenTopicColorPicker=function(a){a=c.Cards.TopicCard.getInstance(a);this.topicColorPicker.getSelectedColorKey()!==a.getColorSchema()&&(this.topicColorPicker.setPickerLink(a.getColorPickerLink()),this.topicColorPicker.setColor(a.getColorSchema()),this.topicColorPicker.openPopup())};
b.prototype.updateTopicColor=function(a,b){CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Topic.SetTopicColorSchema,data:{courseId:this.planner.settings.CourseId,topicId:a,topicColorSchema:b}}).done(function(d){c.Cards.TopicCard.getInstance(a).setTopicColorSchema(b,d.topicColorSchemaCss)}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};return b}();g.TopicColorPicker=e})(c.Dialogs||(c.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b,a){var d=this;this.addingPlanIsInProgress=!1;this.closeTooltip=function(a){setTimeout(function(){return d.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,c){setTimeout(function(){d.$toolTipContent.html(b);d.toolTip.openTooltip(a,d.tooltipPositionSettings)},c)};window[b]=this;e.clientInstanceName=b;this.settings=a;this.courseId=this.settings.CourseId;this.kpi=this.settings.Kpi;this.$container=$("#"+this.settings.Controls.Container);
this.$addNewPlanLink=$("#"+this.settings.Controls.AddNewPlanLink);this.$addNewPlanLinkContainer=$("#"+this.settings.Controls.AddNewPlanLinkContainer);this.$newPlanToolTipContent=$("#"+this.settings.Controls.NewPlanToolTip);this.$toolTipContent=$("#"+this.settings.Controls.FieldsToolTip);this.initNewPlanToolTip();this.initFieldsToolTip();$(function(){d.datePeriodSelector=window[d.settings.Controls.DatePeriodSelector];$(d.datePeriodSelector).on(c.Controls.DatePeriodSelector.periodChangedEventName,function(a,
b){return d.loadPlans(b.startDate,b.endDate)});d.$container.on("click","."+d.settings.Css.SinglePlanEmptyOverlay,function(){return d.addPlan(!1)});d.$addNewPlanLink.on("click",function(){return d.addPlan(!0)});d.cbExpander=window[d.settings.Controls.Expander];CCL.CommonFunctions.attachPostMessageEventListener($(window),g.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){g.Cells.Plan.ResourcesCell.PlanCbResourcesCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,
a.customId,!0)})})}e.getInstance=function(){return window[e.clientInstanceName]};e.prototype.getContainer=function(){return this.$container};e.prototype.getFilterStartDate=function(){return this.datePeriodSelector.getStartDate()};e.prototype.getFilterStopDate=function(){return this.datePeriodSelector.getEndDate()};e.prototype.reloadPlans=function(){this.loadPlans(this.datePeriodSelector.getStartDate(),this.datePeriodSelector.getEndDate())};e.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};
e.prototype.changeDatePeriod=function(b){this.datePeriodSelector.changeDatePeriod(b)};e.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};e.prototype.updatePlansFolder=function(b,a){$("."+this.settings.Css.SinglePlanContainer+CCL.CommonFunctions.getDataSelector(g.PlannerConstants.dataAttributes.PlanId,b)).attr("data-"+g.PlannerConstants.dataAttributes.FolderId,a)};e.prototype.loadPlans=function(b,a){var d=
this;this.datePeriodSelector.toggleNavigationButtons(!1);this.togglePlanTitleToolTip(this.$container,!1);this.$container.append($("<div>").addClass(this.settings.Css.LoadingIndicator));this.cbExpander.renderShowMoreLinkIfNeed(!1);CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadPlans,data:{courseId:this.settings.CourseId,start:b,stop:a}}).done(function(a){d.$container.html(a.html);d.refreshCbExpander(!d.isSelectedWeekNotEmpty());d.renderAddNewPlanLinkIfNeeds();d.disableKeyboardNavigationIfWeekIsEmpty();
d.toggleFieldsToolTip(!0);CCL.CommonFunctions.applyIframely();CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(d.$container)}).fail(function(a,b,c){d.$container.empty();CCL.CommonFunctions.alertAjaxError(a,b,c)}).always(function(){d.datePeriodSelector.toggleNavigationButtons(!0)})};e.prototype.refreshCbExpander=function(b){this.cbExpander&&this.cbExpander.renderShowMoreLinkIfNeed(b);this.$container.removeClass(this.settings.Css.PlansContainerMinHeight)};e.prototype.addPlan=function(b){var a=
this;this.addingPlanIsInProgress||(this.addingPlanIsInProgress=!0,this.toggleFieldsToolTip(!1),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.AddPlan,data:{courseId:this.settings.CourseId,start:this.datePeriodSelector.getStartDate(),stop:this.datePeriodSelector.getEndDate()}}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)}).done(function(d){b?(a.$container.append(d.ControlHtml),d=a.$container.find("."+a.settings.Css.SinglePlanContainer).last(),$("html, body",window.document).stop().animate({scrollTop:d.offset().top})):
(a.$container.html(d.ControlHtml),a.$container.find("."+a.settings.Css.PlanTitleCell).find("."+a.settings.Css.HtmlTextCellViewer).click(),a.togglePlanTitleToolTip(a.$container,!0));a.refreshCbExpander(!0);a.renderAddNewPlanLinkIfNeeds();CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a.$container)}).always(function(){a.addingPlanIsInProgress=!1}))};e.prototype.renderAddNewPlanLinkIfNeeds=function(){this.$addNewPlanLinkContainer.toggle(this.isSelectedWeekNotEmpty())};e.prototype.isSelectedWeekNotEmpty=
function(){return 0<$("."+this.settings.Css.SinglePlanContainer).not("[data-"+g.PlannerConstants.dataAttributes.PlanId+"=0]").length};e.prototype.togglePlanTitleToolTip=function(b,a){b=b.find("."+this.settings.Css.PlanTitleCell).find("div"+CCL.CommonFunctions.getDataSelector(g.PlannerConstants.dataAttributes.HybridEditorItem));0<b.length&&this.showNewPlanToolTip(b,a)};e.prototype.initNewPlanToolTip=function(){this.newPlanToolTip=new CCL.CustomTooltip("newPlanToolTip",{contentContainer:this.$newPlanToolTipContent,
zIndex:1},this.settings.Css.CustomTooltipCssClasses);this.$newPlanToolTipContent.show()};e.prototype.initFieldsToolTip=function(){this.toolTip=new CCL.CustomTooltip("fieldsToolTip",{contentContainer:this.$toolTipContent,zIndex:1},this.settings.Css.CustomTooltipCssClasses);this.tooltipPositionSettings={My:"center bottom",At:"center top-10",Arrow:"top"};this.$toolTipContent.show()};e.prototype.disableKeyboardNavigationIfWeekIsEmpty=function(){var b=$("."+this.settings.Css.SinglePlanEmptyOverlay);0<
b.length&&(this.$container.find("*").prop("tabindex","-1"),b.attr("tabindex","0"))};e.prototype.showNewPlanToolTip=function(b,a){var d=this,c,e,l=function(a){clearTimeout(e);clearTimeout(c);e=setTimeout(function(){d.newPlanToolTip.isTooltipOpened()&&(d.newPlanToolTip.closeTooltip(),b.off(g.PlannerConstants.events.HybridEditorItemInlineModeChanged),d.toggleFieldsToolTip(!0))},a)},m=function(a){clearTimeout(e);clearTimeout(c);c=setTimeout(function(){d.newPlanToolTip.openTooltip(b,{My:"center top",At:"center bottom+10",
Arrow:"bottom"});b.on(g.PlannerConstants.events.HybridEditorItemInlineModeChanged,function(a,b){b.isEditMode||l(300)})},a)};a?m(300):l(0)};e.prototype.toggleTooltipForField=function(b,a,d){var c=this;void 0===d&&(d="");if(!CCL.CommonFunctions.isMobileDevice())if(a)b.on("mouseover",function(a){return c.openTooltip(b,d,0)}).on("mouseleave",function(){return c.closeTooltip(0)});else this.closeTooltip(0),b.off("mouseover mouseleave")};e.prototype.toggleFieldsToolTip=function(b){var a=this;if(!CCL.CommonFunctions.isMobileDevice()){var d=
this.$container.find("."+this.settings.Css.PlanTitleCell);d.each(function(b){return a.toggleTooltipForField($(d[b]),!0,a.settings.Terms.PlanTitleCellTooltip)});var c=this.$container.find("."+this.settings.Css.PlanTopicCell);c.each(function(b){return a.toggleTooltipForField($(c[b]),!0,a.settings.Terms.PlanTopicCellTooltip)});var e=this.$container.find("."+this.settings.Css.PlanDateCell);e.each(function(b){return a.toggleTooltipForField($(e[b]),!0,a.settings.Terms.PlanDateCellTooltip)});var g=this.$container.find("."+
this.settings.Css.PlanEmptyThumbnailCell).closest("."+this.settings.Css.PlanThumbnailCell);g.each(function(b){return a.toggleTooltipForField($(g[b]),!0,a.settings.Terms.PlanThumbnailCellTooltip)})}};return e}();g.CbPlanner=k})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){var a=this;window[b.ClientInstanceName]=this;this.settings=b;this.folderSelector=window[b.FolderSelectorInstanceName];this.dialog=window[b.DialogInstanceName];this.grid=this.folderSelector.controls.grid;this.tree=this.folderSelector.controls.tree;this.tbody=$("#"+this.settings.LearningObjectiveTableClientId+" > tbody");this.checkBoxClientId=b.LearningObjectiveGridClientId+"_select_new";$(document).keyup(function(b){return a.keyup(b)});$(document).keydown(function(b){return a.keydown(b)});
this.dialog.setAfterOpenDialog(function(){a.dialog.setCloseConfirmation(function(){return!a.isEditorShown})})}c.prototype.showEditor=function(){var b=this,a=function(){b.isEditorShown||(b.initEditor(),b.tbody.prepend(b.editor),$("#"+b.checkBoxClientId).prop("checked",!0).prop("disabled",!0),b.toggleInsertButtons(!1));b.isEditorVisibleOnDisplay()||b.editor.animate({scrollTop:0},250);setTimeout(function(){b.editorInput.focus()},250)};this.folderSelector.selectedId===this.settings.NodeIdCreatedRoot?
a():this.folderSelector.navigateToNode(this.settings.NodeIdCreatedRoot,!1,!0,function(){return a()})};c.prototype.initEditor=function(){var b=this,a=$(this.settings.EditorTemplate),d=a.find("td").first(),c=this.grid.createCheckbox(this.checkBoxClientId);d.append(c);CCL.ModernCheckbox.BuildCheckbox(c,this.grid.cclGridConstants.terms.selectOneRow,!0,!0);this.editorInput=a.find("#"+this.settings.EditorClientId);this.editor=a;this.editorInput.on("blur",function(){return b.createLearningObjective()})};
c.prototype.createLearningObjective=function(){var b=this,a=this.editorInput.val().trim();if(""===a)this.removeEditor();else{this.editor.remove();var d=(new Date).getTime();this.renderGridRow({Id:d.toString(),Title:a});CCL.CommonFunctions.safeAjaxPost({data:{title:this.editorInput.val(),courseId:this.settings.CourseId},url:this.settings.CreateLearningObjectiveUrl}).done(function(a){var c=a.Items[0];b.addToCache(a);if(b.folderSelector.selectedId===b.settings.NodeIdCreatedRoot){if(a=b.tbody.find("#"+
d))a.data("id",c.Id),a.attr("data-id",c.Id);a.find("."+b.folderSelector.settings.cssClasses.itemCell+" > span").text(c.Title);b.grid._addRemoveSelectedValue(c.Id,!0);b.refreshTreeRow()}else b.folderSelector.controls.tree.refresh(b.settings.NodeIdCreatedRoot);b.toggleInsertButtons(!0)}).fail(function(){b.tbody.find("#"+d).remove();b.folderSelector.showErrorFeedback()})}};c.prototype.renderGridRow=function(b){var a=$("<tr id='"+b.Id+"' data-id=''></tr>").addClass(this.grid.cclGridConstants.cssClasses.selectedRow),
d=$("<td></td>").prop("class",this.grid.cclGridConstants.cssClasses.selectColumn),c=this.settings.LearningObjectiveGridClientId+"_select_"+b.Id,e=this.grid.createCheckbox(c);d.append(e);CCL.ModernCheckbox.BuildCheckbox(e,this.grid.cclGridConstants.terms.selectOneRow,!0,!0);a.append(d);d=$("<td></td>").addClass(this.folderSelector.settings.cssClasses.itemCell);b=$("<span class='LearningObjective'></span>").text(b.Title);d.append(b);a.append(d);this.tbody.prepend(a);this.grid.allowSelecting&&(this.initCheckBox(c,
!0),this.grid.addCheckBoxHandler(c))};c.prototype.refreshTreeRow=function(){this.folderSelector.controls.tree&&(this.folderSelector.selectedId=this.folderSelector.rootId,this.folderSelector.controls.tree.refresh(this.folderSelector.selectedId),this.folderSelector.navigateToNode(this.settings.NodeIdCreatedRoot,!1,!1),this.folderSelector.selectedId=this.settings.NodeIdCreatedRoot)};Object.defineProperty(c.prototype,"isEditorShown",{get:function(){return 1===this.tbody.find("#"+this.settings.EditorClientId).length},
enumerable:!0,configurable:!0});c.prototype.addToCache=function(b){var a=this.folderSelector.getCachedFolderData(this.settings.NodeIdCreatedRoot);if(null!=b.Folders)for(var d=a.folders,c=b.Folders.length,e=0;e<c;e++){var g=b.Folders[e];d.splice(0,0,{id:g.Id,title:g.Title,description:g.Description,cssClass:g.CssClass,isFolder:g.IsFolder,selectedByDefault:g.SelectedByDefault,setRootAsParent:g.SetRootAsParent})}d=a.items.pages[1];if(null!=b.Items)for(c=b.Items.length,e=0;e<c;e++)g=b.Items[e],d.splice(0,
0,{id:g.Id,title:g.Title,description:g.Description,cssClass:g.CssClass,isFolder:g.IsFolder,selectable:g.Selectable,selectedByDefault:!1});a.virtualItemCount++;this.folderSelector.cache[this.settings.NodeIdCreatedRoot]=a};c.prototype.isEditorVisibleOnDisplay=function(){var b=$(window).scrollTop(),a=b+$(window).height(),d=this.editorInput.offset().top;return d+this.editorInput.height()<=a&&d>=b};c.prototype.keyup=function(b){this.isEditorShown&&b.which===CCL.CommonConstants.keyCodes.escape&&(this.removeEditor(),
event.preventDefault())};c.prototype.keydown=function(b){this.isEditorShown&&b.which===CCL.CommonConstants.keyCodes.enter&&(this.createLearningObjective(),event.preventDefault())};c.prototype.toggleInsertButtons=function(b){this.folderSelector.toggleSelectButtons(b)};c.prototype.removeEditor=function(){this.editor.remove();this.toggleInsertButtons(this.grid.getSelectedIds()&&0!==this.grid.getSelectedIds().length)};c.prototype.initCheckBox=function(b,a){$("#"+b).prop("checked",a)};return c}();c.LearningObjectiveInlineEditor=
g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){window[c.clientInstanceName]=this;this.settings=b}c.getInstance=function(){return window[c.clientInstanceName]};c.prototype.updateLearningObjectiveDataSource=function(b){return this.updateLearningObjectivesDataSource([b])};c.prototype.updateLearningObjectivesDataSource=function(b){var a=this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.GetLearningObjectivesTooltipDataWebMethod,data:{learningObjectiveIds:b}}).done(function(b){$.each(b,
function(b,d){window[a.settings.TooltipDataSourceMethods.AddToDataSource](b,d.title,d.description,d.path)})}).fail(CCL.CommonFunctions.alertAjaxError)};c.clientInstanceName="PlannerLearningObjectiveToolTipManagerClientInstanceName";return c}();c.PlannerLearningObjectiveToolTipManager=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){window[b]=this;c.dataAttributes=a.DataAttributes;c.events=a.Events;c.postMessages=a.PostMessages}return c}();c.PlannerConstants=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){window[b]=this;e.instanceName=b;this._planner=c.Planner.getInstance()}e.getInstance=function(){return window[e.instanceName]};e.prototype.printTopics=function(){var b=this,a=c.Cards.TopicCard.getSelectedTopicIds(!0);null!=a&&(c.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),a.forEach(function(a){b.prepareTopicForPrint(a)}),window.print())};e.prototype.printPlans=function(b){(b=b.getTopicId())?(c.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),
this.prepareTopicForPrint(b)):this._planner.settings.UseTopics?(c.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),c.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint();window.print()};e.prototype.prepareAllPlansForPrint=function(){var b=this;c.Cards.TopicCard.getAllTopicCardContainers().each(function(a,d){d=c.Cards.TopicCard.getInstanceByContainer($(d)).getPlanGrid();a=d.getSelectedRows();d=d.getRows();0<
a.length?(d.addClass(b._planner.css.NoPrint),a.removeClass(b._planner.css.NoPrint)):d.removeClass(b._planner.css.NoPrint)})};e.prototype.prepareTopicForPrint=function(b){var a=c.Cards.TopicCard.getInstance(b);b=a.getTopicCardContainer();var d=a.getPlanGrid();a=d.getRows();d=d.getSelectedRows();b.removeClass(this._planner.css.NoPrint);0<d.length?(a.addClass(this._planner.css.NoPrint),d.removeClass(this._planner.css.NoPrint)):a.removeClass(this._planner.css.NoPrint)};e.prototype.printPlanner=function(b){null==
b?this._planner.settings.UseTopics?(c.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),c.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint():(c.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),this.prepareTopicForPrint(b));window.print()};return e}();c.PlannerPrint=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g;(function(b){b[b.NotLoaded=0]="NotLoaded";b[b.Loading=1]="Loading";b[b.Loaded=2]="Loaded"})(g||(g={}));var e=function(){return function(b,a,d){function c(a){var b=-a.width()/2;a=a.height();m.openDialogAt(b,a,!0);$(window.itslTop).trigger($.Event("QuickAddMenuShow"))}var e=g.NotLoaded,l=$("<div class='ccl-context-dialog-content-container'></div>").hide();b.parent().append(l);var m=new ContextDialog(l,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,valign:"bottom",
marginTop:12,marginBottom:0,marginLeft:0,marginRight:10,cssClass:d,toggleElement:b,noTitle:!0}),k=m.closeDialog;m.setCloseFunction(function(a){k(a);$(window.itslTop).trigger($.Event("QuickAddMenuHide"))});window.addEventListener("orientationchange",function(a){return m.closeDialog(a)});l.click(function(){return m.closeDialog()});b.click(function(b){m.isOpened()?m.closeDialog():e===g.Loaded?c($(b.currentTarget)):e===g.NotLoaded&&(e=g.Loading,$.get(a,function(a){a&&(l.append(a),c($(b.currentTarget)));
e=g.Loaded}).fail(function(){return e=g.NotLoaded}))})}}();c.QuickAddMenu=e})(c.Controls||(c.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(k){(function(e){var b=function(){function a(a,b){var d=this;this.settings=b;window[a]=this;this.courseId=b.CourseId;$(function(){$("body").on("keyup","."+d.settings.Css.ImageUploaderContainer,function(a){var b=$(a.target);a.which===CCL.CommonConstants.keyCodes.enter&&b.getIfHyperLinkEnabled()&&b.find("input").click();a.preventDefault()}).on("change","."+d.settings.Css.ImageUploaderContainer,function(a){return d.uploadImage(a)}).on("click","."+d.settings.Css.DeleteButton,
function(a){return d.deleteImage(a)})})}a.prototype.uploadImage=function(a){var b=this,d=$(a.target),e=d.closest("."+this.settings.Css.CellContainer);this.hideImageLoadingError(e);a=a.target;d=parseInt(d.closest("."+this.settings.Css.PlanContainer).data(g.PlannerConstants.dataAttributes.PlanId),10);var m=c.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a);if(a=m.formData)if(m.fileSizes[0]>this.settings.MaxImageSizeInBytes)this.showImageLoadingError(e,this.settings.Terms.MaximumFileSizeForUpload);
else{var k=this.showLoading(e);g.CbPlanner.getInstance()&&g.CbPlanner.getInstance().toggleTooltipForField(e,!1);d=this.settings.WebMethods.UploadImage.replace("{courseId}",this.settings.CourseId.toString()).replace("{planId}",d.toString());$.ajax({type:"POST",url:d,contentType:!1,processData:!1,dataType:"json",data:a}).done(function(a){a.success?e.replaceWith(a.content):(b.toggleAddImage(e,!0),b.showImageLoadingError(e,a.errorMessage))}).fail(function(){CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,
b.settings.Terms.ErrorMessage,b.settings.Terms.Ok,!1)}).always(function(){return b.hideLoading(e,k)})}};a.prototype.deleteImage=function(a){var b=this;a=$(a.target);var d=a.closest("."+this.settings.Css.CellContainer);a=parseInt(a.closest("."+this.settings.Css.PlanContainer).data(g.PlannerConstants.dataAttributes.PlanId),10);CCL.CommonFunctions.safeAjax({type:"DELETE",url:this.settings.WebMethods.DeletePlanThumbnail,data:{courseId:this.settings.CourseId,planId:a}}).done(function(a){var c=d.parent();
d.replaceWith(a.controlHtml);g.CbPlanner.getInstance()&&g.CbPlanner.getInstance().toggleTooltipForField(c.find("."+b.settings.Css.CellContainer),!0,b.settings.Terms.AddImageTooltip)})};a.prototype.showLoading=function(a){var b=a.css("position");a.css("position","relative").append($('<div class="'+this.settings.Css.AjaxLoader+'"></div>'));this.toggleAddImage(a,!1);return b};a.prototype.hideLoading=function(a,b){a.css("position",b);a.find("."+this.settings.Css.AjaxLoader).replaceWith("")};a.prototype.showImageLoadingError=
function(a,b){b=$('<div class="'+this.settings.Css.ImageErrorMessage+'">'+b+"</div>");a.append(b)};a.prototype.hideImageLoadingError=function(a){a.find("."+this.settings.Css.ImageErrorMessage).replaceWith("")};a.prototype.toggleAddImage=function(a,b){a.find("."+this.settings.Css.AddImage).toggle(b)};return a}();e.PlanThumbnailCell=b})(k.Plan||(k.Plan={}))})(g.Cells||(g.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){function e(b){var a=itslTop;return window!=a?$("#item"+b,a.document):null}c.deleteTopicFolderNode=function(b){b&&(b=e(b))&&b.remove()};c.updateTopicFolderNode=function(b,a){b&&(b=e(b))&&(a=document.createTextNode(a),b.children("a:first").contents().filter(function(){return 3===this.nodeType}).replaceWith(a))}})(c.PlannerUtility||(c.PlannerUtility={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.topicsAutocomplete=function(a,b){d.topicsAutocompleteRequest&&d.topicsAutocompleteRequest.abort&&d.topicsAutocompleteRequest.abort();d.topicsAutocompleteRequest=CCL.CommonFunctions.safeAjaxPost({url:d.settings.WebMethods.FindTopics,data:{courseId:d.courseId,searchText:a.term}}).done(function(a){a.length?b($.map(a,function(a){return{label:a.Name,value:a.TopicId,metadata:a}})):b([{label:"",value:""}])}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,
b,d)}).always(function(){d.topicsAutocompleteRequest=void 0})};this.onTopicSelect=function(a,b){d.selectedTopic=b.item.metadata;d.$textInput.val(d.selectedTopic.Name);d.$textInput[0].blur();return!1};window[b]=this;this.courseId=a.CourseId;this.$textInput=$("#"+a.InputClientId);this.settings=a;var e=this;this.$textInput.autocomplete({focus:function(a){a.preventDefault()},position:{collision:"none flip",of:this.$textInput},source:this.topicsAutocomplete,select:this.onTopicSelect,delay:this.settings.Autocomplete.Delay,
minLength:this.settings.Autocomplete.MinLength,create:function(){$(this).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append(b.metadata?String.format("<span>{0}</span>",CCL.CommonFunctions.htmlEncode(b.metadata.Name)):String.format("<span class='{0}'>{1}</span>",e.settings.Css.NoMatches,e.settings.Terms.NoMatches)).appendTo(a)};$(this).data("ui-autocomplete")._renderMenu=function(a,b){var d=this;$.each(b,function(b,c){d._renderItemData(a,c)});a.hasClass(e.settings.Css.AutocompleteMenu)||
a.addClass(e.settings.Css.AutocompleteMenu)}}});$(function(){a.CurrentTopic&&(d.currentTopic=a.CurrentTopic,d.$textInput.val(d.currentTopic.Name));d.$textInput.blur(function(){return d.onTopicChangeHandler()});d.$textInput.keydown(function(a){return d.keyDown(a)});d.cbPlanner=c.CbPlanner.getInstance()})}e.prototype.getPlanId=function(){var b=this.$textInput.closest("."+this.settings.Css.OnePlanContainer);return parseInt(b.data(c.PlannerConstants.dataAttributes.PlanId),10)};e.prototype.getCurrentTopicId=
function(){return this.currentTopic?this.currentTopic.TopicId:0};e.prototype.getSelectedTopicId=function(){return this.selectedTopic?this.selectedTopic.TopicId:0};e.prototype.checkIfNeedsToUpdateTopic=function(){var b=!0,a=this.$textInput.val().trim();this.currentTopic||this.selectedTopic||""!==a||(b=!1);if(this.getCurrentTopicId()===this.getSelectedTopicId()&&0<this.getCurrentTopicId()||this.currentTopic.Name===a)b=!1;return b};e.prototype.onTopicChangeHandler=function(){var b=this;if(this.checkIfNeedsToUpdateTopic()){var a=
this.getPlanId();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ConnectPlanToTopic,data:{courseId:this.courseId,topicId:this.getSelectedTopicId(),planId:a,topicName:this.$textInput.val()}}).done(function(d){if(d){var e=d.topicInfo;b.currentTopic&&b.currentTopic.TopicId===e.TopicId||b.$textInput.attr("data-"+b.settings.TopicIdDataAttribute,e.TopicId);b.currentTopic=e;b.selectedTopic=null;b.$textInput.val(b.currentTopic.Name);d.isCurrentTopicRenamed&&(b.updateTopicName(b.currentTopic.TopicId,
b.currentTopic.Name),c.PlannerUtility.updateTopicFolderNode(d.topicConnectedFolderId,e.Name));b.cbPlanner.updatePlansFolder(a,d.topicConnectedFolderId)}}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})}};e.prototype.keyDown=function(b){b.which===CCL.CommonConstants.keyCodes.enter&&(b.preventDefault(),this.$textInput[0].blur());b.which===CCL.CommonConstants.keyCodes.escape&&(b.preventDefault(),this.selectedTopic=null,this.currentTopic&&this.$textInput.val(this.currentTopic.Name))};
e.prototype.updateTopicName=function(b,a){b=$("."+this.settings.Css.PlansContainer).find("."+this.settings.Css.TopicNameInput+CCL.CommonFunctions.getDataSelector(this.settings.TopicIdDataAttribute,b));$.each(b,function(b,c){$(c).val(a)})};return e}();c.TopicSelector=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(c,b,a){var d=this;this.sortDirection="DESC";this.refreshGrid=function(a,b){CCL.CommonFunctions.safeAjaxPost({url:d.context.WebMethods.LearnerLetters,data:{PersonId:d.context.PersonId,PageIndex:a-1,PageSize:b,SortDirection:d.sortDirection,SortColumn:d.sortColumn}}).done(function(a){null!=a&&(d.letters(a),d.updateScrollBarYHandler())})};this.pagerEventHandler=function(a){a===d.context.Pager.Name&&(a=window[a],d.refreshGrid(a.pageNumber,a.pageSize))};
this.changeSortColumn=function(a){d.sortColumn===a?d.sortDirection="DESC"===d.sortDirection?"ASC":"DESC":d.sortColumn=a;a=window[d.context.Pager.Name];d.refreshGrid(a.pageNumber,a.pageSize)};this.getCourseTitle=function(a){return a?a:d.context.LanguageTerms.All};this.openLetterLink=function(a){window.open(a,"_blank")};this.openProfile=function(a,b){a===d.context.PersonId?$("li[data-tab='about']").find("a").trigger("click"):document.showProfileCard?document.showProfileCard(a):window.raw_popup(b,"",
"resizable,scrollbars,height=500,width=750")};this.updateScrollBarYHandler=function(){d.lettersTabPage.perfectScrollbar("update");return!0};this.context=c;this.letters=ko.observableArray(b);this.sortColumn=c.Sort.CreatedDateColumnSortName;this.lettersTabPage=a;$(document).off(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName);$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return d.pagerEventHandler(b)});
document.profileCardScope.isWindowLoading=!1;$(".c-modal__mask").on("click",document.profileCardScope.closeProfileCardWindow);a.perfectScrollbar({suppressScrollX:!0});this.updateScrollBarYHandler();$(window).on("resize",this.updateScrollBarYHandler);c=$(".c-profileCard[data-personid='"+c.PersonId+"']");ko.utils.domNodeDisposal.addDisposeCallback(c[0],function(){$(window).off("resize",this.updateScrollBarYHandler)})}}();c.ProfileLetters=g})(c.ProfileCard||(c.ProfileCard={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(c){(function(g){var k=function(c){function b(a){var b=this;c.call(this,a.CommonAjaxClientSettings);this.settings=a;this.toggleLightBulletinSubscriptionForPerson=function(a,d){return $.ajax({type:"PUT",url:b.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,subscribe:d},dataType:"json"})};this.getStreamList=function(a,d){return $.ajax({type:"GET",url:b.settings.Urls.GetStreamList,data:{boundaryNotificationActiveFromTicks:a,boundaryNotificationId:d}})}}__extends(b,c);
return b}(c.CommonAjaxClient);g.StreamAjaxClient=k})(c.Stream||(c.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=c.LightBulletin.LightBulletinUtility,e=function(){function b(a,b){var d=this;this.controls=a;this.settings=b;this.numberOfRepeatsOfCheckingLastItemForIos=12;this.intervalBeforeCheckForLoading=250;this.minVisiblePartOfLastItemToLoadMore=.5;this.afterAddingComment=function(a){a=a.userData.sourceId;var b=d.getBulletinById(a);d.lightBulletinSingleItemDataManager.subscribeToCommentsIfNeeded(b,a)};this.lightBulletinMenuClicked=function(a){var b=d.lightBulletinSingleItemDataManager.getLightBulletinActionDropDownItem(a),
e=d.getBulletinById(b.LightBulletinId);switch(b.ActionType){case c.LightBulletin.LightBulletinDropDownMenuActionType.ToggleSubscription:var f=d.lightBulletinSingleItemDataManager.getSingleItemData(e).SubscriptionStatus!==c.LightBulletin.PersonSubscriptionStatus.Subscribed;d.ajaxClient.toggleLightBulletinSubscriptionForPerson(b.LightBulletinId,f).done(function(b){return c.LightBulletin.GenericResponseHandler.handle(b,function(){return d.lightBulletinSingleItemDataManager.updateSubscriptionStatus(e,
a,f)})}).fail(d.ajaxClient.handleAjaxError);d.resetFocusOnCurrentItem(e);break;case c.LightBulletin.LightBulletinDropDownMenuActionType.ImmersiveReader:window.fetch("/restapi/personal/immersivereader/v1?ResourceType=Bulletin&ResourceId="+b.LightBulletinId).then(function(a){if(a.ok)a.json().then(function(a){window.ImmersiveReader.launchAsync(a.AccessToken,a.SubDomain,{title:a.Title,chunks:[{content:a.Text}]},{uiZIndex:1E6})});else throw Error(a.statusText);})}};this.resetLastItem=function(){d.lastItem.removeAttr("data-"+
d.settings.DataAttributes.BoundaryNotificationActiveFromTicks).removeAttr("data-"+d.settings.DataAttributes.BoundaryNotificationId);d.lastItem=$()};this.getCurrentLastItem=function(){return d.controls.ItemsContainer.find("[data-"+d.settings.DataAttributes.BoundaryNotificationActiveFromTicks+"]")};this.isAllItemsLoaded=function(){return 0===d.lastItem.length};this.lightBulletinContentNodeSelector="[data-"+this.settings.DataAttributes.LightBulletinId+"]";g.StreamContentBlockInstance=this;this.lastItem=
this.getCurrentLastItem();this.isFirstCallLazy=!0;this.oembedError=new c.LightBulletin.EmbedError(this.settings.OembedErrorCssClasses,this.settings.OembedErrorResources);this.linkifyTextNodes(this.controls.ItemsContainer);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.lightBulletinShowMoreLinkRenderer=new c.LightBulletin.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,this.textExpander);
this.lightBulletinEmbedAsynchronousLoader=new c.LightBulletin.EmbedAsynchronousLoader({isIosDevice:this.isIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+this.settings.CssClasses.OembedBox,bulletinItem:this.lightBulletinContentNodeSelector},dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.lightBulletinSingleItemDataManager=
new c.LightBulletin.LightBulletinSingleItemDataManager(this.settings.LightBulletinSingleDataDataAttributes,this.settings.LightBulletinSingleItemDataResources);this.ajaxClient=new g.StreamAjaxClient(this.settings);this.listenToEmbedPostmessages();this.isAllItemsLoaded()||(this.isMobile()||this.loadIfReachedLastItem(!1,0),$(window).on(this.isIosDevice?"touchmove":"scroll",function(){d.isMobile()||d.loadIfReachedLastItem(!1,d.isIosDevice?d.numberOfRepeatsOfCheckingLastItemForIos:0)}),this.controls.ShowMoreLink.click(function(a){d.controls.ShowMoreLink.hide();
d.loadIfReachedLastItem(!0,0);a.preventDefault()}));c.LightBulletin.EmbedResizer.listenToEmbedSizePostmessages(this.controls.ItemsContainer,this.settings.CssClasses.OembedContent,this.lightBulletinShowMoreLinkRenderer,this.lightBulletinEmbedAsynchronousLoader);this.renderShowMoreInLightBulletins(this.controls.ItemsContainer.find(this.lightBulletinContentNodeSelector));this.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(this.controls.ItemsContainer);this.lightBulletinEmbedAsynchronousLoader.loadEmbedContentAsync();
this.lightBulletinSingleItemDataManager.registerDropDownMenuClickHandler(this.isIosDevice,this.lightBulletinMenuClicked)}b.prototype.resetFocusOnCurrentItem=function(a){$(a).parent().find(".itsl-cb-stream-item-header > a").first().focus()};b.prototype.loadIfReachedLastItem=function(a,b){var d=this;if(this.isAllItemsLoaded()||!a&&!CCL.CommonFunctions.isOnScreen(this.lastItem,this.minVisiblePartOfLastItemToLoadMore,this.minVisiblePartOfLastItemToLoadMore,this.isIosDevice?window.parent:window))0<b&&
setTimeout(function(){d.loadIfReachedLastItem(a,b-1)},this.intervalBeforeCheckForLoading);else{var c=this.lastItem.attr("data-"+this.settings.DataAttributes.BoundaryNotificationActiveFromTicks),e=this.lastItem.attr("data-"+this.settings.DataAttributes.BoundaryNotificationId);this.resetLastItem();this.ajaxClient.getStreamList(c,e).done(function(a){a&&(a=$(a),d.controls.ItemsContainer.append(a),d.linkifyTextNodes(a),d.renderShowMoreInLightBulletins(d.controls.ItemsContainer.find(d.lightBulletinContentNodeSelector)),
d.isFirstCallLazy&&($.ajax(d.settings.Urls.MeasureLazyLoading),d.isFirstCallLazy=!1),d.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(a));d.lastItem=d.getCurrentLastItem();d.isAllItemsLoaded()||d.controls.ShowMoreLink.show()}).fail(CCL.CommonFunctions.alertAjaxError)}};b.prototype.renderShowMoreInLightBulletins=function(a){var b=this;a.each(function(a,d){a=$(d);k.setTabindexToHiddenElements(a,b.lightBulletinShowMoreLinkRenderer.findClickablePlaceholder(a),"."+b.settings.CssClasses.ElementLink)});
this.lightBulletinShowMoreLinkRenderer.renderShowMoreWithImagesHack(a,"[data-"+this.settings.DataAttributes.AttachedImage+"]",this.lightBulletinContentNodeSelector,function(a,d){k.setTabindexToHiddenElements(a,d,"."+b.settings.CssClasses.ElementLink)})};b.prototype.linkifyTextNodes=function(a){c.LightBulletin.LightBulletinLinkifyWrapper.linkifyNodes(a.find("[data-"+this.settings.DataAttributes.LightBulletinContent+"]"))};b.prototype.isMobile=function(){return CCL.CommonFunctions.checkScreenSize(CCL.CommonConstants.mediaScreenSizes.mobile,
!1)};b.prototype.getBulletinById=function(a){return this.controls.ItemsContainer.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LightBulletinId,a))};b.prototype.listenToEmbedPostmessages=function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var d=a.controls.ItemsContainer.find("#"+b.oembedPlaceHolderId);a.lightBulletinEmbedAsynchronousLoader.removeAjaxLoader(d);a.controls.ItemsContainer.removeClass(a.settings.CssClasses.AjaxLoader);
b.isPlainLink&&!a.oembedError.hasOembedError(d)&&(d.append(a.oembedError.generateOembedError({originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:d},a.lightBulletinEmbedAsynchronousLoader)),a.lightBulletinShowMoreLinkRenderer.renderShowMoreLink(d.closest(a.lightBulletinContentNodeSelector),!1))})};return b}();g.StreamContentBlock=e})(c.Stream||(c.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this._templates={};window[b]=this;c.instanceName=b;this._settings=a;this.css=a.Css;this.webMethods=a.WebMethods;b=$("#"+this._settings.Controls.PlanTemplateId).html();var e=$("#"+this._settings.Controls.TopicTemplateId).html();this._templates[this._settings.Controls.PlanTemplateId]=Handlebars.compile(b);this._templates[this._settings.Controls.TopicTemplateId]=Handlebars.compile(e);this._container=$("."+a.Css.Container);setTimeout(function(){d.initTimeline()},
100);this._planContextDialog=new ContextDialog("#"+this._settings.Controls.PlanContextDialogId,{valign:"bottom",width:500,zIndex:2,closeButtonTooltip:a.Terms.Close})}c.getInstance=function(){return window[c.instanceName]};c.prototype.getContainer=function(){return this._container};c.prototype.isEmpty=function(){return this._settings.UseTopics?0===this._topics.length:0===this._plans.length};c.prototype.refresh=function(){return this._settings.UseTopics?this.loadTopics():this.loadTopicPlans()};c.prototype.toggleTimeline=
function(b,a){var d=this;this.getContainer().hide();b?($("#"+this._settings.Controls.LoadingLabelId).show(),this.refresh().done(function(){return d.showEmptyMessageIfNecessary()})):a&&this.toggleEmptyMessage(!1);$("#"+this._settings.Controls.LoadingLabelId).hide()};c.prototype.showEmptyMessageIfNecessary=function(){this.toggleEmptyMessage(this.isPlannerTimelineEmpty());this.getContainer().toggle(!this.isPlannerTimelineEmpty())};c.prototype.toggleEmptyMessage=function(b){var a=this._container.parent().find("."+
this._settings.Css.NoTopicsMessage);a&&a.toggle(b)};c.prototype.isPlannerTimelineEmpty=function(){return this._settings.UseTopics&&0===this._topics.length||!this._settings.UseTopics&&0===this._plans.length};c.prototype.initTimeline=function(){var b=this;this._timeline=new vis.Timeline(this._container[0],null,{margin:{item:{vertical:25,horizontal:5E3}},selectable:!1,locale:this._settings.Language,order:function(a,d){return b.orderTimelineItems(a,d)},template:function(a){return(0,b._templates[a.template])(a)},
zoomMin:432E6,zoomMax:321408E5,maxHeight:500});this._timeline.on("click",function(a){b._planContextDialog.isOpened()&&b._planContextDialog.closeDialog();b.expandCollapseTimelineItem(a)});$(document).trigger(this._settings.Events.TimelineControlInitialized)};c.prototype.expandCollapseTimelineItem=function(b){if(null!=b.item&&!$(b.event.target).hasClass(this.css.ItemTitle)){var a=b.item.split("#");if(1===a.length){var d=this.getTopicItem(b.item);a=this._timeline.itemSet.itemFromTarget(b.event).dom.box;
$(a).toggleClass(this.css.TopicArrowCollapsed,null!=d.Plans);$(a).toggleClass(this.css.TopicArrowExpanded,null==d.Plans);$(a).attr("title",this._settings.Terms.HidePlans);null!=d.Plans?(this.removeItemsFromTopicTimeline(d),$(a).attr("title",this._settings.Terms.ShowPlans)):this.loadTopicPlans(b.item)}else d=a[1],(a=this.getPlanItem(b.item,a[0]))&&this.openDialogAndLoadPlanContents(d,a.Content,b)}};c.prototype.openDialogAndLoadPlanContents=function(b,a,d){var c=this;this._planContextDialog.setTitle(a);
this._planContextDialog.openDialog(d.event.srcEvent);this._planContextDialog.setContent(this._settings.Terms.Loading);CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetSinglePlanForPlannerXhtml,data:{planId:b,courseId:this._settings.CourseId,childId:this._settings.ChildId,dashboardHierarchyId:this._settings.DashboardHierarchyId}}).done(function(a){c._planContextDialog.setContent(a.contentHtml);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(c._planContextDialog.mainContainer)})};
c.prototype.refreshTimeline=function(){var b=this,a=[],d=[];this._settings.UseTopics?$.each(this._topics,function(c,e){a.push(b.getTimelineItem(e,!1,e.Id,e.ColorSchemaClass));d.push({id:e.Id,content:"",order:e.Order});null!=e.Plans&&$.each(e.Plans,function(d,c){a.push(b.getTimelineItem(c,!0,e.Id,c.Active?e.ColorSchemaClass:b._settings.Css.InactivePlan))})}):$.each(this._plans,function(c,e){a.push(b.getTimelineItem(e,!0,e.Id,e.Active?b._settings.Css.DefaultColorSchemaClass:b._settings.Css.InactivePlan));
d.push({id:e.Id,content:"",order:e.Order})});0<a.length&&this._timeline.setData({groups:d,items:a})};c.prototype.setViewOptions=function(b,a,d,c){this._timeline.setOptions({start:b,end:a,min:d,max:c})};c.prototype.addItemsToTopicTimeline=function(b){var a=this;$.each(b.Plans,function(d,c){a._timeline.itemsData.add(a.getTimelineItem(c,!0,b.Id,c.Active?b.ColorSchemaClass:a._settings.Css.InactivePlan))})};c.prototype.removeItemsFromTopicTimeline=function(b){if(null!=b.Plans){var a=[];$.each(b.Plans,
function(b,c){a.push(c.Id)});this._timeline.itemsData.remove(a);b.Plans=null}};c.prototype.loadTopics=function(){var b=this;return CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetTopicsForPlannerTimeline,data:{courseId:this._settings.CourseId,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId,topicId:this._settings.FilteredTopicId,termId:this._settings.FilteredTermId}}).done(function(a){a&&a.topics&&(b.setViewOptions(a.initialStart,
a.initialEnd,a.minStart,a.maxEnd),b._topics=a.topics,b.refreshTimeline())}).fail(function(){return CCL.CommonFunctions.alertAjaxError})};c.prototype.loadTopicPlans=function(b){var a=this;void 0===b&&(b="");return CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetPlansForPlannerTimeline,data:{courseId:this._settings.CourseId,topicIdString:b,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId}}).done(function(d){if(d&&d.plans)if(a._settings.UseTopics){var c=
a.getTopicItem(b);c.Plans=d.plans;a.addItemsToTopicTimeline(c);d.topicStartDate&&d.topicStopDate&&(c.Start=d.topicStartDate,c.End=d.topicStopDate,a._timeline.itemsData.update(a.getTimelineItem(c,!1,c.Id,c.ColorSchemaClass)))}else a.setViewOptions(d.initialStart,d.initialEnd,d.minStart,d.maxEnd),a._plans=d.plans,a.refreshTimeline()}).fail(function(){return CCL.CommonFunctions.alertAjaxError})};c.prototype.getTopicItem=function(b){return this.getItem(this._topics,b)};c.prototype.getPlanItem=function(b,
a){void 0===a&&(a=null);a=null!=a&&this._settings.UseTopics?this.getTopicItem(a).Plans:this._plans;return this.getItem(a,b)};c.prototype.getItem=function(b,a){var d=null;$.each(b,function(b,c){return c.Id===a?(d=c,!1):!0});return d};c.prototype.getTimelineItem=function(b,a,d,c){var e=this.isTopicExpanded(b,a)?this._settings.Css.TopicArrowExpanded:this._settings.Css.TopicArrowCollapsed;return{id:b.Id,content:b.Content,start:b.Start,end:b.End,className:a?c+" "+this._settings.Css.Plan:c+" "+e,group:d,
subgroup:a?b.Order:0,template:a?this._settings.Controls.PlanTemplateId:this._settings.Controls.TopicTemplateId,custom:a?b.ElementsCount:null,active:b.Active,title:a?this._settings.Terms.OpenPlanDetails:this.isTopicExpanded(b,a)?this._settings.Terms.HidePlans:this._settings.Terms.ShowPlans}};c.prototype.isTopicExpanded=function(b,a){return!a&&null!=b.Plans};c.prototype.orderTimelineItems=function(b,a){return a.subgroup-b.subgroup};c.prototype.parseDateFromString=function(b){return null!=b?$.datepicker.parseDate(this._settings.DateTimeFormat,
b):null};return c}();c.PlannerTimeline=g})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){this.dataAttributes=b;this.resources=a}e.prototype.getLightBulletinActionDropDownItem=function(b){return b.data(this.dataAttributes.LightBulletinActionDropDownItem)};e.prototype.getSingleItemData=function(b){return b.data(this.dataAttributes.LightBulletinSingleItemData)};e.prototype.updateSingleItemData=function(b,a){b.data(this.dataAttributes.LightBulletinSingleItemData,a)};e.prototype.refreshSingleItemData=function(b,a){var d=this.getSingleItemData(b);
a(d);this.updateSingleItemData(b,d);return d};e.prototype.getToggleSubscriptionLink=function(b){return $(CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItemToggleSubscriptionLink,b))};e.prototype.updateSubscriptionStatus=function(b,a,d){this.refreshSingleItemData(b,function(a){return a.SubscriptionStatus=d?c.PersonSubscriptionStatus.Subscribed:c.PersonSubscriptionStatus.UnsubscribedManually});a.text(d?this.resources.TurnOffNotifications:this.resources.TurnOnNotifications)};
e.prototype.registerDropDownMenuClickHandler=function(b,a){$(document).on(b?"touchstart":"click",CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItem),function(b){b.preventDefault();a($(b.currentTarget))})};e.prototype.subscribeToCommentsIfNeeded=function(b,a){this.getSingleItemData(b).SubscriptionStatus===c.PersonSubscriptionStatus.WasNotSubscribed&&this.updateSubscriptionStatus(b,this.getToggleSubscriptionLink(a),!0)};return e}();c.LightBulletinSingleItemDataManager=
g})(c.LightBulletin||(c.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(b,a,d,c){var e=this;this.$itemSelector=b;this.idDataAttribute=a;this.selectAllItemId=d;this.languageTerms=c;this.hasItems=function(){return 0<e.getAllItems().length};this.getItemId=function(a){a=e.getItemIdByDataAttribute(e.getItem(a));return e.areAllItemsSelected(a)?null:a};this.setDefaultItemText=function(a){a=e.getItem(a);var b=e.getItemIdByDataAttribute(a);a=e.areAllItemsSelected(b)?e.languageTerms.All+" "+e.languageTerms.Items.toLowerCase():
a.text();e.$itemSelector.text(a)};this.getAllItems=function(){return e.$itemSelector.parent().find("[data-"+e.idDataAttribute+"]")};this.isItem=function(a){return null!=a.closest("[data-"+e.idDataAttribute+"]")};this.getItem=function(a){return a.closest("[data-"+e.idDataAttribute+"]")};this.getItemIdByDataAttribute=function(a){return a.data(e.idDataAttribute)};this.areAllItemsSelected=function(a){return a===e.selectAllItemId}}}(),e=function(){function b(a,d,c){var e=this;this.settings=d;this.controls=
c;this.initPerfectScrollbar=function(){e.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});$(window).on("resize",e.updateScrollBarYHandler)};this.updateScrollBarYHandler=function(){e.controls.MenuContainer.perfectScrollbar("update")};this.onItemClickHandler=function(a){var d=e.itemSelectorManagerManager.getItemId($(a.target));void 0!==d&&(e.selectedItemId=d,e.itemSelectorManagerManager.setDefaultItemText($(a.target)),e.controls.ItemSelector.trigger(b.itemSelectorOnChangeEventName,e))};
window[a]=this;this.itemSelectorManagerManager=new g(this.controls.ItemSelector,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.LanguageTerms);this.initPerfectScrollbar();this.controls.ItemSelector.parent().on("focusin",function(){e.controls.ItemSelector.addClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.parent().on("focusout",function(){e.controls.ItemSelector.removeClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.on("keyup",
function(a){a.which===CCL.CommonConstants.keyCodes.enter&&e.controls.ItemSelector.trigger("click")});this.controls.MenuContainer.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);this.itemSelectorManagerManager.getAllItems().on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&(e.onItemClickHandler(a),e.controls.MenuContainer.trigger("click"))})}Object.defineProperty(b.prototype,"hasItems",{get:function(){return this.itemSelectorManagerManager.hasItems()},
enumerable:!0,configurable:!0});b.itemSelectorOnChangeEventName="itemSelector:onchange";return b}();c.ItemSelector=e})(c.ItemSelector||(c.ItemSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b){this.settings=b;this.modalDialog=window[this.settings.ContainerId]}c.prototype.openDialog=function(b,a){this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,a,!1);this.modalDialog.setTitle(b.header);$("#"+this.settings.HeaderId).text(b.assessmentName);this.modalDialog.openDialog(!1)};return c}();c.TermAssessmentDialogManager=g})(c.Supervisor||(c.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function a(b,c){var d=this;this.serviceUrls=b;this.model=c;this.getAssessments=function(){var a={supervisorType:d.model.supervisorType,courseId:d.model.courseId,termId:d.model.termId(),categoryIds:d.model.categoryIds()};a=CCL.CommonFunctions.safeAjaxPost({url:d.serviceUrls.Assessments,data:a,dataType:"json"});a.done(function(a){d.model.addAssessments(a)});return a};this.getAssessmentPersonResults=function(){var b={supervisorType:d.model.supervisorType,courseId:d.model.courseId,
assessmentIds:d.model.assessments().map(function(a){return a.id}),paging:{pageIndex:d.model.assessmentPersonResultsCurrentPage,pageSize:a.pageSize},sortDescending:d.model.sortDescending};b=CCL.CommonFunctions.safeAjaxPost({url:d.serviceUrls.AssessmentPersonResults,data:b,dataType:"json"});b.done(function(a){d.model.addAssessmentPersonResults(a)});return b}}a.pageSize=50;return a}(),e=function(){function a(a){var b=this;this.settings=a;this.isScrollingInProgress=!1;this.assessmentPersonResultsCurrentPage=
0;this.sortDescending=!1;this.initialise=function(){b.areAssessmentsBeingLoaded(!0);b.dataFetcher.getAssessments()};this.addAssessments=function(a){a&&(a=a.map(function(a){return{id:a.Id,title:a.Title}}),[].push.apply(b.assessments(),a),b.assessments.valueHasMutated());b.areAssessmentsBeingLoaded(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.addAssessmentPersonResults=function(a){if(a){var d=a.map(function(a){return{personId:a.PersonId,fullName:a.FullName,pictureUrl:a.PictureUrl,
fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,score:a.Score?a.Score:"-",hasComment:a.HasComment}})}});[].push.apply(b.assessmentPersonResults(),d);b.assessmentPersonResults.valueHasMutated()}0===b.assessmentPersonResultsCurrentPage?b.areAssessmentsPersonResultsBeingLoaded(!1):b.isAssessmentsPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.pageSize)&&
b.areAllAssessmentPersonResultsRetreived(!0);b.assessmentPersonResultsCurrentPage++;b.$assessmentColumnsContainer.perfectScrollbar("update")};this.openProfileCard=function(a){document.showProfileCard?document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.isScrolledToTheBottom(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.fetchAssessmentsData=
function(){b.cancelDataFetching();b.areAssessmentsBeingLoaded(!0);b.assessments([]);b.clearAssessmentPersonResultsData();b.fetchAssessmentsCallbackDebouncer.invokeCallback({},200)};this.clearAssessmentPersonResultsData=function(){b.areAssessmentsPersonResultsBeingLoaded(!0);b.assessmentPersonResults([]);b.isAssessmentsPersonResultsPageBeingLoaded(!1);b.areAllAssessmentPersonResultsRetreived(!1);b.assessmentPersonResultsCurrentPage=0;b.isScrolledToTheBottom(!1);b.resultsScrollLeft=0;b.resultsScrollTop=
0};this.fetchAssessmentPersonResultsData=function(a){void 0===a&&(a=null);b.cancelDataFetching();b.clearAssessmentPersonResultsData();b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(a,200)};this.fetchAssessmentPersonResultsPage=function(){b.isAssessmentsPersonResultsPageBeingLoaded(!0);b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(null,200)};this.cancelDataFetching=function(){null!=b.fetchAssessmentPersonResultsPromise&&b.fetchAssessmentPersonResultsPromise.readyState!==
b.fetchAssessmentPersonResultsPromise.DONE&&b.fetchAssessmentPersonResultsPromise.abort();null!=b.fetchAssessmentsPromise&&b.fetchAssessmentsPromise.readyState!==b.fetchAssessmentsPromise.DONE&&b.fetchAssessmentsPromise.abort()};this.onAssessmentResultsScrollHandler=function(){if(!b.isScrollingInProgress){b.isScrollingInProgress=!0;var a=b.$assessmentColumnsContainer.scrollLeft();a!==b.resultsScrollLeft&&(b.resultsScrollLeft=a,$("."+b.settings.CssClasses.AssessmentHeaders).scrollLeft(b.resultsScrollLeft));
a=b.$assessmentColumnsContainer.scrollTop();a!==b.resultsScrollTop&&(b.fetchAssessmentPersonResultsPageOnScrollHandler(a),b.resultsScrollTop=a,$("."+b.settings.CssClasses.StudentsColumn).scrollTop(b.resultsScrollTop),Math.ceil(b.$assessmentColumnsContainer[0].scrollHeight-b.$assessmentColumnsContainer[0].scrollTop)===b.$assessmentColumnsContainer[0].clientHeight&&b.isScrolledToTheBottom(!0));b.isScrollingInProgress=!1}};this.resetAssessmentRecordScroll=function(){b.$assessmentColumnsContainer.scrollTop(0);
b.$studentsColumn.scrollTop(0)};this.fetchAssessmentPersonResultsPageOnScrollHandler=function(a){!b.areAssessmentsPersonResultsBeingLoaded()&&!b.areAllAssessmentPersonResultsRetreived()&&a>b.resultsScrollTop&&(a=$("."+b.settings.CssClasses.AssessmentColumnsContainer+" > ."+b.settings.CssClasses.AssessmentColumn).first().children(),a=a.eq(a.length-k.pageSize/2),CCL.CommonFunctions.isOnScreen(a,.5,.5)&&b.fetchAssessmentPersonResultsPage())};this.initialiseTermFilter=function(){b.$termFilter.on(c.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,
b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,d){b.termId(d.selectedItemId);b.fetchAssessmentsData()};this.initialiseCategoryFilter=function(){b.$categoryFilter.on(c.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onCategoryFilterItemClickHandler)};this.onCategoryFilterItemClickHandler=function(a,d){b.categoryIds(d.selectedItemIds);b.fetchAssessmentsData()};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchAssessmentsCallbackDebouncer=
new CCL.CallbackDebouncer(function(){b.fetchAssessmentsPromise=b.dataFetcher.getAssessments()});this.fetchAssessmentPersonResultsCallbackDebouncer=new CCL.CallbackDebouncer(function(a){b.fetchAssessmentPersonResultsPromise=b.dataFetcher.getAssessmentPersonResults();a&&b.fetchAssessmentPersonResultsPromise.done(function(){return a()})});this.termId=ko.observable(null);this.categoryIds=ko.observableArray([]);this.areAssessmentsBeingLoaded=ko.observable(!0);this.assessments=ko.observableArray([]);this.areAssessmentsPersonResultsBeingLoaded=
ko.observable(!0);this.isAssessmentsPersonResultsPageBeingLoaded=ko.observable(!1);this.areAllAssessmentPersonResultsRetreived=ko.observable(!1);this.assessmentPersonResults=ko.observableArray([]);this.persons=ko.computed(function(){return b.assessmentPersonResults().map(function(a){return a})});this.resultsScrollLeft=this.$assessmentColumnsContainer.scrollLeft();this.resultsScrollTop=this.$assessmentColumnsContainer.scrollTop();this.initialiseTermFilter();this.initialiseCategoryFilter();this.isScrolledToTheBottom=
ko.observable(!1)}Object.defineProperty(a.prototype,"$assessmentColumnsContainer",{get:function(){return $("."+this.settings.CssClasses.AssessmentColumnsContainer)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$studentsColumn",{get:function(){return $("."+this.settings.CssClasses.StudentsColumn)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$categoryFilter",{get:function(){return $("#"+this.settings.ClientIds.CategoryFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"courseId",{get:function(){return this.settings.CourseId},enumerable:!0,configurable:!0});return a}();g.AssessmentRecordViewModel=e;var b=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=
function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};var d=new c.KnockoutCustomBindingsManager;d.registerSafeImgBinding();d.registerPerfectScrollBarBinding();this.model=new e(a);ko.applyBindings(this.model,this.$container[0]);this.model.initialise();this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,
"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();g.AssessmentRecord=b})(c.Supervisor||(c.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function a(b,c){var d=this;this.serviceUrls=b;this.model=c;this.getDataForOrganisation=function(){var a={supervisorType:d.model.supervisorType,organisationId:d.model.organisationId()};a=CCL.CommonFunctions.safeAjaxPost({url:d.serviceUrls.Filters,data:a,dataType:"html"});a.done(function(a){d.model.updateOrganisation(a)});return a};this.getCourses=function(){var b={supervisorType:d.model.supervisorType,organisationId:d.model.organisationId(),termId:d.model.termId(),
paging:{pageIndex:d.model.coursesCurrentPage,pageSize:a.coursesPageSize}};b=CCL.CommonFunctions.safeAjaxPost({url:d.serviceUrls.Courses,data:b,dataType:"json"});b.done(function(a){d.model.addCourses(a);d.model.areCoursesBeingLoaded(!1)});return b};this.getTermAssessments=function(){if(!d.model.currentCourse())return null;var a={supervisorType:d.model.supervisorType,organisationId:d.model.organisationId(),termId:d.model.termId(),courseId:d.model.currentCourse().id,hierarchyIds:d.model.hierarchyIds()};
a=CCL.CommonFunctions.safeAjaxPost({url:d.serviceUrls.TermAssessments,data:a,dataType:"json"});a.done(function(a){a&&d.model.addTermAssessments(a);d.model.areCourseTermAssessmentsBeingLoaded(!1)});return a};this.getTermAssessmentPersonResults=function(){if(!d.model.currentCourse())return null;var b={supervisorType:d.model.supervisorType,organisationId:d.model.organisationId(),termId:d.model.termId(),courseId:d.model.currentCourse().id,hierarchyIds:d.model.hierarchyIds(),finalAssessmentIds:d.model.termAssessments().map(function(a){return a.id}),
paging:{pageIndex:d.model.termAssessmentPersonResultsCurrentPage,pageSize:a.termAssessmentPersonResultsPageSize},sortDescending:d.model.sortDescending};b=CCL.CommonFunctions.safeAjaxPost({url:d.serviceUrls.TermAssessmentPersonResults,data:b,dataType:"json"});b.done(function(a){d.model.addTermAssessmentPersonResults(a);d.model.areCourseTermAssessmentsResultsBeingLoaded(!1)});return b}}a.coursesPageSize=10;a.termAssessmentPersonResultsPageSize=50;return a}(),e=function(){function a(a){var b=this;this.settings=
a;this.isResultsHorisontalScrollInProgress=!1;this.termAssessmentPersonResultsCurrentPage=this.coursesCurrentPage=0;this.sortDescending=!1;this.updateOrganisation=function(a){$("."+b.settings.CssClasses.FiltersContainer).replaceWith($(a));b.initialiseFilters();b.fetchCoursesData()};this.addCourses=function(a){var d=0===b.coursesCurrentPage,c=a.map(function(a,c){return{id:a.Id,title:a.Title,isSelected:d?0===c:!1,assessmentRecordTooltip:b.getAssessmentRecordTooltip(a.Title)}});[].push.apply(b.courses(),
c);b.courses.valueHasMutated();b.coursesCount(b.courses().length);d?(b.areCoursesBeingLoaded(!1),b.enableHierarchyFilter(),0<b.coursesCount()&&b.selectCourse(b.courses()[0])):b.isCoursesPageBeingLoaded(!1);(0===a.length||a.length<k.coursesPageSize)&&b.areAllCoursesRetreived(!0);b.coursesCurrentPage++};this.selectCourse=function(a){b.currentCourse(a);b.fetchTermAssessmentsData();$(window).scrollTop(0)};this.openAssessmentRecord=function(a){window.location.href=b.settings.ServiceUrls.AssessmentRecord+
"?courseId="+a.id+"&supervisorType="+b.settings.SupervisorType};this.selectStudent=function(a){b.currentStudent(a)};this.clearStudent=function(){b.currentStudent(null)};this.addTermAssessments=function(a){a=a.map(function(a){return{id:a.Id,title:a.Title}});[].push.apply(b.termAssessments(),a);b.termAssessments.valueHasMutated();b.termAssessmentsCount(b.termAssessments().length);b.fetchTermAssessmentPersonResultsData()};this.addTermAssessmentPersonResults=function(a){if(a){var d=a.map(function(a){return{personId:a.PersonId,
fullName:a.FullName,pictureUrl:a.PictureUrl,fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,score:a.Score,hasComment:a.HasComment}})}});[].push.apply(b.termAssessmentPersonResults(),d);b.termAssessmentPersonResults.valueHasMutated();b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length)}0===b.termAssessmentPersonResultsCurrentPage?b.areCourseTermAssessmentsResultsBeingLoaded(!1):
b.isTermAssessmentPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.termAssessmentPersonResultsPageSize)&&b.areAllTermAssessmentPersonResultsRetreived(!0);b.termAssessmentPersonResultsCurrentPage++};this.openProfileCard=function(a){document.showProfileCard?document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.fetchTermAssessmentPersonResultsData();$(window).scrollTop(0)};
this.showMoreCourses=function(){b.fetchCoursesPage()};this.showMoreResults=function(){b.fetchTermAssessmentPersonResultsPage()};this.scrollResultsContainer=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsFixedHeadersWrapper),$("."+b.settings.CssClasses.ResultsContainer))};this.scrollResultsFixedHeader=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsContainer),$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper))};this.ajustResultsFixedHeaderPosition=function(){b.onResultsFixedHeaderPositionChangeHandler()};
this.scrollHorisontaly=function(a,d){b.isResultsHorisontalScrollInProgress||(b.isResultsHorisontalScrollInProgress=!0,d.scrollLeft(a.scrollLeft()),b.isResultsHorisontalScrollInProgress=!1)};this.isScrolledIntoView=function(a){return a.offset().top>=$(window).scrollTop()};this.onResultsFixedHeaderPositionChangeHandler=function(){var a=$("."+b.settings.CssClasses.StudentHeader);if(0<a.length){var d=CCL.CommonFunctions.isElementFullyShownInWindow(a),c=$("."+b.settings.CssClasses.ResultsContainer),e=
CCL.CommonFunctions.isElementFullyShownInWindow(c),f=$("."+b.settings.CssClasses.StudentFixedHeader),g=$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper);if(d&&e)f.css({display:"none"}),g.css({display:"none"});else{d=d||b.isScrolledIntoView(c)?a.offset().top-$(window).scrollTop():0;f.css({display:"block",position:"fixed",top:d,height:a.outerHeight(!0),width:a.outerWidth(!0)});g.css({display:"block",position:"fixed",top:d,left:a.offset().left+a.outerWidth(!0),height:a.outerHeight(!0),width:c.outerWidth(!0)});
g.perfectScrollbar("update");$("."+b.settings.CssClasses.ResultsFixedHeadersContainer).css({display:"flex",width:c[0].scrollWidth});a=$("."+b.settings.CssClasses.ResultsFixedHeader);var k=$("."+b.settings.CssClasses.ResultsHeader);a.each(function(a,b){$(b).css({width:k.eq(a).outerWidth(!0)})})}}};this.openAssessmentDialog=function(a,d){var c=g.termAssessmentDialogManagerInstance;if(c){var e=ko.utils.arrayFirst(b.termAssessments(),function(a){return a.id===d}),f=ko.utils.arrayFirst(b.termAssessmentPersonResults(),
function(b){return b.personId===a});c.openDialog({header:f.fullName,assessmentName:e.title},{personId:a,gradebookItemId:d,supervisorType:b.settings.SupervisorType})}};this.openAssessmentDialogForCurrentStudent=function(a,d){b.openAssessmentDialog(a().personId,d)};this.getPersonGradebookItemResult=function(a,d){var c=ko.utils.arrayFirst(b.termAssessmentPersonResults(),function(b){return b.personId===a().personId});return ko.utils.arrayFirst(c.results,function(a){return a.gradebookItemId===d})};this.initialiseFilters=
function(){b.initialiseOrganisationFilter();b.initialiseTermFilter();b.initialiseHierarchyFilter()};this.disableFilters=function(){b.$organisationFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$organisationFilter.prop("disabled",!0);b.$termFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$termFilter.prop("disabled",!0);b.disableHierarchyFilter()};this.disableHierarchyFilter=function(){b.$hierarchyFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$hierarchyFilter.prop("disabled",
!0)};this.enableHierarchyFilter=function(){window[b.settings.ClientIds.HierarchyFilter].hasItems&&(b.$hierarchyFilter.removeClass(b.settings.CssClasses.FilterDisabled),b.$hierarchyFilter.removeProp("disabled"))};this.initialiseOrganisationFilter=function(){b.$organisationFilter.on(c.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onOrganisationFilterClickHandler)};this.onOrganisationFilterClickHandler=function(a,d){b.organisationId(d.selectedItemId);b.fetchOrganisationData()};this.initialiseTermFilter=
function(){b.$termFilter.on(c.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,d){b.termId(d.selectedItemId);b.fetchCoursesData()};this.initialiseHierarchyFilter=function(){b.$hierarchyFilter.on(c.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onHierarchyFilterItemClickHandler)};this.onHierarchyFilterItemClickHandler=function(a,d){b.hierarchyIds(d.selectedItemIds);b.fetchTermAssessmentPersonResultsData()};
this.fetchOrganisationData=function(){b.clearFilters();b.clearCoursesData();b.cancelDataFetching();b.disableFilters();b.fetchFiltersCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesData=function(){b.clearCoursesData();b.clearTermAssessmentsData();b.cancelDataFetching();b.disableHierarchyFilter();b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesPage=function(){b.isCoursesPageBeingLoaded(!0);b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentsData=
function(){b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData();b.cancelDataFetching();b.fetchTermAssessmentsCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentPersonResultsData=function(){b.clearTermAssessmentPersonResultsData();b.cancelDataFetching();b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.onFetchTermAssessmentPersonResultsPageHandler=function(a){if(!b.areCourseTermAssessmentsResultsBeingLoaded()&&!b.areAllTermAssessmentPersonResultsRetreived()&&
!b.isStudentSelectedInMobile()){a=$(a.target).scrollTop();if(a>b.termAssessmentPersonResultsListScrollTop){var d=$("."+b.settings.CssClasses.MobileStudentContainer).is(":visible")?$("."+b.settings.CssClasses.MobileStudentContainer).children():$("."+b.settings.CssClasses.StudentsContainer).children();d=d.eq(d.length-k.termAssessmentPersonResultsPageSize/2);CCL.CommonFunctions.isOnScreen(d,.5,.5)&&b.fetchTermAssessmentPersonResultsPage()}b.termAssessmentPersonResultsListScrollTop=a}};this.fetchTermAssessmentPersonResultsPage=
function(){b.isTermAssessmentPersonResultsPageBeingLoaded(!0);b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.cancelDataFetching=function(){null!=b.fetchFiltersPromise&&b.fetchFiltersPromise.readyState!==b.fetchFiltersPromise.DONE&&b.fetchFiltersPromise.abort();null!=b.fetchCoursesPromise&&b.fetchCoursesPromise.readyState!==b.fetchCoursesPromise.DONE&&b.fetchCoursesPromise.abort();null!=b.fetchTermAssessmentsPromise&&b.fetchTermAssessmentsPromise.readyState!==b.fetchTermAssessmentsPromise.DONE&&
b.fetchTermAssessmentsPromise.abort();null!=b.fetchTermAssessmentPersonResultsPromise&&b.fetchTermAssessmentPersonResultsPromise.readyState!==b.fetchTermAssessmentPersonResultsPromise.DONE&&b.fetchTermAssessmentPersonResultsPromise.abort()};this.clearFilters=function(){b.termId(null);b.hierarchyIds([])};this.clearCoursesData=function(){b.courses([]);b.coursesCount(b.courses().length);b.areCoursesBeingLoaded(!0);b.isCoursesPageBeingLoaded(!1);b.currentCourse(null);b.areAllCoursesRetreived(!1);b.coursesCurrentPage=
0;b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData()};this.clearTermAssessmentsData=function(){b.termAssessments([]);b.termAssessmentsCount(b.termAssessments().length);b.areCourseTermAssessmentsBeingLoaded(!0)};this.clearTermAssessmentPersonResultsData=function(){b.termAssessmentPersonResults([]);b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length);b.areCourseTermAssessmentsResultsBeingLoaded(!0);b.isTermAssessmentPersonResultsPageBeingLoaded(!1);b.currentStudent(null);
b.areAllTermAssessmentPersonResultsRetreived(!1);b.termAssessmentPersonResultsCurrentPage=0;b.ajustResultsFixedHeaderPosition()};this.getAssessmentRecordTooltip=function(a){a=CCL.CommonFunctions.htmlEncode(a);return CCL.CommonFunctions.formatString(b.settings.LanguageTerms.AssessmentRecordTooltip,a)};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchCoursesCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchCoursesPromise=b.dataFetcher.getCourses()});this.fetchFiltersCallbackDebouncer=
new CCL.CallbackDebouncer(function(){b.fetchFiltersPromise=b.dataFetcher.getDataForOrganisation()});this.fetchTermAssessmentsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentsPromise=b.dataFetcher.getTermAssessments()});this.fetchTermAssessmentPersonResultsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentPersonResultsPromise=b.dataFetcher.getTermAssessmentPersonResults()});this.organisationId=ko.observable(this.settings.OrganisationId);this.termId=
ko.observable(0===this.settings.TermId?null:this.settings.TermId);this.currentCourse=ko.observable(null);this.hierarchyIds=ko.observableArray(this.settings.HierarchyIds);this.currentCourseTitle=ko.pureComputed(function(){var a="";null!=b.currentCourse()&&(a=b.currentCourse().title);return a});this.areCoursesInitiated=ko.observable(!1);this.areCoursesBeingLoaded=ko.observable(!0);this.isCoursesPageBeingLoaded=ko.observable(!1);this.areCourseTermAssessmentsBeingLoaded=ko.observable(!0);this.areCourseTermAssessmentsResultsBeingLoaded=
ko.observable(!0);this.isTermAssessmentPersonResultsPageBeingLoaded=ko.observable(!1);this.courses=ko.observableArray([]);this.coursesCount=ko.observable(0);this.areAllCoursesRetreived=ko.observable(!1);this.termAssessments=ko.observableArray([]);this.termAssessmentsCount=ko.observable(0);this.termAssessmentPersonResults=ko.observableArray([]);this.termAssessmentPersonResultsCount=ko.observable(0);this.areAllTermAssessmentPersonResultsRetreived=ko.observable(!1);this.persons=ko.computed(function(){return b.termAssessmentPersonResults().map(function(a){return a})});
this.currentStudent=ko.observable(null);this.isStudentSelectedInMobile=ko.computed(function(){return b.currentStudent()&&CCL.CommonFunctions.isMobileDevice()});this.initialiseFilters();this.termAssessmentPersonResultsListScrollTop=$(window).scrollTop();$(window).on("resize scroll touchmove",this.onResultsFixedHeaderPositionChangeHandler);$(window).on("scroll touchmove",this.onFetchTermAssessmentPersonResultsPageHandler)}Object.defineProperty(a.prototype,"$organisationFilter",{get:function(){return $("#"+
this.settings.ClientIds.OrganisationFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$hierarchyFilter",{get:function(){return $("#"+this.settings.ClientIds.HierarchyFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});
return a}();g.TermAssessmentsViewModel=e;var b=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};a=new c.KnockoutCustomBindingsManager;a.registerSafeImgBinding();a.registerPerfectScrollBarBinding();this.model=new e(this.settings);ko.applyBindings(this.model,this.$container[0]);this.model.dataFetcher.getCourses().done(function(){b.model.areCoursesInitiated(!0)});this.$container.on("click",
this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();g.TermAssessments=b})(c.Supervisor||(c.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){var b=this;this.context=a;$("#"+this.context.Controls.DeleteButtonId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){return b.deleteSelectedTerms()})}b.prototype.deleteSelectedTerms=function(){var a=this,b=window[this.context.Controls.DataGridName],c=b.GetSelectedValues(),e=[];c&&0<c.length&&(e=c.substr(0,c.length-1).split(","));if(!b.GetNumberOfSelectedRows())return jAlert(this.context.Settings.PleaseMakeSelectionMessage),
!1;b=this.context.Settings.DeleteWarningMessage.replace(/#NumberOfSelectedRows/g,b.GetNumberOfSelectedRows());for(var g in e)if(e.hasOwnProperty(g)&&-1!==this.context.TermIdsUsedInGradebook.indexOf(e[g])){b=this.context.Settings.DeleteWarningMessageWithExistTermInGradebook;break}$.alerts.okButton=this.context.Settings.YesButtonText;$.alerts.cancelButton=this.context.Settings.NotButtonText;jConfirm(b,this.context.Settings.WarningDialogTitle,function(b){b&&__doPostBack("__Page",a.context.Settings.PostBackArgumentDelete)});
return!1};return b}();c.TermManagement=e})(c.TermManagement||(c.TermManagement={}))})(c.Terms||(c.Terms={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(c,b){var a=[],d=new DivToggler({divId:b.ClientIds.TopMenuArea,isCollapsed:!b.TopmenuExpanded,afterToggle:function(){},changeDivVisibility:!0}),e=$(window);d.initialize();a.push(d);b.ClientIds.TopNavigationContainer&&a.push(new DivToggler({divId:b.ClientIds.TopNavigationContainer,isCollapsed:!1,changeDivVisibility:!0}));if(b.UseLeftmenuToggler){var g=new DivToggler({divId:b.ClientIds.LeftArea,isCollapsed:!b.LeftMenuExpanded,changeDivVisibility:!1,
afterToggle:function(){var a=g.settings.isCollapsed,d=b.CssClasses.DesktopLeftmenuHidden;c.LeftArea.toggleClass(b.CssClasses.DesktopLeftmenuVisible,!a).toggleClass(d,a)}});g.initialize();a.push(g)}window.divTogglers=a;CCL.CommonFunctions.attachPostMessageEventListener(e,[CCL.CommonWindowMessages.MessageNames.disableFullScreen,CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame,CCL.CommonWindowMessages.MessageNames.enableFullScreen,CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame],
function(a,d){if(!window.itslTop[CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame])if(b.IsEmbedded)d=document.getElementById(b.ClientIds.CourseOverviewBackLinkContainer),a.messageName===CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame||a.messageName===CCL.CommonWindowMessages.MessageNames.disableFullScreen?d.classList.remove("l-hidden","l-forcibly-hidden"):a.messageName!==CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame&&!CCL.CommonWindowMessages.MessageNames.enableFullScreen||
window.itslTop.isProfileCardOpened||d.classList.add("l-hidden","l-forcibly-hidden");else{var e;if(a.messageName===CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame||a.messageName===CCL.CommonWindowMessages.MessageNames.disableFullScreen){$(window.itslTop.divTogglers).each(function(){this.settings.isCollapsed||this.expandDiv()});var f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasCollapsed);var g=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.collapseExtensionIframe)}else a.messageName!==
CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame&&!CCL.CommonWindowMessages.MessageNames.enableFullScreen||window.itslTop.isProfileCardOpened||($(window.itslTop.divTogglers).each(function(){var a=this.settings.isCollapsed;this.collapseDiv();this.settings.isCollapsed=a}),f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasExpanded),g=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.expandExtensionIframe));
(e=1===c.MenuIframe.length?c.MenuIframe.get(0).contentWindow:void 0)&&CCL.CommonFunctions.makePostMessageCall(e,g);CCL.CommonFunctions.makePostMessageCall(d,f)}})}}();c.NavigationControlScript=g})(c.TopMenu||(c.TopMenu={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){c.GradeExportInstance=this;this.controls=b;this.context=a;this.init()}e.prototype.dismissSyncItemNotifications=function(){$.post(this.context.WebMethods.CancelSyncItemNotification,{courseId:this.context.Settings.CourseId}).fail(function(b){c.Utils.handleAjaxError(b)})};e.prototype.init=function(){var b=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;$(document).on(e.showFeedbackEventTitle,
function(a,d,c){return b.showFeedback(d,c)})};e.prototype.showFeedback=function(b,a){var d=this;this.changeFeedbackContainer(a);null!=b&&CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.Container,b,this.context.LanguageTerms.GotIt,function(){d.closeFeedback()})};e.prototype.changeFeedbackContainer=function(b){null!=b&&$(document).find("."+CCL.CommonCssClasses.InformationFeedback.Container).css("top",b.top+20)};e.prototype.closeFeedback=function(){CCL.InformationFeedback.hideFeedback(this.controls.Container)};
e.showFeedbackEventTitle="LineItemsTransfer:showFeedback";return e}();c.GradeExport=g})(c.OneRoster||(c.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){var a=this;this.toggleValidator=ValidatorEnable;this.self=this;c.AddAssessmentInstance=this;this.context=b;this.window=$(window);var d=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;this.initialDefaultScore=1===this.context.Controls.DefaultScore.length?this.context.Controls.DefaultScore.val():"";this.initialDefaultAssessmentItemId=1===this.context.Controls.DefaultAssessmentItemId.length?
this.context.Controls.DefaultAssessmentItemId.val():"";this.context.Controls.OkButton.click(function(){return a.approveChanges(a)});this.secondSectionSeparator=this.context.Controls.WhereCountSection.parent().find("div."+this.context.CssClasses.FormSectionSeparator).last();this.toggleCustomExistingSections(this);this.context.Controls.CustomRadioButton.click(function(){a.toggleCustomExistingSections(a)});this.context.Controls.ExistingAssessment.click(function(){a.toggleCustomExistingSections(a)});
this.toggleFinalAssessmentCheckbox();this.context.Controls.AddDefaultAssessmentCheckBox.click(function(){a.toggleDefaultAssessmentControls(a)});this.context.Controls.DefaultAssessmentItemList.change(function(){a.saveDefaultAssessmentItemListSelection(a)});this.context.Controls.RetrieveLearningObjectivesFromPlannerButton.click(function(){a.retrieveLearningObjectivesFromPlanner(a)});$(document).on(d.context.Settings.LearningObjectiveItemsChangedClientEventName,function(a,b){d.refreshAssessmentTypeList(d,
a,b)});1===this.context.Controls.AssessmentScaleList.length&&(this.context.Controls.AssessmentScaleList.change(function(){d.toggleWeightPanelAccordingToAssessmentScale(this.value);d.toggleMaxScorePanelAccordingToAssessmentScale();d.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale()}),this.toggleWeightPanelAccordingToAssessmentScale(this.context.Controls.AssessmentScaleList.val()))}e.prototype.toggleCustomExistingSections=function(b){var a=b.context.Controls.CustomRadioButton.prop("checked");
b.toggle(b.context.Controls.ExistingSection,!a);b.toggle(b.context.Controls.CustomSection,a);b.toggle(b.context.Controls.AssessmentScaleListHolder,a);b.context.Controls.AssessmentScaleName.toggle(!a||0===b.context.Controls.AssessmentScaleList.length);b.toggle(b.context.Controls.EditableMaxScoreHolder,a);b.context.Controls.MaxScoreLabel.toggle(!a||0===b.context.Controls.MaxScore.length);b.context.Settings.UseTerms&&(0<b.context.Settings.SelectedTermId&&b.toggle(b.context.Controls.FinalAssessmentPanel,
a),b.context.Controls.FinalAssessmentCheckbox.prop("checked")&&b.toggleFinalAssessmentSettings(a),0<b.context.Settings.SelectedTermId&&b.toggleWhereOrHowSection(b.context.Controls.WhereCountSection,a||b.context.Controls.CategoryListPanel.is(":visible")));b.context.Settings.UseTerms&&0!==b.context.Settings.SelectedTermId||b.context.Controls.CustomRadioButton.prop("disabled")&&a||b.toggleBottomWarningMessageForElement(b);b.toggleWeightPanelAccordingToAssessmentScale(null);b.toggleMaxScorePanelAccordingToAssessmentScale();
b.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale();b.toggleIsManualAssessmentVisible()};e.prototype.toggleIsManualAssessmentVisible=function(){var b=this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&this.context.Controls.FinalAssessmentCheckbox.prop("checked")||!this.context.Controls.CustomRadioButton.prop("checked");this.toggle(this.context.Controls.IsManualAssessmentVisibleTogglePanel,!b)};e.prototype.toggleFinalAssessmentCheckbox=function(){this.toggleFinalAssessmentSettings(this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&
this.context.Controls.FinalAssessmentCheckbox.prop("checked"))};e.prototype.toggleFinalAssessmentSettings=function(b){this.toggleIsManualAssessmentVisible();this.toggle(this.context.Controls.CategoryListPanel,!b);this.context.Settings.UseTerms&&0<this.context.Settings.SelectedTermId&&this.toggleWhereOrHowSection(this.context.Controls.HowAssessSection,!b);this.toggleWeightPanelAccordingToAssessmentScale(null);this.toggleMaxScorePanelAccordingToAssessmentScale()};e.prototype.toggleWhereOrHowSection=
function(b,a){b.is(":visible")&&a||(this.toggle(b,a),this.secondSectionSeparator.toggle(this.context.Controls.HowAssessSection.is(":visible")&&a))};e.prototype.toggleWeightPanelAccordingToAssessmentScale=function(b){1===this.context.Controls.WeightPanel.length&&this.toggle(this.context.Controls.WeightPanel,(!this.context.Controls.FinalAssessmentCheckbox.is(":visible")||!this.context.Controls.FinalAssessmentCheckbox.prop("checked"))&&(1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?
this.isAssessmentScaleSupportWeighting(b||this.context.Controls.AssessmentScaleList.val()):this.context.Settings.IsAssessmentScaleOfTheColumnSupportWeighting))};e.prototype.toggleMaxScorePanelAccordingToAssessmentScale=function(){1===this.context.Controls.MaxScorePanel.length&&this.toggle(this.context.Controls.MaxScorePanel,1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?this.isAssessmentScaleSupportScore():this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore)};
e.prototype.saveDefaultAssessmentItemListSelection=function(b){b.context.Controls.DefaultAssessmentItemId.val(b.context.Controls.DefaultAssessmentItemList.val())};e.prototype.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale=function(){1===this.context.Controls.AddDefaultAssessmentPanel.length&&(this.isAssessmentScaleSelected()||this.isAssessmentScaleSupportScore()?this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("disabled"):(this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"),
this.context.Controls.AddDefaultAssessmentCheckBox.prop("disabled","disabled")),this.toggleDefaultAssessmentControls(this))};e.prototype.toggleDefaultAssessmentControls=function(b){var a=b.context.Controls.CustomRadioButton.prop("checked")&&!b.usedFinalAssessmentOption(),d=!1,c=!1;a?(d=b.context.Controls.AddDefaultAssessmentCheckBox.prop("checked"),c=b.isAssessmentScaleSupportScore(),d&&!c&&$.getJSON(b.context.WebMethods.GetAssessmentItems,{assessmentId:this.getAssessmentId(),courseId:this.context.Settings.CourseId}).done(function(a){b.context.Controls.DefaultAssessmentItemList.empty();
for(var d=0,c=a.length;d<c;d+=1){var e=a[d];b.context.Controls.DefaultAssessmentItemList.append('<option value="'+e.AssessmentItemId+'">'+e.Title+"</option>")}""!==b.context.Controls.DefaultAssessmentItemId.val()&&b.context.Controls.DefaultAssessmentItemList.val(b.context.Controls.DefaultAssessmentItemId.val())}).fail(function(a){return CCL.CommonFunctions.alertAjaxError(a,null,null)})):(b.context.Controls.DefaultAssessmentItemList.empty(),b.context.Controls.DefaultAssessmentItemId.val(""),b.context.Controls.DefaultScore.val(""),
b.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"));b.toggle(b.context.Controls.AddDefaultAssessmentPanel,a);b.toggle(b.context.Controls.DefaultAssessmentItemListPanel,a&&d&&!c);b.toggle(b.context.Controls.DefaultScorePanel,a&&d&&c)};e.prototype.isAssessmentScaleSupportWeighting=function(b){return parseInt(b.split(":")[1])===this.context.Settings.AssessmentTotalsAverage};e.prototype.isAssessmentScaleSupportScore=function(){return 1===this.context.Controls.AssessmentScaleList.length&&
parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0])===this.context.Settings.ScoreItemValue||0===this.context.Controls.AssessmentScaleList.length&&this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore};e.prototype.toggleBottomWarningMessageForElement=function(b){if(window[b.context.Settings.BottomMessageClientInstanceName]){var a=!b.context.Controls.CustomRadioButton.prop("checked")&&b.context.Settings.IsAssessmentScaleOfTheColumnSupportScore;window[b.context.Settings.BottomMessageClientInstanceName].self.context.Controls.container.toggle(a);
a&&(b.context.Controls.FinalAssessmentCheckbox.prop("checked",!1),b.toggleFinalAssessmentCheckbox());b.context.Controls.FinalAssessmentCheckbox.prop("disabled",a)}};e.prototype.usedFinalAssessmentOption=function(){return 1===this.context.Controls.FinalAssessmentCheckbox.length&&this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&this.context.Controls.FinalAssessmentCheckbox.prop("checked")};e.prototype.isAssessmentScaleSelected=function(){return null!=this.getAssessmentId()};e.prototype.getAssessmentId=
function(){return 1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.val()!==this.context.Settings.NotSelectedAssessmentScaleValue?parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0]):0===this.context.Controls.AssessmentScaleList.length&&0<this.context.Settings.SelectedAssessmentId?this.context.Settings.SelectedAssessmentId:null};e.prototype.toggle=function(b,a){var d=this;if(1===b.length){var c=function(a,b){for(var c=0,e=a.length;c<
e;c++)d.toggleValidator(a[c],b)};b.toggle(a);b.hasClass(this.context.CssClasses.FormContainer)?b.find('input:not([type="hidden"]), select, textarea').each(function(a,b){c($(b).nextAll("span[id$=Validator]").toArray(),$(b).is(":visible"))}):c(b.nextAll("span[id$=Validator]").toArray(),a)}};e.prototype.approveChanges=function(b){return b.confirmationDefaultAssessmentEditRequired()?(jConfirm(b.context.Controls.AddDefaultAssessmentCheckBox.prop("checked")?b.context.LanguageTerms.DefaultAssessmentChaingingConfirmMessage:
b.context.LanguageTerms.DefaultAssessmentTurningOffConfirmMessage,b.context.LanguageTerms.PleaseConfirm,function(a){if(a)if(b.pageIsValid())b.context.Functions.SuccessSubmit();else return!1;return!0}),!1):!0};e.prototype.confirmationDefaultAssessmentEditRequired=function(){if(!this.context.Settings.IsEditModeAndCustomAssessment)return!1;var b=1===this.context.Controls.AddDefaultAssessmentCheckBox.length&&this.context.Controls.AddDefaultAssessmentCheckBox.prop("checked");return this.context.Settings.UseDefaultAssessment&&
!b||this.context.Settings.UseDefaultAssessment&&b&&(1===this.context.Controls.DefaultScore.length&&this.context.Controls.DefaultScore.val()!==this.initialDefaultScore||1===this.context.Controls.DefaultAssessmentItemId.length&&this.context.Controls.DefaultAssessmentItemId.val()!==this.initialDefaultAssessmentItemId)};e.prototype.pageIsValid=function(){return Page_ClientValidate&&"function"===typeof Page_ClientValidate?(Page_ClientValidate(),Page_IsValid):!0};e.prototype.retrieveLearningObjectivesFromPlanner=
function(b){b.context.Controls.OkButton.attr("disabled","disabled");b.context.Controls.RetrieveLearningObjectivesFromPlannerButton.addClass(b.context.CssClasses.ButtonInProgerssClass).attr("disabled","disabled");CCL.CommonFunctions.safeAjaxPost({data:{termId:b.context.Settings.TermId,courseId:b.context.Settings.CourseId},dataType:"json",url:b.context.WebMethods.GetLearningObjectivesFromPlanner}).done(function(a){a.Success||alert(a.Message);a=$.unique((a.LearningObjectiveIds?a.LearningObjectiveIds:
[]).concat(window[b.context.Controls.LearningObjectivesEditorKey].getObjectiveIdsArray()));window[b.context.Controls.LearningObjectivesEditorKey].addLearningObjectives(a)}).fail(function(a){CCL.CommonFunctions.alertAjaxError(a,null,null)}).always(function(){b.context.Controls.OkButton.removeAttr("disabled");b.context.Controls.RetrieveLearningObjectivesFromPlannerButton.removeClass(b.context.CssClasses.ButtonInProgerssClass).removeAttr("disabled")})};e.prototype.refreshAssessmentTypeList=function(b,
a,d){b.context.Controls.AssessmentTypeListPanel.find("["+b.context.Settings.IncludeLearningObjectivesAttribute+"='False']").toggle(!(0<d.length))};return e}();c.AddAssessment=g})(c.AssessmentRecord||(c.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a){var d=this;this.settings=b;this.controls=a;this.document=$(document);window[this.settings.ClientInstanceName]=this;this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.form,this.settings.Terms.BeforeUnloadWarningMessage,{cancelButtonId:this.settings.ClientIds.CancelButton});this.controls.usePlagiarismCheckBox.click(function(a){d.controls.plagiarismInfoMessage.toggle()});this.controls.useAnonymousSubmissionCheckBox.click(function(a){d.controls.anonymousSubmissionInfoMessage.toggle()});
this.settings.ConnectAssessmentCriteriaToScale&&this.controls.assessmentDropDown.change(function(){d.toggleCriteriaWeights(!1)})}c.prototype.toggleCriteriaWeights=function(b){var a=this.controls.assessmentDropDown.find("option:selected").val();this.document.trigger(this.settings.LearningObjectivesEditorToggleCriteriaWeightsVisibilityMethodName,{show:!b&&a!==this.settings.AssessmentScaleControlDoNotUseAssessmentValue})};return c}();c.AddEditLearningToolElement=g})(c.LearningToolElement||(c.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(a){this.settings=a;this.document=$(document);window[this.settings.ClientInstanceName]=this}b.prototype.checkIfTransitionAllowed=function(a,b){var d=[];this.settings.AllowedTypeTransitions.forEach(function(b){b.Type==a&&(d=b.AllowedChildrenTypes)});return 0<d.length&&-1<$.inArray(b,d)};b.prototype.extractType=function(a){var b=this.settings.NodeNamePrefix,c=a.indexOf(b);if(0>c)return"";var e=a.indexOf(" ",c);0>e&&(e=a.length-1);return a.substring(c+
b.length,e)};b.prototype.findParentWithType=function(a,b,c){b=this.settings.NodeNamePrefix+b;if(c&&$(a).hasClass(b))return a;a=$(a).parents("."+b);return 0<a.length?a.get(0):null};b.prototype.moveNode=function(a,b,c,e,g){var d=this,f=$("#"+a);b=$("#"+c);var h=$("#"+e),l={};l[this.settings.RequestItems.RepositoryTreeEntityClientIdToMove]=a;l[this.settings.RequestItems.RepositoryTreeEntityToMoveType]=this.extractType(f.attr("class"));l[this.settings.RequestItems.NewParentRepositoryTreeEntityClientId]=
c;l[this.settings.RequestItems.NewParentRepositoryTreeEntityType]=this.extractType(b.attr("class"));l[this.settings.RequestItems.RelativeRepositoryTreeEntityClientId]=e;l[this.settings.RequestItems.RelativeRepositoryTreeEntityType]=this.extractType(h.attr("class"));l[this.settings.RequestItems.RelativeMovePosition]=g;l[this.settings.RequestItems.HierarchyId]=this.settings.HierarchyId;l[this.settings.RequestItems.CountryCode]=this.settings.CountryCode;CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.MoveUrl,
data:l}).done(function(){f.children("a").first().effect("highlight",{},2500)}).fail(function(){jAlert(d.settings.Terms.TreeMenuErrorWhileMoving,d.settings.Terms.Error,function(){location.reload()})})};b.prototype.beforeMove=function(a){if(this.extractType(a.o[0].className)===this.settings.TreeTypeDescriptor){a=a.np[0];var b=this.extractType(a.className)===this.settings.TreeTypeCriterion;return b&&$(a).find("li."+this.settings.NodeNamePrefix+this.settings.TreeTypeDescriptor).length>=this.settings.MaxNumberOfAchievementLevels?
(jAlert(this.settings.Terms.YouCannotAddMoreThanXDescriptors),!1):b}return!0};b.prototype.checkOnMove=function(a){if(a.np[0]!=a.op[0]){var b=this.extractType(a.np[0].className),c=this.extractType(a.o[0].className);if(!b||!c||!this.checkIfTransitionAllowed(b,c)||this.findParentWithType(a.np[0],this.settings.TreeTypeSubject,!0)!=this.findParentWithType(a.o[0],this.settings.TreeTypeSubject,!1))return!1}return!0};return b}();c.LearningObjectiveRepository=e})(c.LearningObjectiveRepository||(c.LearningObjectiveRepository=
{}))})(c.Administration||(c.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){var d=this;this.checkAsyncTaskStatusTimeoutMilliseconds=5E3;this.selectedPersonIds=[];c.AssessmentLettersInstance=this;this.settings=b;this.controls=a;this.letterGroupGridRowsContainer=this.controls.letterGroupGridInstance.getRowsContainer();this.letterGroupGridRows=this.controls.letterGroupGridInstance.getRows();this.letterGroupGridRowsContainer.on("click",CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupDownloadLink),
function(){CCL.CommonFunctions.safeAjaxPost({url:d.settings.ServiceUrlsModel.AddKpiOnDownloadLetterGroupPdf,data:{isViewerRoleHeadteacher:d.settings.IsViewerRoleHeadteacher}}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})});this.controls.createLetterGroupButton.click(this.openCreateLetterGroupPopup);this.scheduleCheckExportToPdfAsyncTaskStatus();this.scheduleCheckLettersGeneratedAsyncTaskStatus();this.settings.IsScrollToGroupLettersFeedbackControlNeeded&&this.scrollToGroupLettersFeedback()}
e.prototype.openViewRecipientsDialog=function(b,a,d){b=window[c.AssessmentLettersInstance.settings.ClientInstanceNames.ViewRecipientsDialogInstance];d=CCL.CommonFunctions.formatString(c.AssessmentLettersInstance.settings.LanguageTerms.RecipientsFor,d);b.setTitle(d);b.setAjaxUrl(c.AssessmentLettersInstance.settings.ServiceUrlsModel.GetLetterGroupRecipients,{letterGroupId:a,isViewerRoleHeadteacher:c.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher},!1);b.openDialog(!1)};e.prototype.publishLetterGroupAction=
function(b,a,d){var c=this,e={letterGroupId:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher};$.alerts.okButton=this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.PublishLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(a){a&&c.postJsonToService(c.settings.ServiceUrlsModel.PublishLetterGroup,e).done(function(a){window.location=window.location})})};e.prototype.deleteLetterGroupAction=
function(b){$.alerts.okButton=this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.DeleteLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(a){a&&b()})};e.prototype.exportToPdfLetterGroupAction=function(b,a){$(b).attr("disabled")||a()};e.prototype.openCreateLetterGroupPopup=function(){var b=window[c.AssessmentLettersInstance.settings.ClientInstanceNames.CreateLetterPopupInstance],a=[],d=c.AssessmentLettersInstance.controls.learnersGridInstance.GetSelectedValues();
d&&0<d.length&&(a=d.substr(0,d.length-1).split(","));0===a.length?jAlert(c.AssessmentLettersInstance.settings.LanguageTerms.SelectAtLeastOneLearner,c.AssessmentLettersInstance.settings.LanguageTerms.AlertTitle,null):0===$(a).not(c.AssessmentLettersInstance.selectedPersonIds).length&&0===$(c.AssessmentLettersInstance.selectedPersonIds).not(a).length?b.openDialog():CCL.CommonFunctions.safeAjaxPost({url:c.AssessmentLettersInstance.settings.ServiceUrlsModel.GetCreateLetterGroupPopupTitle,data:{personIds:a,
termName:c.AssessmentLettersInstance.settings.TermName,isViewerRoleHeadteacher:c.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher}}).done(function(d){c.AssessmentLettersInstance.selectedPersonIds=a;b.setAboutHtml(d);b.openDialog()}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};e.prototype.scheduleCheckExportToPdfAsyncTaskStatus=function(){var b=this;setTimeout(function(){b.checkExportToPdfAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};e.prototype.checkExportToPdfAsyncTaskStatus=
function(){var b=this,a=[];this.controls.letterGroupGridInstance.getRows().each(function(b,c){a.push($(c).data("id"))});0<a.length&&CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceUrlsModel.GetLetterGroupsFeedback,data:{letterGroupIds:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(d){var c=window[b.settings.ClientInstanceNames.GroupLettersTasksStatusFeedbackInstance];d=$(d);var e=d.attr(b.settings.DataAttributes.FeedbackProgress);e!==b.settings.DataAttributes.FeedbackProgressValueWait&&
e!==b.settings.DataAttributes.FeedbackProgressValueOk&&e!==b.settings.DataAttributes.FeedbackProgressValueError||c.showMessage(e===b.settings.DataAttributes.FeedbackProgressValueError?CCL.FeedbackType.Error:CCL.FeedbackType.Information,d.html());e!==b.settings.DataAttributes.FeedbackProgressValueOk&&e!==b.settings.DataAttributes.FeedbackProgressValueError||b.deleteLetterGroupAsyncTaskExportAsPdf();e===b.settings.DataAttributes.FeedbackProgressValueOk&&b.injectLetterGroupDownloadLinks(a);b.scheduleCheckExportToPdfAsyncTaskStatus()}).fail(function(a,
b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};e.prototype.scheduleCheckLettersGeneratedAsyncTaskStatus=function(){var b=this;0<this.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&setInterval(function(){b.checkLettersGeneratedAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};e.prototype.checkLettersGeneratedAsyncTaskStatus=function(){var b=this,a=[];this.controls.letterGroupGridInstance.getRows().each(function(d,
c){0<$(c).find(CCL.CommonFunctions.formatString(".{0}",b.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&a.push($(c).data("id"))});0<a.length&&this.postJsonToService(this.settings.ServiceUrlsModel.GetGenerateLettersJobStatus,{letterGroupIds:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(a){var b=!1;a.forEach(function(a){a.IsLetterGroupBusy||(b=!0)});b&&(window.location=window.location)})};e.prototype.publishLetterGroups=function(b,a){this.postJsonToService(this.settings.ServiceUrlsModel.PublishLetterGroup,
{letterGroupIds:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(){a()})};e.prototype.deleteLetterGroupAsyncTaskExportAsPdf=function(){this.postJsonToService(this.settings.ServiceUrlsModel.DeleteLetterGroupAsyncTaskExportAsPdf,{isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher})};e.prototype.injectLetterGroupDownloadLinks=function(b){var a=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceUrlsModel.GetLetterGroupDownloadLinks,data:{letterGroupIds:b,
isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(b){$(b).children().each(function(b,d){b=$(d);d=a.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString("[{0}='{1}'] ",a.settings.DataAttributes.LetterGroupDownloadLink,b.attr(a.settings.DataAttributes.LetterGroupDownloadLink)));0<d.length&&d.replaceWith(b)})}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};e.prototype.postJsonToService=function(b,a){return CCL.CommonFunctions.safeAjaxPost({dataType:"JSON",
url:b,data:a}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};e.prototype.scrollToGroupLettersFeedback=function(){$("html, body").animate({scrollTop:this.controls.groupLettersGridLabel.offset().top},1E3)};return e}();c.AssessmentLetters=g})(c.Supervisor||(c.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(){function a(a,b){this.PlanId=a;this.ColumnId=b}a.distinctArray=function(a){return a.reduce(function(a,b){0===a.filter(function(a){return b.PlanId===a.PlanId&&b.ColumnId===a.ColumnId}).length&&a.push(b);return a},[])};return a}();b.PlannerCell=a;var d=function(b){function d(a,f,g){b.call(this,f,c.Planner.getInstance().settings.CourseId,g);this._planElementMovingDisabled=!1;window[a]=this;d.instanceName=a;this._css=f.Css;
this._terms=f.Terms;this._elementColumnIds=f.ElementColumnIds;this._planner=c.Planner.getInstance();this._activateElementsByPlan=this._planner.settings.ActivateElementsByPlan;this._planExpandableContentCellCommonLogic=e.PlanExpandableContentCellCommonLogic.getInstance();a=itslTop;this._activateElementsByPlan&&a.reloadFolder&&a.reloadFolder("item0","planner",!0);this.attachEvents()}__extends(d,b);d.prototype.refreshResourcesCell=function(a,b,d){this.refreshActivityResourceCell(a,b,!0,!0,!1);d&&this.measureKpiEditPlan()};
d.prototype.refreshResourcesCellWithElement=function(b){var d=this;b=this.findCellsToRefresh(b);a.distinctArray(b).forEach(function(a){return d.refreshActivityResourceCell(a.PlanId,a.ColumnId,!1,!1)})};d.getPlanActivityResourceCellInstance=function(){return window[d.instanceName]};d.onFileUploadSuccess=function(a){d.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};d.onFileUploadFailed=function(a,b){d.getPlanActivityResourceCellInstance().onFileUploadFailed(a,b)};d.onFileSelected=function(a){d.getPlanActivityResourceCellInstance().onFileSelected(a)};
d.getActivityResourceListItemSelector=function(){return"."+d.getPlanActivityResourceCellInstance()._css.ActivityResourceListItem};d.prototype.refreshActivityResourceCell=function(a,b,d,c,e){void 0===c&&(c=!0);this.reloadPlanElements(a,b,c,d,e)};d.prototype.updateContent=function(a,b,d,e,f){var g=this;b=this.getActivityResourceCell(b,d);b.html(a);a=itslTop;e&&a.reloadFolder&&a.reloadFolder("item0","planner",f,!0);if(this._activateElementsByPlan){e=b.find("."+this._css.ActivityResourceListItem);var h=
this._planner.getContainer();0<e.length&&e.each(function(a,b){var d=$(b);a=d.find("."+g._css.ActivityResourceListItemLink).first();b=d.data(g._planner.data.ElementId);void 0==b||0>=a.length||(a=h.find("."+g._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(g._planner.data.ElementId,b)),0<a.length&&a.each(function(){var a=$(this),b=d.clone();a.replaceWith(b)}))})}this.initDragAndDrop(c.Cards.TopicCard.getParentTopicCardContainer(b))};d.prototype.initDragAndDrop=function(a){var b=this;
null==a&&(a=c.Cards.TopicCard.getAllTopicCardContainers());a.each(function(a,d){var c=$(d);b._elementColumnIds.forEach(function(a){a=c.find("."+b._css.ActivityResourceCell+CCL.CommonFunctions.getDataSelector(b._planner.data.ColumnId,a)+" > ul");b.setDragAndDrop(a)})})};d.prototype.reloadPlanElements=function(a,b,d,c,e){var f=this;this._planElementMovingDisabled=!0;void 0==e&&(e=!this.getActivityResourceCell(a,b).find("."+this._planExpandableContentCellCommonLogic.css.ExpanderLink).hasClass(this._planExpandableContentCellCommonLogic.css.ExpanderLinkExpanded));
CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ReloadPlanElements,data:{courseId:this.courseId,planId:a,columnId:b,showCollapsedList:e}}).done(function(e){f.updateContent(e.ControlHtml,a,b,d,c);f._planElementMovingDisabled=!1}).fail(function(){return f._planElementMovingDisabled=!1})};d.prototype.removeElementFromPlan=function(a){var d=this,e=this.getDataAttributeValueAsNumber(a,c.PlannerConstants.dataAttributes.ElementId),f=this.getDataAttributeValueAsNumber(a,c.PlannerConstants.dataAttributes.PlanId),
g=this.getDataAttributeValueAsNumber(a,c.PlannerConstants.dataAttributes.ColumnId);b.prototype.deletePlanElement.call(this,f,e,!1).done(function(){d.refreshActivityResourceCell(f,g,!1,!1);d.measureKpiEditPlan()})};d.prototype.deleteElementFromCourse=function(d){var e=this,f=this.getDataAttributeValueAsNumber(d,c.PlannerConstants.dataAttributes.ElementId);d=this.getDataAttributeValueAsNumber(d,c.PlannerConstants.dataAttributes.PlanId);b.prototype.deletePlanElement.call(this,d,f,!0).done(function(){var b=
itslTop;b.reloadFolder&&b.reloadFolder("item0","planner");b=e.findCellsToRefresh(f);a.distinctArray(b).forEach(function(a){e.refreshActivityResourceCell(a.PlanId,a.ColumnId,!1,!1)});e.measureKpiEditPlan()})};d.prototype.getActivityResourceCell=function(a,b){return $("."+this._css.ActivityResourceCell+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).closest("."+this._planner.getPlannerCellCssClass())};d.prototype.getActivityResourceList=
function(a,b){return this.getActivityResourceCell(a,b).find("ul")};d.prototype.findCellsToRefresh=function(b){var d=this,c=[];this._planner.getContainer().find("."+this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,b)).each(function(b,e){e=$(e);b=e.data(d._planner.data.PlanId);e=e.data(d._planner.data.ColumnId);c.push(new a(b,e))});this.getChildElementIds(b).forEach(function(a){c=$.merge(c,d.findCellsToRefresh(a))});return c};d.prototype.getChildElementIds=
function(a){var b=this,d=[];this._planner.getContainer().find("."+this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ParentFolderId,a)).each(function(a,c){a=$(c).data(b._planner.data.ElementId);-1===d.indexOf(a)&&d.push(a)});return d};d.prototype.swapPlanElements=function(a,b,d,c){var e=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SwapPlanElements,data:{courseId:this.courseId,firstElementId:b,secondElementId:d,planId:a,columnId:c}}).done(function(){e.reloadPlanElements(a,
c,!1,!1)})};d.prototype.movePlanElement=function(a,b,d,c,e){var f=this;this._planElementMovingDisabled=!0;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.MovePlanElement,data:{courseId:this.courseId,sourcePlanId:a,targetPlanId:b,elementId:d,columnId:c,elementIds:e}}).done(function(){a!==b&&(f.refreshActivityResourceCell(a,c,!1),f.refreshActivityResourceCell(b,c,f._planner.settings.ActivateElementsByPlan));f._planElementMovingDisabled=!1}).fail(function(){f.refreshActivityResourceCell(a,
c,!1);a!==b&&f.refreshActivityResourceCell(b,c,!1);f._planElementMovingDisabled=!1})};d.prototype.moveElementToPlan=function(a,b,d,c){var e=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.MoveElementToPlan,data:{courseId:this.courseId,elementId:d,sourcePlanId:a,targetPlanId:b,columnId:c}}).done(function(d){d.Success&&(e.refreshActivityResourceCell(a,c,!1),e.refreshActivityResourceCell(b,c,e._planner.settings.ActivateElementsByPlan))})};d.prototype.getPrevElementId=function(a,b,
d){var c=this,e=null,f=this.getActivityResourceCell(a,d).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,d){d=$(d);var g=f.eq(a-1);d.data(c._planner.data.ElementId)==b&&0<a&&(e=g.data(c._planner.data.ElementId))});return e};d.prototype.getNextElementId=function(a,b,d){var c=this,e=null,f=this.getActivityResourceCell(a,d).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,d){d=$(d);var g=f.eq(a+1);d.data(c._planner.data.ElementId)==b&&a<f.length-1&&(e=g.data(c._planner.data.ElementId))});
return e};d.prototype.getNextPlanId=function(a,b){var d=null,e=c.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(e,function(b,c){if(c===a)return b<e.length-1&&(d=e[b+1]),!1});return d};d.prototype.getPrevPlanId=function(a,b){var d=null,e=c.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(e,function(b,c){if(c===a)return 0<b&&(d=e[b-1]),!1});return d};d.prototype.updateMoveOptions=function(a,b){if(a.length){var d=a.data(this._planner.data.ElementId),
c=a.data(this._planner.data.ColumnId);a=a.data(this._planner.data.PlanId);var e="data-"+this._planner.data.PlanId,f=this.getActionLink(this._css.MoveUpResourceLink,d,c,b),g=this.getActionLink(this._css.MoveDownResourceLink,d,c,b),h=this.getActionLink(this._css.MoveResourceToPrevPlanLink,d,c,b),k=this.getActionLink(this._css.MoveResourceToNextPlanLink,d,c,b),l=this.getActionLink(this._css.RemoveFromPlanLink,d,c,b);b=this.getActionLink(this._css.DeleteFromCourseLink,d,c,b);f.attr(e,a);g.attr(e,a);h.attr(e,
a);k.attr(e,a);l.attr(e,a);b.attr(e,a)}};d.prototype.hideMoveOptionsIfNecessary=function(a){if(a.length){var b=a.siblings("."+this._css.ActivityResourceListItem),d=b.data(this._planner.data.ElementId);a=b.data(this._planner.data.ColumnId);var c=b.data(this._planner.data.PlanId),e=this.getActionLink(this._css.MoveUpResourceLink,d,a,c).closest("li"),f=this.getActionLink(this._css.MoveDownResourceLink,d,a,c).closest("li"),g=this.getActionLink(this._css.MoveResourceToPrevPlanLink,d,a,c).closest("li");
b=this.getActionLink(this._css.MoveResourceToNextPlanLink,d,a,c).closest("li");var h=this.getPrevElementId(c,d,a);e.toggle(null!=h);d=this.getNextElementId(c,d,a);f.toggle(null!=d);d=this.getPrevPlanId(c,a);g.toggle(null!=d);a=this.getNextPlanId(c,a);b.toggle(null!=a)}};d.prototype.getActionLink=function(a,b,d,c){return $("."+a+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,d)+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,
c))};d.prototype.setDragAndDrop=function(a){var b=this;a.each(function(d,e){d=$(e);if(null!=d.sortable("instance"))return d.sortable("option","connectWith",a),!0;d.sortable({connectWith:a,axis:"y",scroll:!0,scrollSensitivity:50,scrollSpeed:10,handle:"."+b._planner.css.ReorderDragHandler,cursor:"move",dropOnEmpty:!0,items:"."+b.settings.Css.ElementListItem,containment:c.Cards.TopicCard.getParentTopicCard(d).getPlanGrid().getRowsContainer()});d.on("sortstart",function(a,b){b.item.data("oldIndexValue",
b.item.index())});d.on("sortreceive",function(a,d){var c=$(d.item).find("."+b._css.ActivityResourceListItem),e=c.data(b._planner.data.ElementId);b._planElementMovingDisabled?d.sender.sortable("cancel"):$(a.target).find("."+b._css.ActivityResourceListItem).each(function(a,f){if(f==c[0])return!0;if($(f).data(b._planner.data.ElementId)==e)return d.sender.sortable("cancel"),!1})});d.on("sortstop",function(a,d){var e=parseInt(d.item.index(),10),f=parseInt(d.item.data("oldIndexValue"),10),g=$(d.item),h=
g.find("."+b._css.ActivityResourceListItem),k=h.data(b._planner.data.PlanId),l=h.data(b._planner.data.ColumnId),m=h.data(b._planner.data.ElementId),n=c.Cards.TopicCard.getParentPlanContainer(h).data(b._planner.data.GridRowId);if(k!==n||f!==e){var p=[];g.parent().find("."+b._css.ActivityResourceListItem).each(function(a,d){a=$(d);l===a.data(b._planner.data.ColumnId)&&(a=a.data(b._planner.data.ElementId),p.push(a))});b._planElementMovingDisabled?(a=null!=d.sender?d.sender:$(a.currentTarget),null!=a&&
a.sortable("cancel")):(b.movePlanElement(k,n,m,l,p),h.attr("data-"+b._planner.data.PlanId,n),h.data(b._planner.data.PlanId,n),b.updateMoveOptions(h,k))}})})};d.prototype.getLearningObjectiveIds=function(a,b){var d=e.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance();return d?d.getLearningObjectiveIds(a,b):[]};d.prototype.measureKpiEditPlan=function(){this._planner.measureEditPlan()};d.prototype.attachSpecificEvents=function(){var a=this;$(document).on("click",
"."+this._css.DeleteFromCourseLink,function(b){var d=$(b.currentTarget);CCL.CommonFunctions.jAjaxConfirm(a._terms.DeleteFromCourseConfirmation,a._planner.terms.ConfirmTitle,a._planner.terms.Yes,a._planner.terms.No,function(b){b&&a.deleteElementFromCourse(d)})}).on("click","."+this._css.MoveUpResourceLink,function(b){var d=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(d,a._planner.data.PlanId);var c=a.getDataAttributeValueAsNumber(d,a._planner.data.ColumnId);d=a.getDataAttributeValueAsNumber(d,
a._planner.data.ElementId);var e=a.getPrevElementId(b,d,c);e&&a.swapPlanElements(b,d,e,c)}).on("click","."+this._css.MoveDownResourceLink,function(b){var d=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(d,a._planner.data.PlanId);var c=a.getDataAttributeValueAsNumber(d,a._planner.data.ColumnId);d=a.getDataAttributeValueAsNumber(d,a._planner.data.ElementId);var e=a.getNextElementId(b,d,c);e&&a.swapPlanElements(b,d,e,c)}).on("click","."+this._css.MoveResourceToNextPlanLink,function(b){var d=$(b.currentTarget);
b=a.getDataAttributeValueAsNumber(d,a._planner.data.ElementId);var c=a.getDataAttributeValueAsNumber(d,a._planner.data.ColumnId);d=a.getDataAttributeValueAsNumber(d,a._planner.data.PlanId);var e=a.getNextPlanId(d,c);e&&a.moveElementToPlan(d,e,b,c)}).on("click","."+this._css.MoveResourceToPrevPlanLink,function(b){var d=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(d,a._planner.data.ElementId);var c=a.getDataAttributeValueAsNumber(d,a._planner.data.ColumnId);d=a.getDataAttributeValueAsNumber(d,
a._planner.data.PlanId);var e=a.getPrevPlanId(d,c);e&&a.moveElementToPlan(d,e,b,c)}).on("click","."+this._css.ActionLink,function(b){a.hideMoveOptionsIfNecessary($(b.currentTarget))}).on(this._planner.events.PlanActivityResourceCellOutdated,function(b,d){null!=d&&a._elementColumnIds.forEach(function(b){a.refreshActivityResourceCell(d.planId,b,!1,a._activateElementsByPlan)})})};d.prototype.getLibraryBrowserDialog=function(){return this._planner.getLibraryBrowserDialog()};d.prototype.getPlanId=function(a){a=
this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,c.PlannerConstants.dataAttributes.GridRowId)};d.prototype.getColumnId=function(a){a=a.closest("."+this._planner.getPlannerCellCssClass()).find("."+this.settings.Css.ActivityResourceCell);return this.getDataAttributeValueAsNumber(a,c.PlannerConstants.dataAttributes.ColumnId)};d.prototype.getElementDialogOffset=function(){return-15};d.prototype.getFolderId=function(a){return this.getDataAttributeValueAsNumber(a,c.PlannerConstants.dataAttributes.FolderId)};
return d}(b.PlanResourcesCellBase);b.PlanActivityResourceCell=d})(e.ResourcesCell||(e.ResourcesCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(a){function b(d,e){var f=this;a.call(this,e);window[d]=this;b.instanceName=d;this.planner=c.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.showDates=this.planner.settings.ShowDates;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;$(function(){f.attachEvents()})}__extends(b,a);b.getPlanDateCellInstance=function(){return window[b.instanceName]};
b.prototype.updateContent=function(a,b,d){this.getDateCell(b).replaceWith(a);a=[{planId:b,planActive:d}];$(document).trigger(c.PlannerConstants.events.PlanActivationChanged,{planActivations:a})};b.prototype.updatePlanTimeSpan=function(a){var b=this,d=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanTimeSpan,data:{courseId:this.courseId,planId:a,start:d.getStartDate(),stop:d.getStopDate(),showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();
b.refreshDatesCell(a);var e=c.Cards.TopicCard.getInstance(a.topicId);e&&e.updateTopicExpanderLink(a.expanderText)}else d.showErrorMsg(c.DatePickerMode.TimeSpan)}).fail(function(){d.showErrorMsg(c.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,d=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanWeekAndDay,data:{courseId:this.courseId,planId:a,start:d.getStartWeek(),stop:d.getStopWeek(),showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();
b.refreshDatesCell(a);var e=c.Cards.TopicCard.getInstance(a.topicId);e&&e.updateTopicExpanderLink(a.expanderText)}else d.showErrorMsg(c.DatePickerMode.WeekAndDay)}).fail(function(){d.showErrorMsg(c.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,d=this.getDatePicker(),e=d.getEvents();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanEvents,data:{courseId:this.courseId,planId:a,activityIds:e,filterStartDate:this.startDate,filterStopDate:this.endDate,
showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();b.refreshDatesCell(a);var e=c.Cards.TopicCard.getInstance(a.topicId);e&&e.updateTopicExpanderLink(a.expanderText)}else d.showErrorMsg(c.DatePickerMode.Event)}).fail(function(){d.showErrorMsg(c.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(){var a=this.getTimeSpanHidden(this.currentPlanId).data(c.PlannerConstants.dataAttributes.TopicId);c.Cards.TopicCard.setDefaultDate(this.getDatePicker(),a)};b.prototype.getCurrentPlanId=
function(a){a=a.parent().find("input:hidden");return parseInt(a.data(c.PlannerConstants.dataAttributes.PlanId).toString(),10)};b.prototype.openContextDialog=function(a){this.contextDialog.openDialog(a)};b.prototype.focusOnDateEditAction=function(a){this.getDateCell(a).find(CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanCellAction)).focus()};b.prototype.refreshDatesCell=function(a){this.updateContent(a.dateCell,a.planId,a.planActive);this.planner.settings.ActivateElementsByPlan&&
$(document).trigger(c.PlannerConstants.events.PlanActivityResourceCellOutdated,{planId:a.planId})};b.prototype.getDateCell=function(a){return $("."+this.css.CellContent+" input:hidden"+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,a)).closest("."+this.css.CellContent)};b.prototype.attachEvents=function(){var a=this;$(document).on(c.PlannerConstants.events.PlanDateCellChange,function(b,d){void 0!=d.dateCellObject&&a.refreshDatesCell(d.dateCellObject)});$(document).on(c.PlannerConstants.events.PlanDateCellsChanged,
function(b,d){void 0!=d.dateCellObjects&&$.each(d.dateCellObjects,function(b,d){a.getDateCell(d.PlanId).replaceWith(d.Content)})})};return b}(b.PlanDateCellBase);b.PlanDateCell=a})(e.DateCell||(e.DateCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){(function(b){var a=function(a){function b(b,d){a.call(this,b,d,c.Planner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var d=this,e=b.data(c.PlannerConstants.dataAttributes.PlanId);b=b.data(c.PlannerConstants.dataAttributes.LearningObjectiveId);var f=!this.getLearningObjectivesListCell(e).find("."+this.settings.Css.ExpanderLink).hasClass(this.settings.Css.ExpanderLinkExpanded);a.prototype.removeLOFromPlan.call(this,
e,b,f).done(function(a){d.updateContent(a.ControlHtml,e)})};b.prototype.getCurrentPlanId=function(a){return a.data(c.PlannerConstants.dataAttributes.PlanId)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.LearningObjectivesList+CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,a)).closest("."+c.Planner.getInstance().getPlannerCellCssClass())};b.prototype.getLearningObjectiveIds=function(a,b){void 0===b&&(b=!1);var d=this.getLearningObjectivesListCell(a),
e=this.getLearningObjectiveDataAttribute(b);a=d.find(CCL.CommonFunctions.getDataSelector(c.PlannerConstants.dataAttributes.PlanId,a)+CCL.CommonFunctions.getDataSelector(e));var f=[];0<a.length&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(e))&&(a=parseInt(a.data(e).toString(),10),-1===$.inArray(a,f)&&f.push(a))});return f};return b}(b.PlanLearningObjectivesCellBase);b.PlanLearningObjectivesCell=a})(e.LearningObjectivesCell||(e.LearningObjectivesCell={}))})(g.Plan||(g.Plan={}))})(c.Cells||(c.Cells=
{}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){c[c.RichText=0]="RichText";c[c.Theme=1]="Theme";c[c.Lesson=3]="Lesson";c[c.LessonDescription=4]="LessonDescription";c[c.Date=5]="Date";c[c.ClassHours=6]="ClassHours";c[c.LearningObjectives=7]="LearningObjectives";c[c.Resources=8]="Resources";c[c.Activities=9]="Activities";c[c.Term=10]="Term";c[c.Rubric=11]="Rubric";c[c.Elements=12]="Elements"})(c.ColumnType||(c.ColumnType={}));(function(c){c[c.Resource=0]="Resource";c[c.Activity=1]="Activity";c[c.LearningObjectiveAssessmentSupported=
2]="LearningObjectiveAssessmentSupported"})(c.ElementCategory||(c.ElementCategory={}));(function(c){c[c.TimeSpan=0]="TimeSpan";c[c.WeekAndDay=1]="WeekAndDay";c[c.Event=2]="Event"})(c.DatePickerMode||(c.DatePickerMode={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b,a){window[b]=this;e.instanceName=b;this.terms=a;this.planner=c.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;this.showPlanDates=this.planner.settings.ShowDates;this.useTopics=this.planner.settings.UseTopics;this.addingPlanInProgress=!1}e.getInstance=function(){return window[e.instanceName]};e.prototype.addPlan=function(b){var a=
this;if(!this.addingPlanInProgress){this.addingPlanInProgress=!0;this.planner.toggleEnableDisplayModeSwitcher(!1);var d=c.Cards.TopicCard.getInstance(b),e=d.getLastPlanId();e||(e=0);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.AddPlan,data:{courseId:this.courseId,topicId:b,start:this.startDate,end:this.endDate,insertAfterPlanId:e,showPlanDates:this.showPlanDates,currentDisplayMode:this.planner.currentDisplayMode,isSearching:d.isSearching},success:function(b){a.useTopics&&(d.getTopicExpanderLink().html(b.topicExpanderText),
d.hasPlans=b.hasPlans);d.appendNewPlan(b.planRow,b.planId);d.showPlanActionMenu();d.hidePlanMoveOptionsIfNecessary();a.planner.toggleEnableDisplayModeSwitcher(!0);a.addingPlanInProgress=!1},error:function(b,d,c){CCL.CommonFunctions.alertAjaxError(b,d,c);a.planner.toggleEnableDisplayModeSwitcher(!0);a.addingPlanInProgress=!1}})}};e.prototype.removePlan=function(b,a){this.removePlans(b,[a],!1)};e.prototype.removePlans=function(b,a,d){var e=this;void 0===a&&(a=null);void 0===d&&(d=!0);var g=c.Cards.TopicCard.getInstance(b);
d&&null==a&&(a=g.getSelectedPlanIds(!0));null!=a&&this.planner.showConfirmDialog(d?this.terms.DeletePlansConfirmation:this.terms.DeletePlanConfirmation,function(c){c&&CCL.CommonFunctions.safeAjaxPost({url:e.planner.webMethods.Plan.RemovePlans,traditional:!0,data:{courseId:e.courseId,topicId:b,planIds:a,updatePlanCount:e.useTopics,start:e.startDate,end:e.endDate,showPlanDates:e.showPlanDates,isBulkAction:d},success:function(b){e.useTopics&&(g.getTopicExpanderLink().html(b.topicExpanderText),g.hasPlans=
b.hasPlans);g.showPlanFeedbackMessage(CCL.FeedbackType.Information,b.restoreText);g.clearPlanSelection();g.removePlansFromGrid(a,b.emptyGridText);g.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError})},this.planner.terms.Delete,this.planner.terms.Cancel)};e.prototype.restorePlans=function(b,a){var d=this,e=c.Cards.TopicCard.getInstance(b);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.RestorePlans,traditional:!0,data:{courseId:this.courseId,topicId:b,planIds:a,
start:this.startDate,end:this.endDate,updatePlanCount:this.useTopics,showPlanDates:this.showPlanDates},success:function(b){d.useTopics&&(e.getTopicExpanderLink().html(b.topicExpanderText),e.hasPlans=b.hasPlans);e.refreshPlanGrid(function(){b.restoreText&&e.showPlanFeedbackMessage(CCL.FeedbackType.Information,b.restoreText)},a)},error:CCL.CommonFunctions.alertAjaxError})};e.prototype.togglePlanStatus=function(b,a,d){this.togglePlansStatus(b,d,[a],!1)};e.prototype.togglePlansStatus=function(b,a,d,e){var f=
this;void 0===d&&(d=null);void 0===e&&(e=!0);var g=c.Cards.TopicCard.getInstance(b);e&&null==d&&(d=g.getSelectedPlanIds(!0));if(null!=d){var k=function(b){CCL.CommonFunctions.safeAjaxPost({url:f.planner.webMethods.Plan.TogglePlansStatus,traditional:!0,data:{courseId:f.courseId,planIds:d,activate:a,showPlanDates:f.showPlanDates,toggleElementsActivation:b,isBulkAction:e},success:function(b){1===d.length?g.showPlanFeedbackMessage(CCL.FeedbackType.Information,a?f.terms.PlanActivated:f.terms.PlanDeactivated):
g.showPlanFeedbackMessage(CCL.FeedbackType.Information,a?f.terms.PlansActivated:f.terms.PlansDeactivated);e&&g.clearPlanSelection();$.each(b,function(a,b){$(document).trigger(f.planner.events.PlanDateCellChange,{dateCellObject:b,planContainer:g.getPlanContainerById(b.planId)})})},error:CCL.CommonFunctions.alertAjaxError})};!a&&this.planner.settings.ActivateElementsByPlan&&g.containsPlanElements(d)?this.planner.showConfirmDialog(e?this.terms.PlansDeactivatedWithElementsWarning:this.terms.PlanDeactivatedWithElementsWarning,
function(a){k(a)}):k(!0)}};e.prototype.notifyAboutChanges=function(b){null!=b&&CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.NotifyAboutChanges,data:{courseId:this.courseId,planId:b},success:function(){},error:CCL.CommonFunctions.alertAjaxError})};e.prototype.movePlan=function(b,a,d){this.movePlans(b,d,[a])};e.prototype.movePlans=function(b,a,d){void 0===d&&(d=null);var e=c.Cards.TopicCard.getInstance(b);null==d&&(d=e.getSelectedPlanIds(!0));null!=d&&(d.length>=e.getPlanGrid().getRowsCount()||
CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.MovePlans,traditional:!0,data:{courseId:this.courseId,topicId:b,planIds:d,moveUp:a,start:this.startDate,end:this.endDate},success:function(a){e.sortPlans(a.sortedPlanIds);e.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError}))};e.prototype.setPlanDates=function(b){var a=c.Cards.TopicCard.getInstance(b),d=a.getSelectedPlanIds(!0);null!=d&&this.planner.getSetDateDialog().open(d,function(b){a.updatePlanCellsCallback(b)},
function(){a.clearPlanSelection()},b)};e.prototype.sharePlans=function(b){var a=this,d=c.Cards.TopicCard.getInstance(b),e=d.getSelectedPlanIds(!0);null!=e&&CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.ShareablePlanner.CheckPlanDataForSharing,data:{courseId:this.courseId,planIds:e}}).done(function(b){b&&b.conflictMessage?CCL.CommonFunctions.jAjaxAlert(b.conflictMessage,a.planner.terms.Alert,a.planner.terms.Ok):b&&b.warningMessage?a.planner.showConfirmDialog(b.warningMessage,function(a){a&&
d.redirectToSharePlans(e)}):d.redirectToSharePlans(e)}).fail(CCL.CommonFunctions.alertAjaxError)};e.prototype.stopSharingPlan=function(b,a,d){var e=this,g=c.Cards.TopicCard.getInstance(a);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.ShareablePlanner.StopSharingPlans,data:{courseId:this.courseId,planIds:[d]}}).done(function(){e.planner.settings.UseTopics&&g&&g.clearPlanSelection();$(b).parent().hide()}).fail(CCL.CommonFunctions.alertAjaxError)};return e}();c.PlanCommonLogic=g})(c.Planner||
(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(a){function b(b,d,c){var e=this;a.call(this,b,d);$(function(){e.columnsData=[];e.addColumnsToEdit(c)})}__extends(b,a);b.getInstance=function(){return window[e.PlannerInlineCellBase.clientInstanceName]};b.prototype.addColumnsToEdit=function(a){var d=this;$.each(a,function(a,e){d.columnsData[e.HybridEditorItemId]=e;(a=$("div["+c.PlannerConstants.dataAttributes.HybridEditorItem+"][id *= "+e.HybridEditorItemId+"]"))&&a.data(b.hybridEditorItemIdDataAttr,
e.HybridEditorItemId)})};b.prototype.getEditorItemSettings=function(b){return(b=this.columnsData[b])?a.prototype.getSettings.call(this,b):{}};b.prototype.measureKpiEditPlan=function(){c.Planner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){return this.columnsData[a.data(b.hybridEditorItemIdDataAttr).toString()]};b.prototype.replaceMediaContentWithPlaceholders=function(){return c.Planner.getInstance().isTableCurrentMode()};return b}(e.PlannerInlineCellBase);e.PlannerInlineCell=
b})(g.InlineCell||(g.InlineCell={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){var e=function(){function b(a,b){var d=this;this.focusTitle=function(){d.$topicTitle.select()};window[a]=this;this.settings=b;this.planner=c.Planner.getInstance();this.$topicTitle=$("#"+this.settings.Controls.TopicTitleId);this.$errorMessage=$("#"+this.settings.Controls.ErrorMessageId);this.$saveButton=$("#"+this.settings.Controls.SaveButtonId);this.attachEventHandlers()}b.prototype.open=function(){var a=this,b=this.getDialog(),c=this.getColorPicker();this.clearForm();
CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetRandomColorSchemeForNewTopic+"/"+this.planner.settings.CourseId}).done(function(a){c.setColor(a.topicColorSchema)}).fail(function(){c.setColor(a.settings.TopicDefaultColorSchema)});b.openDialog()};b.prototype.getColorPicker=function(){return window[this.settings.Controls.ColorPickerId]};b.prototype.attachEventHandlers=function(){var a=this;this.$saveButton.click(function(){return a.validateAndSave()});this.$topicTitle.keypress(function(b){return 13===
b.keyCode?(a.validateAndSave(),!1):!0})};b.prototype.clearForm=function(){this.$errorMessage.hide();this.$saveButton.toggleHyperlink(!0)};b.prototype.validateAndSave=function(){if(this.$saveButton.getIfHyperLinkEnabled()){var a=$.trim(this.$topicTitle.val());if(0<a.length){var b=this.getColorPicker().getSelectedColorKey();this.addTopic(a,b)}else this.$errorMessage.show()}};b.prototype.addTopic=function(a,b){var d=this;this.$saveButton.toggleHyperlink(!1);c.TopicCommonLogic.getInstance().addTopic(a,
b,CssModal.closeDialog,function(){d.$saveButton.toggleHyperlink(!0)})};b.prototype.getDialog=function(){return window[this.settings.TopicAddDialogInstance]};return b}();g.TopicAddDialog=e})(c.Dialogs||(c.Dialogs={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(){function a(b,e){window[b]=this;a.instanceName=b;this._settings=e;this._css=e.Css;this._planner=c.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._currentColumnId=this._currentTopicId=0;this.attachEvents()}a.getTopicLearningObjectivesCellInstance=function(){return window[a.instanceName]};a.prototype.updateLearningObjectives=function(a){var b=this,d=this._currentTopicId,c=this._currentColumnId;CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.LearningObjective.AddTopicLearningObjectives,
data:{courseId:this._courseId,learningObjectiveIds:a,topicId:d,columnId:c}}).done(function(a){b.getLearningObjectivesListCell(d,c).html(a.contentHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getLearningObjectivesListCell=function(a,b){return $("."+this._css.CardCell+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).parent()};a.prototype.getLearningObjectiveIds=function(a,b,c){var d=this;a=a.find(""+
CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,c)+CCL.CommonFunctions.getDataSelector(this._planner.data.LearningObjectiveId));var e=[];0<a.size()&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(d._planner.data.LearningObjectiveId))&&e.push(parseInt(a.data(d._planner.data.LearningObjectiveId)))});return e};a.prototype.removeLearningObjective=function(a,b,c){var d=this;CCL.CommonFunctions.safeAjax({type:"DELETE",url:this._planner.webMethods.LearningObjective.RemoveTopicLearningObjective,
data:{courseId:this._courseId,topicId:a,learningObjectiveId:c,columnId:b}}).done(function(c){d.getLearningObjectivesListCell(a,b).html(c.contentHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.attachEvents=function(){var a=this;this._planner.getContainer().on("click","."+this._css.AddLearningObjectives,function(b){a._currentTopicId=$(b.currentTarget).data(a._planner.data.TopicId);a._currentColumnId=$(b.currentTarget).data(a._planner.data.ColumnId);b=window[a._settings.LearningObjectiveSelector];
b.setSelectedIds(a.getLearningObjectiveIds(a.getLearningObjectivesListCell(a._currentTopicId,a._currentColumnId),a._currentTopicId,a._currentColumnId),!0);b.openDialog()});$(document).on("click","."+this._css.RemoveLearningObjective,function(b){b=$(b.currentTarget);a.removeLearningObjective(b.data(a._planner.data.TopicId),b.data(a._planner.data.ColumnId),b.data(a._planner.data.LearningObjectiveId))})};return a}();e.TopicLearningObjectivesCell=b})(g.Topic||(g.Topic={}))})(c.Cells||(c.Cells={}))})(c.Planner||
(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(g){(function(e){var b=function(){function a(b,e){window[b]=this;a.instanceName=b;this._settings=e;this._css=e.Css;this._terms=e.Terms;this._planner=c.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._contextDialog=new ContextDialog($("#"+e.TermEditorId),{title:this._terms.TermContextDialogTitle,footerContent:e.TermEditorFooterId,setFocus:!1,width:"auto",zIndex:1});$.each($("."+this._css.TermRadioButton),function(a,b){$(b).find(":radio").attr("name",
"TermGroup")});this.attachEvents()}a.getTopicTermCellInstance=function(){return window[a.instanceName]};a.prototype.editTerm=function(a,b,c,e){this._currentTopicId=c;this._activeContainer=b.parent();this._contextDialog.openDialog(a);null!=e?$("."+this._css.TermRadioButton+CCL.CommonFunctions.getDataSelector(this._planner.data.CourseTermId,e)).find(":radio").attr("checked","checked").focus():($("."+this._css.TermRadioButton).find(":radio:checked").removeAttr("checked").blur(),$("."+this._css.TermRadioButton+
":first").find(":radio").focus())};a.prototype.attachEvents=function(){var a=this;this._contextDialog.setBeforeCloseDialog(function(){a.beforeCloseClontextDialog()});this._planner.getContainer().on("click","."+this._css.EditTermLink,function(b){var d=$(b.currentTarget),c=d.data(a._planner.data.TopicId),e=d.data(a._planner.data.CourseTermId);!a._contextDialog.mainContainer.is(":visible")&&0<c&&a.editTerm(b,d,c,e)});$("#"+this._settings.SaveTermButtonId).on("click",function(){a._contextDialog.closeDialog()});
$("#"+this._settings.ClearTermLinkId).on("click",function(){$("."+a._css.TermRadioButton).find(":radio:checked").removeAttr("checked")})};a.prototype.beforeCloseClontextDialog=function(){var a=this,b=$("."+this._css.EditTermLink+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,this._currentTopicId)).data(this._planner.data.CourseTermId),e=$("."+this._css.TermRadioButton).has(":radio:checked").data(this._planner.data.CourseTermId);b!==e&&CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.TopicTerm.UpdateTopicTerm,
data:{courseId:this._courseId,topicId:this._currentTopicId,courseTermId:void 0!==e?e:0,start:this._planner.settings.FilterStartDate,stop:this._planner.settings.FilterEndDate}}).done(function(b){if(b){a._activeContainer.replaceWith(b.termCell);$(document).trigger(a._planner.events.PlanDateCellsChanged,{dateCellObjects:b.dateCells});var d=c.Cards.TopicCard.getInstance(a._currentTopicId);d&&d.setTermDates(a._planner.parseDateFromString(b.termStartDate),a._planner.parseDateFromString(b.termStopDate))}})};
return a}();e.TopicTermCell=b})(g.Topic||(g.Topic={}))})(c.Cells||(c.Cells={}))})(c.Planner||(c.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){c.mentorFeedbackOverviewInstance=this;this.context=b;this.$window=$(window);this.setMentorFeedbackSelectorAction();this.setCompleteButtonAction();this.setUndoButtonAction();this.context.Settings.IsToolbarButtonsAvailable?(this.setfeedbackSetupAction(),this.setMultipleAssessAction()):(window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+this.context.Controls.FeedbackSetupButtonId)),window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+
this.context.Controls.AssessMultipleButtonId)));b=$("."+this.context.CssClasses.HybridEditorItemCss);this.bindToEditorItemEvents(b);window[this.context.Controls.PersonGrid].toggleSelectAll(!1)}e.prototype.onSetFeedbackColumnValueError=function(b,a){a=a.xhrObject.status;CCL.CommonFunctions.jAlertAjaxError(409===a?this.context.LanguageTerms.AlertMessage:this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,409===a);b.stopPropagation()};e.prototype.bindToEditorItemEvents=
function(b){var a=this;b.on(this.context.Events.HybridEditorItemAjaxError,function(b,c){a.onSetFeedbackColumnValueError(b,c)}).on(this.context.Events.HybridEditorItemSaveError,function(b,c){a.onSetFeedbackColumnValueError(b,c)})};e.prototype.checkLogAvailability=function(b){var a=window[c.mentorFeedbackOverviewInstance.context.Controls.PersonGrid].getRowById(b);a=$("."+c.mentorFeedbackOverviewInstance.context.CssClasses.MentorFeedbackSelectorCss,a).attr(c.mentorFeedbackOverviewInstance.context.Settings.MentorFeedbackIdAttribute);
c.mentorFeedbackOverviewInstance.safeAjaxPostHandler(c.mentorFeedbackOverviewInstance.context.WebMethods.LogAvailability,{mentorFeedbackId:a},function(a){c.mentorFeedbackOverviewInstance.toggleLogLink(a.available,b)})};e.prototype.setfeedbackSetupAction=function(){var b=this;$("#"+this.context.Controls.FeedbackSetupButtonId).click(function(){return b.isAnyStudentSelected(function(a){for(var d,c="",e=0;e<a.length;e++){var g=b.getLearnerMentorFeedbackId(a[e]);if(0===e)d=g;else if(d!==g){c=b.context.LanguageTerms.DifferentMfConfirmation;
break}}var k=b.context.Urls.FeedbackSetupDialogUrl+"&"+b.context.Settings.PersonIdAttribute+"="+a.join(",");""!==c?jConfirm(c,b.context.LanguageTerms.PleaseConfirm,function(a){a&&b.openDialog(k,b.context.Controls.FeedbackSetupDialog)}):b.openDialog(k,b.context.Controls.FeedbackSetupDialog)})})};e.prototype.setMultipleAssessAction=function(){var b=this;$("#"+this.context.Controls.AssessMultipleButtonId).click(function(){return b.isAnyStudentSelected(function(a){for(var d=0,c=b.context.LanguageTerms.WarningNoMfSelected,
e=0;e<a.length;e++){var g=b.getLearnerMentorFeedbackId(a[e]);if(0!==g){if(0!==d&&d!==g){c=b.context.LanguageTerms.WarningDifferentMfSelected;break}d=g;c=""}}""!==c?jAlert(c,b.context.LanguageTerms.AlertTitle,null):(a=b.context.Urls.AssessMultipleDialogUrl+"&"+b.context.Settings.TermAssessmentAttributeId+"="+d+"&"+b.context.Settings.PersonIdAttribute+"="+a.join(","),b.openDialog(a,b.context.Controls.AssesMultipleDialog))})})};e.prototype.openDialog=function(b,a){window[a].setIframeUrl(b);window[a].openDialog()};
e.prototype.isAnyStudentSelected=function(b){var a=window[this.context.Controls.PersonGrid].getSelectedValues();0===a.length?jAlert(this.context.LanguageTerms.AlertNoPersonSelected,this.context.LanguageTerms.AlertTitle,null):b(a)};e.prototype.getLearnerMentorFeedbackId=function(b){return+$("select["+this.context.Settings.LearnerIdAttribute+"='"+b+"']").val()};e.prototype.setCompleteButtonAction=function(){var b=this;$("#"+this.context.Controls.CompleteTermButtonId).click(function(){jConfirm(b.context.LanguageTerms.CompleteTermWarning,
b.context.LanguageTerms.PleaseConfirm,function(a){a&&b.safeAjaxPostHandler(b.context.WebMethods.CompleteTerm,{organizationId:b.context.Settings.OrganizationId,termId:b.context.Settings.TermId},function(){$("#"+b.context.Controls.CompleteContainer).hide();$("#"+b.context.Controls.UndoContainer).show()})})})};e.prototype.setUndoButtonAction=function(){var b=this;$("#"+this.context.Controls.UndoCompleteTermButtonId).click(function(){b.safeAjaxPostHandler(b.context.WebMethods.UndoCompleteTerm,{organizationId:b.context.Settings.OrganizationId,
termId:b.context.Settings.TermId},function(){$("#"+b.context.Controls.UndoContainer).hide();$("#"+b.context.Controls.CompleteContainer).show()})})};e.prototype.ajaxHandler=function(b,a,d){var c=this;this.errorRised=!1;$.ajax({type:"POST",url:b,dataType:"json",data:a,success:d,error:function(a){return c.ajaxErrorHandler(a)}})};e.prototype.safeAjaxPostHandler=function(b,a,d){var c=this;this.errorRised=!1;CCL.CommonFunctions.safeAjaxPost({url:b,dataType:"json",data:a,success:d,error:function(a){return c.ajaxErrorHandler(a)}})};
e.prototype.ajaxErrorHandler=function(b){this.errorRised||(this.errorRised=!0,409===b.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertMessage,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,!0):0===b.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,!1):CCL.CommonFunctions.alertAjaxError(b,null,null))};e.prototype.setMentorFeedbackSelectorAction=
function(){var b=this;$("."+this.context.CssClasses.MentorFeedbackSelectorCss).focus(function(a){return b.feedbackSetupPreviousValue=$(a.target).val()}).change(function(a){var d=$(a.target).attr(b.context.Settings.LearnerIdAttribute);$.getJSON(b.context.WebMethods.IsMentorFeedbackValuesExist,{learnerId:d,organisationId:b.context.Settings.OrganizationId,hierarchyId:b.context.Settings.HierarchyId,termId:b.context.Settings.TermId},function(d){d.result?jConfirm(b.context.LanguageTerms.ChangeFeedbackSetupWarning,
b.context.LanguageTerms.PleaseConfirm,function(d){d?b.changeMentorSetup(a):$(a.target).val(b.feedbackSetupPreviousValue)}):b.changeMentorSetup(a)})})};e.prototype.changeMentorSetup=function(b){var a=this,d=$(b.target),c=d.attr(this.context.Settings.LearnerIdAttribute),e=$("."+c),g=d.val();this.toggleLogLink(!1,c);if(g===this.context.Settings.DefaultMentorFeedbackSelectorValue)b=d.attr(this.context.Settings.MentorFeedbackIdAttribute),this.safeAjaxPostHandler(this.context.WebMethods.RemoveFeedbackSetup,
{mentorFeedbackId:b,learnerId:c,organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId},function(){e.addClass(a.context.CssClasses.HiddenCss);$("."+a.context.CssClasses.CommentLabelCss,e).text("");for(var b=$("."+a.context.CssClasses.HybridEditorItemCss,e),c=0;c<b.length;c++){var f=$(b[c]);f.hybridEditorItem().hybridEditorItem("resetValue");f.hybridEditorItem().hybridEditorItem("setToolTip","");var g=f.hybridEditorItem().hybridEditorItem("option","webMethodParams");
g.mentorFeedbackId="";g.columnId="";f.hybridEditorItem().hybridEditorItem("option","webMethodParams",g)}$("."+a.context.CssClasses.CommentPanelCss,e).addClass(a.context.CssClasses.HiddenCss);d.attr(a.context.Settings.MentorFeedbackIdAttribute,"")});else{var k=d.attr(this.context.Settings.LearnerNameAttribute);this.safeAjaxPostHandler(this.context.WebMethods.SetFeedbackSetup,{organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId,learnerId:c,termAssessmentId:g},
function(b){d.attr(a.context.Settings.MentorFeedbackIdAttribute,b.mentorFeedbackId);e.removeClass(a.context.CssClasses.HiddenCss);var f=a.context.TermAssessmentCustomColumns[g],h=$("."+a.context.CssClasses.CommentLabelCss,e),l=$("."+a.context.CssClasses.HybridEditorItemCss,e),m=$("."+a.context.CssClasses.CommentPanelCss,e);a.setUrlToLogLink(b.mentorFeedbackId,c);for(var n,t,v=0;v<f.length;v++)$(h[v]).text(f[v].Name),t=$(l[v]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",
f[v].ToolTip+" "+k),n=t.hybridEditorItem().hybridEditorItem("option","webMethodParams"),n.mentorFeedbackId=b.mentorFeedbackId,n.columnId=String(f[v].CustomColumnId),t.hybridEditorItem().hybridEditorItem("option","webMethodParams",n),$(m[v]).removeClass(a.context.CssClasses.HiddenCss);if(f.length<h.length)for(b=h.length,f=f.length;f<b;f++)$(h[f]).text(""),t=$(l[f]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",""),n=t.hybridEditorItem().hybridEditorItem("option",
"webMethodParams"),n.mentorFeedbackId="",n.columnId="",t.hybridEditorItem().hybridEditorItem("option","webMethodParams",n),$(m[f]).addClass(a.context.CssClasses.HiddenCss)})}};e.prototype.setUrlToLogLink=function(b,a){var d=window[this.context.Controls.PersonGrid].getRowById(a);$("."+this.context.CssClasses.LogLinkCss,d).attr("href",this.context.Urls.LogLink+"?"+this.context.Settings.PersonIdAttribute+"="+a+"&"+this.context.Settings.SupervisorTypeRequestItem+"="+this.context.Settings.SupervisorType+
"&"+this.context.Settings.MentorFeedbackIdRequestItem+"="+b)};e.prototype.toggleLogLink=function(b,a){var d=window[this.context.Controls.PersonGrid].getRowById(a);a=$("."+this.context.CssClasses.LogLinkCss,d);d=$("."+this.context.CssClasses.NoLogLabelCss,d);b?(a.removeClass(this.context.CssClasses.HiddenCss),d.addClass(this.context.CssClasses.HiddenCss)):(a.addClass(this.context.CssClasses.HiddenCss),d.removeClass(this.context.CssClasses.HiddenCss))};return e}();c.MentorFeedbackOverview=g})(c.Mentor||
(c.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function e(b){c.mentorFeedbackAssessMultipleInstance=this;this.context=b;this.window=$(window);this.setOkClickEvent()}e.prototype.setOkClickEvent=function(){var b=this;$("#"+this.context.Settings.OkClientId).click(function(){for(var a="",d=$('[id*="CustomColumnValue"]'),c=0;c<d.length;c++){var e=$(d[c]);e.val().trim()&&(e=e.attr("data-cc-id"),-1<b.context.Settings.FilledCustomColumns.indexOf(e)&&(a=b.context.Settings.TermCommentWarning))}""!==a?jConfirm(a,
b.context.Settings.TermPleaseConfirm,function(a){a&&b.context.Functions.OkPostbackScript()}):b.context.Functions.OkPostbackScript()})};return e}();c.MentorFeedbackAssessMultiple=g})(c.Mentor||(c.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(g){(function(b){b[b.Expanded=1]="Expanded";b[b.Collapsed=2]="Collapsed";b[b.Loading=3]="Loading"})(g.FolderExpandState||(g.FolderExpandState={}));var k=g.FolderExpandState,e=function(){function b(a,b,e){var d=this;this.settings=b;this.controls=e;this.inputTypeCheckboxSelector="input:checkbox";this.stateChangedHandler=function(a){var b=$(a.target);a=d.closestItem(b);b=d.updateItemState(a,b.is(":checked"));a.find(d.inputTypeCheckboxSelector).first().focus();d.controls.Container.trigger(d.settings.StateChangedEventName,
b)};window[a]=this;this.checkboxStateMachine=new c.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler()}Object.defineProperty(b.prototype,"itemSelector",{get:function(){return CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"listItemFocusedAreaSelector",{get:function(){return"."+this.settings.CssClasses.ListItemFocusedArea},enumerable:!0,configurable:!0});b.prototype.init=function(a){this.initParameters=
a};b.prototype.expandFolder=function(a){var b=this,c=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=c.data(this.settings.DataAttributes.FolderActionExpand),g=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();e?this.setFolderState(g,c,k.Expanded):(this.setFolderState(g,c,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){g.append(a);b.setFolderState(g,c,k.Expanded);
b.onFolderContentLoaded()}))};b.prototype.onFolderContentLoaded=function(){var a=this;this.initParameters.itemStates.forEach(function(b,c){a.checkboxStateMachine.isElementChecked(b)&&(b=a.getCheckbox(c))&&0<b.length&&b.prop("checked",!0)});this.initParameters.disabledItemIds&&this.initParameters.disabledItemIds.forEach(function(b){(b=a.getCheckbox(b))&&b.prop("disabled",!0)})};b.prototype.countItemsChanged=function(){return c.MapUtils.reduce(this.initParameters.itemStates,function(a,b,e){return e===
c.CheckboxStateMachine.State.AttachedByUser||e===c.CheckboxStateMachine.State.DetachedByUser?a+1:a},0)};b.prototype.countCheckedItems=function(){var a=this;return c.MapUtils.reduce(this.initParameters.itemStates,function(b,c,e){return a.checkboxStateMachine.isElementChecked(e)?b+1:b},0)};b.prototype.setupListItemFocusedAreaClickHandler=function(){var a=this;this.controls.Container.on((b={},b.change=this.stateChangedHandler,b),this.inputTypeCheckboxSelector);this.controls.Container.on("click",this.listItemFocusedAreaSelector,
function(b){b=$(b.target);var d=a.closestItem(b);a.isClickTargetEnabled(b,d)&&(a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(d):a.isListItemFocusedArea(b)&&(b=a.getCheckbox(a.getItemId(d)),b.prop("checked",!b.is(":checked")).change()))});this.controls.Container.on("keyup",this.listItemFocusedAreaSelector,function(b){b.which===CCL.CommonConstants.keyCodes.space&&(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.closestItem(b)))});var b};b.prototype.isClickTargetEnabled=
function(a,b){return 0>=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length||this.initParameters.allowFolderSelection&&this.isCheckboxExistAndEnabled(b)};b.prototype.targetIsFolderActionExpand=function(a){return a.is(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand))||0<a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length};b.prototype.updateItemState=function(a,b){a=
this.getItemId(a);var d=this.initParameters.itemStates.get(a)||c.CheckboxStateMachine.State.Empty;b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(b,d);this.initParameters.itemStates.set(a,b);return this.countCheckedItems()};b.prototype.expandOrCollapseFolder=function(a){var b=this,c=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=c.data(this.settings.DataAttributes.FolderActionExpand),g=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();
e?e===k.Expanded?this.setFolderState(g,c,k.Collapsed):e===k.Collapsed&&this.setFolderState(g,c,k.Expanded):(this.setFolderState(g,c,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){g.append(a);b.setFolderState(g,c,k.Expanded);b.onFolderContentLoaded()}))};b.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.getCheckbox(this.getItemId(a)))&&0<a.length&&a.is(":enabled")};b.prototype.setFolderState=function(a,b,c){a.toggle(c===k.Expanded);this.closestListItemFocusedArea(b).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
c===k.Expanded);b.data(this.settings.DataAttributes.FolderActionExpand,c);a=b.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,c!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,c===k.Expanded)};b.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};b.prototype.getFolderContent=function(a){return $.ajax({type:"GET",url:this.settings.Urls.FolderContent,
data:a,dataType:"html"})};b.prototype.isListItemFocusedArea=function(a){return a.is(this.listItemFocusedAreaSelector)};b.prototype.closestListItemFocusedArea=function(a){return a.closest(this.listItemFocusedAreaSelector)};b.prototype.closestItem=function(a){return a.closest(this.itemSelector)};b.prototype.getItemId=function(a){return a.data(this.settings.DataAttributes.ItemId)};b.prototype.getCheckbox=function(a){return $("#"+this.controls.CheckboxItemPrefix+a)};return b}();g.TreeViewSelector=e})(c.TreeViewSelector||
(c.TreeViewSelector={}))})(ItslearningWeb||(ItslearningWeb={}));(function(c){(function(c){c.getFormDataWithAttachedFilesAndFileSizes=function(c){c=c.files;var e=[];if(0<c.length&&FormData){for(var b=new FormData,a=0;a<c.length;a++)0<c[a].size&&(b.append("file"+a,c[a]),e.push(c[a].size));return{formData:b,fileSizes:e}}}})(c.UploadFileHelper||(c.UploadFileHelper={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){return function(){this.timeout=500}}();c.IframeLoadingIndicatorSettings=g;g=function(){function c(b){var a=this;this.settings=b;this.showAfterDelay=!0;this.loadingIndicator=$("#"+this.settings.loadingIndicatorClientId);$(window).load(function(){$("#"+a.settings.iframeClientId).ready(function(){a.hideIndicator()})});$(document).on("cssmodal:show",function(){a.hideIndicator()});setTimeout(function(){a.showAfterDelay&&a.loadingIndicator.show()},this.settings.timeout)}
c.prototype.hideIndicator=function(){if(null!=this.settings.onHideCallback)this.settings.onHideCallback();this.showAfterDelay=!1;this.loadingIndicator.hide()};return c}();c.IframeLoadingIndicator=g})(c.ViewLearningToolElement||(c.ViewLearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){(function(c){var e=function(){function b(){var a=this;this.featureDialogMap={};this.antiForgerySettings={};this.dispatch=function(b){switch(b.type){case CCL.Onboarding.Extensions.MessageType.CompleteFeature:a.completeFeatures(b.features);break;case CCL.Onboarding.Extensions.MessageType.TriggerOnboardingFeature:a.triggerFeature(b.featureId);break;case CCL.Onboarding.Extensions.MessageType.HideOverlay:a.hideOverlay();break;case CCL.Onboarding.Extensions.MessageType.ShowOverlay:a.showOverlay();
break;case CCL.Onboarding.Extensions.MessageType.RequestFeatureState:a.requestFeatureState(b.featureId).done(function(c,d,e){d=a.extensionIframe.get(0).contentWindow;e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionOnboarding);var f={featureId:b.featureId,type:CCL.Onboarding.Extensions.MessageType.ReceiveFeatureState};$.extend(f,c);CCL.CommonFunctions.makePostMessageCallWithData(d,e,f)})}};this.triggerFeature=function(b){b&&a.requestFeatureState(b).done(function(c,
d,e){c.IsCompleted?a.triggerFeature(a.featureDialogMap[b].nextFeatureId):(c=window[a.featureDialogMap[b].dialogClientId],c.blockHighlightZone=!0,c.openDialog(function(c){c?a.completeFeatures([a.featureDialogMap[b].featuresForComplete]):a.triggerFeature(a.featureDialogMap[b].nextFeatureId)}))})};this.completeFeatures=function(b){for(var c=0;c<b.length;c++){var d=b[c];d&&CCL.CommonFunctions.safeAjax({url:a.onboardingServiceUrl.replace("{featureId}",d),type:"PUT",headers:(e={},e[a.antiForgerySettings.headerName]=
a.antiForgerySettings.headerValue,e)})}var e}}b.prototype.init=function(a,b,c){this.pageOptions=c;this.onboardingServiceUrl=a;this.extensionIframe=b;this.antiForgerySettings=this.pageOptions.antiForgerySettings;this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentLearningToolOptions]={dialogClientId:c.optionsOnboradingClientId,nextFeatureId:CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders,featuresForComplete:[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]};
this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]={dialogClientId:c.pageFunctionsClientId};CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.extensionOnboarding,this.dispatch)};b.prototype.showOverlay=function(){this.extensionIframe.css("position","relative");this.extensionIframe.css("z-index","1000");$("<div></div>").appendTo(document.body).addClass(this.pageOptions.cssClasses.onboardingDialogMask).css({opacity:"0",
filter:"alpha(opacity=0)","z-index":997}).fadeTo(0,1)};b.prototype.hideOverlay=function(){this.extensionIframe.css("position","");this.extensionIframe.css("z-index","");$("."+this.pageOptions.cssClasses.onboardingDialogMask).remove()};b.prototype.requestFeatureState=function(a){return $.ajax({url:this.onboardingServiceUrl.replace("{featureId}",a),type:"GET"})};return b}();c.PostMessageDispatcher=e})(c.ViewLearningToolElement||(c.ViewLearningToolElement={}))})(c.Onboarding||(c.Onboarding={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(c){(function(g){var k=function(){function e(b,a){var c=this;window[b]=this;this.settings=a;$(function(){CCL.CommonFunctions.attachPostMessageEventListener($(window),c.settings.SendElementIdToCourseFeature,function(a){c.elementList.addElement(a.elementId).done(function(){return c.refreshLeftMenu(a.folderId,a.elementId,a.notFocusingOnElement)})});c.elementList=window[c.settings.ClientInstanceNames.ElementListClient];c.feedback=window[c.settings.ClientInstanceNames.Feedback];c.$titleTextBox=
$("#"+c.settings.Controls.TitleTextBox);c.$saveButton=$("#"+c.settings.Controls.SaveButton);c.$learningObjectiveSelector=$("#"+c.settings.Controls.LearningObjectiveSelector);c.$saveButton.click(function(){var a=""!==c.$titleTextBox.val();a||(c.feedback.showMessage(CCL.FeedbackType.Error,c.settings.Terms.ValidationError),$("html, body").animate({scrollTop:0}));return a});$("."+c.settings.Css.AddLinkCss).click(function(a){return c.onAddLinkClick($(a.currentTarget))})})}e.prototype.addElement=function(b,
a,c,e){this.elementList.addElementItem(b,a,c,e)};e.prototype.removeElement=function(b){this.elementList.deleteElement(b)};e.prototype.refreshLeftMenu=function(b,a,c){var d=top;d&&d.reloadFolder&&(d.reloadFolder(),d.reloadFolder("item"+b,"item"+a),d.notFocusingOnElement=c)};e.prototype.onAddLinkClick=function(b){var a=this,d=parseInt(b.data(this.settings.DataAttributes.ElementType),10);if(parseInt(b.data(this.settings.DataAttributes.ElementExternalSource),10)===c.AddResourceMenu.ElementExternalSourceType.Course){b=
{locationId:this.settings.CourseId,locationType:c.AddResourceMenu.ElementExternalSourceType.Course};var e=this.elementList.getElementIds(),g=new Map;$.each(e,function(a,b){g.set(b,c.CheckboxStateMachine.State.Saved)});e=d===c.ElementLinkDialog.ContentElementType.Resources?this.settings.Terms.AddResource:this.settings.Terms.AddActivity;d={elementStates:c.MapUtils.makeCopy(g),elementType:d,showAll:!1,header:e,learningObjectiveId:this.$learningObjectiveSelector.val(),allowFolderSelection:!1,openerPage:c.ElementLinkDialog.ElementsPopupOpener.WorkingPortfolioTask,
afterOkClickCallback:function(b){var d=[],e=[];b&&b.forEach(function(a,b){a===c.CheckboxStateMachine.State.AttachedByUser||a===c.CheckboxStateMachine.State.Saved?d.push(b):a===c.CheckboxStateMachine.State.DetachedByUser&&e.push(b)});a.elementList.deleteElements(e);a.elementList.addElements(d)}};c.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(d,b)}};return e}();g.AddEditTask=k})(c.WorkingPortfolio||(c.WorkingPortfolio={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(c){(function(c){var g=function(){function c(b,a,c){this.settings=a;this.getSelectedIds=c;window[b]=this}c.prototype.transferToPortfolio=function(b){if(null!=this.getSelectedIds){var a=this.getSelectedIds();0===a.length?CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.NoElementsSelected,this.settings.Terms.Alert,this.settings.Terms.Ok,!1):(b=""+this.settings.TransferPageUrlConstantPart+("&"+this.getTransferLocationRequestItem(b))+("&"+this.settings.RequestItems.ElementIds+"="+a.join()),
window.location.href=b)}};c.prototype.getTransferLocationRequestItem=function(b){var a=b.startsWith(this.settings.Prefixes.CourseIdPrefix),c=a?this.settings.RequestItems.CourseId:this.settings.RequestItems.PortfolioId;b=parseInt(b.substring((a?this.settings.Prefixes.CourseIdPrefix:this.settings.Prefixes.PortfolioIdPrefix).length),10);return c+"="+b};return c}();c.WorkingPortfolio=g})(c.WorkingPortfolio||(c.WorkingPortfolio={}))})(ItslearningWeb||(ItslearningWeb={}));
